"use strict";(self.webpackChunkcircle=self.webpackChunkcircle||[]).push([["418"],{452187:function(e,t,n){n.d(t,{b:()=>a});var r=n(93199),o=n(547144);function i(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var a={update:function(e,t,n){return(0,r.aU)(o.av.AccountSubscriptions.update(e,t,n))},renew:function(e){return(0,r.Cu)(o.av.AccountSubscriptions.renew(e))},canDowngrade:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return[4,(0,r.UT)(o.av.AccountSubscriptions.canDowngrade(e))];case 1:return[2,t.sent()]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function s(e){i(a,r,o,s,l,"next",e)}function l(e){i(a,r,o,s,l,"throw",e)}s(void 0)})})()},createEmailHubSubscription:function(){return(0,r.Cu)(o.av.AccountSubscriptions.createEmailHubSubscription())},reactivateEmailHubSubscription:function(){return(0,r.Cu)(o.av.AccountSubscriptions.reactivateEmailHubSubscription())}}},550368:function(e,t,n){n.d(t,{Q:()=>i,e:()=>a});var r=n(93199),o=n(547144),i={PENDING:"pending",DETACHED:"detached",IGNORED:"ignored",WITHDRAWN:"withdrawn",ACTIVE:"active"},a=function(){return{getMetrics:function(){return(0,r.UT)(o.av.admin.connections.metrics())},getTopConnectors:function(e){return(0,r.UT)(o.av.admin.connections.topConnectors(e))},getLatestConnections:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(0,r.UT)(o.av.admin.connections.latestConnections(e,t))}}}},551507:function(e,t,n){n.d(t,{w:()=>i});var r=n(93199),o=n(547144),i={list:function(e){var t=e.params;return(0,r.UT)(o.av.broadcasts.list({params:void 0===t?{}:t}))},create:function(e){return(0,r.Cu)(o.av.broadcasts.create(),e)},show:function(e){var t=e.id;return(0,r.UT)(o.av.broadcasts.show({id:t}))},update:function(e){var t=e.id,n=e.body;return(0,r.aU)(o.av.broadcasts.show({id:t}),n)},sendNow:function(e){var t=e.id;return(0,r.gN)(o.av.broadcasts.sendNow({id:t}))},duplicate:function(e){var t=e.id;return(0,r.aU)(o.av.broadcasts.duplicate({id:t}))},recipientList:function(e){var t=e.id,n=e.params;return(0,r.UT)(o.av.broadcasts.recipientList({id:t,params:void 0===n?{}:n}))},report:function(e){var t=e.id;return(0,r.UT)(o.av.broadcasts.report({id:t}))},recipients:function(e){var t=e.id,n=e.params;return(0,r.UT)(o.av.broadcasts.recipients({id:t,params:void 0===n?{}:n}))},cancelSchedule:function(e){var t=e.id;return(0,r.gN)(o.av.broadcasts.cancelSchedule({id:t}))},rename:function(e){var t=e.id,n=e.body;return(0,r.gN)(o.av.broadcasts.rename({id:t}),n)},sendTestEmail:function(e){var t=e.id;return(0,r.gN)(o.av.broadcasts.sendTestEmail({id:t}))},deleteBroadcast:function(e){var t=e.id;return(0,r.pC)(o.av.broadcasts.deleteBroadcast({id:t}))},updateTemplate:function(e){var t=e.id,n=e.body;return(0,r.gN)(o.av.broadcasts.updateTemplate({id:t}),n)},createFromSource:function(e){return(0,r.Cu)(o.av.broadcasts.createFromSource(),e)},resetContent:function(e){var t=e.id;return(0,r.gN)(o.av.broadcasts.resetContent({id:t}))}}},536394:function(e,t,n){n.d(t,{MW:()=>i});var r=n(93199),o=n(547144),i={adminMarkAsRead:function(e){var t=e.id;return(0,r.gN)(o.av.communityInbox.adminMarkAsRead({id:t}))},memberMarkAsRead:function(e){var t=e.id;return(0,r.gN)(o.av.communityInbox.memberMarkAsRead({id:t}))},previewChat:function(e){var t=e.community_bot_profile;return(0,r.Cu)(o.av.communityInbox.preview(),{community_bot_profile:t})},fetchChat:function(e){var t=e.id;return(0,r.UT)(o.av.communityInbox.show({id:t}))},pauseAi:function(e){var t=e.id;return(0,r.gN)(o.av.communityInbox.pauseAi({id:t}))},resumeAi:function(e){var t=e.id;return(0,r.gN)(o.av.communityInbox.resumeAi({id:t}))},unreadMemberChatsCount:function(){return(0,r.UT)(o.av.communityInbox.unreadMemberChatsCount())},unreadAdminPausedAiChatsCount:function(){return(0,r.UT)(o.av.communityInbox.unreadAdminPausedAiChatsCount())}}},534962:function(e,t,n){n.d(t,{_u:()=>a,gX:()=>s,x6:()=>i});var r=n(93199),o=n(547144),i=function(e){var t=e.spaceId,n=e.payload;return(0,r.Cu)(o.av.imagePosts.create(t),n)},a=function(e){var t=e.spaceId,n=e.postSlug,i=e.payload;return(0,r.aU)(o.av.imagePosts.update(t,n),i)},s=function(e){var t=e.spaceId,n=e.postSlug,i=e.payload;return(0,r.aU)(o.av.imagePosts.duplicate(t,n),i)}},144102:function(e,t,n){n.d(t,{g:()=>i});var r=n(93199),o=n(547144),i=function(e){var t=e.entityId,n=e.entityType,i=e.mode;return(0,r.Cu)(o.av.masquerading.masquerades.create({entityId:t,entityType:void 0===n?"CommunityMember":n,mode:void 0===i?"view":i}),{method:"POST"})}},371290:function(e,t,n){n.d(t,{O:()=>i});var r=n(93199),o=n(698173),i={create:function(e){var t=e.blobSignedId;return(0,r.Cu)(o.a.mediaTranscodings.create(),{blob_signed_id:t})}}},929980:function(e,t,n){n.d(t,{W:()=>i});var r=n(93199),o=n(547144),i={index:function(e){var t=e.filters,n=e.order,i=e.page,a=e.perPage,s=e.searchKey,l=s?{search_key:s}:{};return function(){return(0,r.UT)(o.av.admin.paywalls.charges.index({params:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({filters:t,page:i,per_page:a,order:n},l)}))}},refundCharge:function(e){var t=e.chargeProcessorId,n=e.params;return(0,r.Cu)(o.av.admin.paywalls.charges.refunds({chargeProcessorId:t}),n)}}},381881:function(e,t,n){n.d(t,{R:()=>s});var r=n(93199),o=n(547144);function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function a(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s={listTutorialPosts:function(){return(0,r.UT)(o.av.supportWidget.listTutorialPosts())},listPosts:function(e){var t=e.spaceId,n=e.searchText;return(0,r.UT)(o.av.supportWidget.listPosts({spaceId:t,searchText:n}))},listNews:function(){return(0,r.UT)(o.av.supportWidget.listNews())},showPost:function(e){return(0,r.UT)(o.av.supportWidget.showPost({id:e}))},showPinnedPost:function(){return(0,r.UT)(o.av.supportWidget.showPinnedPost())},spaceGroups:function(){return(0,r.UT)(o.av.supportWidget.spaceGroups())},listConversations:function(){return(0,r.UT)(o.av.supportWidget.listConversations())},showConversation:function(e){var t=e.id;return(0,r.UT)(o.av.supportWidget.showConversation({id:t}))},updateConversation:function(e){var t=e.comment,n=e.id,s=e.zendeskUploadIds,l=a(e,["comment","id","zendeskUploadIds"]);return(0,r.t5)(o.av.supportWidget.updateConversation({id:n}),i({method:"PATCH",body:JSON.stringify({conversation:{comment:t,zendesk_upload_ids:s}})},l))},createAttachment:function(e){var t=e.signedId,n=e.target,s=a(e,["signedId","target"]);return(0,r.t5)(o.av.supportWidget.createAttachment(),i({method:"POST",body:JSON.stringify({signed_id:t,target:n})},s))},checkAttachment:function(e){var t=e.zendeskUploadId,n=e.target;return(0,r.UT)(o.av.supportWidget.checkAttachment({zendeskUploadId:t,target:n}))},createPostFeedback:function(e){var t=e.postId,n=e.helpful,s=a(e,["postId","helpful"]);return(0,r.t5)(o.av.supportWidget.createPostFeedback(),i({method:"POST",body:JSON.stringify({post_id:t,helpful:n})},s))},listEvents:function(){return(0,r.UT)(o.av.supportWidget.listEvents())},createChatMessage:function(e){var t=e.message,n=e.authorType,s=e.sessionId,l=e.productArea,c=a(e,["message","authorType","sessionId","productArea"]);return(0,r.t5)(o.av.supportWidget.createChatMessage(),i({method:"POST",body:JSON.stringify({message:t,author_type:n,session_id:s,product_area:l})},c))},createLiveChatMessage:function(e){var t=e.message,n=e.sessionId,s=a(e,["message","sessionId"]);return(0,r.t5)(o.av.supportWidget.createLiveChatMessage(),i({method:"POST",body:JSON.stringify({message:t,session_id:n})},s))},uploadLiveChatAttachment:function(e){var t=e.mediaUrl,n=e.mediaIsImage,s=e.sessionId,l=a(e,["mediaUrl","mediaIsImage","sessionId"]);return(0,r.t5)(o.av.supportWidget.uploadLiveChatAttachment(),i({method:"POST",body:JSON.stringify({media_url:t,media_is_image:n,session_id:s})},l))},getLiveChatStatus:function(){return(0,r.UT)(o.av.supportWidget.getLiveChatStatus())}}},838603:function(e,t,n){n.d(t,{vk:()=>u});var r=n(275271),o=n(932699),i=n(131906),a=n(714218),s=n(93199),l=n(547144);function c(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.params,n=void 0===t?{}:t,u=e.isCalendarView,d=void 0!==u&&u,f=(0,a.d)(),m=f.removeRecord,p=f.findAndReplaceRecord,b=["all","events",n,{type:d?"calendar":"default"}],h=(0,i.useQueryClient)(),v=(0,i.useInfiniteQuery)(b,function(e){var t,r=e.pageParam;return t=void 0===r?1:r,(0,s.UT)(l.av.events.allEvents({params:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({page:t,per_page:d?120:20},n)}))},{select:function(e){var t=e.pages,n=void 0===t?[]:t;return{pages:(0,o.flatten)(n.map(function(e){return e.records})),pageParams:n.map(function(e){return e.page}),pagesList:n}},keepPreviousData:d,getNextPageParam:function(e){return e.has_next_page?Number(e.page)+1:void 0}}),y=v.data,g=void 0===y?{}:y,x=g.pages,_=g.pagesList,j=void 0===_?[]:_,w=v.isLoading,O=v.refetch,S=v.hasNextPage,P=v.fetchNextPage,C=j[j.length-1];(0,r.useEffect)(function(){d&&C&&C.count>C.page*C.per_page&&P()},[C,d,P]);var k=j.map(function(e){return e.records.map(function(e){return e.id})});return{events:void 0===x?[]:x,pagesList:j,isLoading:w,refetchAllEvents:O,hasNextPage:S,fetchNextPage:P,perPageEventIds:k,onEventChange:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.refetch,o=void 0===r||r;return(t=function(){var t;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(n){switch(n.label){case 0:if(t=e,!o)return[3,2];return[4,h.fetchQuery({queryKey:[l.av.posts.show({spaceId:e.space_id,postSlug:e.slug,spaceSlug:e.space_slug})]})];case 1:t=n.sent(),n.label=2;case 2:return[2,p(t,b)]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)})})()},onEventDestroy:function(e){m(e,b)}}}},135822:function(e,t,n){n.d(t,{Y:()=>a});var r=n(217123),o=n(11079),i=n(344484),a=function(e,t){var n=(0,o.Y)(String(t));switch(e){case"daily":return(0,r.default)(n,"EEE, MMM d, yyyy");case"weekly":var a=new Date(n);return a.setDate(n.getDate()+6),"".concat((0,r.default)(n,"MMM d")," – ").concat((0,r.default)(a,"MMM d, yyyy"));case"monthly":return(0,r.default)(n,"MMM, yyyy");default:return(0,r.default)(n,i.zT)}}},795053:function(e,t,n){n.d(t,{D:()=>Q});var r=n(552676),o=n(275271),i=n(713831),a=n(217123),s=n(739792),l=n(466056),c=n(663676),u=n(899550),d=function(e){var t=1/0,n=-1/0,r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,c=!0,u=!1,d=void 0;try{for(var f,m=l.data[Symbol.iterator]();!(c=(f=m.next()).done);c=!0){var p=f.value,b=Number(p.y);Number.isFinite(b)&&(b<t&&(t=b),b>n&&(n=b))}}catch(e){u=!0,d=e}finally{try{c||null==m.return||m.return()}finally{if(u)throw d}}}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return t===1/0||n===-1/0?[0,1]:[t,n]},f=function(e){var t=e.type,n=e.seriesKeys,r=e.colors,o=e.activeId,i="bar"===t?"gradient":"gradient-area";return{gradientDefs:n.map(function(e,n){var a=!o||o===e;return"bar"===t?{id:"".concat(i,"-").concat(e),type:"linearGradient",colors:[{offset:0,color:r[n],opacity:a?1:.5},{offset:100,color:r[n],opacity:a?.4:.2}],x1:0,y1:0,x2:0,y2:1}:{id:"".concat(i,"-").concat(e),type:"linearGradient",colors:[{offset:0,color:r[n],opacity:a?.4:.2},{offset:100,color:r[n],opacity:0}],x1:0,y1:0,x2:0,y2:1}}),fillPattern:n.map(function(e){return{match:{id:e},id:"".concat(i,"-").concat(e)}})}},m=n(726175),p=n(212574);function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var h=function(e){var t,n=e.data,r=e.seriesKeys,i=e.indexBy,a=e.colors,s=e.activeId,l=e.containerWidth,c=e.containerHeight,u=e.secondaryAxis,h=e.marginTop,v=e.marginBottom,y=(0,o.useMemo)(function(){return r.map(function(e,t){return s&&s!==e?"".concat(a[t],"80"):a[t]})},[r,a,s]),g=(0,o.useMemo)(function(){return r.reduce(function(e,t,n){return e[t]=y[n],e},{})},[r,y]),x=(0,o.useMemo)(function(){return f({type:"area",seriesKeys:r,colors:a,activeId:s})},[r,a,s]),_=x.gradientDefs,j=x.fillPattern,w=(0,m.u)({data:n,containerWidth:l,indexBy:i}),O=(0,o.useMemo)(function(){return r.map(function(e){return{id:e,data:n.map(function(t){return{x:t[i],y:Number(t[e]||0)}})}})},[n,r,i]),S=u&&u.keys||[],P=(0,o.useMemo)(function(){return S.length?r.filter(function(e){return!S.includes(e)}):r},[r,S]),C=(0,o.useMemo)(function(){return S.length?n.reduce(function(e,t){var n=P.reduce(function(e,n){var r=Number(t[n]||0);return r>e?r:e},0);return n>e?n:e},0)||1:null},[n,P,S.length]),k=(0,o.useMemo)(function(){return S.length&&C?r.map(function(e){return{id:e,data:n.map(function(t){var n=t[i],r=Number(t[e]||0);return{x:n,y:S.includes(e)?r/100*C:r}})}}):O},[C,r,n,i,S,O]),I=(t=(0,o.useMemo)(function(){return d(k)},[k]),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return b(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),N=I[0],A=I[1],M=(0,p.C)({min:N,max:A,minTickCount:4,maxTickCount:7}),T=(0,o.useMemo)(function(){if(M.length){var e=M[0];if(!(e>=0)){var t=M.length>1?M[1]-M[0]:Math.abs(e)||1;return e-.25*t}}},[M]),E=(0,o.useMemo)(function(){if(!S.length&&M.length)return M[M.length-1]},[S.length,M]),R=(0,o.useMemo)(function(){return r.map(function(e,t){return{id:e,color:a[t],label:e}})},[r,a]),D=(0,o.useMemo)(function(){var e,t=null==(e=n[0])?void 0:e[i];return n.every(function(e){return e[i]===t})},[n,i]),L=(0,o.useMemo)(function(){if(c){var e=Math.max(((null==M?void 0:M.length)||0)-1,1);return Math.max(Math.round(Math.max(c-(h+v),1)/e)*e,e)+h+v}},[c,null==M?void 0:M.length,h,v]);return{activeColors:y,seriesColorById:g,gradientDefs:_,fillPattern:j,tickValues:w,formattedData:k,yTicks:M,yMinScale:T,yMaxScale:E,yMaxForNormalize:C,legendData:R,isSingleDataPoint:D,normalizedHeight:L}},v=n(11079),y=n(22319),g=n(885989),x=n(320900),_=n(472298),j=n(635384),w=n(180948),O=n(344484),S={tickSize:5,tickPadding:5,tickRotation:0,legend:"",legendPosition:"middle"};function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var C=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"linear",r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;return{type:n,min:"number"==typeof r?r:"auto",max:e?t||1:"number"==typeof o?o:"auto",stacked:!1,reverse:!1,nice:!0,clamp:!0}},k=function(e,t,n,r){var o,i;return e?(o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},S),i=i={tickSize:0,legendOffset:50,legendPosition:"middle",legend:(0,s.t)(((function(e){if(Array.isArray(e))return P(e)})(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return P(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}}(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat(["right_axis_label"])),tickValues:[0,20,40,60,80,100].map(function(e){return(t||1)*e/100}),format:function(e){return n?n(Math.round(e/(t||1)*100)):"".concat(Math.round(e/(t||1)*100),"%")}},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(i)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(i,e))}),o):null},I=function(e){var t=function(){return e?(0,r.jsx)("g",{"aria-label":"hover-dot",children:(0,r.jsx)("circle",{cx:e.x,cy:e.y,r:4,fill:e.color,stroke:"#ffffff",strokeWidth:2})}):null};return t.displayName="HoverDotLayer",t},N=n(203468),A=n(135822),M=function(e){var t=e.previousData,n=e.seriesKeys,r=e.currentXDomain,o=e.prevValuesOrdered,i=e.dateGrouping,a=e.renderMembersTooltip,s=e.customTooltip;return function(e){if(t&&1===n.length){var l=e.point,c=null==l?void 0:l.data,u=(null==c?void 0:c.x)!=null?String(c.x):"",d=(null==c?void 0:c.y)!=null&&"number"==typeof c.y?c.y:0,f=r.findIndex(function(e){return String(e)===u}),m=f>=0&&f<o.length?o[f]:0,p=(0,N.ad)(d,m),b=(0,A.Y)(i,u);return a({xValue:u,currentValue:d,headerLabel:b,deltaPercent:p})}return s?s(e):null}},T=n(852507),E=n(11582),R=n(529799),D=n(125696),L=n(976876),F=n(228913),U=n(332273),B=function(e){var t=e.prevPoints,n=e.seriesKeys,o=e.seriesColorById,i=e.curveName,a=1===n.length?o[n[0]]:void 0,s=!!(t&&1===n.length&&a),l={linear:T.Z,cardinal:E.ZP,catmullRom:R.Z,monotoneX:D.Z,natural:L.Z,step:F.ZP,stepAfter:F.cD,stepBefore:F.RN},c=i&&l[i]||D.Z,u=function(e){var n=e.xScale,o=e.yScale;if(!s)return null;var i=t.map(function(e){var t=n(e.x),r=o(e.y);return null==t||null==r?null:{x:Number(t),y:Number(r)}}).filter(Boolean);if(i.length<2)return null;var l=(0,U.Z)().x(function(e){return e.x}).y(function(e){return e.y}).curve(c)(i)||"";return l?(0,r.jsx)("path",{d:l,stroke:a,strokeWidth:2,strokeDasharray:"4 4",fill:"none",opacity:.8}):null};return u.displayName="PreviousPeriodLayer",u};function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var z=function(e,t,n,r){if(!e||0===e.length)return{prevValuesOrdered:[],prevPoints:null};var o=((function(e){if(Array.isArray(e))return q(e)})(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return q(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort(function(e,t){var n=e[r],o=t[r];return null==n||null==o?0:String(n).localeCompare(String(o))}).map(function(e){var n=e[t];return"number"==typeof n?n:Number(null!=n?n:0)}),i=Math.min(n.length,o.length);if(0===i)return{prevValuesOrdered:o,prevPoints:null};for(var a=[],s=0;s<i;s+=1)a.push({x:n[s],y:o[s]});return{prevValuesOrdered:o,prevPoints:a}};function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function H(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Q=function(e){var t,n,d,f=e.isLoading,m=e.className,p=e.title,b=e.data,P=e.previousData,N=e.tooltip,A=e.titleLabel,T=e.indexBy,E=e.seriesKeys,R=e.colors,D=e.dateGrouping,L=e.curve,F=void 0===L?"monotoneX":L,U=e.enableArea,q=e.enableGridX,Z=e.enableGridY,Q=e.emptyStateTitle,G=e.emptyStateDescription,$=e.customTooltip,K=e.rootLocale,J=e.scaleType,X=e.showLegend,Y=e.secondaryAxis,ee=e.translateLegendLabels,et=(0,w.O)(),en=et.containerWidth,er=et.containerHeight,eo=et.containerRef,ei=W((0,o.useState)(null),2),ea=ei[0],es=ei[1],el=(0,y.TC)().isLightAppearance,ec=W((0,o.useState)(null),2),eu=ec[0],ed=ec[1],ef=h({data:b,seriesKeys:E,indexBy:T,colors:R,activeId:ea,containerWidth:en,containerHeight:er,secondaryAxis:Y,marginTop:32,marginBottom:50}),em=ef.seriesColorById,ep=ef.gradientDefs,eb=ef.fillPattern,eh=ef.tickValues,ev=ef.formattedData,ey=ef.yTicks,eg=ef.yMinScale,ex=ef.yMaxScale,e_=ef.yMaxForNormalize,ej=ef.legendData,ew=ef.isSingleDataPoint,eO=ef.normalizedHeight;if(f)return(0,r.jsx)(j.t,{type:"line",className:m});if(!b.length)return(0,r.jsx)(x.u,{chartTitle:p,tooltip:N,className:m,emptyTitle:Q,emptyDescription:G});var eS={background:"transparent",text:{fill:(t=!!el)?O.DM.light.textColor:O.DM.dark.textColor},grid:{line:{stroke:t?O.DM.light.grid:O.DM.dark.grid,strokeWidth:1}},axis:{ticks:{text:{fill:t?O.DM.light.axis:O.DM.dark.axis}}},crosshair:{line:{stroke:t?O.DM.light.axis:O.DM.dark.axis,strokeWidth:1,strokeOpacity:0}}},eP=(null==ev||null==(d=ev[0])||null==(n=d.data)?void 0:n.map(function(e){return e.x}))||[],eC=z(P,E[0],eP,T),ek=eC.prevValuesOrdered,eI=B({prevPoints:eC.prevPoints,seriesKeys:E,seriesColorById:em,curveName:F}),eN=I(eu),eA=M({previousData:P,seriesKeys:E,currentXDomain:eP,prevValuesOrdered:ek,dateGrouping:D,renderMembersTooltip:function(e){var t=e.xValue,n=e.currentValue,o=e.headerLabel,i=e.deltaPercent;return(0,r.jsx)(l.p,{data:{Date:t,total_members:n},rootLocale:K.join("."),headerLabel:o,trendDeltaPercentage:i})},customTooltip:$});return(0,r.jsx)(g.B,{title:p,tooltip:N,titleLabel:A,className:m,data:b,chartType:u.C.LINE,children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[void 0!==X&&X&&(0,r.jsx)(_.F,{data:ej,orientation:"horizontal",setActiveId:es,className:"self-start",rootLocale:void 0===ee||ee?K:void 0}),(0,r.jsx)("div",{ref:eo,className:"relative flex h-80 w-full overflow-visible",style:er?{height:eO}:void 0,children:(0,r.jsx)(i.fH,{data:ev,margin:{top:32,right:Y&&Y.keys&&Y.keys.length?80:50,bottom:50,left:50},xScale:{type:"point"},yScale:C(!!(Y&&Y.keys&&Y.keys.length),e_,void 0===J?"linear":J,eg,ex),curve:F,axisTop:null,axisRight:k(!!(Y&&Y.keys&&Y.keys.length),e_,null==Y?void 0:Y.format,K),axisBottom:H(V({},S),{tickSize:0,legendOffset:40,tickValues:eh,format:function(e){return(0,a.default)((0,v.Y)(String(e)),O.zT)}}),axisLeft:H(V({},S),{legendOffset:-45,legendPosition:"middle",tickSize:0,tickValues:ey,format:c.dm}),enableGridX:void 0!==q&&q,enableGridY:void 0===Z||Z,gridYValues:ey,colors:E.map(function(e){return em[e]}),enablePoints:!0,pointSize:8*!!ew,pointLabelYOffset:-12,enableArea:void 0===U||U,defs:ep,fill:eb,useMesh:!0,onMouseMove:function(e){var t,n,r,o,i=null!=(t=e.seriesId)?t:e.serieId,a=void 0!==i?em[String(i)]:void 0,s=null!=(o=null!=(r=null!=(n=e.serieColor)?n:e.color)?r:a)?o:"";ed({x:e.x,y:e.y,color:s}),void 0!==i&&es(i)},onMouseLeave:function(){es(null),ed(null)},tooltip:eA,theme:eS,ariaLabel:(0,s.t)("settings.analytics.line_chart"),layers:["grid","axes","areas","lines",eI,eN,"points","mesh"]})})]})})};Q.displayName="LineChartComponent"},378178:function(e,t,n){n.d(t,{O:()=>l});var r=n(552676),o=n(381636),i=n(885989),a=n(635384),s=n(408306),l=function(e){var t,n=e.prefix,l=e.suffix,c=e.title,u=e.tooltip,d=e.titleLabel,f=e.value,m=e.isLoading,p=e.className,b=e.decimalPlaces,h=e.children,v=e.showComparison,y=e.comparisonDeltaPercentage,g=e.comparisonLastPeriodValue,x=e.comparisonLastPeriodLabel,_=e.reserveTrendSpace;if(m)return(0,r.jsx)(a.t,{type:"stat",className:p});var j=(t=void 0===b?0:b,"string"==typeof f?f||"—":f.toLocaleString(void 0,{minimumFractionDigits:t,maximumFractionDigits:t})),w=!!v&&"number"==typeof y;return(0,r.jsxs)(i.B,{title:c,tooltip:u,className:p,titleLabel:d,children:[(0,r.jsxs)(o.Z.TitleLg,{as:"div",weight:"font-bold",color:"text-very-dark",children:[n,j,l]}),w&&(0,r.jsx)("div",{className:"mt-0.5 inline-flex items-center whitespace-nowrap",children:(0,r.jsx)(s.E,{deltaPercentage:y,withBackground:!0,lastPeriodValue:""!==g?g:void 0,lastPeriodLabel:x,suffix:l})}),!w&&_&&(0,r.jsx)("div",{className:"mt-0.5 inline-flex h-[22px] items-center whitespace-nowrap"}),h]})}},408306:function(e,t,n){n.d(t,{E:()=>c});var r=n(552676),o=n(790644),i=n(701168),a=n(957363),s=n(381636),l=n(344484),c=function(e){var t=e.deltaPercentage,n=e.withBackground,c=e.lastPeriodValue,u=e.lastPeriodLabel,d=e.suffix,f=e.className,m=0===t,p=t>=0?l.az:l.hK,b=p.containerBg,h=p.textClass,v=p.iconType,y=(0,o.Nh)(t),g=null!=u?u:(0,o.Ym)(c,d);if(m)return(0,r.jsxs)("div",{className:(0,i.A)("inline-flex items-center gap-2",f),children:[(0,r.jsx)("span",{className:"leading-4.5 text-xs font-medium tracking-[0.2px] text-default",children:"— ".concat(y)}),g?(0,r.jsx)(s.Z.LabelXs,{color:"text-default",children:g}):null]});var x=void 0===n||n?(0,i.A)("inline-flex items-center justify-start gap-1 rounded-md px-1 py-0.5",b):"inline-flex items-center gap-1";return m?(0,r.jsxs)("div",{className:(0,i.A)("inline-flex items-center gap-2",f),children:[(0,r.jsx)("span",{className:"leading-4.5 text-xs font-medium tracking-[0.2px] text-default",children:y}),g?(0,r.jsx)(s.Z.LabelXs,{color:"text-default",children:g}):null]}):(0,r.jsxs)("div",{className:(0,i.A)("inline-flex items-center gap-2",f),children:[(0,r.jsxs)("div",{className:(0,i.A)(x,h),children:[(0,r.jsx)("div",{className:(0,i.A)("size-3","flex items-center justify-center overflow-visible"),children:(0,r.jsx)(a.JO,{type:v,size:12,className:(0,i.A)("block"),useWithStrokeCurrentColor:!0})}),(0,r.jsx)("span",{className:(0,i.A)("leading-4.5 text-xs font-medium tracking-[0.2px]"),children:y})]}),u?(0,r.jsx)(s.Z.LabelXs,{color:"text-default",children:u}):null]})}},344484:function(e,t,n){n.d(t,{DM:()=>r,az:()=>i,hK:()=>a,zT:()=>o});var r={light:{axis:"#666666",grid:"#e5e7eb",textColor:"#333333"},dark:{axis:"#cccccc",grid:"#374151",textColor:"#ffffff"}},o="MMM d, yyyy",i={containerBg:"bg-v2-success-100 dark:bg-green-500/15",textClass:"text-green-success-dark dark:text-green-400",iconType:"12-arrow-up"},a={containerBg:"bg-warning-light bg-amber-500/15",textClass:"text-[var(--base-amber-700,#B45309)] dark:text-amber-400",iconType:"12-arrow-down"}},790644:function(e,t,n){n.d(t,{Nh:()=>o,Ym:()=>i,b3:()=>r});var r=function(e){if("number"==typeof e)t=e;else if(null!=e){var t,n=Number(e);t=Number.isFinite(n)?n:void 0}return void 0===t?"":Math.abs(t%1)>0?t.toLocaleString(void 0,{minimumFractionDigits:1,maximumFractionDigits:1}):t.toLocaleString()},o=function(e){if(!Number.isFinite(e))return"—";var t=Math.abs(e);return"".concat(t.toFixed(1),"%")},i=function(e,t){if(null==e||"string"==typeof e&&0===e.length)return null;var n="number"==typeof e?e.toLocaleString():String(e);return"".concat(n).concat(null!=t?t:""," last period")}},885989:function(e,t,n){n.d(t,{B:()=>S});var r=n(552676),o=n(739792),i=n(701168),a=n(275271),s=n(60878),l=n(899550);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}var d="settings.analytics.export_csv",f=function(){var e=(0,s.pm)(),t=e.success,n=e.error;return{downloadCSV:(0,a.useCallback)(function(e,r,i){var a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{if(0===e.length)return;var l=s.filename,c=void 0===l?"".concat(i,".csv"):l,u=s.onSuccess,f=s.prefix,p=s.suffix,b=s.seriesKeys,h=s.columns,v=m(e,r,{seriesKeys:b,columns:h,prefix:void 0===f?"":f,suffix:void 0===p?"":p}),y=g(v),x=new Blob([y],{type:"text/csv;charset=utf-8;"}),_=document.createElement("a"),j=URL.createObjectURL(x);_.setAttribute("href",j),_.setAttribute("download",c),_.style.visibility="hidden",document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(j),t((0,o.t)([d,"success_message"],{report_name:c})),null==u||u()}catch(e){console.error("CSV download error:",e),n((0,o.t)([d,"error_message"])),null==(a=s.onError)||a.call(s)}},[t,n])}},m=function(e,t,n){switch(t){case l.C.PIE:return p(e,n);case l.C.BAR:case l.C.LINE:return h(e,n);case l.C.TABLE:case l.C.CHOROPLETH:return y(e,n);default:return e}},p=function(e,t){var n=t.prefix,r=t.suffix;return e.map(function(e){return{Category:e.label,Value:"".concat(n).concat(e.value.toLocaleString()).concat(r)}})},b=function(e,t,n,r,o){var i=n.includes(e);return"rate"===e?"".concat(t.toFixed(2),"%"):"".concat(r).concat(t.toLocaleString()).concat(i?o:"")},h=function(e,t){var n=t.seriesKeys,r=void 0===n?[]:n,o=t.prefix,i=t.suffix;return e.map(function(e){var t={Date:e.label};return Object.keys(e).forEach(function(n){if("id"!==n&&"label"!==n){var a=e[n];"number"==typeof a?t[n]=b(n,a,r,o,i):null!=a&&(t[n]=(void 0===a?"undefined":u(a))==="object"?JSON.stringify(a):String(a))}}),t})},v=function(e,t,n,r){if("number"==typeof e){var o=t.prefix||n,i=t.suffix||r;return"".concat(o).concat(e.toLocaleString()).concat(i)}return(void 0===e?"undefined":u(e))==="object"?JSON.stringify(e):String(e)},y=function(e,t){var n=t.columns,r=t.prefix,o=t.suffix;return n&&0!==n.length?e.map(function(e){var t={};return n.forEach(function(n){var i=e["".concat(n.id,"_for_csv")]||e[n.id];null!=i&&(t[n.header]=v(i,n,r,o))}),t}):e},g=function(e){if(!e||0===e.length)return"No data available";var t,n=Object.keys(e[0]);return[n.join(",")].concat(function(e){if(Array.isArray(e))return c(e)}(t=e.map(function(e){return n.map(function(t){var n=e[t];return"string"==typeof n&&(n.includes(",")||n.includes('"')||n.includes("\n"))?'"'.concat(n.replace(/"/g,'""'),'"'):n}).join(",")}))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return c(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).join("\n")},x=n(957363),_=n(380171),j=n(943544),w=n(381636),O=function(e){var t=e.title,n=e.titleLabel;return(0,r.jsxs)("div",{className:"flex h-5 min-w-0 flex-1 items-center gap-1.5",children:[(0,r.jsx)("span",{className:"truncate leading-none",children:(0,r.jsx)(_.T,{content:t,className:"inline",children:(0,r.jsx)("span",{children:(0,r.jsx)(w.Z.LabelMd,{color:"text-primary dark:text-white",weight:"medium",children:t})})})}),n&&(0,r.jsx)("span",{className:"h-5 whitespace-nowrap leading-none",children:(0,r.jsx)(w.Z.LabelXs,{color:"text-default",children:n})})]})};O.displayName="ChartTitle";var S=function(e){var t=e.title,n=e.tooltip,a=e.children,s=e.className,l=e.data,c=e.chartType,u=e.prefix,d=e.suffix,m=e.seriesKeys,p=e.columns,b=e.csvColumns,h=e.titleLabel,v=f().downloadCSV,y=l&&c,g="settings.analytics.export_csv";return(0,r.jsxs)("div",{className:(0,i.A)("border-primary flex w-full flex-col gap-2 rounded-xl border p-6",s),children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-1",children:[(0,r.jsx)(O,{title:t,titleLabel:h}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[n&&(0,r.jsx)(_.T,{content:n,className:"inline-flex cursor-pointer dark:text-white",children:(0,r.jsx)(x.JO,{type:"16-info",size:16,useWithStrokeCurrentColor:!0})}),y&&(0,r.jsx)(j.Lt,{direction:"bottom-end",menuWrapperClassName:"!mt-2",buttonClassName:"flex items-center h-6 w-6 flex justify-center !rounded transition-colors duration-200 hover:bg-tertiary focus-visible:outline-secondary focus-visible:rounded focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:bg-tertiary",button:(0,r.jsx)(_.T,{content:(0,o.t)([g,"download_options"]),className:"flex items-center p-1",children:(0,r.jsx)(x.JO,{className:"text-default !h-4 !w-4",type:"20-menu-dots-horizontal",size:16,"aria-label":(0,o.t)([g,"download_options"])})}),options:[{label:(0,o.t)([g,"download_csv"]),value:"download_csv",icon:"download",onClick:function(){l&&c&&v(l,c,t,{prefix:u,suffix:d,seriesKeys:m,columns:b||p})}}]})]})]}),a]})}},320900:function(e,t,n){n.d(t,{u:()=>l});var r=n(552676),o=n(739792),i=n(899550),a=n(381636),s=n(885989),l=function(e){var t=e.chartTitle,n=e.emptyTitle,l=e.emptyDescription,c=e.className,u=e.tooltip,d=null!=n?n:(0,o.t)("analytics.shared.empty_state.title"),f=null!=l?l:(0,o.t)("analytics.shared.empty_state.description");return(0,r.jsx)(s.B,{title:t,tooltip:u,className:c,data:[],chartType:i.C.TABLE,children:(0,r.jsxs)("div",{className:"flex h-80 w-full flex-col items-center justify-center gap-2 text-center",children:[(0,r.jsx)(a.Z.TitleMd,{children:d}),(0,r.jsx)(a.Z.BodyMd,{color:"text-lighter",children:f})]})})};l.displayName="EmptyState"},472298:function(e,t,n){n.d(t,{F:()=>d});var r=n(552676),o=n(275271),i=n(739792),a=n(701168),s=n(39905),l=n(381636);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}}var d=function(e){var t,n=e.data,d=e.orientation,f=e.className,m=e.setActiveId,p=e.rootLocale,b=(t=(0,o.useState)(10),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||u(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),h=b[0],v=b[1];if(!n||0===n.length)return null;var y=n.slice(0,h),g=n.length-h,x=g>0;return(0,r.jsxs)("div",{className:(0,a.A)("flex gap-4","horizontal"===(void 0===d?"horizontal":d)?"flex-row flex-wrap justify-center":"flex-col",f),children:[y.map(function(e){return(0,r.jsxs)(s.z,{variant:"text",small:!0,className:"flex h-auto cursor-pointer items-center gap-2 p-0",onMouseOver:function(){return m(e.id)},onFocus:function(){return m(e.id)},onMouseLeave:function(){return m(null)},onBlur:function(){return m(null)},children:[(0,r.jsx)("div",{className:"size-3 shrink-0 rounded-full",style:{backgroundColor:e.color}}),(0,r.jsx)(l.Z.BodySm,{color:"text-secondary dark:text-white",children:p?(0,i.t)(((function(e){if(Array.isArray(e))return c(e)})(p)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(p)||u(p)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([e.label])):e.label})]},e.label)}),x&&(0,r.jsx)(s.z,{variant:"plain",small:!0,onClick:function(){v(function(e){return Math.min(e+10,n.length)})},className:"flex h-auto cursor-pointer items-center gap-2 p-0 text-sm font-medium",children:1===g?(0,i.t)("analytics.legend.show_more_singular",{count:g}):(0,i.t)("analytics.legend.show_more",{count:g})})]})}},635384:function(e,t,n){n.d(t,{t:()=>l});var r=n(552676),o=n(701168),i=function(e){var t=e.baseContainerClasses,n=e.className;return(0,r.jsxs)("div",{className:"".concat(t," ").concat(n||""),children:[(0,r.jsx)("div",{className:"bg-secondary mb-4 h-6 w-32 animate-pulse rounded"}),(0,r.jsx)("div",{className:"flex h-80 w-full items-center justify-center",children:(0,r.jsx)("div",{className:"bg-secondary h-64 w-full animate-pulse rounded"})})]})};i.displayName="LoadingChoropleth";var a=function(e){var t=e.className,n=e.baseContainerClasses;return(0,r.jsxs)("div",{className:(0,o.A)(n,"gap-2",t),children:[(0,r.jsx)("div",{className:"bg-tertiary h-4 w-1/2 animate-pulse rounded-full"}),(0,r.jsx)("div",{className:"bg-tertiary h-8 w-1/3 animate-pulse rounded-full"})]})},s={stat:a,pie:function(e){var t=e.className,n=e.baseContainerClasses;return(0,r.jsxs)("div",{className:(0,o.A)(n,"gap-4",t),children:[(0,r.jsx)("div",{className:"bg-tertiary h-6 w-1/2 animate-pulse rounded-full"}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsx)("div",{className:"bg-tertiary size-60 animate-pulse rounded-full"}),(0,r.jsx)("div",{className:"flex flex-wrap justify-center gap-4",children:Array.from({length:4},function(e,t){return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"bg-tertiary size-3 animate-pulse rounded-full"}),(0,r.jsx)("div",{className:"bg-tertiary h-4 w-16 animate-pulse rounded-full"})]},"pie-legend-".concat(t))})})]})]})},bar:function(e){var t=e.className,n=e.baseContainerClasses;return(0,r.jsxs)("div",{className:(0,o.A)(n,"gap-4",t),children:[(0,r.jsx)("div",{className:"bg-tertiary h-6 w-1/2 animate-pulse rounded-full"}),(0,r.jsxs)("div",{className:"flex h-64 flex-col justify-end gap-2",children:[(0,r.jsx)("div",{className:"flex items-end justify-between gap-2",children:Array.from({length:6},function(e,t){return(0,r.jsx)("div",{className:(0,o.A)("bg-tertiary w-full animate-pulse rounded-t-md",t%3==0?"h-32":t%2==0?"h-20":"h-40")},"bar-".concat(t))})}),(0,r.jsx)("div",{className:"flex justify-between",children:Array.from({length:6},function(e,t){return(0,r.jsx)("div",{className:"bg-tertiary h-4 w-12 animate-pulse rounded-full"},"bar-label-".concat(t))})})]})]})},line:function(e){var t=e.className,n=e.baseContainerClasses;return(0,r.jsxs)("div",{className:(0,o.A)(n,"gap-4",t),children:[(0,r.jsx)("div",{className:"bg-tertiary h-6 w-1/2 animate-pulse rounded-full"}),(0,r.jsx)("div",{className:"flex h-64 flex-col gap-4",children:(0,r.jsxs)("div",{className:"relative flex size-full flex-col",children:[(0,r.jsx)("div",{className:"absolute left-0 top-0 flex h-full flex-col justify-between py-2",children:Array.from({length:5},function(e,t){return(0,r.jsx)("div",{className:"bg-tertiary h-3 w-8 animate-pulse rounded-full"},"y-axis-".concat(t))})}),(0,r.jsxs)("div",{className:"relative ml-12 mr-4 flex h-full flex-col justify-between",children:[(0,r.jsx)("div",{className:"bg-tertiary absolute left-0 top-0 h-full w-px animate-pulse"}),(0,r.jsx)("div",{className:"bg-tertiary absolute bottom-0 left-0 h-px w-full animate-pulse"}),Array.from({length:4},function(e,t){return(0,r.jsx)("div",{className:"bg-tertiary h-px w-full animate-pulse"},"grid-".concat(t))}),(0,r.jsx)("div",{className:"absolute inset-0 mb-4 mt-2 flex items-end justify-between px-2",children:Array.from({length:6},function(e,t){return(0,r.jsx)("div",{className:"bg-tertiary size-1.5 animate-pulse rounded-full opacity-40",style:{animationDelay:"".concat(.12*t,"s"),marginBottom:"".concat([75,70,60,45,25,15][t],"px")}},"point-".concat(t))})})]}),(0,r.jsx)("div",{className:"ml-12 mr-4 mt-2 flex justify-between",children:Array.from({length:6},function(e,t){return(0,r.jsx)("div",{className:"bg-tertiary h-3 w-12 animate-pulse rounded-full"},"x-axis-".concat(t))})})]})}),(0,r.jsx)("div",{className:"flex flex-wrap justify-center gap-4",children:Array.from({length:3},function(e,t){return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"bg-tertiary size-3 animate-pulse rounded-full"}),(0,r.jsx)("div",{className:"bg-tertiary h-4 w-16 animate-pulse rounded-full"})]},"line-legend-".concat(t))})})]})},table:function(e){var t=e.className,n=e.baseContainerClasses;return(0,r.jsxs)("div",{className:(0,o.A)(n,"gap-4",t),children:[(0,r.jsx)("div",{className:"bg-tertiary h-6 w-1/2 animate-pulse rounded-full"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"flex gap-4",children:Array.from({length:4},function(e,t){return(0,r.jsx)("div",{className:"bg-tertiary h-5 flex-1 animate-pulse rounded-full"},"table-header-".concat(t))})}),Array.from({length:5},function(e,t){return(0,r.jsx)("div",{className:"flex gap-4",children:Array.from({length:4},function(e,n){return(0,r.jsx)("div",{className:(0,o.A)("bg-tertiary h-4 animate-pulse rounded-full",0===n?"w-16":"flex-1")},"table-cell-".concat(t,"-").concat(n))})},"table-row-".concat(t))})]})]})},choropleth:i,heatmap:function(e){var t=e.className,n=e.baseContainerClasses;return(0,r.jsxs)("div",{className:(0,o.A)(n,"gap-4",t),children:[(0,r.jsx)("div",{className:"bg-tertiary h-6 w-1/2 animate-pulse rounded-full"}),(0,r.jsxs)("div",{className:"flex h-96 gap-4",children:[(0,r.jsx)("div",{className:"flex flex-col justify-between py-8",children:Array.from({length:7},function(e,t){return(0,r.jsx)("div",{className:"bg-tertiary h-4 w-12 animate-pulse rounded-full"},"y-label-".concat(t))})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[(0,r.jsx)("div",{className:"flex flex-1 flex-col justify-between gap-2",children:Array.from({length:7},function(e,t){return(0,r.jsx)("div",{className:"flex flex-1 gap-2",children:Array.from({length:6},function(e,n){return(0,r.jsx)("div",{className:(0,o.A)("bg-tertiary flex-1 animate-pulse rounded",(t+n)%3==0?"opacity-100":(t+n)%2==0?"opacity-60":"opacity-30")},"cell-".concat(t,"-").concat(n))})},"row-".concat(t))})}),(0,r.jsx)("div",{className:"flex justify-between gap-2 pt-2",children:Array.from({length:6},function(e,t){return(0,r.jsx)("div",{className:"bg-tertiary h-4 flex-1 animate-pulse rounded-full"},"x-label-".concat(t))})})]})]})]})}},l=function(e){var t=e.className,n=s[e.type]||a;return(0,r.jsx)(n,{className:t,baseContainerClasses:"border-primary flex w-full flex-col rounded-xl border p-6"})};l.displayName="LoadingChartComponent"},180948:function(e,t,n){n.d(t,{O:()=>s});var r=n(275271),o=n(473196);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=function(){var e=a((0,r.useState)(0),2),t=e[0],n=e[1],i=a((0,r.useState)(0),2),s=i[0],l=i[1],c=(0,r.useRef)(null);return{containerHeight:s,containerRef:(0,r.useCallback)(function(e){if(c.current&&(c.current.disconnect(),c.current=null),e){n(e.getBoundingClientRect().width),l(e.getBoundingClientRect().height);var t=new o.do(function(e){var t=e[0];t&&t.contentRect&&(n(t.contentRect.width),l(t.contentRect.height))});t.observe(e),c.current=t}},[]),containerWidth:t}}},726175:function(e,t,n){n.d(t,{u:()=>o});var r=n(275271),o=function(e){var t=e.data,n=e.containerWidth,o=e.indexBy,i=e.estimatedLabelWidth,a=void 0===i?80:i,s=e.marginOffset,l=void 0===s?140:s;return(0,r.useMemo)(function(){var e,r=t.length,i=Math.floor((n-l)/a);return e=r<=i?1:Math.ceil(r/i),t.filter(function(t,n){return n%e==0}).map(function(e){return e[o]})},[t,n,o,a,l])}},212574:function(e,t,n){n.d(t,{C:()=>b});var r=n(275271);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}var a=[1,2,2.5,5,10],s=function(e,t){var n=Math.max(2,null!=e?e:4),r=Math.max(n,null!=t?t:7);return[n,r]},l=function(e,t,n){for(var r=[],o=e;o<=t+1e-6*n;o+=n){var i=1e-12>Math.abs(o)?0:Number(o.toFixed(12));r.push(i)}return r},c=function(e){var t,n=Math.pow(10,Math.floor(Math.log10(e))),r=e/n;return(null!=(t=a.find(function(e){return r<=e}))?t:a[a.length-1])*n},u=function(e,t,n){return l(Math.floor(e/n)*n,Math.ceil(t/n)*n,n)},d=function(e,t,n,r){var o={step:n,ticks:u(e,t,n)},i=Array.from({length:64}).reduce(function(n){if(n.ticks.length<=r)return n;var o=2*n.step,i=u(e,t,o);return{step:o,ticks:i}},o);return{ticks:i.ticks,step:i.step}},f=function(e,t,n,r,o){var i=[0,1,2].reduce(function(n){if(n.ticks.length>=r)return n;var i=n.step/2,a=u(e,t,i);return a.length>o?n:{step:i,ticks:a}},{step:n,ticks:u(e,t,n)});return{ticks:i.ticks,step:i.step}},m=function(e,t,n,r,o){var i=c((t-e)/Math.max(n-1,1)),a=d(e,t,i,o).step;return f(e,t,a,r,o).ticks},p=function(e,t,n,r){if(t>=0||n<=0||e.some(function(e){return e<0}))return e;var a=Math.abs(t),s=-Math.min(c(a/2),a);if(e.includes(s))return e;var l=((function(e){if(Array.isArray(e))return o(e)})(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||i(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([s]).sort(function(e,t){return e-t});return l.length<=r||(l[l.length-1]>0?l.pop():l.shift()),l},b=function(e){var t=e.min,n=e.max,o=e.targetTickCount,a=void 0===o?5:o,l=e.minTickCount,c=e.maxTickCount;return(0,r.useMemo)(function(){if(!Number.isFinite(t)||!Number.isFinite(n))return[];var e,r=Math.min(t,n),o=Math.max(t,n);if(r===o){var u=Math.pow(10,Math.floor(Math.log10(Math.abs(o)||1)));return[o-2*u,o-u,o,o+u,o+2*u]}var d=(e=s(l,c),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||i(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=d[0],b=d[1],h=m(r,o,Math.max(a,f),f,b);return p(h,r,o,b)},[t,n,a,l,c])}},434502:function(e,t,n){n.d(t,{p:()=>h});var r=n(275271),o=n(438209),i=n.n(o),a=n(42693),s=n(650636),l=n(441342),c=n(399761);function u(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){u(i,r,o,a,s,"next",e)}function s(e){u(i,r,o,a,s,"throw",e)}a(void 0)})}}function f(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var m=[90],p=[50,90],b=[25,50,75,90],h=function(e,t){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],o=(0,r.useRef)((0,a.Z)()),u=(0,r.useRef)(!1),h=(0,r.useRef)(new Set),v=(0,r.useRef)(new Set),y=(0,c.U)().pageViewId,g=(0,l.wh)(),x=g.masqueradingEntity,_=g.currentCommunity,j=g.currentCommunityMember,w=g.isLoading,O=null==_?void 0:_.id,S=null==j?void 0:j.id,P=!!(x||w||!t||!n);(0,r.useEffect)(function(){t&&(u.current=!1,o.current=(0,a.Z)(),h.current=new Set,v.current=new Set)},[t]);var C=(0,r.useCallback)(function(){return d(function(){var n,r;return f(this,function(i){switch(i.label){case 0:if(P||!e.current||u.current)return[2];return r={community_id:O,community_member_id:S,video_url:(n=e.current).currentSrc,video_duration:Math.round(n.duration),video_view_id:o.current,page_view_id:null!=y?y:"unknown",signed_id:t},[4,s.n.trackVideoView(r)];case 1:return i.sent(),u.current=!0,[2]}})})()},[O,S,P,e,t,y]),k=(0,r.useCallback)(function(n,r){return d(function(){var i,a;return f(this,function(l){switch(l.label){case 0:if(P||!e.current)return[2];return a={community_id:O,community_member_id:S,video_url:(i=e.current).currentSrc,video_duration:Math.round(i.duration),video_view_id:o.current,page_view_id:null!=y?y:"unknown",signed_id:t,progress_percent:n,progress_seconds:r},[4,s.n.trackVideoSegmentView(a)];case 1:return l.sent(),[2]}})})()},[O,S,P,e,t,y]);(0,r.useEffect)(function(){if(e.current&&t){var n=e.current,r=i()(function(){if(!u.current){var e=n.duration,t=n.currentTime;(e<=30&&t>0||e>30&&t>=30)&&C()}},250);return n.addEventListener("timeupdate",r),function(){r.cancel(),n.removeEventListener("timeupdate",r)}}},[C,e,t,y]),(0,r.useEffect)(function(){if(e.current&&t){var n=e.current,r=i()(function(){if(n.duration){var e,t=(e=n.duration)<=15?m:e<=30?p:b,r=n.currentTime/n.duration*100,o=t.find(function(e){return r<e});o&&v.current.add(o);var i=t.find(function(e,n){var o=t[n+1]||100;return r>=e&&r<o});i&&!h.current.has(i)&&v.current.has(i)&&(h.current.add(i),k(i,Math.round(n.currentTime)))}},250);return n.addEventListener("timeupdate",r),function(){r.cancel(),n.removeEventListener("timeupdate",r)}}},[k,e,t])}},491735:function(e,t,n){n.d(t,{R:()=>s});var r=n(552676),o=n(701168),i=n(381636),a=n(957363),s=function(e){var t,n,s=e.children,l=e.className,c=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["children","className"]);return(0,r.jsxs)("div",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},c),n=n={className:(0,o.A)("bg-secondary mx-6 mb-3 rounded-2xl p-3 text-center text-sm border border-primary",void 0===l?"":l),children:[(0,r.jsx)(a.JO,{type:"20-circle-info",className:"text-default min-w-5 shrink-0 mr-2 mb-[1px]",size:20}),(0,r.jsx)(i.Z.BodySm,{as:"span",color:"text-default",children:s})]},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))}},624310:function(e,t,n){n.d(t,{k:()=>h});var r=n(552676),o=n(932699),i=n(903225),a=n(739792),s=n(441342),l=n(380171),c=n(39905),u=n(547144),d=n(905326),f=n(117617),m=n(403697),p=n(957363);function b(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var h=function(e){var t=e.communityMemberId,n=e.shouldAutoNavigate,h=void 0===n||n,v=e.showIcon,y=e.onClick,g=void 0===y?o.noop:y,x=e.variant,_=void 0===x?"button":x,j=(0,i.k6)(),w=(0,s.wh)().isViewOnlyMasquerading,O=(0,d.p)().findOrCreateChatRoom,S=(0,f.ef)();return(0,r.jsx)(l.T,{placement:"bottom",content:(0,a.t)("post.share.message"),interactive:!1,disabled:"icon"!==_,children:(0,r.jsxs)(c.z,{variant:"secondary",onClick:w?o.noop:function(){var e;return(e=function(){var e;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(n){switch(n.label){case 0:return[4,O({kind:m.g8,community_member_ids:[t]})];case 1:return e=n.sent(),null==g||g(e),h&&j.push((0,u.co)({url:(0,u.so)({uuid:e})})),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){b(i,r,o,a,s,"next",e)}function s(e){b(i,r,o,a,s,"throw",e)}a(void 0)})})()},"aria-label":(0,a.t)("post.share.message"),"data-testid":"chat-button",children:[(void 0===v||v)&&(0,r.jsx)(p.JO,{type:"16-message",size:16,useWithFillCurrentColor:!0,"aria-hidden":!0}),!S&&"icon"!==_&&(0,r.jsx)("span",{className:"ml-1",children:(0,a.t)("message")})]})})}},635556:function(e,t,n){n.d(t,{z:()=>b});var r=n(552676),o=n(275271),i=n(332468),a=n(701168),s="text-sm font-normal whitespace-pre-line chat-message-word-wrap text-darkest",l=function(e,t,n){return(0,r.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",children:t},n)},c=function(e){var t=e.body,n=e.isPinnedMessageAtTop;return(0,r.jsx)("div",{className:(0,a.A)(s,{"pinned-message-body":void 0!==n&&n}),"data-testid":"message-text",children:(0,r.jsx)(i.default,{componentDecorator:l,children:t})})},u=n(739792),d=n(535756),f=n(381636),m=n(326120),p=function(e){var t=e.editedAt,n=e.shouldScrollIntoView,o=e.isPinnedMessageAtTop,i=void 0!==o&&o,l=e.rich_text_body,c=e.chatRoomAccessArr,p=e.shouldShowPreviewBlocks,b=e.chatProps;return l?(0,r.jsx)(d.S,{renderFunc:function(){return(0,r.jsx)(f.Z.LabelSm,{color:"text-v2-danger",children:(0,u.t)("messaging.message_error")})},children:(0,r.jsx)("div",{className:(0,a.A)(s,{"pinned-message-body":i}),"data-testid":"message-text",children:(0,r.jsx)(m.T,{editable:!1,rich_text_body:l,shouldScrollIntoView:void 0!==n&&n,shouldRefetch:!0,isUpdate:i,editedAt:t,chatRoomAccessArr:c,shouldShowPreviewBlocks:void 0===p||p,chatProps:void 0===b?{}:b})})}):null},b=(0,o.memo)(function(e){var t,n=e.message,o=e.shouldScrollIntoView,i=e.isPinnedMessageAtTop,a=void 0!==i&&i,s=e.shouldShowPreviewBlocks;return(a?(t=n.rich_text_body)&&0!==t.body.content.length:n.rich_text_body)?(0,r.jsx)(p,{rich_text_body:n.rich_text_body,shouldScrollIntoView:void 0!==o&&o,isPinnedMessageAtTop:a,editedAt:n.edited_at,chatRoomAccessArr:n.embedded_chat_message_access,shouldShowPreviewBlocks:void 0===s||s,chatProps:{unfurlUrls:n.unfurl_urls}}):(0,r.jsx)(c,{body:n.body,isPinnedMessageAtTop:a})});b.displayName="ContentBody"},457092:function(e,t,n){n.d(t,{f:()=>m});var r=n(552676),o=n(932699),i=n(739792),a=n(757105),s=n(701800),l=n(963549),c=n(315346),u=n(521232),d=function(e){var t=e.chatRoom,n=e.currentParticipant,d=e.handleSubmit,f=e.messageId,m=e.isEditMessage,p=e.message,b=e.onConfirm,h=void 0===b?o.noop:b,v=e.participants,y=e.repliesCount,g=(0,a.dd)(),x=(0,s._)().deleteRichTextMessage;return(0,r.jsxs)(l.c,{isOpen:g.visible,onClose:g.visible?g.hide:o.noop,onConfirm:function(){x({chatRoomUuid:t.uuid,messageId:f}),g.hide(),h()},confirmText:(0,i.t)("delete"),confirmVariant:"danger",title:(0,i.t)("messaging.delete_message.title"),children:[(0,r.jsx)("div",{className:"mb-6",children:(0,c.eB)(y)}),(0,r.jsx)("div",{className:"border-primary w-full rounded-md border py-2",children:(0,r.jsx)(u.t,{isModal:!0,handleSubmit:d,currentParticipant:n,message:p,isEditMessage:void 0!==m&&m,chatRoom:t,participants:v,isViewOnlyMasquerading:!0})})]})},f=a.gk.create(function(e){return(0,r.jsx)(d,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),m=function(){return(0,a.dd)(f)}},459481:function(e,t,n){n.d(t,{P:()=>M});var r=n(552676),o=n(275271),i=n(309757),a=n(701168),s=n(315346),l=n(915912),c=n.n(l),u=n(932699),d=n(131906),f=n(903225),m=n(739792),p=n(251630),b=n(808819),h=n(861853),v=n(499385),y=n(447640),g=n(380171),x=n(441342),_=n(870347),j=n(226801),w=n(775148),O=n(943544),S=n(60878),P=function(e){var t=e.isPinned,n=void 0!==t&&t,o=e.setEditMessageId,i=e.currentParticipant,a=void 0===i?{}:i,l=e.toggleDeleteConfirmationModal,P=e.message,C=e.chatRoom,k=e.isMessageThread,I=void 0!==k&&k,N=e.canUserModifyMessage,A=e.setUnreadMessageFlow,M=void 0===A?u.noop:A,T=e.isLiveStream,E=void 0!==T&&T,R=e.chatRoomUrl,D=void 0===R?"":R,L=e.setActiveMessageId,F=e.isRenderedOnHeader,U=(0,f.TH)().pathname,B=(0,x.wh)(),q=B.currentCommunity,z=B.currentCommunitySettings,Z=null==z?void 0:z.spotlight_chat_messages_enabled,V=U.includes("/messages"),H=(0,h.CD)().appendUnreadChatRoomUuids,W=P.id,Q=P.chat_room_participant_id,G=P.parent_message_id,$=P.spotlighted,K=a.admin,J=Q===a.id,X=(0,S.pm)(),Y="direct"==C.chat_room_kind,ee=(0,x.L2)().data,et=(0,j.L)([null==ee?void 0:ee.id]).refetchSpaceNotifications,en=(0,d.useQueryClient)(),er=J||C.lesson||E,eo=function(e){ec({pinned_message_id:n?null:e})},ei=function(e){el({message_id:e}),V&&(null==q?void 0:q.id)&&H(q.id,C.uuid)},ea=function(){en.invalidateQueries(_.N)},es=function(){en.invalidateQueries({queryKey:[(0,v.S)(C.uuid)]})},el=(0,d.useMutation)(function(e){return p.MS.markAsUnread({uuid:C.uuid,chat_room:e})},{onSuccess:function(){M(!0),es(),ee?et():ea(),X.success((0,m.t)("messaging.actions.mark_as_unread_success"))},onError:function(){X.error((0,m.t)("messaging.actions.mark_as_unread_error"))}}).mutate,ec=(0,d.useMutation)(function(e){return p.MS.pinMessage({uuid:C.uuid,chat_room:e})},{onError:function(){X.error((0,m.t)("messaging.actions.pin_error"))}}).mutate,eu=(0,b.f)({chatUuid:C.uuid}).spotlightMessage,ed=[{value:"edit-message",label:(0,m.t)("edit"),onClick:function(){return o(W)},hide:!J||$},{value:"pin-message",label:n?(0,m.t)("unpin"):(0,m.t)("pin"),onClick:function(){return eo(W)},hide:I||$||!K&&!Y},{value:"spotlight-message",label:(0,m.t)("spotlight"),onClick:function(){return eu(W)},hide:!Z||$||!E||!K},{value:"unread-message",label:(0,m.t)("unread"),onClick:function(){return ei(W)},hide:er},{value:"copy-link",label:(0,m.t)("messaging.actions.copy_link"),onClick:function(){var e=(0,s.Q1)({id:W,parentMessageId:G,chatRoomUrl:D});c()(e),X.success((0,m.t)("messaging.actions.copy_link_success"))},hide:E},{value:"delete-message",label:(0,m.t)("delete"),onClick:l,color:"text-v2-danger",hide:!(void 0!==N&&N)||$}],ef=(0,y.D)().frameDocument;if(ed.every(function(e){return e.hide}))return null;var em=F&&(null==ef?void 0:ef.getElementById("threads-scroll-view"))||ef.body,ep=(0,s.h7)(W,I);return(0,r.jsx)(O.Lt,{direction:"bottom-end",transitionWrapperClassName:"z-[9999]",button:(0,r.jsx)(O.Lt.MenuButton,{onClick:function(){return L(ep)},children:(0,r.jsx)(g.T,{content:(0,m.t)("messaging.more_actions"),children:(0,r.jsx)(w.h,{name:"16-menu-dots-horizontal",ariaLabel:(0,m.t)("messaging.more_actions")})})}),options:ed,dataTestId:"message-actions",appendTo:em})},C=n(965344),k=n(660512),I=n(548880),N=n(356345),A=function(e){var t=e.message,n=void 0===t?{}:t,o=e.chatRoom,i=e.isMessageThread,a=void 0!==i&&i,l=e.chatThreadsEnabled,c=e.isParentMessage,d=e.isRenderedOnHeader,p=void 0!==d&&d,b=e.currentParticipant,h=e.onBookmarkToggle,v=e.setActiveMessageId,y=n.id,x=n.embedded,_=(0,I.K)().removeThreadIdUrlParam,j=(0,k.x)(),O=j.openThreadsRailbar,S=j.setMessageHighlightId,P=j.isLiveStream,A=j.isCourseSpace,M=j.isDrawer,T=P||A,E=window.location.href.includes("threads"),R=(0,u.isFunction)(h)&&!T,D=void 0!==c&&c&&a&&!p&&!T&&!M,L=(0,f.k6)(),F=(b||{}).community_member_id,U=(0,u.throttle)(function(){S(y),(0,s.o7)(y,function(){(0,u.delay)(function(){return S(null)},5e3)})},5e3,{leading:!0,trailing:!1});return(0,r.jsxs)(r.Fragment,{children:[F&&(0,r.jsx)(C.D,{reactions:n.reactions,currentCommunityMemberId:F,reactionableId:n.id,reactionableType:"chat_room_message",setActiveMessageId:v,isMessageThread:a,isRenderedOnHeader:p}),R&&(0,r.jsx)(N.e,{bookmarkType:"message",record:n,onSuccess:function(){return h(n.id)}}),void 0!==l&&l&&!a&&(0,r.jsx)(g.T,{content:(0,m.t)("messaging.reply_in_threads"),dataTestId:"reply-thread",interactive:!1,children:(0,r.jsx)(w.h,{name:"16-open-threads",ariaLabel:(0,m.t)("messaging.reply_in_threads"),onClick:function(){_(),O(n,o)},iconSize:16})}),D&&(0,r.jsx)(g.T,{content:(0,m.t)(x?"messaging.open_in_space":"messaging.open_in_messages"),interactive:!1,children:(0,r.jsx)(w.h,{name:"16-open-in-space",ariaLabel:(0,m.t)(x?"messaging.open_in_space":"messaging.open_in_messages"),onClick:function(){E||p?L.push((0,s.ZZ)(o,n)):U()},iconSize:16})})]})},M=function(e){var t=e.isPinned,n=e.setEditMessageId,l=e.currentParticipant,c=void 0===l?{}:l,u=e.toggleDeleteConfirmationModal,d=e.message,f=e.chatRoom,m=e.isMessageThread,p=void 0!==m&&m,b=e.canUserModifyMessage,h=e.chatThreadsEnabled,v=e.isParentMessage,y=e.isPinnedMessageAtTop,g=e.isRenderedOnHeader,x=void 0!==g&&g,_=e.onBookmarkToggle,j=e.setUnreadMessageFlow,w=e.isLiveStream,O=e.chatRoomUrl,S=e.activeMessageId,C=e.setActiveMessageId,k=(0,o.useRef)(null),I="message-actions-".concat(d.id);(0,i.Z)(k,function(){C(null)});var N=(0,s.XE)({activeMessageId:S,id:d.id,isMessageThread:p});return(0,r.jsx)("div",{className:"absolute right-0 top-0 mb-3",children:(0,r.jsx)("div",{id:I,className:(0,a.A)("border-primary bg-primary -mt-4 mr-4 flex rounded-md border",{"!-mt-1":void 0!==y&&y,invisible:!S||!N,"group-hover/action:visible":!S||N}),children:(0,r.jsx)("div",{ref:k,children:(0,r.jsxs)("div",{className:"flex min-h-[34px] items-center justify-around space-x-1 px-1",children:[(0,r.jsx)(A,{message:d,isMessageThread:p,chatThreadsEnabled:void 0!==h&&h,chatRoom:f,isParentMessage:void 0!==v&&v,isRenderedOnHeader:x,currentParticipant:c,onBookmarkToggle:_,setActiveMessageId:C}),c&&(0,r.jsx)(P,{isPinned:void 0!==t&&t,setEditMessageId:n,currentParticipant:c,toggleDeleteConfirmationModal:u,message:d,chatRoom:f,isMessageThread:p,canUserModifyMessage:void 0!==b&&b,setUnreadMessageFlow:j,isLiveStream:void 0!==w&&w,chatRoomUrl:O,setActiveMessageId:C,isRenderedOnHeader:x})]})})})})}},521232:function(e,t,n){n.d(t,{t:()=>$});var r=n(552676),o=n(275271),i=n(932699),a=n(903225),s=n(739792),l=n(96533),c=n(167518),u=n(664657),d=n(447640),f=n(451980),m=n(701168),p=n(660512),b=n(957363),h=n(664470),v=n(315346),y=n(635556),g=n(619803),x=n.n(g),_=n(380171),j=n(734335),w=n(993441),O=function(e,t,n,r){var o=e.findIndex(function(e){return e.id===n});-1!==o&&(e.splice(o,1),e.unshift({id:n,full_name:(0,s.t)("reactions.you")}));var i=e.map(function(e){return e.full_name});return r>5?i.join(", ")+" ".concat((0,s.t)("reactions.and")," ").concat(r-5," ").concat((0,s.t)("reactions.more_reacted_with")," :").concat(t,":"):i.join(", ").replace(/,([^,]*)$/," ".concat((0,s.t)("reactions.and"),"$1"))+" ".concat((0,s.t)("reactions.reacted_with")," :").concat(t,":")};function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var P=function(e){var t,n=e.reaction,a=e.currentCommunityMemberId,s=e.reactionableId,l=e.reactionableType,c=e.isViewOnlyMasquerading,u=n.emoji,d=n.count,f=n.community_member_ids,m=j.V[u],p=(t=(0,o.useState)([]),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return S(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),b=p[0],h=p[1],v=f.includes(a),y=O(b,u,a,d),g=(0,w.z)({currentCommunityMemberId:a,emoji:u,reactionableId:s,reactionableType:l,setCommunityMembers:h,communityMemberIds:f}),P=g.addReaction,C=g.removeReaction,k=g.fetchCommunityMembers,I=g.isLoading;if(!m)return null;var N=(0,r.jsxs)("button",{type:"button",className:x()("text-default border-primary relative flex h-[1.625rem] cursor-pointer items-center justify-center gap-1 rounded-full border px-1.5 text-sm font-semibold",{"!border-circle text-brand hover:border-brand bg-circle/5":v,"hover:border-gray-400":a&&!v}),onClick:c?i.noop:function(){if(a&&!I){var e,t=(l in(e={emoji:u})?Object.defineProperty(e,l,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[l]=s,e);v?C(t):P(t)}},onMouseEnter:function(){return k()},"data-testid":"reaction-content",children:[(0,r.jsx)("div",{children:m}),(0,r.jsx)("div",{children:d})]});return b.length>0?(0,r.jsx)(_.T,{placement:"top",content:y,interactive:!1,children:N}):(0,r.jsx)("div",{children:N})},C=n(965344),k=function(e){var t=e.reactions,n=void 0===t?[]:t,o=e.currentCommunityMemberId,i=e.reactionableId,a=e.reactionableType,s=e.isMessageThread,l=e.isRenderedOnHeader,c=e.isViewOnlyMasquerading;return(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[n.map(function(e){return(0,r.jsx)(P,{reaction:e,currentCommunityMemberId:o,reactionableId:i,reactionableType:a,isViewOnlyMasquerading:c},e.emoji)}),!!o&&(0,r.jsx)(C.D,{reactions:n,currentCommunityMemberId:o,reactionableId:i,reactionableType:a,showBorder:!0,isMessageThread:void 0!==s&&s,isRenderedOnHeader:void 0!==l&&l})]})},I=n(3255),N=n(808819),A=function(e){var t=e.message,n=e.chatRoom,o=e.isCurrentSpotlightedItem,i=(0,N.f)({chatUuid:n.uuid}),a=i.removeSpotlightMessage,l=i.isRemovingSpotlightMessage,c=o?(0,s.t)("live_streams.room.qa.questions.stop_spotlight"):(0,s.t)("live_streams.room.qa.questions.remove_from_queue");return(0,r.jsx)(I.K,{variant:"text-only",onClick:function(){a(t.id)},disabled:l,children:c})},M=function(e){var t=e.message,n=e.chatRoom,o=e.currentCommunityMemberId,i=e.isSpotlighted,a=e.isCurrentSpotlightedItem,s=e.isAdmin,l=e.isMessageThread,c=e.isRenderedOnHeader,u=e.isViewOnlyMasquerading,d=t.reactions.length>0,f=i&&s;return d||f?(0,r.jsxs)("div",{className:"mt-1.5 flex flex-wrap items-center gap-1",children:[d&&(0,r.jsx)(k,{reactions:t.reactions,currentCommunityMemberId:o,reactionableId:t.id,reactionableType:"chat_room_message",isMessageThread:void 0!==l&&l,isRenderedOnHeader:c,isViewOnlyMasquerading:u}),f&&(0,r.jsx)(A,{message:t,chatRoom:n,isCurrentSpotlightedItem:a})]}):null},T=n(915912),E=n.n(T),R=n(857338),D=n(308683),L=n(60878),F=function(e){var t=e.message,n=e.chatRoomUrl,o=void 0===n?"":n,i=e.isParentMessage,a=e.isMessageThread,l=t.id,c=t.sent_at,u=t.parent_message_id,d=(0,R.H)(c),f=d.day,p=d.time,b=(0,D.TF)(c),h=(0,L.pm)(),y=!!l&&l>0;return(0,r.jsx)("button",{type:"button",className:(0,m.A)("text-timestamp inline min-w-fit text-sm font-medium",y?"hover:underline":"cursor-default"),onClick:function(){if(y){var e=(0,v.Q1)({id:l,parentMessageId:u,chatRoomUrl:o});E()(e),h.success((0,s.t)("messaging.actions.copy_link_success"))}},children:y?void 0!==a&&a?void 0!==i&&i?"".concat(f," at ").concat(p):b:p:(0,s.t)("messaging.sending")})},U=n(918594),B=n(547144),q=function(e){var t=e.message,n=e.chatRoom,o=e.isParentMessage,i=void 0!==o&&o,a=e.isMessageThread,l=e.isRenderedOnHeader,c=t.id,u=t.sent_at,d=(0,R.H)(u),f=d.day,p=d.time,b=(0,D.TF)(u);return(0,r.jsx)(U.rU,{to:(0,B.co)({url:(0,v._z)(n,t),hash:i?(0,v.uo)(t):(0,v.d6)(t),search:i?"":"message_id=".concat(t.id)}),className:(0,m.A)({"inline-flex flex-row items-center":void 0!==l&&l}),children:(0,r.jsx)("span",{className:"text-light inline cursor-pointer text-xs hover:underline",children:c&&c>0?void 0!==a&&a?i?"".concat(f," at ").concat(p):b:p:(0,s.t)("messaging.sending")})})},z=n(403697),Z=function(e){var t=e.chatRoomKind,n=e.sender,o=(0,p.x)(),i=o.isChatSpace,a=o.isDmsPage&&t===z.RN,l=!!(null==n?void 0:n.community_admin),c=!!(null==n?void 0:n.moderator);return(i||a)&&(l||c)?(0,r.jsx)(_.T,{className:"flex items-center justify-center",interactive:!1,content:(0,s.t)(i&&l?"admin":"moderator"),children:(0,r.jsx)(b.JO,{type:"14-moderator-icon",size:14,className:(0,m.A)("!w-[14px]",i&&l?"text-[#2563EB]":"text-tertiary")})}):null},V=n(326120),H=function(e){var t=e.chatRoom,n=e.isRenderedOnHeader,o=e.message,i=e.onDelete,l=e.onSubmit,c=(0,a.TH)().pathname,u=o.rich_text_body||{body:o.body},d=(0,v.$S)(t),f=(0,v.C9)(t),m=c.includes("/messages"),p=(0,v.jr)(m,void 0!==n&&n);return(0,r.jsxs)("div",{className:"chat-message-word-wrap text-dark mb-1 whitespace-pre-line text-sm font-normal","data-testid":"message-text",children:[(0,r.jsx)(V.T,{autofocus:!0,editable:!0,rich_text_body:u,onSubmit:l,onDelete:i,isUpdate:!0,chatProps:{isThread:!!o.parent_message_id,isDirectMessaging:d,isChatAdminOrModerator:f,unfurlUrls:o.unfurl_urls},portalTargetId:p}),(0,r.jsxs)("div",{className:"-mt-5 text-xs",children:[(0,s.t)("messaging.esc_to")," ",(0,r.jsx)("span",{className:"font-semibold",children:(0,s.t)("cancel")})," ",(0,s.t)("messaging.bullet")," ",(0,s.t)("messaging.enter_to")," ",(0,r.jsx)("span",{className:"font-semibold",children:(0,s.t)("save")})]})]})},W=function(e){var t=e.role;return(0,r.jsx)(_.T,{placement:"top",content:(0,s.t)("live_roles.".concat(t)),children:(0,r.jsx)(b.JO,{type:t,size:16,className:"-ml-1 -mt-1"})})},Q=n(7447),G=function(e){var t,n=e.spotlighted,r=(0,Q.I3)(Q.TQ);return{isSpotlighted:n,isCurrentSpotlightedItem:(null==r?void 0:r.type)==="ChatRoomMessage"&&(null==r||null==(t=r.spotlightable)?void 0:t.id)===e.id}},$=function(e){var t=e.chatRoom,n=e.chatRoomUrl,g=e.currentParticipant,x=void 0===g?{}:g,_=e.handleSubmit,j=e.isEditMessage,w=e.isMessageThread,O=void 0!==w&&w,S=e.isModal,P=e.isParentMessage,C=void 0!==P&&P,k=e.isPinned,I=e.isPinnedMessageAtTop,N=e.isRenderedOnHeader,A=void 0!==N&&N,T=e.message,E=e.messageBodyClassName,R=e.participants,D=void 0===R?[]:R,L=e.roles,U=void 0===L?{}:L,B=e.toggleDeleteConfirmationModal,z=void 0===B?i.noop:B,V=e.isViewOnlyMasquerading,Q=e.shouldScrollIntoView,$=(0,a.TH)().pathname,K=(0,l.r)(),J=(0,d.D)().isInFrame,X=T.chat_room_participant_id,Y=G(T),ee=Y.isSpotlighted,et=Y.isCurrentSpotlightedItem,en=(0,o.useMemo)(function(){return D.find(function(e){return e.id===X})},[D,X]),er=(0,o.useMemo)(function(){return(0,v.cY)(null==en?void 0:en.community_member_id,U)},[null==en?void 0:en.community_member_id,U]),eo=(0,i.isEmpty)(en),ei=null==en?void 0:en.user_public_uid,ea=ei&&!J,es=x||{},el=es.community_member_id,ec=es.admin,eu=(0,p.x)().isLiveStream,ed=function(){ea&&K.show({memberPublicId:en.user_public_uid,params:{shouldOpenInNewTab:eu}})},ef=(0,o.useMemo)(function(){return(null==en?void 0:en.id)===(null==x?void 0:x.id)?(0,s.t)("messaging.you"):null==en?void 0:en.name},[en,x]),em=(0,o.useMemo)(function(){return(null==en?void 0:en.deleted_at)?(0,s.t)("messaging.removed_or_left"):""},[null==en?void 0:en.deleted_at]),ep=$.endsWith("threads")||A;return(0,r.jsxs)("div",{className:(0,m.A)("flex w-full flex-col",{"px-4 py-3":!A,"px-3 py-1.5":A}),children:[ee&&(0,r.jsx)(c.U,{isQueuedForSpotlight:!et}),(0,r.jsxs)("div",{className:"flex w-full justify-start",children:[(0,r.jsx)("button",{type:"button",className:(0,m.A)("mr-3 mt-1 self-start",{"cursor-default":!ei}),"aria-label":(0,s.t)("messaging.open_member_profile_button_aria_label",{name:null==en?void 0:en.name}),disabled:!ea,onClick:ed,children:eo?(0,r.jsx)(h.qE,{}):(0,r.jsx)(f.C,{communityMemberId:en.community_member_id,name:en.name,publicUid:en.user_public_uid,headline:en.headline,avatarURL:en.avatar_url,disabled:!ea,children:(0,r.jsx)(u.W,{src:en.avatar_url,name:en.name,size:"9"})})}),(0,r.jsxs)("div",{className:(0,m.A)("w-full overflow-x-auto",E),children:[(0,r.jsxs)("div",{className:"mb-px flex items-center gap-1.5",children:[void 0!==k&&k&&(0,r.jsx)(b.JO,{type:"14-pin","aria-label":(0,s.t)("messaging.pinned_message"),"aria-hidden":!1,size:14,className:"text-darkest !w-3.5"}),(0,r.jsx)("button",{type:"button",className:(0,m.A)("text-darkest truncate text-left text-sm font-semibold",{"cursor-default":!ei}),disabled:!ea,onClick:ed,"data-testid":"number-of-replies",children:eo?(0,r.jsx)(h.X2,{md:!0}):(0,r.jsxs)(r.Fragment,{children:[ef," ",(0,r.jsx)("span",{className:"font-normal",children:em})]})}),er&&(0,b.Er)(er)&&(0,r.jsx)(W,{role:er}),(0,r.jsx)(Z,{chatRoomKind:null==t?void 0:t.chat_room_kind,sender:en}),ep?(0,r.jsx)(q,{chatRoom:t,message:T,isParentMessage:C,isMessageThread:O,isRenderedOnHeader:A}):(0,r.jsx)(F,{message:T,chatRoomUrl:n,isParentMessage:C,isMessageThread:O})]}),!(void 0!==S&&S)&&void 0!==j&&j?(0,r.jsx)(H,{message:T,onSubmit:_,onDelete:z,chatRoom:t,isRenderedOnHeader:A}):(0,r.jsx)(y.z,{message:T,isPinnedMessageAtTop:void 0!==I&&I,shouldScrollIntoView:void 0!==Q&&Q}),(0,r.jsx)(M,{message:T,chatRoom:t,currentCommunityMemberId:el,isSpotlighted:ee,isCurrentSpotlightedItem:et,isAdmin:ec,isMessageThread:O,isRenderedOnHeader:A,isViewOnlyMasquerading:V})]})]})]})}},801771:function(e,t,n){n.d(t,{J:()=>i});var r=n(552676),o=n(739792),i=function(e){var t=e.showDateChangeLine,n=void 0!==t&&t,i=e.showUnreadMessageLine,a=void 0!==i&&i,s=e.day;return n&&a?(0,r.jsxs)("div",{id:"unread-message-breakpoint",className:"before:border-v2-danger relative z-0 mx-5 flex items-center justify-center before:bottom-0 before:left-0 before:top-1/2 before:z-[-1] before:m-0 before:w-full before:border-t before:border-solid before:content-['']",children:[(0,r.jsx)("span",{className:"text-disabled bg-primary text-xxs absolute border-none px-[15px] py-[5px] font-bold uppercase",children:s}),(0,r.jsx)("span",{className:"text-v2-danger text-xxs border-none py-[5px] pl-[10px] font-semibold uppercase",children:(0,o.t)("messaging.new")})]}):n?(0,r.jsx)("div",{className:"before:border-primary relative z-0 mx-5 flex items-center justify-center before:absolute before:bottom-0 before:left-0 before:top-1/2 before:z-[-1] before:m-0 before:w-full before:border-t before:border-solid before:content-['']",children:(0,r.jsx)("span",{className:"bg-primary text-disabled text-xxs border-none px-[15px] py-[5px] font-bold uppercase",children:s})}):a?(0,r.jsx)("div",{id:"unread-message-breakpoint",className:"before:border-v2-danger relative z-0 mx-5 flex items-center justify-center before:z-[-1] before:m-0 before:w-full before:border-t before:border-solid before:content-['']",children:(0,r.jsx)("span",{className:"text-v2-danger text-xxs border-none py-[5px] pl-[10px] font-semibold uppercase",children:(0,o.t)("messaging.new")})}):null}},626725:function(e,t,n){n.d(t,{q:()=>_});var r=n(552676),o=n(275271),i=n(903225),a=n(936353),s=n(447640),l=n(701168),c=n(861853),u=n(701800),d=n(660512),f=n(78580),m=n(739792),p=function(){return(0,r.jsx)("div",{id:"unread-thread-message-breakpoint",className:"relative flex items-center justify-center z-0 mx-5 before:w-full before:m-0 before:border-t before:border-solid before:border-v2-danger before:z-[-1] before:content-['']",children:(0,r.jsx)("span",{className:"text-v2-danger border-none py-[5px] pl-[10px] text-xs font-semibold uppercase",children:(0,m.t)("messaging.new")})})},b=n(315346),h=n(457092),v=n(459481),y=n(521232),g=n(378252);function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var _=function(e){var t,n=e.chatRoom,m=e.chatThreadsEnabled,_=e.currentParticipant,j=e.isInitialPage,w=e.isParentMessage,O=void 0!==w&&w,S=e.isRenderedOnHeader,P=void 0!==S&&S,C=e.isUnreadMessageLineEnabled,k=e.lastReadMessageId,I=e.message,N=e.onBookmarkToggle,A=e.participants,M=e.roles,T=e.setUnreadMessageFlow,E=e.isLiveStream,R=e.chatRoomUrl,D=e.isViewOnlyMasquerading,L=(0,u._)().updateRichTextMessage,F=(0,c.qN)().setScrollInfo,U=(0,a.Op)().calculateScrollInfo,B=(0,d.x)().messageHighlightId,q=(0,i.TH)().pathname,z=(0,c.AP)().activeMessageId,Z=(0,c.G9)().setActiveMessageId,V=(t=(0,o.useState)(null),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return x(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),H=V[0],W=V[1],Q=I.id,G=I.replies_count,$=(0,s.D)().isInFrame,K=!!Q&&H===Q,J=(0,g.O5)({message:I,chatRoom:n}).canUserModifyMessage,X=!!_,Y=function(){return W(null)};(0,f.M)("esc",Y,{enabled:K,enableOnContentEditable:!0},[K]);var ee=function(e){var t=e.body,r=e.attachments;L({chatRoomUuid:n.uuid,messageId:Q,rich_text_body:{body:t,attachments:void 0===r?[]:r}}),F(U({event:"messageUpdated"})),Y()},et=(0,h.f)(),en=function(){et.visible?et.hide():et.show({chatRoom:n,currentParticipant:_,handleSubmit:ee,isEditMessage:K,message:I,messageId:Q,participants:A,repliesCount:G})},er=void 0!==C&&C&&k===I.id,eo=(0,b.XE)({activeMessageId:z,id:Q,isMessageThread:!0});return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{id:"thread-".concat(Q),className:(0,l.A)("group/action bg-primary relative mx-2 flex flex-col rounded-md",{relative:!O||"/threads"===q,"hover:bg-secondary-dark":!z&&X,"!bg-secondary-dark":K||eo,"message-highlight":(0,b.DH)({id:Q,messageHighlightId:B,isParentMessage:O})}),"data-testid":"message-item",children:[(0,r.jsx)(y.t,{isModal:!1,handleSubmit:ee,currentParticipant:_,message:I,shouldScrollIntoView:void 0!==j&&j,isEditMessage:K,toggleDeleteConfirmationModal:en,isPinned:!1,roles:void 0===M?{}:M,isParentMessage:O,chatRoom:n,chatRoomUrl:R,participants:A,isMessageThread:!0,isRenderedOnHeader:P,messageBodyClassName:"mr-4",isViewOnlyMasquerading:D}),X&&(0,r.jsx)(v.P,{isPinned:!1,setEditMessageId:W,chatRoom:n,toggleDeleteConfirmationModal:en,message:I,currentParticipant:_,canUserModifyMessage:J&&!$,chatThreadsEnabled:void 0!==m&&m,isParentMessage:O,isRenderedOnHeader:P,isMessageThread:!0,onBookmarkToggle:N,setUnreadMessageFlow:T,chatRoomUrl:R,isLiveStream:void 0!==E&&E,activeMessageId:z,setActiveMessageId:Z})]}),er&&(0,r.jsx)(p,{})]})}},378252:function(e,t,n){n.d(t,{Sh:()=>p,O1:()=>h,O5:()=>i});var r=n(932699),o=n(403697),i=function(e){var t=e.message,n=e.chatRoom,i=t.id,a=t.chat_room_participant_id,s=n.current_participant,l=void 0===s?{}:s,c=n.chat_room_kind===o.g8,u=a===(null==l?void 0:l.id),d=!(0,r.isNull)(i),f=null==l?void 0:l.admin;c&&(f=!1);var m=!!(d&&u),p=!!(d&&(u||f));return{canUserDeleteMessage:p,canUserEditMessage:m,canUserModifyMessage:m||p}},a=n(275271),s=n(447640),l=n(857338),c=n(701800),u=n(78580),d=n(315346),f=n(457092);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var p=function(e){var t,n=e.chatRoom,o=e.chatThreadsEnabled,p=void 0!==o&&o,b=e.isLastMessage,h=void 0!==b&&b,v=e.message,y=e.participants,g=e.prevDayRef,x=e.setScrollInfo,_=e.calculateScrollInfo,j=e.isViewOnlyMasquerading,w=n.current_participant,O=(0,c._)().updateRichTextMessage,S=(t=(0,a.useState)(null),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return m(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),P=S[0],C=S[1],k=(0,s.D)().isInFrame,I=v.id,N=v.sent_at,A=v.replies_count,M=(0,l.H)(N).day,T=!(0,r.isFunction)(g)&&(null==g?void 0:g.current)!==M;g&&!(0,r.isFunction)(g)&&(g.current=M);var E=!j&&!!I&&P===I,R=(0,f.f)(),D=i({message:v,chatRoom:n}).canUserModifyMessage,L=!E&&(D||p),F=function(){return C(null)};(0,a.useEffect)(function(){E&&h&&(0,d.o7)(I)},[E]),(0,u.M)("esc",F,{enabled:E,enableOnContentEditable:!0},[E]);var U=function(e){x(_({event:e}))},B=function(e){var t=e.body,r=e.attachments,o=e.unfurlUrls;O({chatRoomUuid:n.uuid,messageId:I,rich_text_body:{body:t,attachments:void 0===r?[]:r},unfurl_urls:o}),U("messageUpdated"),F()};return{canUserModifyMessage:D&&!k,day:M,handleSubmit:B,id:I,isDayChange:T,isEditMessage:E,setEditMessageId:C,shouldShowMessageActions:L,shouldShowRepliesBlock:p&&A>0,toggleDeleteConfirmationModal:function(){R.visible?R.hide():R.show({chatRoom:n,currentParticipant:w,handleSubmit:B,isEditMessage:E,message:v,messageId:I,participants:y,onConfirm:function(){U("messageDeleted")},repliesCount:A})}}},b=n(903225),h=function(){var e=(0,b.k6)(),t=function(t){var n=t.id,r=t.parent_message_id;r?e.push({hash:"message_".concat(r),search:"message_id=".concat(n)}):e.push({hash:"message_".concat(n)})};return{redirectToMessage:t,handlePinnedMessage:function(e){document.getElementById(e.id)?(0,d.o7)(e.id):t(e)}}}},156615:function(e,t,n){n.d(t,{G:()=>c});var r=n(552676),o=n(739792),i=n(944428),a=n(716089),s=n(381636),l=n(315346),c=function(e){var t=e.chatRoomUuid,n=e.userList,c=(0,i.u)(t),u=c.chatParticipants,d=c.isLoading,f=n||u;if(d)return null;var m=(0,l.jo)(f);return(0,r.jsxs)("div",{className:"block px-5 py-4",children:[(0,r.jsx)("div",{className:"mb-2 flex space-x-2","data-testid":"participants",children:f.map(function(e){var t=e.name,n=e.avatar_url,o=e.id,i=e.status;return(0,r.jsx)(a.g,{src:n,name:t,size:"10",status:i},o)})}),(0,r.jsx)(s.Z.LabelLg,{weight:"medium",color:"text-darkest",dataTestId:"start-conversation",children:(0,o.t)("messaging.start_conversation")}),(0,r.jsxs)(s.Z.BodyMd,{"data-testid":"start-conversation-message",children:[(0,o.t)("messaging.direct_message_history")," ",m]})]})}},707999:function(e,t,n){n.d(t,{$S:()=>A,BR:()=>u,C9:()=>M,DH:()=>O,OG:()=>y,PM:()=>j,Pd:()=>_,VA:()=>v,Vs:()=>h,YQ:()=>x,ZZ:()=>I,_z:()=>P,bZ:()=>b,cY:()=>m,d6:()=>k,eB:()=>S,f9:()=>p,jo:()=>d,jr:()=>T,lC:()=>c,nR:()=>N,o7:()=>f,uR:()=>w,uo:()=>C,wJ:()=>g});var r=n(932699),o=n(739792),i=n(403697),a=n(547144),s=n(619347);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var c=96,u=64,d=function(e){var t="";return e.forEach(function(n,r){t=r==e.length-1?t+n.name+".":r==e.length-2?t+n.name+" and ":t+n.name+", "}),t},f=function(e,t){var n=document.getElementById(e),r=setTimeout(function(){null==n||n.scrollIntoView({behavior:"smooth",block:"center"}),null==t||t()},100);return function(){return clearTimeout(r)}},m=function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=Object.entries(t||[])[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s,c=(s=i.value,function(e){if(Array.isArray(e))return e}(s)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(s,2)||function(e,t){if(e){if("string"==typeof e)return l(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}}(s,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=c[0],d=c[1];if(Array.isArray(d)&&d.includes(e))return u}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}},p=function(){return!!document.getElementById("mobile-bottom-toolbar")},b=function(){return!!document.getElementById("bookmarks-bar")},h=function(){return document.getElementById("lesson-hello-bar")?112:s.Mz},v=function(e){return e<20?100:e},y=function(e,t){return e.sender.id===t.id},g=function(e,t){return e&&!!e.id&&e.id>0&&(null==e?void 0:e.creation_uuid)===(null==t?void 0:t.creation_uuid)},x=function(){return(window.location.hash||"").split("#message_")[1]},_=function(e,t){return e&&t},j=function(e){var t=e.id,n=e.isPinned,o=e.disableUnreadMessageLine,i=e.unreadMessageId;return!(0,r.isNull)(t)&&!n&&!o&&i===t},w=function(e){var t=e.id,n=e.messageHashId,r=e.messageHighlightId;return n&&t==n||r&&t==r},O=function(e){var t=e.id,n=e.messageHighlightId;return!e.isParentMessage&&n&&t==n},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>0?"".concat((0,o.t)("messaging.delete_message.description")," ").concat((0,o.t)("messaging.delete_message.threads")):(0,o.t)("messaging.delete_message.description")},P=function(e,t){if((0,r.isEmpty)(e))return"";var n=e.embedded_space,o=e.uuid,i=(n||{}).slug;return t.embedded?(0,a.kr)({spaceSlug:i}):(0,a.so)({uuid:o})},C=function(e){return"message_".concat(e.id)},k=function(e){return"message_".concat(e.parent_message_id)},I=function(e,t){var n=P(e,t);return"".concat(n,"#message_").concat(t.id)},N=function(e,t){var n=[];return e.map(function(e){var r=e.chat_room_participant_id;t.find(function(e){return(null==e?void 0:e.id)===r})||n.includes(r)||n.push(r)}),n},A=function(e){return(null==e?void 0:e.chat_room_kind)===i.g8},M=function(e){var t=(e||{}).current_participant,n=void 0===t?{}:t;return!!((null==n?void 0:n.admin)||(null==n?void 0:n.moderator))},T=function(e,t){var n=null;return e?n="fullscreen-modal-body":t&&(n="chat-threads-header"),n}},861219:function(e,t,n){n.d(t,{Q1:()=>o,XE:()=>i,h7:()=>a,j_:()=>s,ut:()=>l,yf:()=>u});var r=n(547144),o=function(e){var t=e.id,n=e.parentMessageId,r=e.chatRoomUrl;return window.location.protocol+"//"+window.location.host+(r||window.location.pathname)+(n?"?message_id=".concat(t,"#message_").concat(n):"#message_".concat(t))},i=function(e){var t=e.activeMessageId,n=e.id,r=e.isMessageThread;return t===a(n,void 0!==r&&r)},a=function(e,t){return"".concat(t?"thread-":"message-").concat(String(e))},s=function(e){var t=e||document;return t.getElementById("message-thread-scroll-view")||t.getElementById("message-scroll-view")||t.body},l=function(e,t){var n=e.slug,o=e.uuid,i=t.id,a=t.parent_message_id,s=t.embedded?(0,r.kr)({spaceSlug:n}):(0,r.so)({uuid:o}),l="#message_".concat(i);return a&&(l="?message_id=".concat(i,"#message_").concat(a)),"".concat(s).concat(l)},c=0,u=function(e){var t,n,r=e.chatRoom,o=e.richTextBody,i=e.localAttachments,a=e.localSgidToObjectMap,s=e.parentMessageId,l=e.creationUuid,u=e.sentAt,d=e.unfurlUrls,f=r.current_participant,m=null==f?void 0:f.id;if(!f||!m)return null;var p={id:--c,chat_room_id:r.id,rich_text_body:(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},o),n=n={attachments:i,sgids_to_object_map:a},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t),body:"",chat_room_uuid:r.uuid,chat_room_participant_id:m,creation_uuid:l,sender:f,reactions:[],parent_message_id:null!=s?s:null,updated_at:u,sent_at:u,created_at:u,chat_thread_id:null};return d&&(p.unfurl_urls=d),s&&(p.parent_message_id=s),p}},315346:function(e,t,n){n.d(t,{cY:()=>r.cY,XE:()=>a.XE,$S:()=>r.$S,DH:()=>r.DH,o7:()=>r.o7,Q1:()=>a.Q1,eB:()=>r.eB,h7:()=>a.h7,_z:()=>r._z,PM:()=>r.PM,uR:()=>r.uR,ZZ:()=>r.ZZ,yf:()=>a.yf,nR:()=>r.nR,d6:()=>r.d6,uo:()=>r.uo,ut:()=>a.ut,jo:()=>r.jo,cj:()=>i,wJ:()=>r.wJ,Pd:()=>r.Pd,j_:()=>a.j_,C9:()=>r.C9,jr:()=>r.jr,YQ:()=>r.YQ});var r=n(707999),o=n(619347),i=function(e){var t=e.searchInputClientHeight,n=void 0===t?0:t,i=e.footerClientHeight,a=e.isSmOrMdScreen,s=e.isLiveStream,l=void 0!==s&&s,c=e.isInCourseSpace,u=void 0!==c&&c,d=e.isDrawer,f=void 0!==d&&d,m=e.isMessagingModalOpen,p=void 0===i?0:i;return n&&(p+=n),(0,r.f9)()&&(p+=o.Q_),!u&&(0,r.bZ)()&&(p+=40),void 0!==a&&a?p+=l||u||f?o.Mz:r.BR+o.Mz:l?p=r.lC:u?p=(0,r.Vs)():f&&(p=o.Mz),void 0!==m&&m&&(p=(0,r.VA)(p)),p},a=n(861219)},528740:function(e,t,n){n.d(t,{x:()=>eu});var r=n(552676),o=n(275271),i=n(932699),a=n(861853),s=n(499385),l=n(263271),c=n(441342),u=n(579528),d=n(202952),f=n(72220),m=n(701800),p=n(739792),b=n(532701),h=n(491735),v=n(261242),y=n(156615),g=function(e){var t=e.userList,n=!(0,b.E8)()&&1===t.length;return(0,r.jsxs)("div",{children:[(0,r.jsx)(y.G,{userList:t}),n?(0,r.jsx)(h.R,{children:(0,p.t)("community_member.member_to_member_messaging_disabled")}):(0,r.jsx)(v.Fx,{userList:t,isChatPreview:!0,portalTargetId:"fullscreen-modal-body"})]})},x=n(903225),_=n(282859),j=n(60589),w=n(495834),O=n(936353),S=n(117617),P=n(218059),C=n(701168),k=n(716533),I=n(944428),N=n(772309),A=n(807355),M=n(239295),T=n(548880),E=n(289131),R=n(226801),D=n(840905);n(619347);var L=n(547144),F=n(315346),U=n(459481),B=n(521232),q=n(801771),z=n(660512),Z=n(861219),V=n(378252),H=function(e){var t=e.children,n=e.id,o=e.isEditMessage,i=void 0!==o&&o,a=e.isPinned,s=void 0!==a&&a,l=e.isPinnedMessageAtTop,c=e.message,u=e.messageHashId,d=e.shouldShowMessageActions,f=void 0!==d&&d,m=e.shouldShowRepliesBlock,p=void 0!==m&&m,b=e.activeMessageId,h=(0,z.x)().messageHighlightId,v=(0,V.O1)().handlePinnedMessage,y=c.spotlighted,g=(0,Z.XE)({activeMessageId:b,id:c.id,isMessageThread:!1}),x="group/action bg-primary mx-2 flex flex-col rounded-md text-left relative z-0";return void 0!==l&&l?(0,r.jsx)("button",{type:"button",id:"pinned","data-testid":"message-item",className:(0,C.A)(x,"cursor-pointer",{"hover:bg-secondary-dark":!b&&f,"!bg-secondary-dark":i||g||y,"bg-message-highlight mt-2":s,"pb-2":p}),onClick:function(){i||v(c)},children:t}):(0,r.jsx)("div",{id:n,"data-testid":"message-item",className:(0,C.A)(x,{"hover:bg-secondary-dark":!b&&f,"!bg-secondary-dark":i||g||y,"bg-message-highlight":s,"message-highlight":(0,F.uR)({id:n,messageHashId:u,messageHighlightId:h}),"pb-2":p}),children:t})},W=n(308683),Q=n(381636),G=n(729806),$=function(e){var t=e.avatars,n=(void 0===t?[]:t).slice(0,3).map(function(e){return{name:e.name,src:e.avatar_url}});return(0,r.jsx)("div",{className:"border-tertiary isolate flex items-center space-x-1 rounded-lg md:justify-center",children:(0,r.jsx)(G.p,{size:"5",users:n,isFullRounded:!0})})},K=function(e){var t=e.message,n=e.chatRoom,o=(0,z.x)().openThreadsRailbar,i=t.replies_count,a=t.last_reply_at,s=(0,T.K)().removeThreadIdUrlParam;return(0,r.jsx)("button",{type:"button",className:"hover:border-primary hover:bg-primary group -mt-2 ml-[62px] flex h-[30px] max-w-fit cursor-pointer items-center rounded-2xl border border-transparent px-0.5 md:mr-0 hover:md:mr-[30px]",onClick:function(){s(),o(t,n)},children:(0,r.jsx)("div",{className:"flex items-center justify-between","data-testid":"replies-block",children:(0,r.jsxs)("div",{className:"flex items-center space-x-1.5",children:[(0,r.jsx)($,{avatars:t.thread_participants_preview}),(0,r.jsx)(Q.Z.LabelXs,{weight:"medium",children:1===i?(0,p.t)("threads.one_reply"):(0,p.t)("threads.many_replies",{count:i})}),a&&(0,r.jsx)("div",{className:"flex items-center pr-2.5 leading-none group-hover:hidden",children:(0,r.jsx)(Q.Z.LabelXs,{color:"text-timestamp",weight:"medium",children:(0,W.TF)(a)})}),(0,r.jsx)("div",{className:"hidden pr-2.5 leading-none group-hover:block",children:(0,r.jsx)(Q.Z.LabelXs,{color:"text-timestamp",weight:"medium",children:(0,p.t)("messaging.view_thread")})})]})})})},J=(0,o.forwardRef)(function(e,t){var n=e.chatRoom,o=e.chatThreadsEnabled,a=void 0!==o&&o,s=e.disableUnreadMessageLine,l=e.displayDayChange,c=e.isInitialPage,u=e.isLastMessage,d=e.isParentMessage,f=void 0!==d&&d,m=e.isPinned,p=void 0!==m&&m,b=e.isPinnedMessageAtTop,h=void 0!==b&&b,v=e.message,y=e.messageBodyClassName,g=e.messageHashId,x=e.onBookmarkToggle,_=e.participants,j=e.roles,w=e.setUnreadMessageFlow,O=e.unreadMessageId,S=e.isLiveStream,P=e.activeMessageId,C=e.setActiveMessageId,k=e.setScrollInfo,I=e.calculateScrollInfo,N=e.isViewOnlyMasquerading,A=n.current_participant,T=(0,V.Sh)({chatRoom:n,chatThreadsEnabled:a,isLastMessage:void 0!==u&&u,message:v,participants:_,prevDayRef:t,setScrollInfo:k,calculateScrollInfo:I,isViewOnlyMasquerading:N}),E=T.canUserModifyMessage,R=T.day,D=T.handleSubmit,z=T.id,Z=T.isDayChange,W=T.isEditMessage,Q=T.setEditMessageId,G=T.shouldShowMessageActions,$=T.shouldShowRepliesBlock,J=T.toggleDeleteConfirmationModal,X=(0,M.q)().isMessaging?(0,L.so)(n):"",Y=void 0!==c&&c&&!(g||O);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(q.J,{showDateChangeLine:(0,F.Pd)(void 0!==l&&l,Z),showUnreadMessageLine:(0,F.PM)({id:z,isPinned:p,disableUnreadMessageLine:void 0!==s&&s,unreadMessageId:O}),day:R}),(0,r.jsxs)(H,{isPinnedMessageAtTop:h,id:z,shouldShowMessageActions:G,isEditMessage:W,isPinned:p,messageHashId:g,shouldShowRepliesBlock:$,message:v,activeMessageId:P,children:[(0,r.jsx)(B.t,{isModal:!1,handleSubmit:D,currentParticipant:A,message:v,isEditMessage:W,toggleDeleteConfirmationModal:N?i.noop:J,isPinned:p,roles:void 0===j?{}:j,isParentMessage:f,chatRoom:n,isPinnedMessageAtTop:h,participants:_,messageBodyClassName:y,chatRoomUrl:X,isViewOnlyMasquerading:N,shouldScrollIntoView:Y}),(0,r.jsx)(U.P,{isPinned:p,setEditMessageId:Q,chatRoom:n,toggleDeleteConfirmationModal:N?i.noop:J,message:v,currentParticipant:A,canUserModifyMessage:E,chatThreadsEnabled:a,isParentMessage:f,isPinnedMessageAtTop:h,onBookmarkToggle:x,setUnreadMessageFlow:w,isLiveStream:S,chatRoomUrl:X,activeMessageId:P,setActiveMessageId:C}),$&&(0,r.jsx)(K,{message:v,chatRoom:n})]})]})});function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Y(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}J.displayName="MessageItem";var et={},en=function(e){var t,n,s,l=e.chatRoom,u=e.displayDayChange,f=void 0===u||u,m=e.isChatPreview,b=e.isChatSpace,y=e.isInCourseSpace,g=e.chatUserSearchRef,L=e.isLiveStream,U=e.isDrawer,B=e.roles,q=void 0===B?et:B,z=e.messageBodyClassName,Z=(0,F.YQ)(),V=ee((0,o.useState)(Z),2),H=V[0],W=V[1],Q=(0,T.K)(),G=Q.openThreadsRailbarOnThreadsNotification,$=Q.closeThreadsRailbar,K=(0,c.L2)().data,X=(0,c.wh)().isViewOnlyMasquerading,en=ee((0,o.useState)(!1),2),er=en[0],eo=en[1],ei=(0,w.w)().markChatRoomAsRead,ea=(0,R.L)([null==K?void 0:K.id]).refetchSpaceNotifications,es=(0,P.h4)().spaces,el=(0,j.Xd)(es,null==K?void 0:K.id),ec=(0,x.k6)(),eu=ee((0,o.useState)(!0),2),ed=eu[0],ef=eu[1],em=ee((0,o.useState)(!0),2),ep=em[0],eb=em[1],eh=(0,S.ef)();(0,E.t)();var ev=(0,I.u)(l.uuid,{shouldDisableCache:!0,per_page:100}).chatParticipants,ey=(0,M.q)().isMessaging,eg=l.uuid,ex=l.last_message,e_=l.current_participant,ej=void 0===e_?{}:e_,ew=l.pinned_message,eO=l.first_unread_message_id,eS=(0,o.createRef)(),eP=(0,a.AP)(),eC=eP.activeMessageId,ek=eP.hasNextPage,eI=eP.isLoading,eN=eP.isInitialPageLoaded,eA=(0,a.G9)(),eM=eA.setChatRoomMessages,eT=eA.setActiveMessageId,eE=eA.setScrollInfo,eR=eA.appendLastMessage,eD=(0,a.XT)().chatRoomMessages,eL=void 0===eD?[]:eD,eF=(0,O.Op)(),eU=eF.calculateScrollInfo,eB=eF.scrollerId,eq=(0,d.u)(),ez=eq.fetchChatMessagesFirstPage,eZ=eq.adjustScroller,eV=eq.setUnreadMessageFlow,eH=(0,k.B)(eL,eM),eW=!b&&0===eL.length,eQ=(0,N.L)(l,ev,y),eG=eQ.canSendMessage,e$=eQ.getBottomBannerMessage,eK=ee((0,o.useState)(),2),eJ=eK[0],eX=eK[1],eY=(0,o.useRef)(null),e0=ed&&ep;(0,o.useEffect)(function(){W(Z)},[Z]),(0,o.useEffect)(function(){$()},[eg]),(0,o.useEffect)(function(){ez(Number(H)||eO),eb(!0),ef(!0)},[eg,H,eO]),(0,o.useEffect)(function(){H&&e0&&!eI&&((0,F.o7)(H),G({messageHashId:H,chatRoomMessages:eL,chatRoom:l}))},[H,eI,e0]);var e1=(0,o.useMemo)(function(){var e=(0,i.uniqBy)(eL,"id");return(0,i.sortBy)(e,"sent_at")},[eL]);(0,o.useEffect)(function(){e0&&H||!eN||(0,i.defer)(eZ)},[e1,H,eN]);var e2=function(){!ek&&ex&&ex.id>0&&eR(ex)};(0,o.useEffect)(function(){var e=function(){var e,t;eX((0,F.cj)({searchInputClientHeight:null==g||null==(e=g.current)?void 0:e.clientHeight,footerClientHeight:null==eY||null==(t=eY.current)?void 0:t.clientHeight,isSmOrMdScreen:eh,isLiveStream:L,isInCourseSpace:y,isDrawer:U}))};return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[g,eW,eG,L,y,eh,null==eY||null==(s=eY.current)?void 0:s.clientHeight,U]),(0,o.useEffect)(function(){eo(!((b||ey)&&eG))},[eG,b,ey]);var e3=(0,o.useMemo)(function(){return(0,F.nR)(e1,ev)},[e1,ev]);(0,A.g)({uuid:l.uuid,ids:e3,enabled:!!(ev.length&&e3.length)});var e6=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.shouldAppendLastMessage,r=void 0!==n&&n;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:if(!(b&&(null==el?void 0:el.unread_content_count)>0&&!X))return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,ei({uuid:l.uuid})];case 2:return e.sent()&&ea(),[3,4];case 3:return console.error(e.sent()),[3,4];case 4:return H?ec.push({}):ez(),r&&(0,i.delay)(e2,100),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){Y(i,r,o,a,s,"next",e)}function s(e){Y(i,r,o,a,s,"throw",e)}a(void 0)})})()},e5=(0,_.OP)(),e4=(0,o.useMemo)(function(){return{uuid:l.uuid,chat_room_kind:l.chat_room_kind,current_participant:ej,chat_room_participants_count:l.chat_room_participants_count}},[l.uuid,l.chat_room_kind,ej,l.chat_room_participants_count]),e7=(0,o.useMemo)(function(){return(0,i.omit)(l,"last_message")},[l.uuid,l.chat_room_kind,l.identifier,l.chat_room_participants_count,ej,l.chat_room_show_history,l.pinned_message,l.first_unread_message_id,l.chat_room_name,l.chat_room_description]);return(0,r.jsxs)("div",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({id:"scrollWrapper",className:"flex grow flex-col overflow-y-auto border-r-0","data-testid":"chat-room-wrapper"},eJ&&{style:{height:"calc(100".concat(e5," - ").concat(eJ,"px)")}}),n=n={children:[eN?(0,r.jsxs)(r.Fragment,{children:[ew&&(0,r.jsx)(J,{message:ew,isPinned:!0,roles:q,chatRoom:e7,chatThreadsEnabled:!m,isLiveStream:L,isPinnedMessageAtTop:!0,participants:ev,messageBodyClassName:z,onBookmarkToggle:eH,setUnreadMessageFlow:eV,setScrollInfo:eE,calculateScrollInfo:eU,activeMessageId:eC,setActiveMessageId:eT,isViewOnlyMasquerading:X}),(0,r.jsx)(v.Qk,{isLastPage:ed,isFirstPage:ep,setIsLastPage:ef,setIsFirstPage:eb,componentId:eB,children:e1.map(function(e){var t;return(0,r.jsx)(J,{message:e,displayDayChange:f,ref:eS,isInitialPage:e0,isLastMessage:(null==(t=(0,i.last)(eL))?void 0:t.id)===e.id,messageHashId:H,roles:q,isPinned:(null==ew?void 0:ew.id)===e.id,disableUnreadMessageLine:er,unreadMessageId:eO,chatRoom:e7,chatThreadsEnabled:!m,isLiveStream:L,participants:ev,messageBodyClassName:z,onBookmarkToggle:eH,setUnreadMessageFlow:eV,activeMessageId:eC,setActiveMessageId:eT,setScrollInfo:eE,calculateScrollInfo:eU,isViewOnlyMasquerading:X},e.id)})})]}):(0,r.jsx)("div",{id:eB,className:"overflow-hidden pt-0",children:(0,r.jsx)(D.gi,{variant:"chat-room",hideMessageBox:!0})}),ek&&eN&&(0,r.jsx)("div",{className:"relative bottom-8 m-auto h-0",children:(0,r.jsx)(v.E0,{label:(0,p.t)("messaging.latest_messages"),onClick:function(){e6()}})}),eG?(0,r.jsxs)("div",{ref:eY,className:(0,C.A)("bg-primary fixed z-[9] w-full md:static md:bottom-auto md:z-auto md:w-auto md:bg-auto",{"bottom-0":!eW||L,"bottom-16":eW&&!L||b,"rounded-b-lg":L}),children:[!eI&&eW&&(0,r.jsx)(v.GW,{isLiveStream:L,isInCourseSpace:y,isMessaging:ey,chatRoomUuid:l.uuid}),(0,r.jsx)(v.Fx,{spaceId:null==K?void 0:K.id,chatRoomData:e4,onClick:function(){(H||ek)&&e6({shouldAppendLastMessage:!0})},isChatPreview:m,isLiveStream:L,isChatSpace:b,isInCourseSpace:y,isLoading:!eN||eI,participants:ev})]}):(0,r.jsx)("div",{className:(0,C.A)("fixed md:bottom-0 z-[9] w-full pt-2 md:static md:z-auto md:w-auto bg-primary",ey?"pb-4":"pb-1 h-18",b?"bottom-16":"bottom-0"),ref:eY,children:(0,r.jsx)(h.R,{children:e$()})})]},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},er=n(257335),eo=n(60878);function ei(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ea=function(){var e=document.getElementById("message-thread-scroll-view")||document.getElementById("message-scroll-view");return!!(null==e?void 0:e.offsetParent)},es=function(e){var t,n=e.uuid,r=e.isLiveStream,i=(0,o.useRef)(),a=(0,o.useRef)(),s=(0,o.useRef)("connected"),l=(0,eo.pm)(),c=(t=(0,o.useState)("connected"),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return ei(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ei(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=c[0],f=c[1],m=(0,d.u)().fetchChatMessagesFirstPage,b=!r||ea(),h=function(e){f(e.subscriptionState)};(0,o.useEffect)(function(){return er.Z.on("chatRoomSubscriptionStateChange",h),function(){er.Z.off("chatRoomSubscriptionStateChange",h)}},[]),(0,o.useEffect)(function(){s.current=u},[u]),(0,o.useEffect)(function(){if("disconnected"===u)a.current=Date.now(),setTimeout(function(){"disconnected"===s.current&&b&&l.error((0,p.t)("websocket_message.unstable_right_now"))},3e3);else if("disconnected"===i.current&&"connected"===u){var e;Date.now()-(null!=(e=a.current)?e:0)>3e3&&b&&l.success((0,p.t)("websocket_message.back_online"),{shouldUseProgress:!1}),m()}i.current=u},[u,n])},el={},ec=[],eu=function(e){var t=e.uuid,n=e.displayDayChange,p=e.onNewChatMessage,b=e.isChatSpace,h=e.chatUserSearchRef,y=e.isLiveStream,x=void 0!==y&&y,_=e.isInCourseSpace,j=e.isDrawer,w=e.roles,O=e.messageBodyClassName,S=e.isChatPreview,P=e.userList,C=void 0===P?ec:P,k=e.isMessaging,I=(0,d.u)().onEventReceive,N=(0,a.XT)().chatRoomMessages,A=(0,u.Q)().onReactionWebsocketEvent;es({uuid:t,isLiveStream:x});var M=(0,c.N3)(),T=(0,m._)(),E=T.onEventReceive,R=T.onEmbedEventReceive,D=(0,s.m)(t),L=D.chatRoom,F=D.onEventReceive,U=D.isLoading,B=(0,f.a)((0,a.Kv)(t)),q=(0,f.a)(a.yf).appendChatRoom;return((0,o.useEffect)(function(){L&&!B&&q(L)},[q,L,B]),(0,l.s)({channel:"Chats::RoomChannel",chat_room_uuid:null==L?void 0:L.uuid,onMessageReceive:function(e){"newMessage"===e.event&&(E(e,t===(null==L?void 0:L.uuid)),p&&(null==e?void 0:e.json_message)&&p(e.json_message)),I(e,N),F(e)},canCreateConnection:!!((null==L?void 0:L.uuid)&&(null==M?void 0:M.id))},[null==L?void 0:L.uuid,null==M?void 0:M.id]),(0,l.s)({channel:"ChatRoomChannel",onMessageReceive:function(e){A(e),R(e)},community_member_id:null==M?void 0:M.id,canCreateConnection:(null==L?void 0:L.uuid)&&(null==M?void 0:M.id)},[null==L?void 0:L.uuid,null==M?void 0:M.id]),B)?(0,r.jsx)(en,{chatRoom:B,displayDayChange:void 0===n||n,isChatSpace:void 0!==b&&b,chatUserSearchRef:h,isLiveStream:x,isInCourseSpace:void 0!==_&&_,isDrawer:void 0!==j&&j,roles:void 0===w?el:w,messageBodyClassName:void 0===O?"":O,isChatPreview:S}):void 0!==k&&k?"new"===t&&(0===C.length||U)?(0,r.jsx)(v.Fx,{onClick:i.noop,disabled:!0}):(0,r.jsx)(g,{userList:C}):null}},704614:function(e,t,n){n.d(t,{V:()=>F});var r=n(552676),o=n(275271),i=n(932699),a=n(861853),s=n(263271),l=n(441342),c=n(547144),u=n(26674),d=n(739792),f=n(93199),m=n(251630),p=n(660512),b=n(60878),h=n(90047);function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function g(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}}var _=function(){var e,t=(0,a.qN)(),n=t.chatMessages,r=t.setChatMessages,s=t.isLoading,l=t.setIsLoading,u=t.hasNextPage,v=t.hasPrevPage,_=t.setHasNextPage,j=t.setHasPrevPage,w=t.scrollInfo,O=t.setScrollInfo,S=t.setFirstMessageId,P=t.setLastMessageId,C=t.setTotalMessagesCount,k=t.setMetaData,I=t.appendLastMessage,N=(e=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||x(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),A=N[0],M=N[1],T=(0,h.j)().isMobileView,E=(0,p.x)(),R=E.parentMessage,D=E.updateParentMessage,L=(0,b.pm)().error,F=function(e){var t=e.event,n=document.getElementById("message-thread-scroll-view");if(!n)return{action:"noScroll",scrollTopValue:0,scrollHeightValue:0};var r="noScroll";switch(t){case"messageSent":r="scrollToBottom";break;case"messageReceived":var o=n.scrollTop-n.scrollHeight+n.offsetHeight;(T()&&0===o||o<=1||o>14)&&(r="scrollToBottom");break;case"chatThreadsLoad":r="scrollToUnreadMessageIndicator";break;case"paginatedMessageLoad":r="adjustTop"}return{action:r,scrollTopValue:n.scrollTop,scrollHeightValue:n.scrollHeight}},U=function(e,t){var n=e.id;r(t.filter(function(e){return e.id!==n}))},B=function(e,t){var n=e.json_message;n&&(r(g(t.reduce(function(e,t){return t.id===n.id?e.push(n):e.push(t),e},[]))),n.id===(null==R?void 0:R.id)&&D(n))},q=function(e,t){var n=e.json_message;n&&(O(F({event:n.sender.id===t.id?"messageSent":"messageReceived"})),I(n))};return{fetchChatMessages:function(e){var t,o=e.id,a=e.previousPerPage,p=void 0===a?20:a,b=e.nextPerPage,h=void 0===b?0:b,x=e.chatRoomUuid,w=e.isInitialPage,I=void 0!==w&&w,N=e.parentMessage;return(t=function(){var e,t,a,b,y;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(w){switch(w.label){case 0:if(((e=0===p)||I)&&s)return[2];l(!0),t={previous_per_page:p,next_per_page:h,parent_message_id:N.id},o&&(t.id=o),w.label=1;case 1:return w.trys.push([1,3,4,5]),[4,(0,f.UT)(c.av.chatRoomMessages.index({uuid:x,params:t}))];case 2:return a=w.sent(),I?((null==(b=a.meta)?void 0:b.chat_thread_participant_id)&&(O(F({event:"chatThreadsLoad"})),(0,m.ex)(N.chat_thread_id)),k(a.meta),r(a.records),_(a.has_next_page),j(a.has_previous_page),C(a.total_count),S(a.first_id),P(a.last_id),M(!0)):(e?(O(F({event:"nextPaginatedMessageLoad"})),P(a.last_id)):(O(F({event:"paginatedMessageLoad"})),S(a.first_id)),r((0,i.uniqBy)(g(a.records).concat(g(n)),"id")),u&&_(a.has_next_page),v&&j(a.has_previous_page)),[3,5];case 3:return y=w.sent(),L((0,d.t)("request_failure_message")),console.error(y),[3,5];case 4:return l(!1),[7];case 5:return[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){y(i,r,o,a,s,"next",e)}function s(e){y(i,r,o,a,s,"throw",e)}a(void 0)})})()},calculateScrollInfo:F,adjustScroller:function(){var e=document.getElementById("message-thread-scroll-view");if(e){var t=document.getElementById("unread-thread-message-breakpoint");switch(w.action){case"scrollToBottom":e.scrollTop=e.scrollHeight;break;case"adjustTop":e.scrollTop=e.scrollHeight-(w.scrollHeightValue-w.scrollTopValue);break;case"scrollToUnreadMessageIndicator":t?t.scrollIntoView({behavior:"smooth"}):e.scrollTop=e.scrollHeight}}},onEventReceive:function(e,t,n){switch(e.event){case"newMessage":q(e,n);break;case"deletedMessage":U(e,t);break;case"updatedMessage":B(e,t)}},isInitialPageLoaded:A,setIsInitialPageLoaded:M}},j=n(548880),w=n(716533),O=n(944428),S=n(772309),P=n(807355),C=n(239295),k=n(840905),I=n(491735),N=n(626725),A=n(315346),M=n(261242),T=n(874178),E=function(e){var t=e.children,n=e.isLastPage,o=e.isFirstPage,i=e.setIsFirstPage,s=e.setIsLastPage,l=e.chatRoomUuid,c=e.parentMessage,u=_().fetchChatMessages,d=(0,a.qN)(),f=d.hasNextPage,m=d.hasPrevPage,p=d.isLoading,b=d.firstMessageId,h=d.lastMessageId;return(0,r.jsx)(T.Y,{shouldShowPrevLoader:!n,shouldShowNextLoader:!o,hasNextPage:f,hasPrevPage:m,onNextPage:function(e){u({chatRoomUuid:l,id:e,previousPerPage:0,nextPerPage:20,parentMessage:c}),i(!1)},onPrevPage:function(e){u({chatRoomUuid:l,id:e,parentMessage:c}),s(!1)},firstItemId:b,lastItemId:h,componentId:"message-thread-scroll-view",isLoading:p,children:t})},R=function(e){var t=e.count;return(0,r.jsx)("div",{id:"replies-message-line",className:"before:border-primary relative z-0 mx-5 flex items-center justify-start before:absolute before:bottom-0 before:left-0 before:top-1/2 before:z-[-1] before:m-0 before:w-full before:border-t before:border-solid before:content-['']",children:(0,r.jsx)("span",{className:"bg-primary w-[68px] border-none py-0.5 pr-[10px] text-xs text-gray-400",children:1===t?(0,d.t)("threads.one_reply"):(0,d.t)("threads.many_replies",{count:t})})})};function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var F=function(e){var t=e.parentMessage,n=e.chatRoom,d=L((0,o.useState)(!0),2),f=d[0],m=d[1],b=L((0,o.useState)(!0),2),h=b[0],v=b[1],y=L((0,o.useState)(0),2),g=y[0],x=y[1],T=L((0,o.useState)(!1),2),D=T[0],F=T[1],U=(0,l.wh)().isViewOnlyMasquerading,B=(0,j.K)().removeThreadIdUrlParam,q=(0,O.u)(n.uuid).chatParticipants,z=(0,l.L2)().data,Z=(0,a.qN)(),V=Z.chatMessages,H=Z.setChatMessages,W=Z.hasPrevPage,Q=Z.hasNextPage,G=Z.isLoading,$=Z.totalMessagesCount,K=Z.metaData,J=_(),X=J.fetchChatMessages,Y=J.onEventReceive,ee=J.adjustScroller,et=J.isInitialPageLoaded,en=J.setIsInitialPageLoaded,er=(0,u.N)().handleReactionFromWebsocket,eo=(0,w.B)(V,H),ei=(0,p.x)(),ea=ei.messageHighlightId,es=ei.isLiveStream,el=ei.isCourseSpace,ec=(0,C.q)().isMessaging,eu=Number((0,A.YQ)())!==ea,ed=ec?(0,c.so)(n):"",ef=n.current_participant,em=(0,S.L)(n,q,el),ep=em.canSendMessage,eb=em.getBottomBannerMessage;(0,o.useEffect)(function(){var e={chatRoomUuid:n.uuid,isInitialPage:!0,parentMessage:t,id:null,nextPerPage:0};return ea&&eu&&(e.id=ea,e.nextPerPage=20),en(!1),X(e),function(){return x(0)}},[t.id,null==n?void 0:n.uuid]),(0,s.s)({channel:"Chats::RoomChannel",chat_room_uuid:null==n?void 0:n.uuid,onMessageReceive:function(e){var n=e.event,r=e.json_message;if("newMessage"===n){if(!(null==r?void 0:r.parent_message_id)||r.parent_message_id!==t.id)return;x(function(e){return e+1})}else"deletedMessage"===n&&x(function(e){return e-1});Y(e,V,ef)},canCreateConnection:!!(null==n?void 0:n.uuid)},[null==n?void 0:n.uuid]),(0,o.useEffect)(function(){et&&ea&&eu&&(0,A.o7)("thread-".concat(ea))},[et,ea,eu]),(0,o.useEffect)(function(){!et||ea&&eu||(0,i.defer)(ee)},[V,et,ea]);var eh=(0,o.useMemo)(function(){var e=(0,i.uniqBy)(V,"id");return(0,i.sortBy)(e,"sent_at")},[V]),ev=(K||{}).last_read_message_id,ey=(0,i.last)(eh),eg=(0,o.useMemo)(function(){return(0,A.nR)(eh,q)},[eh,q]);(0,P.g)({uuid:n.uuid,ids:eg,enabled:!!(q.length&&eg.length)}),(0,o.useEffect)(function(){if(!G&&et){var e=!(0,i.isNull)(ev),t=ev!==(null==ey?void 0:ey.id);F(e&&t)}},[ev,et,t.id,G]),(0,s.s)({channel:"ChatRoomChannel",onMessageReceive:function(e){("createReaction"===e.event||"destroyReaction"===e.event)&&er(e)},community_member_id:null==ef?void 0:ef.community_member_id,canCreateConnection:!!(null==ef?void 0:ef.community_member_id)},[null==ef?void 0:ef.community_member_id]);var ex=$+g,e_=(0,o.useMemo)(function(){return{uuid:n.uuid,chat_room_kind:n.chat_room_kind,current_participant:ef,chat_room_participants_count:n.chat_room_participants_count}},[n.uuid,n.chat_room_kind,ef,n.chat_room_participants_count]);return et?(0,r.jsx)("div",{id:"scrollWrapper",className:"flex h-full grow flex-col border-r-0",children:(0,r.jsxs)(E,{isLastPage:f,isFirstPage:h,setIsLastPage:m,setIsFirstPage:v,chatRoomUuid:n.uuid,parentMessage:t,children:[!W&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N.q,{message:t,currentParticipant:ef,chatRoom:n,participants:q,isLiveStream:es,isParentMessage:!0,chatThreadsEnabled:!0,chatRoomUrl:ed,isViewOnlyMasquerading:U}),ex>0&&(0,r.jsx)(R,{count:ex})]}),eh.map(function(e){return(0,r.jsx)(N.q,{message:e,currentParticipant:ef,chatRoom:n,chatRoomUrl:ed,chatThreadsEnabled:!0,isUnreadMessageLineEnabled:D,lastReadMessageId:ev,participants:q,isLiveStream:es,onBookmarkToggle:eo,isViewOnlyMasquerading:U},e.id)}),!Q&&(ep?(0,r.jsx)(M.Fx,{chatRoomData:e_,parentMessageId:t.id,onClick:B,spaceId:null==z?void 0:z.id,portalTargetId:"rail-content",participants:q,messageBoxId:"threadsMessageTextBox"+String(t.id)}):(0,r.jsx)(I.R,{className:"mt-2",children:eb()}))]})}):(0,r.jsx)("div",{id:"message-thread-scroll-view",children:(0,r.jsx)(k.gi,{variant:"chat-thread"})})}},792771:function(e,t,n){n.d(t,{I:()=>g});var r=n(552676),o=n(932699),i=n(903225),a=n(739792),s=n(764208),l=n(251630),c=n(571807),u=n(314625),d=n(660512),f=n(233516),m=n(619347),p=n(704614),b=n(117617),h=n(775148),v=n(381636),y=function(e){var t=e.title,n=e.onClose,o=(0,b.kK)(),i=(0,d.x)(),s=i.isChatSpace,l=i.isCourseSpace,c=i.isLiveStream,u=i.isDrawer;if(o)return(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)(h.h,{name:"16-arrow-left",onClick:n,iconClassName:"!text-dark",className:"flex-none",ariaLabel:(0,a.t)("close")}),(0,r.jsx)("div",{className:"flex-auto text-center",children:(0,r.jsx)(v.Z.TitleSm,{as:"h2",weight:"semibold",children:t})})]});if(c||l||u)return(0,r.jsxs)("div",{className:"flex w-full items-center justify-start",children:[(0,r.jsx)(h.h,{name:"20-back",onClick:n,iconSize:20,buttonSize:20,iconClassName:"!text-dark !h-5 !w-5",className:"mr-3 size-8 flex-none",ariaLabel:(0,a.t)("back")}),(0,r.jsx)(v.Z.TitleSm,{as:"h2",weight:"semibold",children:t})]});var f=s?v.Z.TitleSm:v.Z.LabelMd;return(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)(f,{as:"h2",weight:"semibold",children:t}),(0,r.jsx)(h.h,{name:"20-close",iconSize:20,onClick:n,iconClassName:"!text-dark",ariaLabel:(0,a.t)("close")})]})},g=function(e){var t=e.isFullWidth,n=void 0!==t&&t,b=e.shouldRenderInline,h=void 0!==b&&b,v=(0,f.T)(),g=v.ref,x=v.height,_=(0,i.k6)(),j=(0,d.x)(),w=j.closeThreadsRailbar,O=j.parentMessage,S=j.chatRoom,P=void 0===S?{}:S,C=j.messageHighlightId,k=j.setMessageHighlightId,I=j.shouldShowRailBar,N=j.isCourseSpace,A=j.isDrawer,M=j.isLiveStream,T=(0,s.r)(),E=T.unreadChatThreadIds,R=T.isUnreadThreadFlow;if(!I||(0,o.isEmpty)(P))return null;var D=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{ref:g,children:(0,r.jsx)(m.S0.Header,{children:(0,r.jsx)(y,{title:(0,a.t)("messaging.thread"),onClose:function(){C&&(_.push({search:(0,u.iO)("message_id")}),k(null)),O.chat_thread_id&&(M||E.includes(O.chat_thread_id))&&!R&&(0,l.ex)(O.chat_thread_id),w()}})})}),(0,r.jsx)(m.S0.Content,{heightGap:x,isCourseSpace:N,noPadding:!0,adaptHeightToLgScreen:!h,children:(0,r.jsx)(p.V,{parentMessage:O,chatRoom:P})})]});if(h)return(0,r.jsx)(m.S0,{isFullWidth:n,noBorderLeft:N,isSmallScreen:!0,children:D});var L=N?"portal":A?"drawer":"header";return(0,r.jsx)(c.x,{position:L,noBorderLeft:N,isFullWidth:n,children:D})}},697485:function(e,t,n){n.d(t,{h:()=>l});var r=n(552676),o=n(932699),i=n(957363),a=n(117617),s=n(381636),l=function(e){var t=e.title,n=e.memberCount,l=e.isDirect,c=e.description,u=e.onClose,d=void 0===u?o.noop:u,f=(0,a.BT)();return(0,r.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)(s.Z.LabelMd,{as:"h2",weight:"semibold",children:t}),f?(0,r.jsx)("button",{type:"submit",onClick:d,children:(0,r.jsx)(i.JO,{type:"close-v2",className:"text-dark mr-1 mt-2.5",useWithFillCurrentColor:!0})}):(0,r.jsx)(r.Fragment,{children:!l&&n&&(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"text-default mr-2 pb-0.5",children:(0,r.jsx)(s.Z.LabelSm,{weight:"medium",children:n})}),(0,r.jsx)(i.JO,{type:"space-chat-members",className:"text-dark",useWithFillCurrentColor:!0})]})})]}),!l&&!!c&&(0,r.jsx)("div",{className:"text-default whitespace-pre-line",children:(0,r.jsx)(s.Z.BodySm,{children:c})})]})}},407383:function(e,t,n){n.d(t,{F2:()=>a,bb:()=>s});var r=n(403697);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[],n=[];return e.forEach(function(e){e.admin?t.push(e):n.push(e)}),i(t).concat(i(n))},s=function(e){var t=[],n=[],o=[];return e.filter(function(e){return!e.deleted_at}).forEach(function(e){e.status===r.eh.online?t.push(e):e.status===r.eh.idle?o.push(e):n.push(e)}),{onlineParticipants:i(t).concat(i(o)),offlineParticipants:n}}},786518:function(e,t,n){n.d(t,{_:()=>a});var r=n(552676),o=n(739792),i=n(963549),a=function(e){var t=e.showModal,n=e.onClose,a=e.onConfirm,s=e.memberName,l=e.isLoading;return(0,r.jsx)(i.c,{disabled:void 0!==l&&l,isOpen:t,onClose:n,size:"lg",onConfirm:a,title:(0,o.t)("messaging.block_direct_messages_modal.title",{name:s}),confirmText:(0,o.t)("confirm"),children:(0,o.t)("messaging.block_direct_messages_modal.description",{name:s})})}},134560:function(e,t,n){n.d(t,{F:()=>I});var r=n(552676),o=n(275271),i=n(72622),a=n(903225),s=n(739792),l=n(403697),c=n(852770),u=n(861853),d=n(326120),f=n(441342),m=n(701168),p=n(905326),b=n(72220),h=n(932699),v=n(807355),y=n(263271),g=function(e){var t,n,r=e.enabled,o=e.chatRoomUuid,i=e.isThread,a=e.currentCommunityMember,s=e.onMessageReceive,l=i?{community_member_id:null==a?void 0:a.id}:{chat_room_uuid:o},c=i?!!(null==a?void 0:a.id):!!o,u=(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({channel:i?"Chats::CommunityMemberThreadsChannel":"Chats::RoomChannel",canCreateConnection:r&&c},l),n=n={onMessageReceive:s},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t),d=(0,y.s)(u);return{subscription:null==d?void 0:d.subscription}};function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var _=function(e){var t,n,r=e.enabled,i=e.chatRoomUuid,a=e.currentParticipant,s=e.parentMessageId,l=e.editorRef,c=e.participants,u=void 0===c?[]:c,d=e.messageBoxId,f=e.currentCommunityMember,m=(t=(0,o.useState)(new Set),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return x(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=m[0],b=m[1],y=(0,o.useRef)(new Map),_=(0,o.useRef)(!1),j=function(e){y.current.has(e)&&clearTimeout(y.current.get(e));var t=setTimeout(function(){return O(e)},3e4);y.current.set(e,t)},w=function(e){y.current.has(e)&&(clearTimeout(y.current.get(e)),y.current.delete(e))},O=function(e){w(e),b(function(t){var n=new Set(t);return n.delete(e),n})},S=g({enabled:r,chatRoomUuid:i,isThread:!!s,currentCommunityMember:f,onMessageReceive:function(e){var t=!(0,h.isUndefined)(s)&&s===e.parent_message_id||(0,h.isUndefined)(s)&&(0,h.isNull)(e.parent_message_id);b(function(n){var r=new Set(n);if(t&&e.chat_room_participant_id!==a.id){var o=e.chat_room_participant_id;"typing"===e.event?(j(o),r.add(e.chat_room_participant_id)):"stopTyping"===e.event&&(w(o),r.delete(e.chat_room_participant_id))}return r})}}).subscription,P=function(){!_.current&&S&&(S.perform("typing",{chat_room_uuid:i,community_member_id:null==f?void 0:f.id,parent_message_id:s}),_.current=!0)},C=function(){_.current&&k()},k=function(){S.perform("stop_typing",{chat_room_uuid:i,community_member_id:null==f?void 0:f.id,parent_message_id:s}),_.current=!1};(0,o.useEffect)(function(){var e=l.current;return r&&e&&e.on("update",function(e){var t=e.transaction;(null==t?void 0:t.docChanged)&&P()}),function(){r&&e&&e.off("update")}},[null==l?void 0:l.current,S]);var I=document.getElementById(d);null==I||I.addEventListener("keyup",function(e){n&&clearTimeout(n),(null==e?void 0:e.key)==="Enter"&&C(),n=setTimeout(C,3e3)});var N=document.getElementById("tiptap-send");null==N||N.addEventListener("click",function(){n&&clearTimeout(n),C()});var A=Array.from(p).filter(function(e){return!u.some(function(t){return t.id===e})}),M=u.filter(function(e){return p.has(e.id)}).map(function(e){return e.name});return(0,v.g)({uuid:i,ids:A,enabled:A.length>0}),{typingUserNames:M,isTyping:M.length>0}},j=n(275753),w=n(60878),O=n(315346),S=n(381636);let P=n.p+"static/react/components/Chat/TypingIndicator/typing-81b0b18d6d56b7da.gif";var C=function(e){var t=e.typingUserNames,n="";return 1===t.length?n=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.Z.LabelXs,{as:"span",weight:"medium",children:t[0]})," ",(0,r.jsx)(S.Z.LabelXs,{as:"span",children:(0,s.t)("messaging.is_typing")})]}):2===t.length?n=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.Z.LabelXs,{as:"span",weight:"medium",children:t[0]})," ",(0,r.jsx)(S.Z.LabelXs,{as:"span",children:(0,s.t)("and")})," ",(0,r.jsx)(S.Z.LabelXs,{as:"span",weight:"medium",children:t[1]})," ",(0,r.jsx)(S.Z.LabelXs,{as:"span",children:(0,s.t)("messaging.are_typing")})]}):t.length>2&&(n=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.Z.LabelXs,{as:"span",weight:"medium",children:t[0]})," ",(0,r.jsxs)(S.Z.LabelXs,{as:"span",children:[(0,s.t)("and")," ",t.length-1," ",(0,s.t)("others")," ",(0,s.t)("messaging.are_typing")]})]})),(0,r.jsx)("div",{className:"flex items-center",children:n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{loading:"eager",src:P,className:"mt-1.5 w-6",alt:""}),(0,r.jsx)("span",{children:n})]})})};function k(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var I=function(e){var t=e.onClick,n=e.autoFocus,h=e.disabled,v=void 0!==h&&h,y=e.spaceId,g=e.chatRoomData,x=e.isChatPreview,S=void 0!==x&&x,P=e.parentMessageId,I=e.userList,N=void 0===I?[]:I,A=e.isLiveStream,M=void 0!==A&&A,T=e.isChatSpace,E=e.isInCourseSpace,R=void 0!==E&&E,D=e.portalTargetId,L=e.isLoading,F=e.participants,U=e.messageBoxId,B=void 0===U?"tiptapMessageTextBox":U,q=(0,a.UO)().uuid,z=(0,f.wh)(),Z=z.currentCommunityMember,V=z.isViewOnlyMasquerading,H=(0,b.a)(u.iX),W=(0,a.k6)(),Q=(0,w.pm)(),G=(0,j.T)(),$=(0,p.p)().findOrCreateChatRoom,K=(0,o.useRef)(null),J=(0,o.useCallback)(function(e){var t,n=e.richTextBody,r=e.unfurlUrls;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return[4,$({kind:N.length>1?l.RN:l.g8,community_member_ids:N.map(function(e){return e.id}),rich_text_body:n,shouldNavigate:!0,unfurl_urls:r})];case 1:return e.sent(),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){k(i,r,o,a,s,"next",e)}function s(e){k(i,r,o,a,s,"throw",e)}a(void 0)})})()},[N,$]),X=!i.isMobile&&void 0!==n&&n,Y=(0,O.$S)(g),ee=(0,O.C9)(g),et=(g||{}).current_participant,en=_({enabled:!(S||R),chatRoomUuid:(null==g?void 0:g.uuid)||"",currentParticipant:void 0===et?{}:et,editorRef:K,participants:void 0===F?[]:F,parentMessageId:P,messageBoxId:B,currentCommunityMember:Z}),er=en.isTyping,eo=en.typingUserNames,ei=(0,o.useCallback)(function(e){var n=e.body,r=e.attachments,o=e.localAttachments,i=e.localSgidToObjectMap,a=e.unfurlUrls;if(!v)if(null==t||t(),g){var l=g.uuid;if(H(l,{richTextBody:{body:n,attachments:r},localAttachments:o,localSgidToObjectMap:i,parentMessageId:P,unfurlUrls:a}).catch(function(e){Q.error((0,s.t)("something_went_wrong")),(0,c.dD)(e)}),P)return;S&&("new"==q||!q)&&W.push("/messages/".concat(l))}else J({richTextBody:{body:n,attachments:r},unfurlUrls:a})},[v,t,g,H,P,Q,S,q,W,J]);return(0,r.jsxs)("div",{className:(0,m.A)("bg-primary relative px-5 pt-2",{"rounded-b-lg":er&&M}),children:[(0,r.jsx)(d.T,{autofocus:X,disabled:v||V,isMediaUploadAllowed:G,onSubmit:ei,spaceId:y,id:B,editorRef:K,portalTargetId:void 0===D?"chat-threads-header":D,isLiveStream:M,isChatSpace:void 0!==T&&T,shouldShowTextModifiersMenu:!(void 0!==L&&L),chatProps:{disableGroupMentions:M||R,isThread:!!P,isDirectMessaging:Y,isChatAdminOrModerator:ee,chatParticipantsCount:null==g?void 0:g.chat_room_participants_count,isTyping:er}}),er&&(0,r.jsx)(C,{typingUserNames:eo})]})}},72048:function(e,t,n){n.d(t,{s:()=>a});var r=n(552676),o=n(739792),i=n(963549),a=function(e){var t=e.shouldShowConfirmationModal,n=e.toggleConfirmationModal,a=e.handleSubmit,s=e.chatParticipantsCount;return(0,r.jsx)(i.c,{isOpen:t,onClose:n,onConfirm:function(){a(!0),n()},confirmText:(0,o.t)("send"),title:(0,o.t)("messaging.send_group_message.title",{participants_count:s}),children:(0,r.jsx)("div",{className:"mb-6",children:(0,o.t)("messaging.send_group_message.description")})})}},954578:function(e,t,n){n.d(t,{u:()=>s});var r=n(552676),o=n(275271),i=n(739792),a=n(963549),s=function(e){var t=e.shouldShowPrivateMessageConfirmationModal,n=e.togglePrivateMessageConfirmationModal,s=e.handleSubmit,l=e.shouldShowPrivateMessageConfirmationOnSubmit,c=e.setShouldShowPrivateMessageConfirmationOnSubmit;return(0,o.useEffect)(function(){l||(s(!0),n())},[l,s,n]),(0,r.jsx)(a.c,{isOpen:t,onClose:n,onConfirm:function(){c(!1)},confirmText:(0,i.t)("send"),title:(0,i.t)("messaging.share_private_message.title"),cancelText:(0,i.t)("messaging.edit_message"),children:(0,r.jsx)("div",{className:"mb-6",children:(0,i.t)("messaging.share_private_message.description")})})}},261242:function(e,t,n){n.d(t,{Qk:()=>f,GW:()=>s,E0:()=>m,Fx:()=>l.F});var r=n(552676),o=n(739792),i=n(324512),a=n(156615),s=function(e){var t=e.isLiveStream,n=e.isInCourseSpace,s=e.isMessaging,l=e.chatRoomUuid,c=(0,i.d)().translatedLabels;return void 0!==s&&s?(0,r.jsx)(a.G,{chatRoomUuid:l}):void 0!==t&&t?(0,r.jsxs)("div",{className:"block px-5 py-4",children:[(0,r.jsx)("div",{className:"text-darkest text-lg font-medium",children:(0,o.t)("messaging.live_stream_start_conversation")}),(0,r.jsx)("div",{className:"text-dark",children:(0,o.t)("messaging.live_stream_start_conversation_description")})]}):void 0!==n&&n?(0,r.jsxs)("div",{className:"block px-5 py-4",children:[(0,r.jsx)("div",{className:"text-darkest text-lg font-medium",children:(0,o.t)("messaging.course_lesson_chat_start_conversation")}),(0,r.jsx)("div",{className:"text-dark",children:(0,o.t)("messaging.course_lesson_chat_start_conversation_description",{lessonSingular:c.lesson.singular.toLowerCase()})})]}):null},l=n(134560),c=n(861853),u=n(202952),d=n(874178),f=function(e){var t=e.children,n=e.isLastPage,o=e.isFirstPage,i=e.setIsFirstPage,a=e.setIsLastPage,s=e.componentId,l=(0,u.u)().fetchChatMessages,f=(0,c.AP)(),m=f.hasNextPage,p=f.hasPrevPage,b=f.isLoading,h=f.firstMessageId,v=f.lastMessageId;return(0,r.jsx)("div",{className:"flex h-auto grow flex-col overflow-auto",children:(0,r.jsx)(d.Y,{shouldShowPrevLoader:!n,shouldShowNextLoader:!o,hasNextPage:m,hasPrevPage:p,onNextPage:function(e){l({id:e,previousPerPage:0,nextPerPage:20,parentMessageId:null}),i(!1)},onPrevPage:function(e){l({id:e,parentMessageId:null}),a(!1)},firstItemId:h,lastItemId:v,componentId:void 0===s?"message-scroll-view":s,isLoading:b,children:t})})},m=function(e){var t=e.label,n=e.onClick;return(0,r.jsx)("button",{type:"submit",className:"bg-circle rounded-2xl px-2.5 py-1 text-xs font-semibold leading-5 text-white hover:opacity-90",onClick:n,children:t})}},693440:function(e,t,n){n.d(t,{G:()=>i});var r=n(552676),o=n(322825),i=function(e){var t=e.tiptapBody;return(0,r.jsx)(o.Rs,{readOnly:!0,value:t.body,sgidToObjectMap:t.sgids_to_object_map,inlineAttachments:t.inline_attachments,openInternalLinksInCurrentTab:!0,disabledExtensions:["cta"],shouldSupportTables:!0})}},251805:function(e,t,n){n.d(t,{E:()=>c,z:()=>l});var r=n(275271),o=n(131906),i=n(93199),a=n(547144),s=n(307992),l=function(e){var t=e.postId,n=e.id;return[s.b,t,"hierarchy",String(n)]},c=function(e){var t=e.postId,n=e.id,s=e.postCommentsClosed,c=e.postLikingDisabled,u=(0,o.useQueryClient)(),d=(0,r.useMemo)(function(){return l({postId:t,id:n})},[t,n]);(0,r.useEffect)(function(){u.removeQueries(d)},[s,c,u,d]);var f=(0,o.useQuery)(d,function(){return(0,i.UT)(a.av.comments.commentHierarchy({postId:t,id:null!=n?n:void 0}))},{cacheTime:0,onError:function(e){404===e.status&&u.setQueryData(d,null)},retry:function(e,t){return 404!==t.status&&e<3}}),m=f.data;return{comment:m,isLoading:f.isLoading,updateQueryData:function(e){var t,n;return u.setQueryData(d,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),n=n={replies:m.replies},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))}}}},307992:function(e,t,n){n.d(t,{b:()=>r,k:()=>o});var r="comments",o=function(e){var t=e.postId,n=e.parentCommentId,o=e.usedIn;return[r,t,"list",n,void 0===o?null:o].filter(Boolean)}},167919:function(e,t,n){n.d(t,{Q:()=>o,q:()=>r});var r="#comment_wrapper_",o="#all_comments"},96533:function(e,t,n){n.d(t,{r:()=>j});var r=n(552676),o=n(757105),i=n(497202),a=n(739792),s=n(861853),l=n(754951),c=n(981261),u=n(208054),d=n(434519),f=n(851945),m=n(381636),p=n(528740),b=n(792771),h=n(660512),v=n(239295),y=function(e){var t=e.uuid;return(0,r.jsx)("div",{className:"flex grow flex-col overflow-auto",children:(0,r.jsx)(v.A,{chatRoomUuid:t,isMessaging:!0,children:(0,r.jsxs)(h.G,{isDrawer:!0,children:[(0,r.jsx)(p.x,{uuid:t,displayDayChange:!0,isDrawer:!0}),(0,r.jsx)("div",{id:"rail-bar-drawer"}),(0,r.jsx)(b.I,{})]})})})},g={page_name:c.$q.PROFILE_VIEW},x=function(e){var t,n=e.memberPublicId,o=e.params,c=(0,s.nC)(),p=c.liveChatRoomUuid,b=c.setLiveChatRoomUuid,h=(0,i.dd)(),v=(0,u.P$)({publicId:n,params:g}).getProfileInfoQuery,x=v.data,_=v.isLoading,j=v.refetch,w=(null==o?void 0:o.recommendation_id)?Number.parseInt(String(o.recommendation_id),10):void 0,O=function(){b(null),h.remove()};return(0,r.jsxs)(d.u_,{isOpen:h.visible,onClose:O,contentPortalId:"post-modal-portal",children:[(0,r.jsx)(d.u_.Overlay,{}),(0,r.jsxs)(d.u_.Content,{size:"full",className:"max-w-screen-xl",children:[(0,r.jsxs)("div",{className:"border-primary text-dark flex justify-between border-b !px-9 !py-4",children:[(0,r.jsx)(m.Z.TitleSm,{weight:"semibold",children:p?null!=(t=null==x?void 0:x.name)?t:"":(0,a.t)("profile")}),(0,r.jsx)(f.o,{onClick:O})]}),p?(0,r.jsx)(y,{uuid:p}):(0,r.jsx)(d.u_.Body,{className:"!md:px-0 !md:pt-0 !md:overflow-hidden block grid-cols-12 !p-0 md:grid md:grid-flow-row-dense",children:(0,r.jsx)(l.o,{member:x,isLoading:_,onClose:function(){return h.remove()},recommendationId:w,refetchProfileInfo:j})})]})]})},_=o.gk.create(function(e){var t=e.memberPublicId,n=e.params;return(0,r.jsx)(x,{memberPublicId:t,params:n})}),j=function(){return(0,o.dd)(_)}},114735:function(e,t,n){n.d(t,{t:()=>d});var r=n(552676),o=n(275271),i=n(739792),a=n(963549),s=n(379522),l=n(125152);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var u="events.delete.recurring_event_modal",d=function(e){var t,n=e.show,d=e.onConfirm,f=e.onCloseModal,m=e.isDeleting,p=void 0!==m&&m,b=(t=(0,o.useState)(),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return c(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),h=b[0],v=b[1];return(0,r.jsx)(a.c,{title:(0,i.t)("".concat(u,".title")),isOpen:void 0!==n&&n,confirmText:p?(0,i.t)("deleting"):(0,i.t)("".concat(u,".accept")),cancelText:(0,i.t)("".concat(u,".cancel")),onClose:f,onCancel:f,onConfirm:function(){h&&d(h)},disabled:p,confirmVariant:"danger",size:"sm",children:(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(s.S,{defaultChecked:l.HA.CURRENT,name:"recurring_event_settings.frequency_edit",options:[{label:(0,i.t)("".concat(u,".this_event")),value:l.HA.CURRENT},{label:(0,i.t)("".concat(u,".this_and_following")),value:l.HA.REMAINING},{label:(0,i.t)("".concat(u,".all_events")),value:l.HA.ALL}],size:"sm",onChange:function(e){v(e)}})})})}},19338:function(e,t,n){n.d(t,{E:()=>g,e:()=>j});var r,o,i=n(275271),a=n(704783),s=n(227851),l=n(739792),c=n(125152),u=n(842953),d=n(404393),f=n(943945);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||h(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}}var v="recurring_setting_attributes.ends_at",y="events.recurring",g=function(e){var t=e.startsAt,n=e.firstLetterCapital,r=void 0===n||n?"frequencies_capital_letter":"frequencies",o=new Date(t).getDate(),i=(0,f.UZ)(t),a=(0,f.ZY)(t),s=(0,f.cz)(t),u=(0,f.Rc)(t);return[{label:(0,l.t)("".concat(y,".").concat(r,".daily"),{dayName:i}),value:c.PB.DAILY},{label:(0,l.t)("".concat(y,".").concat(r,".weekday"),{dayName:i}),value:c.PB.WEEKDAY},{label:(0,l.t)("".concat(y,".").concat(r,".weekly"),{dayName:i}),value:c.PB.WEEKLY},{label:(0,l.t)("".concat(y,".").concat(r,".bi_weekly"),{dayName:i}),value:c.PB.BI_WEEKLY},{label:(0,l.t)("".concat(y,".").concat(r,".monthly"),{dayNumberWithOrdinal:u}),value:c.PB.MONTHLY_WEEK_BASED},{label:(0,l.t)("".concat(y,".").concat(r,".monthly"),{dayNumberWithOrdinal:s}),value:c.PB.MONTHLY},{label:(0,l.t)("".concat(y,".").concat(r,".annually"),{monthName:a,dayNumber:o}),value:c.PB.ANNUALLY}]},x=(p(r={},c.PB.DAILY,60),p(r,c.PB.WEEKDAY,90),p(r,c.PB.WEEKLY,360),p(r,c.PB.BI_WEEKLY,720),p(r,c.PB.MONTHLY,720),p(r,c.PB.MONTHLY_WEEK_BASED,720),p(r,c.PB.ANNUALLY,3600),r),_=(p(o={},c.PB.DAILY,60),p(o,c.PB.WEEKDAY,60),p(o,c.PB.WEEKLY,52),p(o,c.PB.BI_WEEKLY,52),p(o,c.PB.MONTHLY,24),p(o,c.PB.MONTHLY_WEEK_BASED,24),p(o,c.PB.ANNUALLY,10),o),j=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).event,t=(0,s.Gc)().setValue,n=(0,s.qo)({name:"event_setting_attributes.starts_at"}),r=n?new Date(n).toISOString():"",o=(0,s.qo)({name:v}),f=(0,s.qo)({name:"recurring_setting_attributes.range_type"}),p=(0,s.qo)({name:"recurring_setting_attributes.frequency"}),j=(0,s.qo)({name:"event_type"}),w=b((0,i.useState)(!0),2),O=w[0],S=w[1],P=b((0,i.useState)(),2),C=P[0],k=P[1],I=b((0,i.useState)(),2),N=I[0],A=I[1],M=b((0,i.useState)(),2),T=M[0],E=M[1],R=(0,i.useMemo)(function(){return{label:(0,l.t)("".concat(y,".does_not_repeat")),value:!1}},[]),D=b((0,i.useState)([R]),2),L=D[0],F=D[1],U=[{label:(0,l.t)("".concat(y,".ending.on_day")),value:c.pd.ON},{label:(0,l.t)("".concat(y,".ending.after")),value:c.pd.AFTER}];return(0,i.useEffect)(function(){var t=g({startsAt:n});F(e&&(0,u.f0)(e)?t:[R].concat(function(e){if(Array.isArray(e))return m(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||h(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),E(n)},[n,R,e]),(0,i.useEffect)(function(){S(!!p)},[p]),(0,i.useEffect)(function(){if(f==c.pd.ON&&p){t("recurring_setting_attributes.occurrences",null);var e=(0,d.Xz)(n,x[p]);k((0,a.default)(e))}else f==c.pd.AFTER&&p&&(t(v,null),A(_[p]))},[f,p,n,t]),{endsAtMaxDate:C,endsAfterMaxOccurrences:N,isRecurringEvent:j===c.E_.RECURRING,frequencyOptions:L,endingOptions:U,endsAtMinDate:T,endsOnValue:f,shouldShowRecurringFields:O,currentEndsAt:o,startsAtInUTC:r}}},686785:function(e,t,n){n.d(t,{D:()=>v});var r=n(552676),o=n(131906),i=n(903225),a=n(739792),s=n(64282),l=n(617013),c=n(441342),u=n(93199),d=n(547144),f=n(39905),m=n(767900),p=n(26950),b=n(60878);function h(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var v=function(e){var t=e.event,n=e.onClose,v=e.show,y=(0,i.k6)(),g=(0,b.pm)(),x=g.success,_=g.error,j=(0,c.nT)(),w=j.isLoading,O=j.helpers,S=O.findById,P=O.spacesWithEventCreationAllowed;if(w)return null;var C=P(),k=(0,c.L2)().data,I=(0,s.Z)(),N=(0,o.useMutation)(function(e){var n;return(n=function(){var n;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:return[4,(0,u.t5)(d.av.events.duplicate({spaceId:t.space_id,slug:t.slug}),{method:"PUT",body:JSON.stringify({event:{event_id:t.id,space_id:e.space_id}}),forReactQuery:!0})];case 1:if(!(n=r.sent())||!("id"in n))throw Error("Failed to duplicate event");return[2,n]}})},function(){var e=this,t=arguments;return new Promise(function(r,o){var i=n.apply(e,t);function a(e){h(i,r,o,a,s,"next",e)}function s(e){h(i,r,o,a,s,"throw",e)}a(void 0)})})()},{onSuccess:function(e){var t=S(e.space_id);if(!t)return void _((0,a.t)("space_not_found"));y.push((0,d.Xq)({spaceSlug:t.slug,eventSlug:e.slug})),setTimeout(function(){I.show({event:e})},500),x((0,a.t)("event_duplicated_successfully"))},onError:function(){_((0,a.t)("event_duplication_failed"))}});return(0,r.jsx)(p.u,{overflowVisible:!0,title:(0,a.t)("duplicate_event_title",{event_title:t.name}),show:v,onClose:n,children:(0,r.jsxs)(m.l,{onSubmit:function(e){N.mutate({space_id:e.space_id})},defaultValues:{space_id:null==k?void 0:k.id},children:[(0,r.jsx)(m.l.Item,{name:"space_id",hideBorder:!0,fullWidth:!0,description:(0,a.t)("duplicate_event_to_space"),rules:{required:(0,a.t)("events.create.form.space_required_error")},children:(0,r.jsx)(l.M,{spaces:C,name:"space_id",variant:"form-input",defaultValue:null==k?void 0:k.id})}),(0,r.jsx)("p",{className:"modal__small text-dark mb-4",children:(0,a.t)("attendees_wont_be_duplicated")}),(0,r.jsx)(f.z,{type:"submit",variant:"primary",children:(0,a.t)("duplicate")})]})})}},559709:function(e,t,n){n.d(t,{E:()=>l});var r=n(552676),o=n(739792),i=n(479840),a=n(943544),s=n(434754),l=function(e){var t=e.canEdit,n=e.event,l=n.pinned_at_top_of_space,c=(0,s.B)({event:n}).onPinToTop;return t?(0,r.jsx)(a.Lt.ItemLink,{onClick:c,children:(0,r.jsx)(i.sI,{label:(0,o.t)("pin_to_space"),field:"pin_to_top",value:l,variant:"small"})}):null}},434754:function(e,t,n){n.d(t,{B:()=>h});var r=n(131906),o=n(739792),i=n(651714),a=n(266205),s=n(842953),l=n(931796),c=n(64282),u=n(441342),d=n(624804),f=n(60878);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var h=function(e){var t=e.event,n=e.onDestroy,m=(0,u.wh)().isViewOnlyMasquerading,h=(0,a.q)(),v=(0,c.Z)(),y=t.policies||{},g=y.can_destroy_post,x=y.can_update_post,_=y.can_duplicate_post,j=t.pinned_at_top_of_space,w=(0,f.pm)(),O=w.success,S=w.error,P=b((0,d.k)(!1),2),C=P[0],k=P[1],I=b((0,d.k)(!1),2),N=I[0],A=I[1],M=b((0,d.k)(!1),2),T=M[0],E=M[1],R=(0,r.useMutation)(function(e){return i.S.destroy({event:t,params:{delete_mode:e}})},{onSuccess:function(){null==n||n(t.id),O((0,s.Km)(t)),h()},onError:function(){return S((0,o.t)("event_dropdown_actions.delete_failed"))}});return{canEdit:x,onEdit:function(){x&&!m&&v.show({event:t})},canDelete:g,canDuplicate:_,onDelete:R.mutate,isDeleting:R.isLoading,onPinToTop:function(){var e;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return[4,i.S.pin({event:t,formData:{pin_to_top:!0,is_pinned:!j}})];case 1:return e.sent().ok?(O((0,o.t)(j?"event_unpinned":"event_pinned")),h({shouldInvalidateHomePagePosts:!0})):S((0,o.t)(j?"event_unpinned_error":"event_pinned_error")),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)})})()},onDuplicate:k,onDeleteClickHandler:function(){m||((0,l.H3)(t)?E():A())},isDuplicateEventModalOpen:C,isConfirmationModalOpen:N,toggleConfirmationModal:A,isRecurringModalOpen:T,toggleRecurringModal:E}}},298324:function(e,t,n){n.d(t,{i:()=>w});var r=n(552676),o=n(739792),i=n(227053),a=n(441342),s=n(117617),l=n(957363),c=n(943544),u=n(381636),d=n(58664),f=n(60589),m=n(39905),p=n(479840),b=n(275271),h=n(915912),v=n.n(h),y=n(547144),g=n(60878);function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var _=function(e){var t,n=e.post,r=e.getSharePostLink,i=e.sharePostData,s=(0,g.pm)().success,l=(0,a.wh)().currentCommunity,c=(0,a.L2)().data,u=(t=(0,b.useState)({post:{show_post_teaser:!!(null==n?void 0:n.show_post_teaser),share_to_web:!!(null==n?void 0:n.share_post_enabled),share_post_enabled:!!(null==n?void 0:n.share_post_enabled),minimal_layout:!!(null==n?void 0:n.minimal_layout)}}),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return x(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=u[0],f=u[1],m=(0,y.LM)({spaceSlug:null==n?void 0:n.space_slug,slug:null==n?void 0:n.slug});return(0,b.useEffect)(function(){n.share_post_enabled&&!i&&r({postId:null==n?void 0:n.id,body:d})},[null==n?void 0:n.share_post_enabled,i,d,r,null==n?void 0:n.id]),{onClickCopyLink:function(e){v()(e||window.location.origin+m),s((0,o.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},onChange:function(e){f(function(t){var o={post:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},t.post,e)};return r({postId:null==n?void 0:n.id,body:o}),o})},formData:d,currentCommunity:l,currentSpace:c}},j=function(e){var t,n=e.getSharePostLink,i=e.post,a=e.sharePostData,s=_({post:i,getSharePostLink:n,sharePostData:a}),b=s.onClickCopyLink,h=s.onChange,v=s.formData,y=s.currentCommunity,g=s.currentSpace,x=(null==i||null==(t=i.event_setting_attributes)?void 0:t.allow_non_members_to_rsvp)||!1,j=!!((0,f.$n)(g)||(0,f.WB)(g)||(null==y?void 0:y.is_private));return(null==y?void 0:y.is_private)||(null==g?void 0:g.is_private)?(0,r.jsxs)("div",{children:[(0,r.jsx)(c.Lt.ItemLink,{onClick:function(){h({share_to_web:!v.post.share_to_web})},children:(0,r.jsx)(p.sI,{label:(0,o.t)("post.share.share_to_web"),tooltipText:x?(0,o.t)("post.share.share_to_web_on_description_allow_non_members_to_rsvp"):(0,o.t)("post.share.share_to_web_on_description"),field:"share_to_web",value:v.post.share_to_web,variant:"small",disabled:x})}),v.post.share_to_web&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex flex-row items-center",children:(0,r.jsx)("div",{className:"mb-2 mt-1 flex-1 px-5",children:(0,r.jsx)(d.I,{disabled:!0,value:null==a?void 0:a.share_post_link,rightAddon:(0,r.jsx)("button",{type:"button",onClick:function(){return b(null==a?void 0:a.share_post_link)},children:(0,r.jsx)(l.JO,{type:"20-copy"})})})})}),(j||x)&&(0,r.jsx)("div",{className:"flex flex-row items-center",children:(0,r.jsx)("div",{className:"mb-2 mt-1 flex-1 px-5",children:(0,r.jsx)(u.Z.LabelSm,{children:x?(0,o.t)("post.share.share_to_web_public_content_warning"):(null==y?void 0:y.is_private)&&(null==g?void 0:g.visibility)=="open"?(0,o.t)("post.share.share_to_web_open_content_warning"):(0,f.$n)(g)?(0,o.t)("post.share.share_to_web_secret_content_warning"):(0,o.t)("post.share.share_to_web_private_content_warning")})})}),!(null==y?void 0:y.is_private)&&(0,r.jsx)(c.Lt.ItemLink,{onClick:function(){return h({minimal_layout:!v.post.minimal_layout})},children:(0,r.jsx)(p.sI,{label:(0,o.t)("post.share.minimal_layout"),tooltipText:(0,o.t)("post.share.minimal_layout_description"),field:"minimal_layout",value:v.post.minimal_layout,variant:"small"})})]})]}):(0,r.jsxs)("div",{className:"flex flex-row items-center px-4 py-2",children:[(0,r.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,r.jsx)(u.Z.LabelMd,{weight:"bold",children:(0,o.t)("post.share.share_to_web")}),(0,r.jsx)(u.Z.LabelSm,{children:(0,o.t)("post.share.post_is_public")})]}),(0,r.jsx)("div",{children:(0,r.jsx)(m.z,{type:"button",variant:"secondary",onClick:function(){return b(null)},children:(0,o.t)("copy_link")})})]})},w=function(e){var t=e.onChange,n=e.button,d=(0,i.m)({onChangeSharePost:t}),f=d.showShareOnWebOptions,m=d.post,p=d.getSharePostLink,b=d.sharePostData,h=(0,s.kK)(),v=(0,a.L2)().data,y=null!=n?n:(0,r.jsx)(l.JO,{type:"16-share",size:20});return f(v)?(0,r.jsx)(c.Lt,{size:"extra-large",direction:"bottom-end",menuButtonEl:"button",className:"w-full",buttonClassName:"w-full focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-1 md:p-1 hover:bg-tertiary rounded group flex items-center",button:h?y:(0,r.jsx)(u.Z.LabelSm,{weight:"medium",color:"text-default group-hover:text-dark",children:(0,o.t)("post.share.title")}),children:(0,r.jsx)(j,{post:m,getSharePostLink:p,sharePostData:b})}):null}},517534:function(e,t,n){n.d(t,{m:()=>i});var r=n(903225),o=n(441342),i=function(){var e,t=(0,o.nT)(),n=(0,r.UO)().spaceSlug,i=(t.helpers.spacesWithPostCreationAllowed()||[]).filter(function(e){return"event"===e.post_type}),a=(null==(e=i.find(function(e){return e.slug===n}))?void 0:e.id)||null;return{spaces:i,spaceId:a}}},266205:function(e,t,n){n.d(t,{q:()=>o});var r=n(131906),o=function(){var e=(0,r.useQueryClient)();return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.shouldInvalidateHomePagePosts,r=t.shouldInvalidateAllEvents;e.invalidateQueries({queryKey:["post-show"]}),e.invalidateQueries({queryKey:["posts"]}),e.invalidateQueries({queryKey:["space-show"],refetchInactive:!0}),void 0!==r&&r&&e.invalidateQueries({queryKey:["all","events","calendar-view"]}),void 0!==n&&n&&e.invalidateQueries({queryKey:["home-page-posts"]})}}},666403:function(e,t,n){n.d(t,{j:()=>a});var r=n(552676),o=n(739792),i=n(595342),a=function(e){var t=e.rsvpStatus;if(!t)return null;var n="yes"===t?(0,o.t)("events.rsvp.attending"):"invited"===t?(0,o.t)("events.rsvp.invited"):(0,o.t)("events.rsvp.not_attending");return(0,r.jsx)(i.O,{variant:"yes"===t?"success":"default",children:n})}},998869:function(e,t,n){n.d(t,{t:()=>s});var r=n(552676),o=n(739792),i=n(39905),a=n(381636),s=function(e){var t=e.startRecordNumber,n=e.endRecordNumber,s=e.totalRecordCount,l=e.fetchPrevPage,c=e.fetchNextPage,u=e.hasPrevPage,d=e.hasNextPage;return(0,r.jsxs)("div",{className:"flex h-16 w-full items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-end",children:[(0,r.jsx)("div",{children:(0,r.jsx)(a.Z.LabelSm,{children:(0,o.t)("events.edit_modal.pagination.showing")})}),(0,r.jsx)("div",{className:"mx-1",children:(0,r.jsxs)(a.Z.LabelSm,{weight:"semibold",children:[t,"-",n]})}),(0,r.jsx)("div",{className:"mr-1",children:(0,r.jsx)(a.Z.LabelSm,{children:(0,o.t)("events.edit_modal.pagination.of")})}),(0,r.jsx)("div",{children:(0,r.jsx)(a.Z.LabelSm,{weight:"semibold",children:s})})]}),(u||d)&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(i.z,{variant:"secondary",type:"button",className:"mr-3",disabled:!u,onClick:l,children:(0,o.t)("events.edit_modal.pagination.previous")}),(0,r.jsx)(i.z,{variant:"secondary",type:"button",disabled:!d,onClick:c,children:(0,o.t)("events.edit_modal.pagination.next")})]})]})}},537291:function(e,t,n){n.d(t,{x:()=>s});var r=n(903225),o=n(999037),i=n(326371),a=n(343832),s=function(){var e=(0,r.k6)(),t=(0,o.l)(),n=t.mutate,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,["mutate"]),l=(0,a.g)();return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({onSendAnnouncement:function(t){var r=t.eventId,o=t.onSuccess;if(!l){e.push(i.e.list()),null==o||o();return}n({source_content_id:r,source_content_type:"Event"},{onSuccess:function(t){null==o||o(),e.push(i.e.edit({broadcastId:t.broadcast.id}))}})}},s)}},744281:function(e,t,n){n.d(t,{V:()=>f});var r=n(275271),o=n(131906),i=n(739792),a=n(251630),s=n(698173),l=n(60878),c=n(842953);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.a.PARTICIPANT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,u=e||{},f=u.space_id,m=u.slug,p=(0,l.pm)(),b=p.error,h=p.success,v=d((0,r.useState)(1),2),y=v[0],g=v[1],x=d((0,r.useState)(!1),2),_=x[0],j=x[1],w=(0,o.useQuery)({queryKey:[s.a.eventAttendees.index({spaceId:f,slug:m,params:{page:y,role:t,per_page:n}})],refetchInterval:!!_&&5e3,refetchIntervalInBackground:!1,keepPreviousData:!0,enabled:!!e}),O=w.isLoading,S=w.isFetching,P=w.data,C=w.refetch,k=w.remove,I=(null==P?void 0:P.records)||[],N=(null==P?void 0:P.count)||0,A=null==P?void 0:P.total_confirmed_record_count,M=null==P?void 0:P.page_count,T=N?Math.ceil(N/10):0,E=y>1,R=!!(null==P?void 0:P.has_next_page),D=(y-1)*10+1,L=(0,o.useMutation)(function(t){return a.S1.bulkRsvp({event:e,params:t})},{onSuccess:function(){g(1),k(),j(!0),h((0,i.t)("events.edit_modal.people.add_attendees_started"))},onError:function(){j(!1),b((0,i.t)("events.edit_modal.people.add_attendees_error"))}});return{page:y,records:I,totalRecordCount:N,totalConfirmedRecordCount:A,pageRecordCount:M,pageCount:T,hasPrevPage:E,hasNextPage:R,startRecordNumber:D,endRecordNumber:D+(null!=M?M:0)-1,isLoading:O,isFetching:S,isWaitingForAttendees:_,isAdding:L.isLoading,addAttendeesAsync:L.mutateAsync,refetch:C,fetchNextPage:function(){g(y+1)},fetchPrevPage:function(){g(Math.max(y-1,1))},resetPage:function(){g(1)}}}},639766:function(e,t,n){n.d(t,{Bq:()=>i,E_:()=>a,HA:()=>c,Mj:()=>s,Q_:()=>u,SA:()=>o,a:()=>d,n4:()=>f,pd:()=>l});var r=n(739792),o={overview:(0,r.t)("events.edit_modal.overview.title"),people:(0,r.t)("events.edit_modal.people.title"),basicInfo:(0,r.t)("events.create.form.basic_info"),details:(0,r.t)("events.edit_modal.details.title"),notifications:(0,r.t)("events.edit_modal.notifications.title"),email:(0,r.t)("events.edit_modal.email.title"),advancedOptions:(0,r.t)("events.edit_modal.advanced_options.title")},i={VIRTUAL:"virtual",IN_PERSON:"in_person",TBD:"tbd",LIVE_STREAM:"live_stream",LIVE_ROOM:"live_room"},a={SINGLE:"single",RECURRING:"recurring"},s={FREE:"free",PAID:"paid"},l={ON:"on",NEVER:"never",AFTER:"after"},c={CURRENT:"current",REMAINING:"remaining",ALL:"all"},u={PUBLISHED:"published",DRAFT:"draft"},d={PARTICIPANT:"participant",COHOST:"cohost",HOST:"host"},f={ATTENDEES:"attendees",COHOSTS:"cohosts"}},932525:function(e,t,n){n.d(t,{k:()=>a});var r=n(134870),o=n(943945),i=n(404393),a=function(e,t,n){if(!e)return"";var a=new Date(e),s=(0,o.UZ)(e),l=(0,r.w)({dateTime:a,format:"short_time"}),c=(0,i.ED)(t,a)||(0,i.ED)(n,a)||(0,i.ED)(i.tq,a),u=(0,r.w)({dateTime:a,format:"short_month_and_date"});return"".concat(s,", ").concat(u,", ").concat(l," (").concat(c,")")}},734086:function(e,t,n){n.d(t,{Q:()=>s,i:()=>l});var r=n(739792),o=n(19338),i=n(404393),a=n(134870),s=function(e){var t=e.frequency,n=e.startsAt,s=e.endsAt,l=e.occurrences;if(!t||!n)return"";var c=(0,o.E)({startsAt:n,firstLetterCapital:!0}).find(function(e){return e.value===t}),u=(null==c?void 0:c.label)||t,d=new Date(n),f=(0,a.w)({dateTime:d,format:"short_time"}),m=(0,i.ED)(void 0,d)||"GMT";if(l)return(0,r.t)("events.recurring.schedule.repeats_with_occurrences_number",{count:l,frequency:u,occurrences:l,time:f,timezone:m});if(s){var p=new Date(s),b=(0,a.w)({dateTime:p,format:"date_time_with_short_timezone"});return(0,r.t)("events.recurring.schedule.ends_on_date",{frequency:u,endDate:b})}return(0,r.t)("events.recurring.schedule.repeats_at_time",{frequency:u,time:f,timezone:m})},l=function(e){var t=e.frequency,n=e.startsAt,r=e.firstLetterCapital;if(!t||!n)return null;var s=(0,o.E)({startsAt:n,firstLetterCapital:void 0!==r&&r}).find(function(e){return e.value===t}),l=(null==s?void 0:s.label)||t.toLowerCase(),c=new Date(n);return{frequency:l,time:(0,a.w)({dateTime:c,format:"short_time"}),timezone:(0,i.ED)(void 0,c)||"GMT"}}},931796:function(e,t,n){n.d(t,{H3:()=>g,Km:()=>x,L6:()=>m,Rv:()=>h,U7:()=>u,UJ:()=>p,VL:()=>b,dy:()=>d,f0:()=>c,hA:()=>y,mv:()=>s,s9:()=>l,yl:()=>v});var r=n(739792),o=n(404393),i=n(437588),a=n(639766),s=function(e){return(null==e?void 0:e.status)===a.Q_.DRAFT},l=function(e){return(null==e?void 0:e.status)===a.Q_.PUBLISHED},c=function(e){return(null==e?void 0:e.event_type)===a.E_.RECURRING},u=function(e){return(null==e?void 0:e.event_type)===a.E_.SINGLE},d=function(e){var t;return(null==e||null==(t=e.event_setting_attributes)?void 0:t.location_type)===a.Bq.LIVE_ROOM},f=function(e){var t;return(null==e||null==(t=e.event_setting_attributes)?void 0:t.location_type)===a.Bq.LIVE_STREAM},m=function(e){var t,n;return f(e)&&(null==e||null==(n=e.event_setting_attributes)||null==(t=n.live_stream_room_setting_attributes)?void 0:t.access_type)===i._d.PUBLIC_STREAM},p=function(e){return[a.Bq.LIVE_STREAM,a.Bq.LIVE_ROOM].includes(e)},b=function(e){var t;return!!(e&&(0,o.aA)(null==e||null==(t=e.event_setting_attributes)?void 0:t.ends_at))},h=function(e){var t;return!!(e&&(0,o.aA)(null==e||null==(t=e.event_setting_attributes)?void 0:t.starts_at))},v=function(e){var t;return(null==e||null==(t=e.event_setting_attributes)?void 0:t.ticket_type)==a.Mj.PAID},y=function(e){var t;return e&&(null==e||null==(t=e.paywall_attributes)?void 0:t.published)},g=function(e){return c(e)&&!v(e)},x=function(e){var t=c(e),n=t?(0,r.t)("events.recurring_deletion_successful"):(0,r.t)("event_dropdown_actions.delete_successful");return(b(e)||s(e))&&(n=t?(0,r.t)("events.recurring_draft_deletion_successful"):(0,r.t)("event_dropdown_actions.draft_delete_successful")),n}},842953:function(e,t,n){n.d(t,{Bq:()=>r.Bq,E_:()=>r.E_,HA:()=>r.HA,Km:()=>o.Km,L6:()=>o.L6,Mj:()=>r.Mj,Q_:()=>r.Q_,Rv:()=>o.Rv,SA:()=>r.SA,UJ:()=>o.UJ,VL:()=>o.VL,a:()=>r.a,dy:()=>o.dy,f0:()=>o.f0,hA:()=>o.hA,mv:()=>o.mv,n4:()=>r.n4,pd:()=>r.pd,s9:()=>o.s9,yl:()=>o.yl});var r=n(639766),o=n(931796)},157514:function(e,t,n){n.d(t,{G:()=>nX});var r=n(552676),o=n(275271),i=n(932699);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var l=(0,o.createContext)({isUpdatingAttendees:!1,setIsUpdatingAttendees:i.noop,isEmailNotificationsEnabled:!1,setIsEmailNotificationsEnabled:i.noop,isAutoRsvpInvitedAttendees:!1,setIsAutoRsvpInvitedAttendees:i.noop});l.displayName="EventsContext";var c=function(){return(0,o.useContext)(l)},u=function(e){var t=e.children,n=s((0,o.useState)(!1),2),i=n[0],a=n[1],c=s((0,o.useState)(!0),2),u=c[0],d=c[1],f=s((0,o.useState)(!1),2),m=f[0],p=f[1];return(0,r.jsx)(l.Provider,{value:{isUpdatingAttendees:i,setIsUpdatingAttendees:a,isEmailNotificationsEnabled:u,setIsEmailNotificationsEnabled:d,isAutoRsvpInvitedAttendees:m,setIsAutoRsvpInvitedAttendees:p},children:t})},d=n(701168),f=n(117617),m=n(88663),p=n(437416),b=n(185633),h=n(767900),v=n(739792),y=n(775148),g=n(381636);function x(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var _=function(){var e=(0,o.useRef)(null);return{validateAndSetCurrentSection:function(t,n){var r;return(r=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:if(!(0,i.isFunction)(e.current))return[3,2];return[4,e.current()];case 1:if(!r.sent())return[2];r.label=2;case 2:return n(t),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function a(e){x(i,n,o,a,s,"next",e)}function s(e){x(i,n,o,a,s,"throw",e)}a(void 0)})})()},triggerValidationRef:e}},j=n(842953),w=function(e){var t=e.isOpen,n=e.handleClose,o=e.isEditMode,i=(0,m.eW)(),a=i.currentSection,s=i.setCurrentSection,l=_().validateAndSetCurrentSection;return a===j.SA.overview?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.x.HeaderContent,{children:(0,r.jsx)(g.Z.TitleSm,{truncate:!0,weight:"semibold",children:(0,v.t)("edit_event")})}),(0,r.jsx)(b.o,{onClick:n,isVisible:t,className:"!pr-0"})]}):(0,r.jsx)(p.x.HeaderContent,{children:(0,r.jsxs)("div",{className:"flex w-full items-center justify-between gap-2",children:[o&&(0,r.jsx)(y.h,{name:"16-arrow-left",onClick:function(){l(j.SA.overview,s)},ariaLabel:(0,v.t)("back")}),(0,r.jsx)(g.Z.TitleSm,{truncate:!0,weight:"semibold",children:o?(0,v.t)("edit_event"):(0,v.t)("events.create.title")}),(0,r.jsx)(b.o,{onClick:n,isVisible:t})]})})},O=n(20056),S=n(39905),P=n(931796),C=n(963549),k=n(379522);function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var N="events.edit.recurring_event_modal",A=function(e){var t,n=e.show,i=e.onConfirm,a=e.onCloseModal,s=e.isPublishing,l=void 0!==s&&s,u=e.showCurrentOptionOnly,d=e.showRemainingOptionOnly,f=e.showCurrentAndRemainingOnly,m=e.shouldHideAllEventOption,p=e.defaultSelection,b=e.isDraft,h=(t=(0,o.useState)(p||j.HA.CURRENT),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return I(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),y=h[0],x=h[1],_=c(),w=_.isEmailNotificationsEnabled,O=_.isAutoRsvpInvitedAttendees;(0,o.useEffect)(function(){x(p||j.HA.CURRENT)},[p]);var S=[{label:(0,v.t)("".concat(N,".this_event")),value:j.HA.CURRENT},{label:(0,v.t)("".concat(N,".this_and_following")),value:j.HA.REMAINING},{label:(0,v.t)("".concat(N,".all_events")),value:j.HA.ALL}],P=y===j.HA.ALL||y===j.HA.REMAINING,A=(0,o.useMemo)(function(){return u?S.filter(function(e){return e.value===j.HA.CURRENT}):d?S.filter(function(e){return e.value===j.HA.REMAINING}):f?S.filter(function(e){return e.value===j.HA.CURRENT||e.value===j.HA.REMAINING}):m?S.filter(function(e){return e.value!==j.HA.ALL}):S},[u,d,f,m]),M=w&&P&&l,T=!b&&w&&(f||d)&&y===j.HA.REMAINING,E=y===j.HA.CURRENT&&(u||f);return(0,r.jsxs)(C.c,{title:l?(0,v.t)("".concat(N,".title_publish")):(0,v.t)("".concat(N,".title")),isOpen:void 0!==n&&n,confirmText:(0,v.t)("".concat(N,".accept")),cancelText:(0,v.t)("".concat(N,".cancel")),onClose:a,onCancel:a,onConfirm:function(){i(y)},size:"md",children:[(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(k.S,{defaultChecked:y,name:"recurring_event_settings.frequency_edit",options:A,size:"sm",onChange:function(e){x(e)}})}),M&&(0,r.jsx)("div",{className:"mt-4 leading-4",children:(0,r.jsx)(g.Z.LabelXs,{color:"text-light",weight:"semibold",as:"span",children:O?(0,v.t)("".concat(N,".confirmation_email_notifications")):(0,v.t)("".concat(N,".invitation_email_notifications"))})}),E&&(0,r.jsx)("div",{className:"mt-4 leading-4",children:(0,r.jsx)(g.Z.LabelXs,{color:"text-light",weight:"semibold",as:"span",children:(0,v.t)("".concat(N,".keep_original_series_notice"))})}),T&&(0,r.jsx)("div",{className:"mt-4 leading-4",children:(0,r.jsx)(g.Z.LabelXs,{color:"text-light",weight:"semibold",as:"span",children:(0,v.t)("".concat(N,".update_event_notifications"))})})]})},M=n(957363),T=n(131906),E=n(93199),R=n(547144);function D(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var L=function(e){var t=e||{},n=t.event,r=t.formScheduleValues,o=r||{},i=o.startsAt,a=o.endsAt,s=o.frequency;return(0,T.useQuery)({queryKey:["calculateSchedule",null==n?void 0:n.id,r],queryFn:function(){var e;return(e=function(){var e;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){return n&&i&&a&&s?(e={event:{frequency:s,starts_at:i,event_ends_at:a}},[2,(0,E.UT)(R.av.events.calculateSchedule({slug:n.slug,spaceId:n.space_id,params:e}))]):[2,null]})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){D(i,r,o,a,s,"next",e)}function s(e){D(i,r,o,a,s,"throw",e)}a(void 0)})})()},enabled:!!(n&&i&&a&&s)})},F=n(932525),U=function(e){var t,n=null==(t=e.event_setting_attributes)?void 0:t.starts_at;return(0,F.k)(n)},B=function(e){var t=e.startsAt;return(0,F.k)(t)},q=n(734086),z=n(705250),Z=n(816209);function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var H=function(){var e,t=(e=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return V(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=t[0],i=t[1];return(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("button",{type:"button",onClick:function(){i(!n)},className:"hover:bg-secondary flex w-full items-center justify-between transition-colors",children:[(0,r.jsx)(g.Z.LabelSm,{weight:"medium",color:"text-primary",children:(0,v.t)("events.edit_modal.schedule_update_modal.attendee_experience_title")}),n?(0,r.jsx)(z.Z,{className:"size-5"}):(0,r.jsx)(Z.Z,{className:"size-5"})]}),n&&(0,r.jsxs)("ul",{className:"list-outside list-disc pl-4",children:[(0,r.jsx)("li",{children:(0,r.jsx)(g.Z.LabelSm,{color:"text-secondary",children:(0,v.t)("events.edit_modal.schedule_update_modal.attendee_experience_1")})}),(0,r.jsx)("li",{children:(0,r.jsx)(g.Z.LabelSm,{color:"text-secondary",children:(0,v.t)("events.edit_modal.schedule_update_modal.attendee_experience_2")})}),(0,r.jsx)("li",{children:(0,r.jsx)(g.Z.LabelSm,{color:"text-secondary",children:(0,v.t)("events.edit_modal.schedule_update_modal.attendee_experience_3")})}),(0,r.jsx)("li",{children:(0,r.jsx)(g.Z.LabelSm,{color:"text-secondary",children:(0,v.t)("events.edit_modal.schedule_update_modal.attendee_experience_4")})})]})]})},W=function(e,t){var n,r,o,i;return t?U(e):(0,q.Q)({frequency:(null==(n=e.recurring_setting_attributes)?void 0:n.frequency)||"",startsAt:(null==(r=e.event_setting_attributes)?void 0:r.starts_at)||"",endsAt:null==(o=e.recurring_setting_attributes)?void 0:o.ends_at,occurrences:null==(i=e.recurring_setting_attributes)?void 0:i.occurrences})},Q=function(e){var t,n=e.event,o=e.isOpen,i=e.onCancel,a=e.onConfirm,s=e.formScheduleValues,l=e.editMode===j.HA.CURRENT,c=L(o&&n&&s&&!l?{event:n,formScheduleValues:s}:void 0),u=c.isLoading,d=c.data,f=c.error,m=null==n?void 0:n.name,p=W(n,l),b=l?B(s):(null==d?void 0:d.schedule)?(0,q.Q)({frequency:d.schedule.frequency,startsAt:d.schedule.starts_at,endsAt:d.schedule.ends_at,occurrences:d.schedule.occurrences}):"",h=u&&!l,y=!!f&&!l;return(0,r.jsx)(C.c,{title:(0,v.t)("events.edit_modal.schedule_update_modal.title"),isOpen:o,confirmText:(0,v.t)("events.edit_modal.schedule_update_modal.update_schedule"),cancelText:(0,v.t)("events.edit_modal.schedule_update_modal.back"),onClose:i,onCancel:i,onConfirm:a,size:"lg",disabled:!!f||h,children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col rounded-xl border p-4 pt-3 shadow-lg",children:[(0,r.jsxs)("div",{className:"border-primary border-b pb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 pb-2",children:[(0,r.jsx)(g.Z.LabelMd,{weight:"semibold",textTransform:"capitalize",children:m}),(0,r.jsx)(g.Z.BodyMd,{color:"text-secondary",children:(0,v.t)("events.edit_modal.schedule_update_modal.updated_schedule")})]}),!l&&(0,r.jsx)("div",{className:"pb-2",children:(0,r.jsx)(g.Z.BodySm,{color:"text-secondary",children:(0,v.t)("events.edit_modal.schedule_update_modal.series_update_notice")})})]}),(0,r.jsxs)("div",{className:"border-primary relative flex flex-col gap-2 border-b pb-6 pt-4",children:[(0,r.jsx)(g.Z.LabelSm,{weight:"semibold",color:"text-secondary",children:l?(0,v.t)("events.edit_modal.schedule_update_modal.original_date_time"):(0,v.t)("events.edit_modal.schedule_update_modal.original_series")}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(M.JO,{type:"16-calendar-recurring",size:16,className:"text-default !w-4"}),(0,r.jsx)(g.Z.BodySm,{color:"text-secondary",children:p})]}),(0,r.jsx)("div",{className:"bg-primary absolute left-1/2 top-full flex -translate-x-1/2 -translate-y-1/2 justify-center rounded-full border p-1",children:(0,r.jsx)(M.JO,{type:"16-arrow-down",size:16,className:"!w-4"})})]}),(0,r.jsxs)("div",{className:"border-primary relative flex flex-col gap-2 pb-2 pt-4",children:[(0,r.jsx)(g.Z.LabelSm,{weight:"semibold",color:"text-secondary",children:l?(0,v.t)("events.edit_modal.schedule_update_modal.new_date_time"):(0,v.t)("events.edit_modal.schedule_update_modal.new_series")}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(M.JO,{type:"16-calendar-recurring",size:16,className:"text-default !w-4"}),h?(0,r.jsx)(M.JO,{type:"loader",size:16,className:"animate-spin"}):y?(0,r.jsx)(g.Z.BodySm,{color:"text-v2-danger",children:(null!=(t=Error)&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](f):f instanceof t)?f.message:(0,v.t)("events.edit_modal.schedule_update_modal.calculation_failed")}):(0,r.jsx)(g.Z.BodySm,{color:"text-secondary",children:b})]})]})]}),!l&&(0,r.jsx)(H,{})]})})};function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function K(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var J=function(e){var t,n,i=e.onEditModeConfirm,a=e.isRecurringEvent,s=void 0!==a&&a,l=e.isPublishing,c=e.children,u=e.isStartsAtDirty,d=void 0!==u&&u,f=e.isRepeatsDirty,m=void 0!==f&&f,p=e.shouldHideAllEventOption,b=void 0!==p&&p,h=e.type,v=e.event,y=e.formScheduleValues,g=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["onEditModeConfirm","isRecurringEvent","isPublishing","children","isStartsAtDirty","isRepeatsDirty","shouldHideAllEventOption","type","event","formScheduleValues"]),x=K((0,o.useState)(!1),2),_=x[0],w=x[1],C=K((0,o.useState)(!1),2),k=C[0],I=C[1],N=K((0,o.useState)(null),2),M=N[0],T=N[1],E=(0,O.n)().hasSplitRecurringEventsEnabled;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.z,(t=$({type:void 0===h?"button":h,onClick:function(){s?w(!0):i(j.HA.CURRENT)}},g),n=n={children:c},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t)),(0,r.jsx)(A,$({show:_,onConfirm:function(e){w(!1),(e===j.HA.REMAINING||e===j.HA.CURRENT)&&(m||d)&&v?(T(e),I(!0)):i(e)},onCloseModal:function(){return w(!1)},isPublishing:void 0!==l&&l,isDraft:!!v&&(0,P.mv)(v)},E?m?{showRemainingOptionOnly:!0,shouldHideAllEventOption:b,defaultSelection:j.HA.REMAINING}:d?{showCurrentAndRemainingOnly:!0,shouldHideAllEventOption:b,defaultSelection:j.HA.CURRENT}:{shouldHideAllEventOption:b,defaultSelection:j.HA.CURRENT}:{showCurrentOptionOnly:d,shouldHideAllEventOption:b})),v&&M&&(0,r.jsx)(Q,{isOpen:k,onConfirm:function(){I(!1),M&&(i(M),T(null))},onCancel:function(){I(!1),T(null)},event:v,formScheduleValues:void 0===y?{startsAt:"",endsAt:"",frequency:""}:y,editMode:M})]})},X=function(e){var t=e.event,n=e.isEventDraft,o=t||{},i=o.slug,a=o.space_slug;return(0,r.jsxs)("button",{type:"button",className:"flex cursor-pointer items-center whitespace-nowrap",onClick:function(){window.open((0,R.LM)({spaceSlug:a,slug:i}),"_blank")},children:[(0,r.jsx)(g.Z.LabelSm,{weight:"medium",children:(0,v.t)(n?"events.edit_modal.preview":"events.edit_modal.overview.view_event")}),(0,r.jsx)(M.JO,{type:"16-arrow-top-right",size:16})]})},Y=function(e){var t=e.event,n=e.onPublish,o=e.className,i=(0,m.eW)().isSaving,a=(0,j.mv)(t);return(0,r.jsxs)(m.h4.Actions,{className:(0,d.A)("justify-between px-5 pb-6 pt-2 md:justify-end md:p-0",o),children:[t&&(0,r.jsx)(X,{event:t,isEventDraft:a}),a&&(0,r.jsx)(J,{variant:"circle",disabled:i,onEditModeConfirm:n,isRecurringEvent:(0,j.f0)(t),isPublishing:!0,children:(0,v.t)("events.edit_modal.buttons.publish")})]})},ee=n(524304),et=function(e){var t=e.onChangeSection,n=(0,m.eW)(),o=n.sections,i=n.currentSection,a=n.setCurrentSection,s=o.map(function(e){return{value:e,label:e}});return(0,r.jsx)(m.h4.Actions,{className:"items-center justify-center",children:(0,r.jsx)(ee.S,{value:i,onChange:function(e){t(e,a)},options:s})})},en=n(524330),er=n(428414);function eo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function ei(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var ea=function(e){var t=e.event,n=e.isCreating,o=e.isEditMode,i=e.actionsProps,a=(0,m.eW)().title,s=(0,j.s9)(t)?(0,v.t)("events.badge_status.published"):(0,v.t)("events.badge_status.draft");return(0,f.kK)()?(0,r.jsxs)("div",{className:"flex w-full flex-col gap-4 px-5 py-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[o&&(0,r.jsx)(en.g,{label:s}),o&&(0,r.jsx)(Y,ei(eo({},i),{className:"inline-flex lg:hidden"}))]}),(0,r.jsx)(g.Z.TitleSm,{truncate:!0,weight:"semibold",children:a})]}):(0,r.jsxs)("div",{className:"flex w-full min-w-0 items-center justify-between gap-4",children:[(0,r.jsx)(er.Y,{className:"flex",children:!n&&a&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(g.Z.TitleSm,{truncate:!0,weight:"semibold",children:a}),(0,r.jsx)("div",{className:"flex items-center",children:o&&(0,r.jsx)(en.g,{label:s})})]})}),o&&(0,r.jsx)(Y,ei(eo({},i),{className:"lg:hidden"}))]})},es=function(e){var t,n,o=e.isOpen,i=e.isEditMode,a=e.isCreating,s=e.event,l=e.onPublish,c=e.validateAndSetCurrentSection,u=e.handleClose,d={event:s,isEditMode:i,onPublish:l};return(0,f.kK)()?(0,r.jsx)(w,{isOpen:o,isEditMode:i,handleClose:u}):(0,r.jsxs)(p.x.HeaderContent,{children:[(0,r.jsx)(ea,{event:s,isCreating:a,isEditMode:i,actionsProps:d}),i&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.x.HeaderContent.Navigation,{children:(0,r.jsx)(et,{onChangeSection:c})}),(0,r.jsx)(Y,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},d),n=n={className:"hidden lg:flex"},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))]})]})},el=n(227851),ec=n(441342),eu=n(78456),ed=function(e){var t,n,o=e.children,i=e.name,a=e.rules,s=e.tooltipText,l=e.hidePlaceholder,c=e.placeholder,u=e.inlineReverse,d=e.translationRoot,f=e.hideLabel,m=e.className,p=e.tooltipTextClassName,b=e.errorClassName,v=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["children","name","rules","tooltipText","hidePlaceholder","placeholder","inlineReverse","translationRoot","hideLabel","className","tooltipTextClassName","errorClassName"]);return(0,r.jsx)(h.l.Item,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({name:i,hideDescription:!0,translationRoot:void 0===d?"events.edit_modal":d,rules:void 0===a?{}:a,hideBorder:!0,fullWidth:!0,hidePlaceholder:void 0!==l&&l,placeholder:c,tooltipText:s,inlineReverse:void 0!==u&&u,hideLabel:void 0!==f&&f,className:void 0===m?"":m,tooltipTextClassName:void 0===p?"":p,errorClassName:b},v),n=n={children:o},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},ef=function(){return(0,r.jsx)("div",{className:"w-[100px]",children:(0,r.jsx)(h.l.Item,{name:"event_setting_attributes.rsvp_limit",hideLabel:!0,hideBorder:!0,placeholder:(0,v.t)("events.edit_modal.event_setting_attributes.rsvp_limit_placeholder"),rules:{required:(0,v.t)("events.edit_modal.event_setting_attributes.rsvp_limit_required"),min:{value:1,message:(0,v.t)("events.edit_modal.event_setting_attributes.rsvp_limit_error")}},children:(0,r.jsx)(h.l.Input,{})})})};function em(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ep=function(e){var t,n,o=e.event,i=(0,ec.wh)().currentCommunityMember,a=(0,O.n)().hasPublicEventRsvpEnabled,s=(0,el.qo)({name:"event_setting_attributes.rsvp_limit_enabled",defaultValue:null!=(n=null==o?void 0:o.event_setting_attributes.rsvp_limit_enabled)&&n}),l=(0,eu.vb)(i)||(0,eu.I$)(i),c=((function(e){if(Array.isArray(e))return em(e)})(t=a&&(0,P.U7)(o)&&l?["event_setting_attributes.allow_non_members_to_rsvp"]:[])||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return em(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return em(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat(["event_setting_attributes.rsvp_disabled","event_setting_attributes.hide_attendees","event_setting_attributes.rsvp_limit_enabled"]);return(0,r.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,r.jsx)("div",{className:"mb-0 mt-6 md:mb-3 md:mt-8",children:(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.advanced_options.attendees")})}),c.map(function(e){return(0,r.jsx)(ed,{name:e,tooltipText:(0,v.t)("events.edit_modal.".concat(e,"_tooltip")),inlineReverse:!0,className:"!pb-0",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:e})},e)}),s&&(0,r.jsx)(ef,{})]})},eb=n(403697),eh=n(330889),ev=n(206394),ey=n(257462),eg=function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"md:mb-3",children:(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.advanced_options.meta_tags")})}),(0,r.jsxs)("div",{className:"pb-4",children:[(0,r.jsx)(ed,{name:"meta_tag_attributes.meta_title",hidePlaceholder:!0,label:(0,v.t)("events.edit_modal.meta_tag_attributes.meta_title"),tooltipText:(0,v.t)("events.edit_modal.meta_tag_attributes.meta_title_description",{obj:"event"}),children:(0,r.jsx)(h.l.Input,{})}),(0,r.jsx)(ed,{name:"meta_tag_attributes.meta_description",hidePlaceholder:!0,label:(0,v.t)("events.edit_modal.meta_tag_attributes.meta_description"),tooltipText:(0,v.t)("events.edit_modal.meta_tag_attributes.meta_description_description"),children:(0,r.jsx)(h.l.Input,{variant:"textarea"})}),(0,r.jsx)(ed,{name:"meta_tag_attributes.opengraph_title",hidePlaceholder:!0,label:(0,v.t)("events.edit_modal.meta_tag_attributes.opengraph_title"),tooltipText:(0,v.t)("events.edit_modal.meta_tag_attributes.opengraph_title_description",{obj:"event"}),children:(0,r.jsx)(h.l.Input,{})}),(0,r.jsx)(ed,{name:"meta_tag_attributes.opengraph_description",hidePlaceholder:!0,label:(0,v.t)("events.edit_modal.meta_tag_attributes.opengraph_description"),tooltipText:(0,v.t)("events.edit_modal.meta_tag_attributes.opengraph_description_description"),children:(0,r.jsx)(h.l.Input,{variant:"textarea"})}),(0,r.jsx)("div",{className:"mt-4 grid grid-cols-1",children:(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)(eh.Q,{field:"hide_location_from_non_attendees",label:(0,v.t)("events.edit_modal.meta_tag_attributes.opengraph_image"),description:" "}),(0,r.jsx)(ev.D,{name:"meta_tag_attributes[opengraph_image]",alt:(0,v.t)("spaces.form.edit.options.seo.opengraph_image.label"),className:"relative",showAddCoverBtn:!0,aspectRatio:eb.pI.OPEN_GRAPH,changeImageText:(0,v.t)("spaces.form.edit.options.seo.opengraph_image.change"),customAddCoverBtn:(0,r.jsx)(ey.Z,{title:(0,v.t)("spaces.form.edit.options.seo.opengraph_image.add"),description:(0,v.t)("spaces.form.edit.options.seo.opengraph_image.description")})})]})})]})]})},ex=function(){return(0,r.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,r.jsx)("div",{className:"mb-0 mt-6 md:mb-3 md:mt-8",children:(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.advanced_options.permissions")})}),["hide_meta_info","is_comments_disabled","is_liking_disabled","hide_from_featured_areas"].map(function(e){return(0,r.jsx)(ed,{name:e,tooltipText:(0,v.t)("events.edit_modal.".concat(e,"_tooltip")),inlineReverse:!0,className:"!pb-0",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:e})},e)})]})},e_=function(e){var t=e.event;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Z.TitleXl,{children:(0,v.t)("events.edit_modal.advanced_options.title")}),(0,r.jsx)(ex,{}),(0,r.jsx)(ep,{event:t}),(0,r.jsx)(eg,{})]})},ej=n(60589),ew=n(517534),eO=n(780754),eS=n(617013),eP=function(e){var t=e.event,n=e.canCreateTopics,o=e.requireTopicSelection,i=(0,ew.m)().spaces,a=!!t,s=o?{required:(0,v.t)("events.create.form.topics_required_error")}:{required:!1},l=(0,(0,el.Gc)().getValues)("space_id");return(0,r.jsxs)("div",{className:"my-6 md:my-8",children:[(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.create.form.event_name")}),(0,r.jsxs)("div",{className:"flex flex-col items-stretch gap-2 md:flex-row",children:[(0,r.jsx)("div",{className:a?"w-full pr-0 md:pr-2 md:w-1/2":"w-full",children:(0,r.jsx)(ed,{name:"name",rules:{required:(0,v.t)("events.create.form.name_required_error"),maxLength:{value:255,message:(0,v.t)("events.create.form.name_length_error")}},placeholder:(0,v.t)("events.create.form.name_placeholder"),translationRoot:"events.create.form",children:(0,r.jsx)(h.l.Input,{autoFocus:!0,"data-testid":"event-title"})})}),a&&(0,r.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:(0,r.jsx)(ed,{name:"slug",hidePlaceholder:!0,rules:{maxLength:{value:255,message:(0,v.t)("events.create.form.slug_length_error")}},tooltipText:(0,v.t)("events.edit_modal.slug_tooltip",{url:window.location.origin}),children:(0,r.jsx)(h.l.Input,{})})})]}),(0,r.jsxs)("div",{className:"flex flex-col items-stretch md:flex-row",children:[(0,r.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,r.jsx)(ed,{name:"space_id",rules:{required:(0,v.t)("events.create.form.space_required_error")},translationRoot:"events.create.form",children:(0,r.jsx)(eS.M,{spaces:i,name:"space_id",variant:"form-input",dropdownClassName:"!top-[100%] -mt-1"})})}),(0,r.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:(0,r.jsx)(ed,{name:"user_id",translationRoot:"events.create.form",children:(0,r.jsx)(h.l.CommunityMemberSelect,{name:"user_id",direction:"down",valueField:"user_id",hideIcon:!0})})})]}),(0,r.jsx)("div",{className:"flex flex-col items-stretch md:flex-row",children:(0,r.jsx)(ed,{name:"topics",tooltipText:(0,v.t)("events.edit_modal.topics_tooltip"),rules:s,children:(0,r.jsx)(eO.w,{containerClassName:"bg-primary border-primary rounded-md border",name:"topics",spaceId:l,creatable:n})})})]})},eC=n(19338),ek=n(125152),eI=n(404393),eN=n(306685),eA=n(864608),eM=n(432050),eT=function(e){var t=e.title,n=e.description,o=e.className;return(0,r.jsx)(eM.b,{type:"warning",icon:(0,r.jsx)(M.JO,{type:"20-triangle-exclamation",size:20,className:"mt-1 !self-start text-amber-600"}),title:t,description:n,className:"text-dark mb-4 mt-2 rounded-xl !border !border-amber-400 bg-[rgba(245,158,11,0.05)] [&_span]:!text-sm ".concat(void 0===o?"":o)})};function eE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function eR(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return eE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eE(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var eD=function(e){var t=e.event,n=(0,eC.e)({event:t}),i=n.endsAtMaxDate,a=n.endsAfterMaxOccurrences,s=n.frequencyOptions,l=n.endingOptions,c=n.endsAtMinDate,u=n.endsOnValue,d=n.shouldShowRecurringFields,f=n.currentEndsAt,m=n.startsAtInUTC,p=(0,O.n)().hasSplitRecurringEventsEnabled,b=t&&(0,j.VL)(t),y=(0,el.Gc)(),x=y.setValue,_=y.getValues,w=y.clearErrors,S=(0,el.cl)(),P=S.isSubmitting,C=S.isSubmitted,k=eR((0,o.useState)(null),2),I=k[0],N=k[1],A=eR((0,o.useState)(!1),2),M=A[0],T=A[1],E=_("recurring_setting_attributes.frequency");(0,o.useEffect)(function(){m&&f&&(0,j.f0)(t)?(new Date(m)>new Date(f)?T(!0):T(!1),w("event_setting_attributes.starts_at")):T(!1)},[m,f]),(0,o.useEffect)(function(){P&&N(E)},[P]),(0,o.useEffect)(function(){P||C||N(null)},[C,P,I]),(0,o.useEffect)(function(){I&&C&&x("recurring_setting_attributes.frequency",I,{shouldDirty:!1})},[I,E,C,x]);var R=((0,j.mv)(t)||(0,j.s9)(t))&&(0,j.f0)(t),D=p?!!t&&!(0,j.f0)(t)||b:!!t;return(0,r.jsxs)("div",{className:"my-6 md:mb-8 md:mt-16",children:[(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.create.form.date_and_time")}),(0,r.jsx)("div",{className:"flex flex-col items-stretch md:flex-row",children:(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(ed,{name:"event_setting_attributes.starts_at",label:(0,v.t)("events.create_modal.event_setting_attributes.starts_at",{timeZone:(0,eI.ED)(eI.tq)}),translationRoot:"events.create.form",children:(0,r.jsx)(eN.D,{startsAtConfig:{name:"event_setting_attributes.starts_at",minDate:new Date},endsAtConfig:{name:"event_setting_attributes.ends_at"},durationConfig:{name:"event_setting_attributes.duration_in_seconds"},disabled:b})})})}),M&&(0,r.jsx)(eT,{title:(0,v.t)("events.edit_modal.recurring_setting_attributes.starts_at_after_ends_at_warning_title"),description:(0,v.t)("events.edit_modal.recurring_setting_attributes.starts_at_after_ends_at_warning_content")}),(0,r.jsx)("div",{className:"flex items-stretch",children:(0,r.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,r.jsx)(ed,{name:"recurring_setting_attributes.frequency",translationRoot:"events.create.form",children:(0,r.jsx)(h.l.AnimatedSelect,{name:"recurring_setting_attributes.frequency",fullWidth:!0,options:s,disabled:D,dataTestId:"event-repeats"})})})}),(0,r.jsxs)("div",{className:"flex flex-col items-stretch md:flex-row",children:[d&&(0,r.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,r.jsx)(ed,{name:"recurring_setting_attributes.range_type",translationRoot:"events.create.form",children:(0,r.jsx)(h.l.AnimatedSelect,{name:"recurring_setting_attributes.range_type",fullWidth:!0,options:l,disabled:R,dataTestId:"event-ends"})})}),d&&(0,r.jsxs)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:[(!u||u===ek.pd.ON)&&(0,r.jsx)("div",{className:"mt-0 flex items-end md:mt-7",children:(0,r.jsx)(ed,{name:"recurring_setting_attributes.ends_at",hideLabel:!0,rules:{required:(0,v.t)("events.create.form.ends_at_required")},translationRoot:"events.create.form",children:(0,r.jsx)(eA.x,{name:"recurring_setting_attributes.ends_at",minDate:c?new Date(c):void 0,maxDate:i?new Date(i):void 0,disabled:R,dataTestId:"recurring_event_ends_at",datePlaceholder:(0,v.t)("events.create.form.recurring_setting_attributes.date_placeholder"),timePlaceholder:(0,v.t)("events.create.form.recurring_setting_attributes.time_placeholder")})})}),u===ek.pd.AFTER&&(0,r.jsx)("div",{className:"flex items-end",children:(0,r.jsx)("div",{className:"grow",children:(0,r.jsx)(ed,{name:"recurring_setting_attributes.occurrences",rules:{required:!R&&(0,v.t)("events.create.form.occurrences_required"),max:{value:a||1,message:(0,v.t)("events.create.form.max_occurrences_error")}},translationRoot:"events.create.form",children:(0,r.jsx)(h.l.Input,{type:"number",min:1,max:a||1,autoFocus:!0,disabled:R,"data-testid":"event-occurrences",customOpacity:"70"})})})})]})]})]})},eL=n(333382),eF=function(){return(0,eL.H)("location-picker-z-index-override"),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ed,{name:"event_setting_attributes.in_person_location",variant:"extra-bottom-margin",translationRoot:"events.create.form",rules:{required:(0,v.t)("events.create_modal.event_setting_attributes.location_address_required_error")},children:(0,r.jsx)(h.l.LocationPicker,{name:"event_setting_attributes.in_person_location",autoFocus:!0})}),(0,r.jsx)(ed,{name:"event_setting_attributes.hide_location_from_non_attendees",inlineReverse:!0,translationRoot:"events.create.form",children:(0,r.jsx)(h.l.ToggleSwitch,{name:"event_setting_attributes.hide_location_from_non_attendees",variant:"small"})})]})},eU=n(391150),eB=n(437588),eq=n(252484),ez=n(943544),eZ=function(e){var t=e.name,n=e.roomType,i=void 0===n?eB.H0.STREAM:n,a=(0,ew.m)().spaces,s=(0,eq.oQ)().config,l=null==s?void 0:s.live_room_participants_capacity,c=(0,el.Gc)(),u=c.control,d=c.getValues,f=c.setValue,m=d("space_id"),p=d("event_setting_attributes.ticket_type"),b=a.find(function(e){return e.id==m}),h=b?b.visibility:"open",y=[{value:eB._d.SECRET,label:(0,v.t)("events.create.form.".concat(h,".access_type_secret")),description:(0,r.jsx)(g.Z.LabelSm,{children:(0,v.t)("events.create.form.".concat(h,".access_type_secret_label"))})}];return p==j.Mj.FREE&&y.push({value:eB._d.OPEN,label:(0,v.t)("events.create.form.".concat(h,".access_type_space")),description:(0,r.jsx)(g.Z.LabelSm,{children:(0,v.t)("events.create.form.".concat(h,".access_type_space_label"),{maxCapacity:l})})}),i===eB.H0.STREAM&&p==j.Mj.FREE&&y.push({value:eB._d.PUBLIC_STREAM,label:(0,v.t)("events.create.form.".concat(h,".access_type_public")),description:(0,r.jsx)(g.Z.LabelSm,{children:(0,v.t)("events.create.form.".concat(h,".access_type_public_label"))})}),(0,o.useEffect)(function(){"paid"==p&&f("event_setting_attributes.live_stream_room_setting_attributes.access_type",eB._d.SECRET,{shouldDirty:!0})},[p,f]),(0,r.jsx)(el.Qr,{control:u,name:void 0===t?"":t,render:function(e){var t,n=e.field,o=n.onChange,i=(t=n.value,y.find(function(e){return e.value===t})||y[0]);return(0,r.jsx)(ez.Lt,{direction:"bottom-start",linkType:"button",button:(0,r.jsx)(ez.Lt.MenuButton,{className:"form-control relative inline-block w-full text-left",children:(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("div",{className:"content-start",children:(0,r.jsx)(g.Z.LabelMd,{children:null==i?void 0:i.label})}),(0,r.jsx)("div",{className:"flex content-end",children:(0,r.jsx)(M.JO,{type:"cheveron-down"})})]})}),buttonClassName:"w-full",className:"relative w-full",size:ez.wk.EXTRA_LARGE,onChange:o,options:y,labelWeight:"semibold"})}})},eV=function(e){var t,n,i,a=e.recordingEnabled,s=e.showRecordingToggle,l=e.roomTypeOverride,c=e.event,u=!!c,d=function(){var e,t=(c||{}).event_setting_attributes,n=!!t&&(0,eI.aA)(null==t?void 0:t.ends_at),r=null==t||null==(e=t.live_stream_room_setting_attributes)?void 0:e.stream_status;return n||r===eB.LV.LIVE},f=(0,el.Gc)(),m=f.watch,p=f.setValue,b=m("event_setting_attributes.live_stream_room_setting_attributes.access_type"),y=m("event_setting_attributes.live_stream_room_setting_attributes.auto_post_recording_enabled"),g=m("event_setting_attributes.ticket_type"),x=b===eB._d.PUBLIC_STREAM,_="event_setting_attributes.live_stream_room_setting_attributes.limit_url_sharing",w=(0,o.useRef)(null==c||null==(t=c.event_setting_attributes)?void 0:t.ticket_type),O=u&&w.current==g?null==c||null==(i=c.event_setting_attributes)||null==(n=i.live_stream_room_setting_attributes)?void 0:n.limit_url_sharing:g===j.Mj.PAID;return(0,o.useEffect)(function(){b===eB._d.PUBLIC_STREAM&&p(_,!1,{shouldDirty:!0})},[b,p]),(0,o.useEffect)(function(){p(_,O,{shouldDirty:!0})},[g,p]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-stretch",children:[(0,r.jsx)("div",{className:"w-1/2 pr-2",children:(0,r.jsx)(ed,{name:"event_setting_attributes.live_stream_room_setting_attributes.view_type",labelClassName:"mb-3 text-lg",translationRoot:"events.create.form",children:(0,r.jsx)(eU.b,{roomType:l})})}),(0,r.jsx)("div",{className:"w-1/2 pl-2",children:(0,r.jsx)(ed,{name:"event_setting_attributes.live_stream_room_setting_attributes.access_type",labelClassName:"mb-3 text-lg",translationRoot:"events.create.form",children:(0,r.jsx)(eZ,{roomType:l,name:"event_setting_attributes.live_stream_room_setting_attributes.access_type"})})})]}),void 0!==s&&s&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)(ed,{name:"event_setting_attributes.live_stream_room_setting_attributes.recording_enabled",tooltipText:(0,v.t)("events.create_modal.event_setting_attributes.recording_enabled_tooltip"),inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",isDisabled:d(),children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",disabled:d(),name:"event_setting_attributes.live_stream_room_setting_attributes.recording_enabled"})}),a&&(0,r.jsx)(ed,{name:"event_setting_attributes.live_stream_room_setting_attributes.auto_post_recording_enabled",tooltipText:(0,v.t)("events.create_modal.event_setting_attributes.auto_post_recording_enabled_tooltip"),inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.live_stream_room_setting_attributes.auto_post_recording_enabled"})}),(0,r.jsx)(ed,{name:"event_setting_attributes.live_stream_room_setting_attributes.mute_on_join",inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.live_stream_room_setting_attributes.mute_on_join"})}),(0,r.jsx)(ed,{name:"event_setting_attributes.live_stream_room_setting_attributes.hide_participants_list",tooltipText:(0,v.t)("events.create.form.event_setting_attributes.live_stream_room_setting_attributes.hide_participants_list_tooltip"),inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.live_stream_room_setting_attributes.hide_participants_list"})})]}),(0,r.jsx)(ed,{name:"event_setting_attributes.hide_location_from_non_attendees",inlineReverse:!0,translationRoot:y?"events.create.form.live_location":"events.create.form",className:"!pt-1",labelClassName:"!font-normal",tooltipText:y&&(0,v.t)("events.create_modal.event_setting_attributes.hide_location_from_non_attendees_tooltip"),children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.hide_location_from_non_attendees"})}),!x&&(0,r.jsx)(ed,{name:_,translationRoot:"events.create.form",tooltipText:(0,v.t)("events.create_modal.event_setting_attributes.limit_url_sharing_tooltip"),inlineReverse:!0,className:"!pt-1",labelClassName:"!font-normal",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:_})})]})},eH=n(573622),eW=function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ed,{name:"event_setting_attributes.virtual_location_url",rules:{required:(0,v.t)("events.create_modal.event_setting_attributes.virtual_location_required_error"),pattern:{value:eH.lu,message:(0,v.t)("events.create.form.virtual_location_url_error")}},translationRoot:"events.create.form",children:(0,r.jsx)(h.l.Input,{"data-testid":"url-event-location"})}),(0,r.jsx)(ed,{name:"event_setting_attributes.hide_location_from_non_attendees",inlineReverse:!0,translationRoot:"events.create.form",children:(0,r.jsx)(h.l.ToggleSwitch,{name:"event_setting_attributes.hide_location_from_non_attendees",variant:"small"})})]})},eQ=function(e){var t,n,i=e.setLocationType,a=e.event,s=!!a,l=(0,el.Gc)().setValue,c=(0,el.qo)({name:"event_setting_attributes.location_type"}),u=(0,el.qo)({name:"event_setting_attributes.live_stream_room_setting_attributes.recording_enabled"}),d=(0,el.qo)({name:"event_setting_attributes.ticket_type"}),f=(0,o.useRef)(null==a||null==(t=a.event_setting_attributes)?void 0:t.ticket_type),m=s&&f.current==d?null==a||null==(n=a.event_setting_attributes)?void 0:n.hide_location_from_non_attendees:d===j.Mj.PAID;(0,o.useEffect)(function(){[j.Bq.TBD,j.Bq.IN_PERSON].includes(c)||l("event_setting_attributes.hide_location_from_non_attendees",m,{shouldDirty:!0})},[d,l,c]),(0,o.useEffect)(function(){i(c)},[c,i]);var p=c===j.Bq.LIVE_ROOM?eB.H0.CONFERENCE:eB.H0.STREAM;switch(c){case j.Bq.IN_PERSON:return(0,r.jsx)(eF,{});case j.Bq.VIRTUAL:return(0,r.jsx)(eW,{});case j.Bq.LIVE_ROOM:case j.Bq.LIVE_STREAM:return(0,r.jsx)(eV,{recordingEnabled:u,showRecordingToggle:!0,roomTypeOverride:p,event:a});case j.Bq.TBD:default:return null}},eG=function(e){var t,n,o=e.event,i=e.setLocationType,a=(0,ec.wh)().currentCommunity,s=null!=(t=null==a?void 0:a.supports_live_streams)&&t,l=null!=(n=null==a?void 0:a.white_label)&&n,c=[{label:(0,v.t)("events.create_modal.event_setting_attributes.location_type_in_person"),value:j.Bq.IN_PERSON},{label:(0,v.t)("events.create_modal.event_setting_attributes.location_type_virtual"),value:j.Bq.VIRTUAL},{label:l?(0,v.t)("events.location_types.live_stream"):(0,v.t)("events.create_modal.event_setting_attributes.location_type_live_stream"),value:j.Bq.LIVE_STREAM,hidden:!s},{label:l?(0,v.t)("events.location_types.live_room"):(0,v.t)("events.create_modal.event_setting_attributes.location_type_live_room"),value:j.Bq.LIVE_ROOM,hidden:!s},{label:(0,v.t)("events.create_modal.event_setting_attributes.location_type_tbd"),value:j.Bq.TBD}];return(0,r.jsxs)("div",{className:"my-6 md:mb-8 md:mt-16",children:[(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.create.form.event_location")}),(0,r.jsx)("div",{className:"flex items-stretch",children:(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(ed,{name:"event_setting_attributes.location_type",placeholder:(0,v.t)("events.create_modal.event_setting_attributes.location_type_placeholder"),rules:{required:(0,v.t)("events.create_modal.event_setting_attributes.location_required_error")},translationRoot:"events.create.form",children:(0,r.jsx)(h.l.AnimatedSelect,{name:"event_setting_attributes.location_type",fullWidth:!0,options:c,allowEmpty:!0,dataTestId:"event-location"})})})}),(0,r.jsx)(eQ,{setLocationType:i,event:o})]})},e$=n(29378),eK=n(247075),eJ=function(){return(0,r.jsx)("div",{className:"bg-tertiary mb-16 mt-5 flex h-[208px] w-full items-center justify-center rounded-xl",children:(0,r.jsxs)("div",{className:"flex w-[300px] flex-col space-y-6 text-center",children:[(0,r.jsx)(g.Z.LabelLg,{weight:"medium",children:(0,v.t)("events.create.form.connect_to_stripe_description")}),(0,r.jsx)("div",{className:"mx-6",children:(0,r.jsx)(eK.Q,{href:"/settings/paywalls",variant:"circle",full:!0,children:(0,v.t)("events.create.form.connect_to_stripe")})})]})})},eX=n(936877),eY=n(65631),e0=n(751169),e1=n(29607),e2=n(102056),e3=function(e){var t=e.name,n=e.labelKey,o=e.placeholder,i=e.currency,a=e.isDisabled,s=(0,el.Gc)().formState.errors[t];if(!i)return null;var l=(0,e1.Bj)(i,{amountInCents:!0}),c=function(e){return l(e)||l(0)||"0"},u=(0,v.t)("settings.paywalls.modal.tabs.pricing.add_price_modal.field_errors.amount",{min:(0,e2.I)(i,i.min_charge_amount,{amountInCents:!0,includeCurrencyCode:!1}),max:(0,e2.I)(i,i.max_charge_amount,{amountInCents:!0,includeCurrencyCode:!1})});return(0,r.jsx)(h.l.Item,{name:t,className:(0,d.A)({"border-red-500":s},"m-0 grow"),label:(0,v.t)("events.create.form.paywall_attributes.".concat(n)),placeholder:o||c(0),rules:{validate:{bounds:function(e){var t=(0,e1.LG)(e);return t>=(null==i?void 0:i.min_charge_amount)&&t<=(null==i?void 0:i.max_charge_amount)||u}}},transformValue:c,labelClassName:"mb-2 text-sm font-semibold leading-5 tighter normal-case text-dark",labelWrapperClassName:"m-0",errorClassName:"mt-1 text-red-500 text-sm",hideDescription:!0,hideBorder:!0,children:(0,r.jsx)(h.l.Input,{"data-testid":"ticket-price",disabled:a})})},e6=function(e){var t,n=e.event,o=(0,el.Gc)().watch,i=!!n,a=n&&(0,j.Rv)(n),s=o("event_setting_attributes.ticket_type"),l=(0,j.yl)(n)||"paid"==s,c=(0,j.hA)(n),u=i&&l&&c&&!(0,j.mv)(n)||a||(0,j.f0)(n),d=o("paywall_attributes.currency_id")||(null==n||null==(t=n.paywall_attributes)?void 0:t.currency_id),f=(0,eY.K)(),m=f.data;if(f.isLoading)return(0,r.jsx)(e0.a,{});var p=null==m?void 0:m.find(function(e){return e.id.toString()===(null==d?void 0:d.toString())});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col items-stretch md:flex-row",children:[(0,r.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,r.jsx)(e3,{name:"paywall_attributes.price_amount",labelKey:"price",currency:p,placeholder:(0,v.t)("events.create.form.paywall_attributes.price_placeholder"),isDisabled:a})}),(0,r.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:(0,r.jsx)(eX.H,{formItemName:"paywall_attributes.currency_id",formItemTranslationRoot:"events.create.form",disabled:u,markDefaultCurrencyDirty:!0})})]}),(0,r.jsx)("div",{className:"flex flex-col items-stretch",children:(0,r.jsx)(ed,{name:"paywall_attributes.description",rules:{maxLength:{value:0xffffff,message:(0,v.t)("events.create.form.paywall_attributes.description_length_error")}},placeholder:(0,v.t)("events.create.form.paywall_attributes.description_placeholder"),translationRoot:"events.create.form",children:(0,r.jsx)(h.l.TextArea,{name:"paywall_attributes.description","data-testid":"event-paywall-description",disabled:a})})})]})},e5=function(e){var t=e.event,n=(0,ec.wh)().currentCommunity,o=(0,el.qo)({name:"event_setting_attributes.ticket_type"});return o===j.Mj.FREE?null:o!==j.Mj.PAID||(0,e$.qF)(n)?(0,r.jsx)(e6,{event:t}):(0,r.jsx)(eJ,{})},e4=function(e){var t=e.event,n=(0,el.Gc)().watch,o=(0,j.Rv)(t)||(0,j.f0)(t),i=n("event_setting_attributes.ticket_type"),a=n("event_setting_attributes.location_type"),s=i==j.Mj.PAID&&[j.Bq.LIVE_STREAM,j.Bq.LIVE_ROOM].includes(a),l=[{label:(0,v.t)("events.create_modal.event_setting_attributes.free_event"),value:j.Mj.FREE},{label:(0,v.t)("events.create_modal.event_setting_attributes.paid_event"),value:j.Mj.PAID}];return(0,r.jsxs)("div",{className:"my-6 md:mb-8 md:mt-16",children:[(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.create.form.event_ticket")}),(0,r.jsx)("div",{className:"flex items-stretch",children:(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(ed,{name:"event_setting_attributes.ticket_type",placeholder:(0,v.t)("events.create_modal.event_setting_attributes.ticket_type_placeholder"),rules:{required:(0,v.t)("events.create_modal.event_setting_attributes.ticket_type_required_error")},translationRoot:"events.create.form",children:(0,r.jsx)(h.l.AnimatedSelect,{name:"event_setting_attributes.ticket_type",fullWidth:!0,options:l,dataTestId:"event-ticket-type",disabled:o})})})}),s&&(0,r.jsxs)("div",{className:"bg-tertiary my-2.5 flex h-14 w-full flex-none items-center justify-start gap-x-3 rounded-lg",children:[(0,r.jsx)(M.JO,{type:"24-info",size:24,className:"ms-3"}),(0,r.jsx)(g.Z.LabelSm,{color:"bg-tertiary",children:(0,v.t)("events.create.form.event_setting_attributes.live_stream_room_setting_attributes.paid_event_warning_msg")})]}),(0,r.jsx)(e5,{event:t})]})};function e7(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var e9=function(e){var t,n,r,i=(0,ec.wh)().currentCommunity,a=(0,el.Gc)(),s=a.setValue,l=a.getValues,c="event_setting_attributes.live_stream_room_setting_attributes.access_type",u=(0,o.useRef)(null==e||null==(t=e.event_setting_attributes)?void 0:t.location_type),d=null==(n=l().event_setting_attributes)?void 0:n.location_type,f=(0,ew.m)().spaces,m=(0,el.qo)({name:"space_id"}),p=(null==f?void 0:f.find(function(e){return e.id===m}))||null,b=["private","secret"].includes(null!=(r=null==p?void 0:p.visibility)?r:"")?eB._d.SECRET:eB._d.OPEN,h=(0,el.qo)({name:c}),v=(0,o.useMemo)(function(){var t,n={access_type:b,view_type:eB.Bk.GRID,recording_enabled:null==i?void 0:i.live_stream_recording_enabled,auto_post_recording_enabled:!1,room_type:eB.H0.STREAM},r=null==e||null==(t=e.event_setting_attributes)?void 0:t.live_stream_room_setting_attributes;return r?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},n,r):n},[i,e,b]);return(0,o.useEffect)(function(){(0,j.UJ)(d)&&u.current!==d&&(Object.entries(v).forEach(function(e){var t=function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return e7(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e7(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=t[0],r=t[1];s("event_setting_attributes.live_stream_room_setting_attributes.".concat(n),r,{shouldDirty:!0,shouldTouch:!0})}),u.current=d),d===j.Bq.LIVE_ROOM&&h===eB._d.PUBLIC_STREAM&&s(c,eB._d.SECRET,{shouldDirty:!0})},[d,v,s]),{space:p}},e8=function(e){var t=e.event,n=e.setLocationType,o=e9(t).space,i=((0,ec.wh)().currentCommunityMember||{}).is_admin;return(0,r.jsxs)(r.Fragment,{children:[t&&(0,r.jsx)(g.Z.TitleXl,{children:(0,v.t)("events.create.form.basic_info")}),(0,r.jsx)(eP,{event:t,canCreateTopics:!!o&&(0,ej.Y_)(o),requireTopicSelection:null==o?void 0:o.require_topic_selection}),(0,r.jsx)(eD,{event:t}),(0,r.jsx)(eG,{event:t,setLocationType:n}),i&&(0,r.jsx)(e4,{event:t})]})},te=n(805116),tt=function(){return(0,r.jsxs)("div",{className:"create-event-details__cover-image",children:[(0,r.jsx)("label",{children:(0,v.t)("events.create.form.cover_image")}),(0,r.jsx)(ev.D,{name:"cover_image",alt:"",customAspectRatioHelpText:(0,v.t)("image_upload.recommended_size_event_cover"),showAddCoverBtn:!0,customAddCoverBtn:(0,r.jsxs)("div",{className:"create-event-details__cover-image-add",children:[(0,r.jsx)("div",{className:"create-event-details__cover-image-add__icon-wrapper",children:(0,r.jsx)(M.JO,{type:"plus-big",viewBox:"0 0 20 20"})}),(0,r.jsx)("span",{className:"text-dark font-semibold",children:(0,v.t)("events.create.form.cover_image_upload")}),(0,r.jsx)("span",{className:"text-light mt-1 text-sm",children:(0,v.t)("events.create.form.event_cover_image_recommended_size")})]})})]})},tn=function(){var e=(0,o.useRef)(null);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Z.TitleXl,{children:(0,v.t)("events.edit_modal.details.title")}),(0,r.jsxs)("div",{className:"my-8",children:[(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.details.cover_image")}),(0,r.jsx)(tt,{})]}),(0,r.jsxs)("div",{className:"mb-8 mt-6 md:mt-12",children:[(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.details.description")}),(0,r.jsx)(ed,{name:"body",hideLabel:!0,children:(0,r.jsx)("div",{className:"trix-v2 event-description-wrapper trix-v2--modal-3 mt-2",children:(0,r.jsx)(te.O,{placeholder:(0,v.t)("events.edit_modal.details.description_placeholder"),id:"event-details-body",ref:e,name:"body"})})})]})]})},tr=n(387513),to=n(825252),ti=n(259928),ta=n(90170),ts=n(20735),tl=n(818369),tc=n(725724),tu=n(134870),td=n(954262),tf=n(984208);function tm(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var tp=function(e){var t=e.shouldShowConfirmationModal,n=e.toggleConfirmationModal,o=e.handleSubmit,i=e.isLoading;return(0,r.jsx)(tf.W,{isOpen:t,onClose:n,onAction:function(){var e;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return[4,o()];case 1:return e.sent(),n(),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){tm(i,r,o,a,s,"next",e)}function s(e){tm(i,r,o,a,s,"throw",e)}a(void 0)})})()},actionText:(0,v.t)("scheduled_emails.delete.email"),title:(0,v.t)("scheduled_emails.delete.modal_title"),size:"sm",actionVariant:"danger",disabled:i,children:(0,r.jsx)("div",{className:"my-4 text-center",children:(0,v.t)("scheduled_emails.delete.modal_description")})})};function tb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var th=function(){var e,t=(e=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return tb(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tb(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=t[0],r=t[1];return{isOpen:n,openModal:function(){r(!0)},closeModal:function(){r(!1)}}},tv=(0,o.createContext)(null);tv.displayName="ScheduledEmailContext";var ty=function(e){var t,n=e.event,o=e.children,i=(0,td.T)().getScheduledEmailList,a=String((null==n?void 0:n.id)||""),s=null==n||null==(t=n.event_setting_attributes)?void 0:t.starts_at,l=s?new Date(s):void 0,c=new Date,u=(0,T.useQuery)(["scheduled-email-list",a,s],function(){return i({record_id:a,scheduled_email_type:"event"})}),d=u.data,f=u.isLoading,m=u.refetch,p={event:n,scheduledEmailList:(null==d?void 0:d.records)||[],isLoading:f,maxDate:l,minDate:c,refetch:m,hasScheduledEmails:function(){var e;return!!(null==d||null==(e=d.records)?void 0:e.length)}};return(0,r.jsx)(tv.Provider,{value:p,children:o})},tg=function(){var e=(0,o.useContext)(tv);if(null===e)throw Error("useScheduledEmailContext must be used within a ScheduledEmailProvider");return e};function tx(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function t_(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){tx(i,r,o,a,s,"next",e)}function s(e){tx(i,r,o,a,s,"throw",e)}a(void 0)})}}function tj(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var tw=function(e){var t=e.scheduledEmail,n=e.disabled,o=th(),i=o.isOpen,a=o.closeModal,s=o.openModal,l=th(),c=l.isOpen,u=l.closeModal,d=l.openModal,f=tg(),m=f.event,p=f.refetch,b=f.maxDate,h=f.minDate,g=(0,td.T)(),x=g.destroyScheduledEmail,_=g.isDestroyLoading;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(ez.Lt,{direction:"bottom-end",menuButtonEl:"div",button:(0,r.jsx)(y.h,{name:"20-menu-dots-horizontal",iconClassName:"!text-default group-hover:!text-dark !w-5 !h-5",className:"group",variant:"secondary",iconSize:20,buttonSize:28,ariaLabel:(0,v.t)("events.event_actions"),dataTestId:"action-more",disabled:n}),transitionWrapperClassName:"z-50",size:"small",children:[(0,r.jsx)(ez.Lt.ItemWithLink,{onClick:s,linkType:"button",children:(0,v.t)("edit")}),(0,r.jsx)(ez.Lt.ItemWithLink,{onClick:d,linkType:"button",children:(0,r.jsx)("span",{className:"text-v2-danger",children:(0,v.t)("delete")})})]}),(0,r.jsx)(tc.D,{isDateDisabled:(0,j.VL)(m),isOpen:i,onClose:function(){return t_(function(){return tj(this,function(e){switch(e.label){case 0:return a(),[4,null==p?void 0:p()];case 1:return e.sent(),[2]}})})()},scheduledEmail:t,maxDate:b,minDate:h}),(0,r.jsx)(tp,{shouldShowConfirmationModal:c,toggleConfirmationModal:u,handleSubmit:function(){return t_(function(){return tj(this,function(e){switch(e.label){case 0:return[4,x(t)];case 1:return e.sent(),u(),[4,null==p?void 0:p()];case 2:return e.sent(),[2]}})})()},isLoading:_})]})},tO=function(e){var t=e.scheduledEmail,n=t.scheduled_at,o=t.metadata,i=t.subject,a=o.send_to,s=(0,(0,el.Gc)().getValues)("event_setting_attributes.send_email_reminder")?"":"text-gray-400";return(0,r.jsxs)("div",{className:(0,d.A)("border-primary flex items-center gap-3 border-b py-4",s),children:[(0,r.jsx)("div",{className:"bg-tertiary flex size-12 items-center justify-center rounded-lg",children:(0,r.jsx)(M.JO,{type:"16-email",size:16})}),(0,r.jsxs)("div",{className:"grow",children:[(0,r.jsx)(g.Z.LabelMd,{weight:"semibold",color:s,children:i}),(0,r.jsxs)("div",{children:[(0,r.jsxs)(g.Z.LabelSm,{weight:"medium",color:s,children:[(0,v.t)("events.edit_modal.email.to",{send_to:(0,v.t)("scheduled_emails.form.".concat(a))}),(0,v.t)("events.edit_modal.email.separator")]}),(0,r.jsx)(g.Z.LabelSm,{weight:"medium",color:s||"text-light",children:(0,v.t)("events.edit_modal.email.scheduled_at",{scheduled_at:n&&(0,tu.w)({dateTime:new Date(n),format:tu.f.short_date_at_short_time})})})]})]}),(0,r.jsx)(tw,{scheduledEmail:t})]})},tS=function(){var e=tg(),t=e.isLoading,n=e.scheduledEmailList;return t?(0,r.jsx)(e0.a,{}):n&&0!==n.length?(0,r.jsx)(r.Fragment,{children:n.map(function(e){return(0,r.jsx)(tO,{scheduledEmail:e},e.id)})}):null};function tP(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function tC(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){tP(i,r,o,a,s,"next",e)}function s(e){tP(i,r,o,a,s,"throw",e)}a(void 0)})}}function tk(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var tI="event_setting_attributes.send_email_reminder",tN=function(e){var t,n,i=e.event,a=th(),s=a.isOpen,l=a.openModal,c=a.closeModal,u=tg(),d=u.refetch,f=u.hasScheduledEmails,m=u.maxDate,p=u.minDate,b=(0,el.Gc)(),y=b.getValues,x=b.setValue,_=(0,o.useMemo)(function(){return(0,tr.AW)((0,v.t)("events.edit_modal.email.email_body_default_text",{event_name:null==i?void 0:i.name}).replace(/[{}]/g,function(e){return"".concat(e).concat(e)}),[ti.Z,ts.Z,tl.Z,to.ZP,ta.Z])},[null==i?void 0:i.name]),w=(0,eI.ZX)(null==i||null==(n=i.event_setting_attributes)||null==(t=n.starts_at)?void 0:t.toString(),-3600),O={record_id:String(null==i?void 0:i.id),scheduled_email_type:"event",scheduled_at:w,subject:(0,v.t)("events.edit_modal.email.default_subject").replace(/[{}]/g,function(e){return"".concat(e).concat(e)}),email_body:{body:_},enabled:(0,j.s9)(i),metadata:{send_to:"going",email_type:"reminder"}},P=y(tI);return(0,r.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,r.jsx)(g.Z.TitleXl,{children:(0,v.t)("events.edit_modal.email.long_title")}),(0,r.jsxs)("div",{className:"md:my-3",children:[(0,r.jsx)(ed,{name:"event_setting_attributes.send_in_app_notification_reminder",tooltipText:(0,v.t)("events.edit_modal.event_setting_attributes.send_in_app_notification_reminder_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,r.jsx)(h.l.ToggleSwitch,{name:"event_setting_attributes.send_in_app_notification_reminder",variant:"small"})}),(0,r.jsx)(ed,{name:tI,tooltipText:(0,v.t)("events.edit_modal.event_setting_attributes.send_scheduled_email_tooltip"),inlineReverse:!0,className:"!pb-0 [&>p]:absolute [&>p]:left-0 [&>p]:top-full [&>p]:!mt-0",rules:{validate:{bounds:function(e){return!e||!!f()||(0,v.t)("events.scheduled_email_error")}}},children:(0,r.jsx)(h.l.ToggleSwitch,{name:tI,variant:"small",onClick:function(){return tC(function(){return tk(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e){return setTimeout(e,0)})];case 1:if(e.sent(),!(P=y(tI))||f())return[2];return l(),[2]}})})()}})})]}),(0,r.jsx)("div",{className:"mt-6 md:mb-3 md:mt-8",children:(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.email.schedule")})}),(0,r.jsx)(tS,{}),(0,r.jsx)(S.z,{type:"button",variant:"secondary",onClick:l,className:"mt-4 min-w-[96px]",disabled:!P||(0,j.VL)(i),children:(0,v.t)("events.edit_modal.email.add_reminder")}),(0,r.jsx)(tc.D,{isDateDisabled:(0,j.VL)(i),isOpen:s,onClose:function(){return tC(function(){var e,t;return tk(this,function(n){switch(n.label){case 0:return c(),[4,d()];case 1:return(null==(t=n.sent().data)||null==(e=t.records)?void 0:e.length)===0&&x(tI,!1,{shouldDirty:!0}),[2]}})})()},scheduledEmail:O,maxDate:m,minDate:p})]})},tA=function(e){var t=e.event;return(0,r.jsx)(ty,{event:t,children:(0,r.jsx)(tN,{event:t})})},tM=n(400770),tT=function(){return(0,r.jsxs)(tM.t,{backgroundNone:!0,className:"!p-0 md:!px-4 md:!py-2",children:[(0,r.jsx)(ed,{name:"event_setting_attributes.confirmation_message_title",hideLabel:!0,children:(0,r.jsx)(h.l.Input,{})}),(0,r.jsx)(ed,{name:"event_setting_attributes.confirmation_message_description",hideLabel:!0,children:(0,r.jsx)(h.l.TextArea,{name:"event_setting_attributes.confirmation_message_description"})}),(0,r.jsx)(ed,{name:"event_setting_attributes.confirmation_message_button_title",hideLabel:!0,children:(0,r.jsx)(h.l.Input,{})}),(0,r.jsx)(ed,{name:"event_setting_attributes.confirmation_message_button_link",hideLabel:!0,children:(0,r.jsx)(h.l.Input,{})})]})},tE=function(e){var t=e.event,n=(0,el.qo)({name:"event_setting_attributes.enable_custom_thank_you_message",defaultValue:(null==t?void 0:t.event_setting_attributes.enable_custom_thank_you_message)||!1}),i=(0,el.qo)({name:"event_setting_attributes.allow_non_members_to_rsvp",defaultValue:(null==t?void 0:t.event_setting_attributes.allow_non_members_to_rsvp)||!1}),a=c().setIsEmailNotificationsEnabled,s=(0,(0,el.Gc)().getValues)("event_setting_attributes.send_email_confirmation");return(0,o.useEffect)(function(){a(s)},[s]),(0,r.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,r.jsx)(g.Z.TitleXl,{children:(0,v.t)("events.edit_modal.notifications.title")}),(0,r.jsx)("div",{className:"mt-6 md:mb-3 md:mt-8",children:(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.notifications.publish")})}),(0,r.jsx)(ed,{name:"event_setting_attributes.send_publish_email",tooltipText:(0,v.t)("events.edit_modal.event_setting_attributes.send_publish_email_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.send_publish_email"})}),(0,r.jsx)("div",{className:"mt-6 md:mb-3 md:mt-8",children:(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.notifications.confirmation")})}),(0,r.jsx)(ed,{name:"event_setting_attributes.send_email_confirmation",tooltipText:i?(0,v.t)("events.edit_modal.event_setting_attributes.send_email_confirmation_disabled_tooltip"):(0,v.t)("events.edit_modal.event_setting_attributes.send_email_confirmation_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.send_email_confirmation",disabled:i})}),(0,r.jsx)(ed,{name:"event_setting_attributes.send_in_app_notification_confirmation",tooltipText:(0,v.t)("events.edit_modal.event_setting_attributes.send_in_app_notification_confirmation_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.send_in_app_notification_confirmation"})}),(0,r.jsx)(ed,{name:"event_setting_attributes.enable_custom_thank_you_message",tooltipText:(0,v.t)("events.edit_modal.event_setting_attributes.enable_custom_thank_you_message_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.enable_custom_thank_you_message"})}),n&&(0,r.jsx)(tT,{})]})},tR=n(370378),tD=n(744281),tL=function(e){var t=e.event,n=e.onClick,o=(0,tD.V)(t,j.a.PARTICIPANT,3),i=o.records,a=o.totalRecordCount,s=a||(0,v.t)("events.edit_modal.overview.zero");return(0,r.jsxs)("button",{type:"button",className:"border-primary flex size-full cursor-pointer flex-col justify-between rounded-lg border p-4",onClick:n,"aria-label":(0,v.t)("events.edit_modal.overview.rsvps"),children:[(0,r.jsxs)("div",{className:"mb-2 flex w-full items-start justify-between",children:[(0,r.jsx)(g.Z.LabelMd,{weight:"medium",color:"text-light",children:(0,v.t)("events.edit_modal.overview.rsvps")}),(0,r.jsx)(tR.v,{users:i,totalCount:a,size:"md"})]}),(0,r.jsx)(g.Z.TitleMd,{children:s})]})},tF=function(e){var t=e.event,n=e.onClick,o=(0,tD.V)(t,j.a.COHOST,3),i=o.records,a=o.totalRecordCount,s=a||(0,v.t)("events.edit_modal.overview.zero");return(0,r.jsxs)("button",{type:"button",className:"border-primary flex size-full cursor-pointer flex-col justify-between rounded-lg border p-4",onClick:n,"aria-label":(0,v.t)("events.edit_modal.overview.cohosts"),children:[(0,r.jsxs)("div",{className:"mb-2 flex w-full items-start justify-between",children:[(0,r.jsx)(g.Z.LabelMd,{weight:"medium",color:"text-light",children:(0,v.t)("events.edit_modal.overview.cohosts")}),(0,r.jsx)(tR.v,{users:i,totalCount:a,size:"md"})]}),(0,r.jsx)(g.Z.TitleMd,{children:s})]})},tU=n(664657),tB=n(285122),tq=function(e){var t=e.name,n=e.avatarUrl,o=e.email,i=e.rsvpDate,a=(0,tB.ie)(i,{year:"numeric",month:"short",day:"numeric"});return(0,r.jsxs)("tr",{children:[(0,r.jsxs)("td",{className:"flex items-center pt-6",children:[(0,r.jsx)("div",{className:"mr-4",children:(0,r.jsx)(tU.W,{name:t,src:n,size:"8"})}),(0,r.jsx)(g.Z.LabelSm,{weight:"semibold",color:"text-dark",children:t})]}),(0,r.jsx)("td",{className:"hidden pt-6 md:[display:revert]",children:(0,r.jsx)(g.Z.LabelSm,{color:"text-light",children:o})}),(0,r.jsx)("td",{className:"pt-6",children:(0,r.jsx)(g.Z.LabelSm,{color:"text-light",children:a})})]})},tz=function(){return(0,r.jsx)("div",{className:"flex h-64 w-full flex-col items-center justify-center",children:(0,r.jsx)(g.Z.TitleSm,{weight:"semibold",children:(0,v.t)("events.edit_modal.overview.empty_rsvp")})})},tZ=function(e){var t=e.event,n=(0,tD.V)(t,j.a.PARTICIPANT,10),o=n.isLoading,i=n.records;return(0,r.jsxs)("div",{className:"border-primary w-full rounded-lg border p-4",children:[(0,r.jsx)(g.Z.LabelMd,{weight:"medium",color:"text-light",children:(0,v.t)("events.edit_modal.overview.latest_rsvps")}),(null==i?void 0:i.length)>0&&(0,r.jsxs)("table",{className:"mt-6 w-full",children:[(0,r.jsxs)("thead",{className:"text-xxs text-light uppercase",children:[(0,r.jsx)("th",{children:(0,v.t)("events.edit_modal.overview.name")}),(0,r.jsx)("th",{className:"hidden md:[display:revert]",children:(0,v.t)("events.edit_modal.overview.email")}),(0,r.jsx)("th",{children:(0,v.t)("events.edit_modal.overview.rsvp_date")})]}),(0,r.jsx)("tbody",{children:i.map(function(e){return(0,r.jsx)(tq,{name:e.name,avatarUrl:e.avatar_url,email:e.email,rsvpDate:e.rsvp_date},e.id)})})]}),!o&&!(null==i?void 0:i.length)&&(0,r.jsx)(tz,{})]})},tV=n(952723),tH=function(e){var t,n,r=e.event,o=(0,el.Gc)(),i=o.formState.dirtyFields,a=(0,o.watch)(),s=a.name,l=a.event_setting_attributes,c=(null==i||null==(t=i.event_setting_attributes)?void 0:t.duration_in_seconds)||(null==i||null==(n=i.event_setting_attributes)?void 0:n.starts_at),u=r||{},d=u.event_setting_attributes,f=u.share_post_enabled,m=(null==l?void 0:l.starts_at)||(null==d?void 0:d.starts_at),p=c?(0,eI.ZX)(m,null==l?void 0:l.duration_in_seconds):null==d?void 0:d.ends_at,b=null==d?void 0:d.time_zone_abbreviations,h=null==d?void 0:d.time_zone,v=(0,tV.N)(m,h);return{name:s,startsAt:m,endsAt:p,timeZoneAbbreviations:b,timeZone:h,dayOfMonth:v.dayOfMonth,shortMonthString:v.shortMonthString,sharePostEnabled:f}},tW=n(915912),tQ=n.n(tW),tG=n(60878),t$=function(e){var t=e.label,n=void 0===t?(0,v.t)("share_link.label"):t,o=e.link,i=void 0===o?window.location.href:o,a=(0,tG.pm)().success;return(0,r.jsxs)("button",{type:"button",className:"flex cursor-pointer items-center",onClick:function(){tQ()(i),a((0,v.t)("share_link.copied"),{duration:"short",shouldUseProgress:!1})},children:[(0,r.jsx)(g.Z.LabelSm,{weight:"medium",children:n}),(0,r.jsx)(M.JO,{type:"16-copy",size:16,className:"ml-1","aria-hidden":!0})]})},tK=function(e){var t=e.event||{},n=t.slug,o=t.space_slug,i=(0,R.LM)({spaceSlug:o,slug:n}),a="".concat(window.location.origin).concat(i);return(0,r.jsx)(t$,{label:(0,v.t)("events.edit_modal.overview.copy_url"),link:a})},tJ=function(e){var t=e.event||{},n=t.share_uid,o=t.space_slug,i=(0,R.LM)({spaceSlug:o,slug:n}),a="".concat(window.location.origin).concat(i);return(0,r.jsx)(t$,{label:(0,v.t)("events.edit_modal.overview.copy_public_url"),link:a})},tX=function(e){var t,n,o,i=e.event,a=null==i||null==(t=i.event_setting_attributes)?void 0:t.live_stream_slug,s=null==i||null==(o=i.event_setting_attributes)||null==(n=o.live_stream_room_setting_attributes)?void 0:n.limit_url_sharing,l=R.dE.room({roomSlug:a}),c=window.location.origin;return a?(0,r.jsxs)("div",{className:"flex",children:[s?null:(0,r.jsx)(t$,{label:(0,v.t)("events.edit_modal.overview.copy_live_room_url"),link:c+l}),(0,j.L6)(i)&&(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)(t$,{label:(0,v.t)("events.edit_modal.overview.copy_live_stream_url"),link:c+R.dE.publicRoom({roomSlug:a})})})]}):null},tY=function(e){var t=e.event||{},n=t.slug,o=t.space_slug;return(0,r.jsxs)("button",{type:"button",className:"flex items-center",onClick:function(){window.open((0,R.LM)({spaceSlug:o,slug:n}),"_blank")},children:[(0,r.jsx)(g.Z.LabelSm,{weight:"medium",children:(0,v.t)("events.edit_modal.overview.view_event")}),(0,r.jsx)(M.JO,{type:"16-arrow-top-right",size:16,"aria-hidden":!0})]})},t0=function(e){var t=e.event,n=tH({event:t}),o=n.name,i=n.startsAt,a=n.endsAt,s=n.timeZoneAbbreviations,l=n.timeZone,c=n.dayOfMonth,u=n.shortMonthString,d=n.sharePostEnabled;return(0,f.kK)()?null:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Z.TitleXl,{children:o}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(M.JO,{type:"16-calendar",size:16,className:"mr-3"}),(0,r.jsx)(g.Z.LabelSm,{children:"".concat(u," ").concat(c," \xb7 ").concat((0,tB.Dk)(i,l)," - ").concat((0,tB.Dk)(a,l),"  ").concat(s)})]})}),(0,r.jsxs)("div",{className:"mt-7 flex items-center",children:[(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)(tY,{event:t})}),(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)(tK,{event:t})}),d&&(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)(tJ,{event:t})}),(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)(tX,{event:t})})]})]})},t1=function(e){var t=e.event,n=(0,m.eW)().setCurrentSection,o=function(){return n(j.SA.people)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t0,{event:t}),(0,r.jsxs)("div",{className:"my-4 flex flex-col items-stretch gap-4 md:my-6 md:flex-row",children:[(0,r.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-3",children:(0,r.jsx)(tL,{event:t,onClick:o})}),(0,r.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-3",children:(0,r.jsx)(tF,{event:t,onClick:o})})]}),(0,r.jsx)("div",{className:"mt-4 md:my-6",children:(0,r.jsx)(tZ,{event:t})})]})},t2=n(540432),t3=n(251630),t6=function(e){var t=e.event,n=(0,tG.pm)(),r=n.success,o=n.error,i=(0,T.useMutation)(function(){return t3.S1.downloadCSV({event:t})},{onSuccess:function(e){return r(null==e?void 0:e.message)},onError:function(){return o((0,v.t)("something_went_wrong"))}}).mutate;return function(e){e.preventDefault(),i()}},t5=function(e){var t=t6({event:e.event});return(0,r.jsxs)(S.z,{onClick:t,variant:"link",className:"!text-dark !flex !items-center !px-0 !text-sm !font-normal",children:[(0,r.jsx)("span",{className:"mr-2",children:(0,v.t)("events.edit_modal.people.download_csv")}),(0,r.jsx)(M.JO,{type:"download",size:20})]})},t4=n(310194),t7=function(){return(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(g.Z.LabelSm,{children:(0,v.t)("events.edit_modal.people.add_attendees_warning_message")})})},t9=function(e){var t=e.event,n=e.onSuccess,r=(0,tG.pm)(),o=r.success,i=r.error,a=(0,T.useQueryClient)();return{removeCohostMutation:(0,T.useMutation)(function(e){return t3.S1.removeAttendeeById({event:t,attendeeId:e})},{onSuccess:function(){o((0,v.t)("events.event_attendee_deleted")),a.invalidateQueries({queryKey:["events-people-cohost"]}),a.invalidateQueries({queryKey:["events-people-participant"]}),n&&n()},onError:function(){return i((0,v.t)("events.can_not_delete_event_attendee"))}})}},t8=function(e){var t=e.event,n=e.attendeeId,o=e.onRemove,i=e.accessType,a=e.setSelectedAttendeeId,s=e.setShouldShowAttendeeRemovalConfirmation,l=t9({event:t,onSuccess:function(){return o(n)}}).removeCohostMutation,c="invited"===i||!(0,j.yl)(t),u=function(e){c?l.mutate(e):(a(e),s(!0))},d=c?(0,v.t)("remove_member"):(0,v.t)("manage_attendee");return(0,r.jsx)(ez.Lt,{direction:"bottom-end",className:"flex justify-end",button:(0,r.jsx)(ez.Lt.MenuButton,{className:"invisible w-full group-hover:visible",children:(0,r.jsx)(M.JO,{type:"20-menu-dots-horizontal",size:20,className:"text-dark"})}),children:(0,r.jsx)(ez.Lt.Item,{onClick:function(){return u(n)},children:(0,r.jsx)(ez.Lt.ItemLink,{type:"button",children:d})})})},ne=n(647190),nt=n(111532),nn=n(434519),nr=function(e){var t=e.isOpen,n=e.onClose,o=e.removeAttendeeMutation,i=e.attendeeId,a=e.charge,s=(null==a?void 0:a.amount_to_refund_raw)>0,l=(0,nt.q)(),c=function(e){o(e),n()},u=function(){c(i)};return(0,r.jsxs)(nn.u_,{title:(0,v.t)("events.rsvp.remove_member_modal.title"),isOpen:void 0!==t&&t,onClose:n,children:[(0,r.jsx)(nn.u_.Overlay,{}),(0,r.jsxs)(nn.u_.Content,{children:[(0,r.jsxs)(nn.u_.Header,{children:[(0,r.jsx)(nn.u_.Title,{size:"md",className:"text-center",children:(0,v.t)("events.rsvp.remove_member_modal.title")}),(0,r.jsx)(nn.u_.HeaderActions,{children:(0,r.jsx)(nn.u_.CloseButton,{onClick:n})})]}),(0,r.jsx)(nn.u_.Body,{children:(0,r.jsx)("div",{className:"px-6 pb-4 pt-5 text-center",children:(0,r.jsx)(g.Z.BodyMd,{size:"text-sm",children:(0,v.t)("events.rsvp.remove_member_modal.description")})})}),(0,r.jsxs)(nn.u_.Footer,{className:"space-y-2",children:[(0,r.jsx)(S.z,{variant:"secondary",full:!0,large:!0,onClick:function(){return c(i)},className:"h-10",children:(0,v.t)("events.rsvp.remove_member_modal.remove_button")}),s&&(0,r.jsx)(S.z,{variant:"secondary",full:!0,large:!0,onClick:function(){return l.show({charge:a,onSuccess:n})},className:"h-10",children:(0,v.t)("events.rsvp.remove_member_modal.refund_button")}),s&&(0,r.jsx)(S.z,{variant:"danger",full:!0,large:!0,onClick:function(){return l.show({charge:a,onSuccess:u})},className:"h-10",children:(0,v.t)("events.rsvp.remove_member_modal.remove_and_refund_button")}),!s&&(0,r.jsx)(S.z,{variant:"secondary",full:!0,large:!0,onClick:n,className:"h-10",children:(0,v.t)("events.rsvp.remove_member_modal.decline_button")})]})]})]})},no=n(666403);function ni(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function na(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ni(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ni(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ns=function(e,t,n,r){if(e||r)return t?n?"yes":void 0:n?"yes":"invited"},nl=function(e){var t,n,i=e.records,a=e.event,s=e.onChange,l=t9({event:a,onSuccess:s}).removeCohostMutation,u=na((0,o.useState)(null),2),d=u[0],f=u[1],m=na((0,o.useState)(!1),2),p=m[0],b=m[1],h=(0,el.cl)().dirtyFields,v=(0,el.Gc)().getValues,y=c().isUpdatingAttendees,x=(null==(t=h.event_setting_attributes)?void 0:t.auto_rsvp_invited_attendees)!==void 0&&(null==(n=h.event_setting_attributes)?void 0:n.auto_rsvp_invited_attendees),_=v("event_setting_attributes.auto_rsvp_invited_attendees"),w=ns(x,(0,j.s9)(a),_,y);if(!(null==i?void 0:i.length))return null;var O=i.find(function(e){return e.id===d}),S=null==O?void 0:O.charge;return(0,r.jsxs)("div",{className:"flex w-full flex-col",children:[(null==i?void 0:i.length)>0&&(0,r.jsx)("hr",{}),null==i?void 0:i.map(function(e){var t=e.id,n=e.avatar_url,i=e.name,l=e.email,c=e.rsvp_date,u=e.rsvp_status,d=e.public_uid,m=e.access_type;return(0,r.jsxs)(o.Fragment,{children:[(0,r.jsxs)("div",{className:"hover:bg-secondary group flex h-14 items-center rounded-md px-2",children:[(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)(ne.o,{member:{name:i,public_uid:d},children:(0,r.jsx)(tU.W,{src:n,name:i,size:"8"})})}),(0,r.jsx)("div",{className:"w-1/2 shrink-0 md:w-1/3",children:(0,r.jsx)(ne.o,{member:{name:i,public_uid:d},children:(0,r.jsx)(er.Y,{children:(0,r.jsx)(g.Z.LabelSm,{weight:"semibold",children:i})})})}),(0,r.jsx)("div",{className:"hidden w-1/4 shrink-0 md:[display:revert]",children:(0,r.jsx)(er.Y,{children:(0,r.jsx)(g.Z.LabelSm,{children:l})})}),(0,r.jsx)("div",{className:"w-1/2 text-right md:w-1/4",children:(0,r.jsx)(g.Z.LabelSm,{children:(0,tB.ie)(c,{day:"numeric",month:"long",year:"numeric",timeZone:void 0})})}),(0,r.jsxs)("div",{className:"mx-2 flex w-24 shrink-0 justify-end",children:[w&&(0,r.jsx)(no.j,{rsvpStatus:w}),!w&&(0,r.jsx)(no.j,{rsvpStatus:u})]}),(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)(t8,{event:a,attendeeId:t,onRemove:s,accessType:m,setSelectedAttendeeId:f,setShouldShowAttendeeRemovalConfirmation:b})})]}),(0,r.jsx)("hr",{})]},t)}),(0,j.yl)(a)&&(0,r.jsx)(nr,{isOpen:p,onClose:function(){return b(!1)},removeAttendeeMutation:l.mutate,attendeeId:d,charge:S})]})},nc=n(998869);function nu(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var nd=function(e){var t=e.event,n=(0,tD.V)(t,j.a.PARTICIPANT),i=n.records,a=n.refetch,s=n.fetchPrevPage,l=n.fetchNextPage,u=n.hasPrevPage,d=n.hasNextPage,f=n.totalRecordCount,m=n.totalConfirmedRecordCount,p=n.addAttendeesAsync,b=n.startRecordNumber,y=n.endRecordNumber,x=(0,el.Gc)(),_=x.resetField,w=x.watch,O=c().setIsAutoRsvpInvitedAttendees,S=w("event_setting_attributes.auto_rsvp_invited_attendees");return(0,o.useEffect)(function(){O(S||!1)},[S,O]),(0,r.jsxs)("div",{className:"flex h-full flex-col items-stretch pt-4",children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)(g.Z.LabelMd,{weight:"semibold",children:"".concat(m||0," ").concat((0,v.t)("events.edit_modal.people.attendees"))}),(0,r.jsx)(ed,{name:"attendee_invite_attributes.invited_entities_ids",className:"!w-auto",hideLabel:!0,children:(0,r.jsx)(t4.l,{name:"attendee_invite_attributes.invited_entities_ids",variant:"button",buttonLabel:(0,v.t)("events.edit_modal.people.add_attendees"),selectionLabel:(0,v.t)("events.edit_modal.people.attendees_selection_label"),searchPlaceholder:(0,v.t)("events.edit_modal.people.attendees_placeholder"),modalSaveButtonLabel:(0,v.t)("save"),onModalSave:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:if(!e||"spaces_ids"in e&&!e.spaces_ids.length&&!e.space_groups_ids.length&&!e.member_tags_ids.length&&!e.members_ids.length)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,p({invited_entities_ids:e})];case 2:return t.sent(),_("attendee_invite_attributes.invited_entities_ids"),[3,4];case 3:return console.error(t.sent()),[3,4];case 4:return[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){nu(i,r,o,a,s,"next",e)}function s(e){nu(i,r,o,a,s,"throw",e)}a(void 0)})})()},renderAfterSelection:(0,r.jsx)(t7,{}),includeAllResultTypes:!0})})]}),(0,r.jsx)("div",{className:"mb-3 mt-2",children:(0,r.jsx)(ed,{name:"event_setting_attributes.auto_rsvp_invited_attendees",tooltipText:(null==t?void 0:t.disable_auto_rsvp_attendees)?(0,v.t)("events.edit_modal.event_setting_attributes.auto_rsvp_invited_attendees_tooltip_disabled"):(0,v.t)("events.edit_modal.event_setting_attributes.auto_rsvp_invited_attendees_tooltip"),inlineReverse:!0,className:"!pb-0",tooltipTextClassName:"text-center",labelClassName:(null==t?void 0:t.disable_auto_rsvp_attendees)?"text-tertiary":"",children:(0,r.jsx)(h.l.ToggleSwitch,{name:"event_setting_attributes.auto_rsvp_invited_attendees",variant:"small",disabled:null==t?void 0:t.disable_auto_rsvp_attendees})})}),(0,r.jsx)("div",{className:"mt-4"}),(null==i?void 0:i.length)>0&&(0,r.jsx)(nl,{event:t,records:i,onChange:a}),f>0&&(0,r.jsx)(nc.t,{startRecordNumber:b,endRecordNumber:y,totalRecordCount:f,fetchPrevPage:s,fetchNextPage:l,hasPrevPage:u,hasNextPage:d})]})},nf=function(e){var t=(0,(0,el.Gc)().watch)().event_setting_attributes,n=(e||{}).event_setting_attributes;return{locationType:(null==t?void 0:t.location_type)||(null==n?void 0:n.location_type),formEventData:t,eventData:n}},nm=n(101924);function np(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function nb(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var nh=function(e){var t,n=e.event,i=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return np(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return np(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],s=i[1],l=(0,tD.V)(n,j.a.COHOST),c=l.records,u=l.refetch,d=l.fetchPrevPage,f=l.fetchNextPage,m=l.hasPrevPage,p=l.hasNextPage,b=l.totalRecordCount,h=l.totalConfirmedRecordCount,y=l.addAttendeesAsync,x=l.startRecordNumber,_=l.endRecordNumber,w=(0,el.Gc)().resetField,O=nf(n).locationType,S=null==c?void 0:c.map(function(e){return e.community_member_id}),P=O===ek.Bq.LIVE_STREAM||O===ek.Bq.LIVE_ROOM;return(0,r.jsxs)("div",{className:"flex h-full flex-col items-stretch pt-4",children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)(g.Z.LabelMd,{weight:"semibold",children:"".concat(h||0," ").concat((0,v.t)("events.edit_modal.people.cohosts"))}),(0,r.jsx)(ed,{name:"attendee_invite_attributes.invited_cohost_ids",className:"!w-auto",hideLabel:!0,children:(0,r.jsx)(t4.l,{name:"attendee_invite_attributes.invited_cohost_ids",variant:"button",countLabel:(0,v.t)("events.edit_modal.people.cohosts_added_label"),selectionLabel:(0,v.t)("events.edit_modal.people.cohosts_selection_label"),searchPlaceholder:(0,v.t)("events.edit_modal.people.cohosts_placeholder"),disableSearch:a,excludedMemberIds:S,modalSaveButtonLabel:(0,v.t)("save"),allowCurrentCommunityMember:!0,onModalSave:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:if(!e)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,y({community_member_ids:e,role:j.a.COHOST})];case 2:return t.sent(),w("attendee_invite_attributes.invited_cohost_ids"),[3,4];case 3:return console.error(t.sent()),[3,4];case 4:return[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){nb(i,r,o,a,s,"next",e)}function s(e){nb(i,r,o,a,s,"throw",e)}a(void 0)})})()},renderAfterSelection:P?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t7,{}),(0,r.jsx)(nm.b,{setIsLimitReached:s,initialCohostQuantity:b+eB.ln,shouldDisplayDisabledSearchMessage:a})]}):(0,r.jsx)(t7,{})})})]}),(0,r.jsx)("div",{className:"mt-4"}),(null==c?void 0:c.length)>0&&(0,r.jsx)(nl,{event:n,records:c,onChange:u}),b>0&&(0,r.jsx)(nc.t,{startRecordNumber:x,endRecordNumber:_,totalRecordCount:b,fetchPrevPage:d,fetchNextPage:f,hasPrevPage:m,hasNextPage:p})]})},nv=function(e){var t=e.event,n=e.currentTab;switch(null==n?void 0:n.key){case j.n4.COHOSTS:return(0,r.jsx)(nh,{event:t});case j.n4.ATTENDEES:default:return(0,r.jsx)(nd,{event:t})}},ny=function(){var e,t=(0,ec.wh)(),n=t.currentCommunityMember,r=t.currentCommunitySettings,o=(0,ec.L2)().data,i=(0,eu.vb)(n),a=!!(null==o||null==(e=o.policies)?void 0:e.can_manage_space),s=null==r?void 0:r.allow_moderator_csv_download;return i||a&&s};function ng(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var nx=function(e){var t,n=[{label:(0,v.t)("events.edit_modal.people.attendees"),key:j.n4.ATTENDEES}];e||n.push({label:(0,v.t)("events.edit_modal.people.cohosts"),key:j.n4.COHOSTS});var r=n.find(function(e){return e.label===(0,v.t)("events.edit_modal.people.attendees")}),i=(t=(0,o.useState)(r),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return ng(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ng(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],s=i[1];return{tabs:n,currentTab:a,onTabClick:function(e){s(n.find(function(t){return t.label===e}))}}},n_=function(e){var t=e.event,n=nx((0,j.dy)(t)),o=n.onTabClick,i=n.currentTab,a=n.tabs,s=ny()&&(null==i?void 0:i.key)===j.n4.ATTENDEES;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Z.TitleXl,{children:(0,v.t)("events.create.form.people")}),(null==i?void 0:i.label)&&(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(t2.m,{variant:"underline",className:"sticky",wrapperClassName:"overflow-x-auto overflow-y-hidden",controlled:!0,activeTab:i.label,onClick:o,options:a}),s&&(0,r.jsx)("div",{className:"absolute bottom-2 right-0",children:(0,r.jsx)(t5,{event:t})})]}),(0,r.jsx)(nv,{event:t,currentTab:i})]})},nj=function(e){var t,n,i,a,s=e.event,l=e.triggerValidationRef,c=e.setValueRef,u=e.setIsDirty,d=e.setLocationType,f=e.setStartsAtDirty,p=e.setPaywallAttributesDirty,b=e.setRepeatsDirty,h=e.setFormScheduleValues,v=(0,m.eW)().currentSection,y=(0,el.Gc)(),g=y.trigger,x=y.setValue,_=y.formState.dirtyFields,w=(0,el.qo)({name:"event_setting_attributes.starts_at"}),O=(0,el.qo)({name:"event_setting_attributes.ends_at"}),S=(0,el.qo)({name:"recurring_setting_attributes.frequency"});(0,o.useEffect)(function(){var e,t,n,r=function(e){var t;return(null!=(t=Date)&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t)?e.toUTCString():e};h({startsAt:w||(null==s||null==(e=s.event_setting_attributes)?void 0:e.starts_at)||"",endsAt:r(O)||r(null==s||null==(t=s.event_setting_attributes)?void 0:t.ends_at)||"",frequency:S||(null==s||null==(n=s.recurring_setting_attributes)?void 0:n.frequency)||""})},[w,O,S,s,h]),(0,o.useEffect)(function(){l&&g&&(l.current=g)},[l,g]),(0,o.useEffect)(function(){c&&x&&(c.current=x)},[c,x]);var P=Object.values(_),C=!!(null==_||null==(t=_.event_setting_attributes)?void 0:t.starts_at),k=!!(null==_||null==(n=_.paywall_attributes)?void 0:n.price_amount)||!!(null==_||null==(i=_.paywall_attributes)?void 0:i.description),I=!!(null==_||null==(a=_.recurring_setting_attributes)?void 0:a.frequency);return(0,o.useEffect)(function(){u(null==P?void 0:P.some(function(e){return!!e}))},[u,P]),(0,o.useEffect)(function(){f(C)},[f,C]),(0,o.useEffect)(function(){p(k)},[p,k]),(0,o.useEffect)(function(){b(I)},[b,I]),(0,r.jsxs)("div",{className:"p-4 md:p-6 lg:py-8",children:[v===j.SA.overview&&(0,r.jsx)(t1,{event:s}),v===j.SA.people&&(0,r.jsx)(ec.mE,{spaceId:null==s?void 0:s.space_id,children:(0,r.jsx)(n_,{event:s})}),v===j.SA.basicInfo&&(0,r.jsx)(e8,{event:s,setLocationType:d}),v===j.SA.details&&(0,r.jsx)(tn,{}),v===j.SA.notifications&&(0,r.jsx)(tE,{event:s}),v===j.SA.email&&(0,r.jsx)(tA,{event:s}),v===j.SA.advancedOptions&&(0,r.jsx)(e_,{event:s})]})},nw=function(e){var t=e.event,n=e.isCreating,o=e.isDirty,i=e.onSubmit,a=e.isStartsAtDirty,s=e.shouldHideAllEventOption,l=e.isRepeatsDirty,c=e.formScheduleValues,u=(0,m.eW)(),d=u.isSaving,f=u.onExit;return(0,r.jsx)(r.Fragment,{children:!n&&(0,r.jsx)("div",{className:"ml-auto flex space-x-4",children:o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.z,{type:"button",onClick:f,variant:"secondary",children:(0,v.t)("cancel")}),(0,r.jsx)(J,{type:"submit",variant:"circle",disabled:d,onEditModeConfirm:i,event:t,isRecurringEvent:(0,j.f0)(t),isStartsAtDirty:a,isRepeatsDirty:l,shouldHideAllEventOption:s,formScheduleValues:c,children:t?(0,v.t)("save_changes"):(0,v.t)("save_draft")})]})})})},nO=function(){return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-52",children:[(0,r.jsx)("div",{className:"override-svg-width",children:(0,r.jsx)(e0.a,{})}),(0,r.jsx)("div",{className:"mb-4 text-center",children:(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.create_modal.creating_event")})}),(0,r.jsx)("div",{className:"mb-4 text-center",children:(0,r.jsx)(g.Z.LabelMd,{children:(0,v.t)("events.create_modal.creating_event_message")})})]})},nS={strategy:"fixed",modifiers:[{name:"offset",options:{offset:[0,-1]}}]},nP=function(e){var t,n=e||{},r=n.slug,o=n.space_slug,i=(0,tG.pm)().success,a=(0,R.LM)({spaceSlug:o,slug:r}),s="".concat(window.location.origin).concat(a),l=null==e||null==(t=e.event_setting_attributes)?void 0:t.live_stream_slug,c=R.dE.room({roomSlug:l}),u=window.location.origin;return{onViewEvent:function(){window.open(a,"_blank")},onCopyLink:function(e){tQ()(e),i((0,v.t)("share_link.copied"),{duration:"short",shouldUseProgress:!1})},eventUrl:s,liveRoomUrl:"".concat(u).concat(c),publicLiveRoomUrl:"".concat(u).concat(R.dE.publicRoom({roomSlug:l}))}},nC=function(e){var t,n=e.event,i=nP(n),a=i.onViewEvent,s=i.onCopyLink,l=i.eventUrl,c=i.liveRoomUrl,u=(null==n||null==(t=n.event_setting_attributes)?void 0:t.live_stream_slug)||"",d=window.location.origin+R.dE.publicRoom({roomSlug:u}),f=(0,j.dy)(n)?(0,v.t)("events.edit_modal.overview.copy_live_room_url"):(0,v.t)("events.edit_modal.overview.copy_live_stream_url"),m=(0,j.dy)(n)?c:d,p=[{label:(0,v.t)("events.edit_modal.overview.view_event"),onClick:a,iconName:"16-arrow"},{label:(0,v.t)("events.edit_modal.overview.copy_url"),onClick:function(){return s(l)},iconName:"16-copy"},{label:f,onClick:function(){return s(m)},iconName:"16-copy",disabled:!u}];return(0,r.jsx)(ez.Lt,{size:"medium",direction:"bottom-start",button:(0,r.jsx)(y.h,{name:"16-menu-dots-horizontal",className:"!text-dark",ariaLabel:(0,v.t)("options_dropdown")}),buttonWrapperClassName:"flex items-center ml-4",popperOptions:nS,transitionWrapperClassName:"z-30",dataTestId:"user-profile",children:p.map(function(e){return(0,r.jsx)(o.Fragment,{children:!e.disabled&&(0,r.jsx)(ez.Lt.ItemWithLink,{onClick:e.onClick,children:(0,r.jsxs)("div",{className:"text-dark flex items-center justify-between",children:[e.label,(0,r.jsx)(M.JO,{size:16,type:e.iconName,className:"text-dark"})]})})},e.label)})})},nk=function(e){var t,n,o,i,a,s,l,c,u,d,f=e.validateAndSetCurrentSection,p=e.event,b=e.isEditMode,h=e.title,y=(0,m.eW)(),x=y.sections,_=y.setCurrentSection,w=y.currentSection,O=x.filter(function(e){return e!==j.SA.overview}).map(function(e){return{value:e,label:e}}),S=function(e){f(e,_)},P=(0,j.s9)(p)?(0,v.t)("events.badge_status.published"):(0,v.t)("events.badge_status.draft"),C=(null==p||null==(t=p.event_setting_attributes)?void 0:t.starts_at)||"",k=(0,eI.ZX)(C,(null==p||null==(n=p.event_setting_attributes)?void 0:n.duration_in_seconds)||3600),I=w===j.SA.overview,N=(0,tV.N)(C,null==p||null==(o=p.event_setting_attributes)?void 0:o.time_zone),A=N.dayOfMonth,T=N.shortMonthString,E=null==p||null==(i=p.event_setting_attributes)?void 0:i.time_zone_abbreviations,R="".concat(null!=(l=null==A?void 0:A.toString())?l:""," ").concat(null!=T?T:""," ").concat((0,tB.Dk)(null!=C?C:new Date().toISOString(),null!=(c=null==p||null==(a=p.event_setting_attributes)?void 0:a.time_zone)?c:"")," - ").concat((0,tB.Dk)(null!=(u=k.toISOString())?u:new Date().toISOString(),null!=(d=null==p||null==(s=p.event_setting_attributes)?void 0:s.time_zone)?d:""),",").concat(null!=E?E:"");return I?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mb-4 mt-5 flex flex-col gap-2 px-5",children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[b&&(0,r.jsx)(en.g,{label:P}),(0,r.jsx)(nC,{event:p})]}),(0,r.jsx)(g.Z.TitleSm,{truncate:!0,weight:"semibold",children:h}),(0,r.jsx)(g.Z.LabelSm,{weight:"font-semibold",children:R})]}),(0,r.jsx)("div",{className:"flex flex-col px-5",children:O.map(function(e){return(0,r.jsxs)("button",{type:"button",className:"border-b-primary text-default flex items-center justify-between border-b py-3 text-sm",onClick:function(){return S(e.value)},children:[e.label,(0,r.jsx)(M.JO,{size:16,type:"16-chevron-right",className:"text-default size-4"})]},e.label)})})]}):null},nI=n(838603),nN=function(e){var t,n,r=e.event,o=e.spaceId,i=e.locationType,a=(0,ec.wh)(),s=a.currentUser,l=a.currentCommunity,c=(0,ew.m)().spaces.find(function(e){return e.id===(o||(null==r?void 0:r.space_id))})||null,u=["private","secret"].includes((null==c?void 0:c.visibility)||""),d=(0,eI.TP)(new Date),f=(0,eI.ZX)(d.toISOString(),3600);return r?(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},r),n=n={body:r.body_for_editor,attendee_invite_attributes:{invited_entities_ids:null}},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t):{user_id:null==s?void 0:s.id,space_id:null!=o?o:void 0,event_type:j.E_.SINGLE,status:j.Q_.DRAFT,event_setting_attributes:{auto_rsvp_invited_attendees:(null==c?void 0:c.event_auto_rsvp_enabled)||!1,location_type:i,starts_at:d.toUTCString(),ends_at:f.toUTCString(),duration_in_seconds:3600,allow_non_members_to_rsvp:!1,live_stream_room_setting_attributes:{access_type:u?eB._d.SECRET:eB._d.OPEN,view_type:eB.Bk.GRID,recording_enabled:(null==l?void 0:l.live_stream_recording_enabled)||!1,auto_post_recording_enabled:(null==l?void 0:l.live_stream_recording_enabled)||!1,room_type:eB.H0.STREAM,mute_on_join:!1,hide_participants_list:!1,limit_url_sharing:!1},send_email_confirmation:!0,send_in_app_notification_confirmation:!0,send_email_reminder:!0,send_in_app_notification_reminder:!0,send_publish_email:!0,ticket_type:j.Mj.FREE},recurring_setting_attributes:{range_type:j.pd.ON,occurrences:null,ends_at:f.toUTCString()}}},nA=n(903225),nM=n(757105),nT=n(266205),nE=n(497202),nR=n(57851),nD=n(390431),nL=n(431089),nF=n(537291),nU="events.connection_modal",nB=nM.gk.create(function(e){var t=e.eventId,n=e.spaceName,o=(0,nE.dd)(),i=(0,nF.x)(),a=i.onSendAnnouncement,s=i.isLoading;return(0,r.jsx)(nD.o,{isOpen:o.visible,onClose:o.hide,title:(0,v.t)([nU,"title"]),description:(0,v.t)([nU,"description"],{space_name:n}),isLoading:s,"data-testid":"event-momentum-modal",children:(0,r.jsx)("div",{className:"flex flex-col gap-y-10",children:(0,r.jsx)(nR.X,{children:(0,r.jsx)(nL.K,{iconEl:(0,r.jsx)(M.JO,{type:"20-page-edit-text",size:20}),onClick:function(){a({eventId:t,onSuccess:function(){o.hide()}})},disabled:s,"data-testid":"send-announcement-event-button",children:(0,v.t)([nU,"review_draft"])})})})})}),nq=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,T.useMutation)(function(t){var n,r;return e?t3.S1.update({event:e,formData:(n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},t),r=r={event_type:e.event_type},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(r)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}),n),forReactQuery:!0}):t3.S1.create({formData:t,forReactQuery:!0})})};function nz(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function nZ(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var nV="force_dirty",nH=function(e){var t=e.onClose,n=e.event,r=e.isDirty,i=e.isEditMode,a=e.setEvent,s=e.shouldClearEventStateOnHide,l=e.onEventChange,u=(0,nA.k6)(),d=(0,ec.wh)().currentCommunityMember,f=(0,tG.pm)(),m=f.success,p=f.error,b=(0,nT.q)(),h=(0,nA.TH)().pathname,y=nq(n),g=!n&&y.isLoading,x=c().setIsUpdatingAttendees,_=(0,eu.vb)(d),w=(0,o.useRef)(null),O=(0,o.useRef)(null),S="/events"===h,P=function(e){void 0!==e&&(!(0,j.s9)(n)||e)&&x(!0)},C=function(e,r){if(m(n?(0,v.t)("events.saved_successfully"):(0,v.t)("events.created_successfully")),b({shouldInvalidateAllEvents:S}),S&&l(n),k(e)){if(t(),a(null),I(e),_)return void nM.gk.show(nB,{eventId:e.id,spaceName:e.space_name})}else N(e,r)},k=function(e){return(null==n?void 0:n.status)===j.Q_.DRAFT&&(null==e?void 0:e.status)===j.Q_.PUBLISHED},I=function(e){u.push(R.xu.show({spaceSlug:e.space_slug,slug:e.slug}))},N=function(e,t){t(nZ(nz({},e),{body:e.body_for_editor})),a(e)},A=function(){p(n?(0,v.t)("events.save_error"):(0,v.t)("events.create_error"))},M=function(e){var t;(null!=(t=Error)&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t)&&console.error(e.message)},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j.HA.CURRENT;w.current&&O.current&&(w.current("recurring_setting_attributes.edit_mode",e,{shouldDirty:!0}),w.current(nV,!0,{shouldDirty:!0}),O.current())};return{handleClose:function(){(!r||confirm((0,v.t)("events.edit_modal.close_warning")))&&(t(),s&&a(null))},onSubmit:function(e,t){var r=t.reset;try{var o,a,s,l,c=null==n?void 0:n.event_type;if(i?delete e[nV]:c=e.recurring_setting_attributes.frequency?j.E_.RECURRING:j.E_.SINGLE,i?null==e||null==(o=e.paywall_attributes)?void 0:o.price_amount:(0,j.yl)(e)){var u=e.paywall_attributes.price_amount,d=(0,e1.LG)(u);e.paywall_attributes.price_amount=d}!i&&(null==e||null==(a=e.event_setting_attributes)?void 0:a.ticket_type)==j.Mj.PAID&&[j.Bq.LIVE_ROOM,j.Bq.LIVE_STREAM].includes(null==e||null==(s=e.event_setting_attributes)?void 0:s.location_type)&&(e.event_setting_attributes.live_stream_room_setting_attributes.access_type=eB._d.SECRET);var f=null==e||null==(l=e.event_setting_attributes)?void 0:l.auto_rsvp_invited_attendees;P(f),y.mutate(nZ(nz({},e),{event_type:c}),{onSuccess:function(e){return C(e,r)},onError:A})}catch(e){M(e)}},onSave:T,onPublish:function(e){w.current&&w.current("status",j.Q_.PUBLISHED,{shouldDirty:!0}),T(e)},isCreating:g,setValueRef:w,triggerFormSubmitRef:O,mutation:y}};function nW(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function nQ(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return nW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nW(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var nG=function(e){var t,n=e.onClose,r=e.event,i=e.spaceId,a=e.locationType,s=e.shouldClearEventStateOnHide,l=nQ((0,o.useState)(r||null),2),c=l[0],u=l[1],d=!!r&&(0,eI.aA)(null==(t=r.event_setting_attributes)?void 0:t.ends_at),f=(0,nI.vk)({params:{past_events:d}}).onEventChange;(0,o.useEffect)(function(){u(r||null)},[r]);var m=!!c,p=m?c.name:(0,v.t)("events.create.title"),b=nN({event:c,spaceId:i,locationType:a}),h=nQ((0,o.useState)(!1),2),y=h[0],g=h[1],x=nQ((0,o.useState)(!1),2),w=x[0],O=x[1],S=nQ((0,o.useState)(!1),2),P=S[0],C=S[1],k=nQ((0,o.useState)(!1),2),I=k[0],N=k[1],A=nQ((0,o.useState)(a),2),M=A[0],T=A[1],E=_(),R=E.triggerValidationRef,D=E.validateAndSetCurrentSection,L=M===ek.Bq.LIVE_STREAM||M===ek.Bq.LIVE_ROOM,F=(0,j.f0)(c)&&P,U=nH({onClose:n,event:c,isDirty:y,isEditMode:m,setEvent:u,shouldClearEventStateOnHide:void 0!==s&&s,onEventChange:f}),B=U.handleClose,q=U.onSubmit,z=U.onSave,Z=U.onPublish,V=U.setValueRef,H=U.triggerFormSubmitRef,W=U.mutation;return{event:c,isEditMode:m,isCreating:U.isCreating,isDirty:y,isStartsAtDirty:w,locationType:M,setLocationType:T,isLiveLocation:L,handleClose:B,onSubmit:q,onSave:z,onPublish:Z,setValueRef:V,triggerFormSubmitRef:H,triggerValidationRef:R,validateAndSetCurrentSection:D,formDefaultValues:b,title:p,mutation:W,setIsDirty:g,setStartsAtDirty:O,shouldHideAllEventOption:F,setPaywallAttributesDirty:C,isRepeatsDirty:I,setRepeatsDirty:N}};function n$(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var nK=function(e){var t,n=e.isOpen,a=e.onClose,s=e.event,l=e.spaceId,c=e.locationType,u=e.shouldClearEventStateOnHide,v=e.initialSection,y=void 0===v?j.SA.basicInfo:v,g=(t=(0,o.useState)({startsAt:"",endsAt:"",frequency:""}),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return n$(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return n$(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),x=g[0],_=g[1],w=nG({spaceId:l,event:s,shouldClearEventStateOnHide:void 0!==u&&u,locationType:c,onClose:a}),O=w.event,S=w.isEditMode,P=w.isCreating,C=w.isDirty,k=w.isStartsAtDirty,I=w.setLocationType,N=w.setValueRef,A=w.triggerFormSubmitRef,M=w.formDefaultValues,T=w.title,E=w.handleClose,R=w.onSubmit,D=w.onSave,L=w.onPublish,F=w.validateAndSetCurrentSection,U=w.triggerValidationRef,B=w.setIsDirty,q=w.setStartsAtDirty,z=w.mutation,Z=w.setPaywallAttributesDirty,V=w.shouldHideAllEventOption,H=w.setRepeatsDirty,W=w.isRepeatsDirty,Q=(0,f.kK)();return(0,r.jsxs)(r.Fragment,{children:[!Q&&(0,r.jsx)(b.o,{onClick:E,className:"z-[1100]",isVisible:n}),(0,r.jsx)(p.x,{isOpen:n,shouldShowCloseButton:!1,contentPortalId:"events",onClose:i.noop,children:(0,r.jsxs)(m.MW,{formId:"events",sections:Object.values(j.SA),initialSection:Q&&S?j.SA.overview:y,title:T,onExit:E,onSave:function(e){return R(e,{})},isSaving:z.isLoading,children:[(0,r.jsx)(p.x.Header,{className:(0,d.A)("!px-5 !py-3 md:!px-6 md:!py-5",{"!border-0":P}),children:(0,r.jsx)(es,{isEditMode:S,isCreating:P,event:O,onPublish:L,handleClose:E,validateAndSetCurrentSection:F})}),(0,r.jsxs)(p.x.Body,{children:[Q&&(0,r.jsx)(nk,{validateAndSetCurrentSection:F,event:s,isEditMode:S,title:T}),(0,r.jsxs)(h.l,{id:"events",onSubmit:R,passThroughProps:{onCancel:E},defaultValues:M,triggerFormSubmitRef:A,submitDirtyOnly:S,children:[!P&&(0,r.jsx)(nj,{event:O,triggerValidationRef:U,setValueRef:N,setIsDirty:B,setLocationType:I,setStartsAtDirty:q,setPaywallAttributesDirty:Z,setRepeatsDirty:H,setFormScheduleValues:_}),P&&(0,r.jsx)(nO,{}),Q&&(0,r.jsx)(Y,{event:O,onPublish:L})]})]}),(0,r.jsx)(p.x.Footer,{className:(0,d.A)({"!border-0 !p-0":P||!C}),children:(0,r.jsx)(nw,{event:O,isCreating:P,isDirty:C,onSubmit:D,isStartsAtDirty:k,shouldHideAllEventOption:V,isRepeatsDirty:W,formScheduleValues:x})})]})})]})};function nJ(){return(nJ=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var nX=function(e){var t=nJ({},function(e){if(null==e)throw TypeError("Cannot destructure "+e);return e}(e));return(0,r.jsx)(u,{children:(0,r.jsx)(nK,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},t))})}},58664:function(e,t,n){n.d(t,{I:()=>i});var r=n(552676),o=n(701168),i=function(e){var t=e.label,n=e.value,i=e.placeholder,a=e.error,s=e.disabled,l=e.leftAddon,c=e.rightAddon,u=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["label","value","placeholder","error","disabled","leftAddon","rightAddon"]);return(0,r.jsxs)("div",{children:[t&&(0,r.jsx)("div",{className:"text-sm font-semibold",children:t}),(0,r.jsxs)("div",{className:"mt-2 flex w-full",children:[l&&(0,r.jsx)("div",{className:(0,o.A)({"cursor-not-allowed bg-gray-50":s},"flex h-11 items-center rounded-l-lg border border-gray-300 bg-white px-4 py-3"),children:l}),(0,r.jsx)("input",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:(0,o.A)("placeholder:text-light h-11 grow rounded-lg border border-solid px-4 py-3 outline-none placeholder:opacity-100 focus:border-2 focus:border-gray-500",{"border-red-600 focus:border-red-600":a,"border-primary bg-secondary text-light cursor-not-allowed":s,"text-dark border-gray-400":!s,"rounded-l-none":l,"rounded-r-none":c}),value:n,placeholder:i,disabled:s},u)),c&&(0,r.jsx)("div",{className:(0,o.A)({"border-primary bg-secondary text-light cursor-not-allowed":s},"bg-primary border-primary text-dark ml-[-1px] flex h-11 items-center rounded-r-lg border px-4 py-3"),children:c})]}),a&&(0,r.jsx)("div",{className:"mt-2 text-sm text-red-600",children:a})]})}},571807:function(e,t,n){n.d(t,{x:()=>l});var r=n(552676),o=n(383294),i=n(230967),a=n(660512),s=n(619347),l=function(e){var t,n,l=e.position,c=e.children,u=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["position","children"]),d=(0,a.x)().shouldShowRailBar,f=document.querySelector("#rail-bar-".concat(void 0===l?"header":l));return f?(0,r.jsx)(r.Fragment,{children:(0,i.createPortal)((0,r.jsx)(o.J,{children:(0,r.jsx)(o.J.Panel,{as:"div",static:void 0===d||d,children:(0,r.jsx)(s.S0,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},u),n=n={children:c},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))})}),f)}):null}},709397:function(e,t,n){n.d(t,{i:()=>c});var r=n(552676),o=n(664657),i=n(756993),a=n(701168),s=n(22319),l=n(381636),c=function(e){var t=e.avatarUrl,n=e.name,c=e.progress,u=e.level,d=e.size,f=void 0===d?"large":d,m=(0,s.TC)().isDarkAppearance,p="large"===f?104:64,b=(p-4)/2,h=2*Math.PI*b,v=h-(void 0===c?0:c)/100*h,y=(0,i.O)(u||1);return(0,r.jsxs)("div",{className:"relative flex items-center justify-center rounded-full",style:{height:p,width:p},children:[(0,r.jsxs)("svg",{className:"absolute",width:p,height:p,style:{transform:"rotate(-90deg)"},children:[(0,r.jsx)("circle",{cx:p/2,cy:p/2,r:b,stroke:m?"#42464D":"#F0F3F5",strokeWidth:4,fill:"none"}),(0,r.jsx)("circle",{cx:p/2,cy:p/2,r:b,stroke:y.progress,strokeWidth:4,fill:"none",strokeDasharray:h,strokeDashoffset:v,strokeLinecap:"round"})]}),(0,r.jsx)("div",{className:"bg-secondary absolute z-0 rounded-full",style:{height:p-8,width:p-8},children:(0,r.jsx)(o.W,{isFullRounded:!0,src:t,name:n,size:"large"===f?"24":"14"})}),u&&(0,r.jsx)("div",{className:(0,a.A)("absolute -bottom-1 -right-1 z-10 flex items-center justify-center rounded-full",{"h-8 w-8":"large"===f,"h-6 w-6":"small"===f},y.bg),children:(0,r.jsx)(l.Z.LabelSm,{weight:"bold",children:(0,r.jsx)("span",{className:y.text,children:u})})})]})}},737840:function(e,t,n){n.d(t,{U:()=>l});var r=n(552676),o=n(739792),i=n(756993),a=n(701168),s=n(381636),l=function(e){var t=e.level,n=e.levelName,l=(0,i.O)(t);return(0,r.jsxs)("div",{className:(0,a.A)("mb-2 inline-flex items-center space-x-3 rounded-full px-3 py-1",l.bg,l.text),children:[(0,r.jsxs)(s.Z.LabelSm,{weight:"semibold",color:"text-inherit",children:[(0,r.jsx)("span",{className:"mr-2",children:(0,o.t)("leaderboard.trophy_emoji")}),(0,o.t)("leaderboard.level_number_only",{level:t})]}),(0,r.jsx)("div",{className:(0,a.A)("h-3 w-px rounded-md",l.divider)}),(0,r.jsx)(s.Z.LabelSm,{weight:"semibold",color:"text-inherit",children:n||(0,o.t)("leaderboard.level_n",{level:t})})]})}},756993:function(e,t,n){n.d(t,{O:()=>c});var r=n(22319),o={light:{basic:"bg-[#F8EFDD] text-[#D69B29]",mid:"bg-[#EAEDFD] text-[#506CF0]",pro:"bg-[#F5ECFC] text-[#AC61E7]"},dark:{basic:"bg-[#443E32] text-[#E2AB40]",mid:"bg-[#31374E] text-[#7A91FD]",pro:"bg-[#3E354D] text-[#CF93FF]"}},i={light:{basic:"text-[#D69B29]",mid:"text-[#506CF0]",pro:"text-[#AC61E7]"},dark:{basic:"text-[#E2AB40]",mid:"text-[#7A91FD]",pro:"text-[#CF93FF]"}},a={light:{basic:"bg-[#F4E3C1]",mid:"bg-[#D1D8FB]",pro:"bg-[#E9D6F9]"},dark:{basic:"bg-[#6C624E]",mid:"bg-[#4D577B]",pro:"bg-[#5D4278]"}},s={light:{basic:"#D69B29",mid:"#506CF0",pro:"#AC61E7"},dark:{basic:"#E2AB40",mid:"#7A91FD",pro:"#CF93FF"}},l={light:{basic:"bg-gradient-to-b from-[#F8EFDD] to-transparent",mid:"bg-gradient-to-b from-[#EAEDFD] to-transparent",pro:"bg-gradient-to-b from-[#F5ECFC] to-transparent"},dark:{basic:"bg-gradient-to-b from-[#443E32] to-transparent",mid:"bg-gradient-to-b from-[#31374E] to-transparent",pro:"bg-gradient-to-b from-[#3E354D] to-transparent"}},c=function(e){var t=(0,r.TC)().isDarkAppearance,n=e&&!(e<=3)?e<=6?"mid":"pro":"basic",c=t?"dark":"light";return{bg:o[c][n],text:i[c][n],divider:a[c][n],progress:s[c][n],bgGradient:l[c][n]}}},391150:function(e,t,n){n.d(t,{b:()=>u});var r=n(552676),o=n(227851),i=n(739792),a=n(437588),s=n(957363),l=n(943544),c=n(381636),u=function(e){var t=e.name,n=e.roomType,u=void 0===n?a.H0.STREAM:n,d=(0,o.Gc)().control,f=[{value:a.Bk.GRID,label:(0,i.t)("live_streams.form.view_type_grid"),icon:"gallery-view",description:(0,r.jsx)(c.Z.LabelSm,{children:(0,i.t)("live_streams.form.".concat(u,".view_type_description_grid"))})},{value:a.Bk.SPEAKER,label:(0,i.t)("live_streams.form.view_type_speaker"),icon:"speaker-view",description:(0,r.jsx)(c.Z.LabelSm,{children:(0,i.t)("live_streams.form.".concat(u,".view_type_description_speaker"))})}];return(0,r.jsx)(o.Qr,{control:d,name:void 0===t?"":t,render:function(e){var t,n=e.field,o=n.onChange,i=(t=n.value,f.find(function(e){return e.value===t}));return(0,r.jsx)(l.Lt,{direction:"bottom-start",linkType:"button",button:(0,r.jsx)(l.Lt.MenuButton,{className:"form-control relative inline-block w-full text-left",children:(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(s.JO,{type:null==i?void 0:i.icon,className:"ml-1 mr-2 flex"}),(0,r.jsx)(c.Z.LabelMd,{children:null==i?void 0:i.label})]}),(0,r.jsx)("div",{className:"flex content-end",children:(0,r.jsx)(s.JO,{type:"cheveron-down",className:"ml-1 mr-2"})})]})}),buttonClassName:"w-full",className:"relative w-full",size:l.wk.EXTRA_LARGE,onChange:o,options:f,labelWeight:"semibold"})}})}},3255:function(e,t,n){n.d(t,{K:()=>s});var r=n(552676),o=n(701168),i=n(380171),a=n(39905),s=function(e){var t=e.variant,n=void 0===t?"icon-only":t,s=e.isActive,l=e.tooltipText,c=e.onClick,u=e.children,d=e.disabled;return(0,r.jsx)(i.T,{placement:"top",content:l,enabled:!!l,className:"inline-block",children:(0,r.jsx)(a.z,{variant:"secondary",small:!0,isFullRounded:!0,className:(0,o.A)("flex h-7 items-center justify-center font-semibold",{"w-7 !p-0":"icon-only"===n,"!px-3":"text-only"===n,"!bg-v2-success/10 !border-v2-success/20 text-v2-success":s,"!border-primary":!s}),onClick:c,disabled:void 0!==d&&d,children:u})})}},167518:function(e,t,n){n.d(t,{U:()=>a});var r=n(552676),o=n(739792),i=n(381636),a=function(e){var t=e.isQueuedForSpotlight;return(0,r.jsx)("div",{className:"mb-1.5",children:(0,r.jsx)(i.Z.LabelXxs,{weight:"semibold",color:"text-very-dark",textTransform:"uppercase",children:t?(0,o.t)("live_streams.room.qa.questions.queued_up"):(0,o.t)("live_streams.room.qa.questions.spotlighted")})})}},808819:function(e,t,n){n.d(t,{f:()=>s});var r=n(131906),o=n(739792),i=n(56608),a=n(60878),s=function(e){var t=e.chatUuid,n=(0,a.pm)(),s=(0,r.useMutation)(function(e){return i.M.spotlightMessage(t,e)},{onSuccess:function(){n.success((0,o.t)("messaging.actions.spotlight_success"))},onError:function(){n.error((0,o.t)("messaging.actions.spotlight_error"))}}),l=s.mutateAsync,c=s.isLoading,u=(0,r.useMutation)(function(e){return i.M.removeSpotlightMessage(t,e)},{onError:function(){n.error((0,o.t)("messaging.actions.remove_spotlight_error"))}});return{spotlightMessage:l,isSpotlightingMessage:c,removeSpotlightMessage:u.mutateAsync,isRemovingSpotlightMessage:u.isLoading}}},534811:function(e,t,n){n.d(t,{CH:()=>a,E1:()=>f,Fp:()=>i,O_:()=>s,SF:()=>o,X2:()=>d,dF:()=>l,fm:()=>c,nX:()=>u,w5:()=>r});var r="default",o=8,i=4,a=2,s=16,l=6,c=2,u=16,d=2,f=6},7447:function(e,t,n){n.d(t,{ch:()=>o.ch,vi:()=>o.vi,if:()=>a,O_:()=>s.O_,zl:()=>o.zl,iZ:()=>o.iZ,QW:()=>o.QW,zD:()=>o.zD,Ft:()=>i,bJ:()=>o.bJ,I7:()=>o.I7,EY:()=>o.EY,fm:()=>s.fm,aW:()=>o.aW,X2:()=>s.X2,E1:()=>s.E1,Sl:()=>o.Sl,O4:()=>o.O4,wV:()=>o.wV,YK:()=>o.YK,y:()=>o.y,bR:()=>o.bR,W4:()=>o.W4,nX:()=>s.nX,Hj:()=>o.Hj,fC:()=>o.fC,Le:()=>o.Le,sO:()=>o.sO,OF:()=>o.OF,SK:()=>o.SK,TQ:()=>o.TQ,IQ:()=>o.IQ,P$:()=>o.P$,I3:()=>r.I,w5:()=>s.w5,CH:()=>s.CH,oe:()=>o.oe,SI:()=>o.SI,tS:()=>o.tS});var r=n(845024),o=n(293253),i=function(){return(0,r.I)(function(e){return e.settingsActions})},a=function(){var e,t,n=(0,r.I)(o.fC),i=(0,r.I)(o.yU),a=(0,r.I)(o.i$),s=(0,r.I)(o.XT);return e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},n),t=t={isChatSelected:i,isParticipantsSelected:a,isQASelected:s},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e},s=n(534811)},293253:function(e,t,n){n.d(t,{EY:()=>E,Hj:()=>F,I7:()=>c,IQ:()=>f,Le:()=>k,O4:()=>M,OF:()=>y,P$:()=>D,QW:()=>P,SI:()=>N,SK:()=>T,Sl:()=>v,TQ:()=>L,W4:()=>A,XT:()=>w,YK:()=>p,aW:()=>O,bJ:()=>U,bR:()=>C,ch:()=>R,fC:()=>x,i$:()=>j,iZ:()=>u,oe:()=>h,sO:()=>b,tS:()=>l,vi:()=>s,wV:()=>m,y:()=>g,yU:()=>_,zD:()=>S,zl:()=>d});var r=n(534811),o=n(357836);function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var s=function(e){return e.settings||{}},l=function(e){var t;return null==(t=e.settings)?void 0:t.audioInputId},c=function(e){var t;return null==(t=e.settings)?void 0:t.audioOutputId},u=function(e){var t;return null==(t=e.settings)?void 0:t.videoInputId},d=function(e){var t;return null==(t=e.settings)?void 0:t.blurEnabled},f=function(e){var t;return null==(t=e.settings)?void 0:t.mirrorEnabled},m=function(e){var t;return null==(t=e.settings)?void 0:t.microphoneEnabled},p=function(e){var t;return null==(t=e.settings)?void 0:t.cameraEnabled},b=function(e){var t;return null==(t=e.settings)?void 0:t.noiseSuppression},h=function(e){var t;return null==(t=e.settings)?void 0:t.gridLayoutPageSize},v=function(e){var t;return null==(t=e.settings)?void 0:t.speakerLayoutPageSize},y=function(e){var t;return(null==(t=e.settings)?void 0:t.pipLayoutPageSize)||r.Fp},g=function(e){var t;return null==(t=e.settings)?void 0:t.infinityMirrorAlertDisabled},x=function(e){return e.ui},_=function(e){var t;return(null==(t=e.ui)?void 0:t.currentTab)===o.G7.CHAT},j=function(e){var t;return(null==(t=e.ui)?void 0:t.currentTab)===o.G7.PARTICIPANTS},w=function(e){var t;return(null==(t=e.ui)?void 0:t.currentTab)===o.G7.QA},O=function(e){var t;return null==(t=e.ui)?void 0:t.pipViewMode},S=function(e){var t;return(null==(t=e.session)?void 0:t.spectators)||{}},P=function(e){var t;return(null==(t=e.session)?void 0:t.preJoinChecklist)||{}},C=function(e){return e.qa.session},k=function(e){var t,n=e.qa.upvotedQuestionIds||[];return(null==(t=e.qa.questions)?void 0:t.map(function(e){return a(i({},e),{upvoted_by_current_contact:n.includes(e.id)})}))||[]},I=function(e,t){var n=e.qa.upvotedQuestionIds||[],r=e.qa.questions.find(function(e){return e.id===t});return r?a(i({},r),{upvoted_by_current_contact:n.includes(t)}):null},N=function(e){var t=e.qa.replyingQuestionId;return t?I(e,t):null},A=function(e){return e.qa.replies||[]},M=function(e){return e.qaActions||{}},T=function(e){return e.qa.filterByStatus},E=function(e){return e.qa.sortBy},R=function(e){var t;return(null==(t=e.qa.pendingQuestionIds)?void 0:t.length)||0},D=function(e){return e.spotlightActions||{}},L=function(e){var t;return null==(t=e.spotlight.items)?void 0:t[0]},F=function(e){return e.telemetry.actions||{}},U=function(e){return e.telemetry.data||{}}},106223:function(e,t,n){n.d(t,{R:()=>i,r:()=>c});var r=n(433251),o=n(494571),i={POPULAR:"popular",LATEST:"latest",OLDEST:"oldest"},a=[o.d.APPROVED,o.d.ANSWERED,o.d.UNANSWERED],s=function(e,t){return t===o.d.APPROVED&&a.includes(e.status)||e.status===t},l=function(e,t){switch(t){case"latest":return e.sort(function(e,t){var n=new Date(t.approved_at||t.created_at),r=new Date(e.approved_at||e.created_at);return n.getTime()-r.getTime()});case"oldest":return e.sort(function(e,t){var n=new Date(t.approved_at||t.created_at);return new Date(e.approved_at||e.created_at).getTime()-n.getTime()});case"popular":return e.sort(function(e,t){return t.upvotes_count-e.upvotes_count});default:return e}},c=(0,r.n)(function(e,t){return{qa:{session:null,questions:[],filterByStatus:o.d.APPROVED,sortBy:i.LATEST,replyingQuestionId:null,replies:[],upvotedQuestionIds:[],pendingQuestionIds:[]},qaActions:{setSession:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t().qa.session;e(function(e){r.setInitialFilter&&!i&&(null==n?void 0:n.enabled)&&((null==n?void 0:n.has_pending_questions)?e.qa.filterByStatus=o.d.PENDING:e.qa.filterByStatus=o.d.APPROVED),e.qa.session=n})},setQuestions:function(t){return e(function(e){e.qa.questions=t;var n=t.filter(function(e){return e.upvoted_by_current_contact}).map(function(e){return e.id}),r=new Set(e.qa.upvotedQuestionIds);n.forEach(function(e){return r.add(e)}),e.qa.upvotedQuestionIds=Array.from(r)})},setFilterToSee:function(e){s(e,t().qa.filterByStatus)||t().qaActions.setFilterByStatus(e.status)},addQuestion:function(n){var r=t().qa,o=r.questions,i=r.filterByStatus,a=r.sortBy;s(n,i)&&!o.some(function(e){return e.id===n.id})&&e(function(e){e.qa.questions.push(n),e.qa.questions=l(e.qa.questions,a)})},updateQuestion:function(n){var r=t().qa,o=r.questions,i=r.filterByStatus,a=r.sortBy,c=o.findIndex(function(e){return e.id===n.id});-1!==c?e(function(e){s(n,i)?e.qa.questions[c]=n:e.qa.questions.splice(c,1),e.qa.questions=l(e.qa.questions,a)}):s(n,i)&&t().qaActions.addQuestion(n)},updateUpvotedQuestionIds:function(n){var r=new Set(t().qa.upvotedQuestionIds);n.upvoted_by_current_contact?r.add(n.id):r.delete(n.id),e(function(e){e.qa.upvotedQuestionIds=Array.from(r)})},setPendingQuestionIds:function(t){return e(function(e){e.qa.pendingQuestionIds=t})},updatePendingQuestionIds:function(n){var r=new Set(t().qa.pendingQuestionIds);n.status===o.d.PENDING?r.add(n.id):r.delete(n.id),e(function(e){e.qa.pendingQuestionIds=Array.from(r),0===r.size&&e.qa.session&&(e.qa.session.has_pending_questions=!1)})},clearSpotlightedQuestions:function(){e(function(e){e.qa.questions=e.qa.questions.map(function(e){var t,n;return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),n=n={spotlighted:!1},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t})})},deleteQuestion:function(t){return e(function(e){e.qa.questions=e.qa.questions.filter(function(e){return e.id!==t}),e.qa.pendingQuestionIds=e.qa.pendingQuestionIds.filter(function(e){return e!==t})})},setReplyingQuestionId:function(t){return e(function(e){e.qa.replyingQuestionId=t})},setReplies:function(t){return e(function(e){e.qa.replies=t})},addReply:function(n){return e(function(e){var r=t().qa,o=r.replyingQuestionId,i=r.replies;o!==n.question_id||i.some(function(e){return e.id===n.id})||e.qa.replies.push(n)})},updateReply:function(n){var r=t().qa.replies.findIndex(function(e){return e.id===n.id});-1!==r&&e(function(e){e.qa.replies[r]=n})},deleteReply:function(t){return e(function(e){e.qa.replies=e.qa.replies.filter(function(e){return e.id!==t})})},setFilterByStatus:function(t){return e(function(e){e.qa.filterByStatus=t})},setSortBy:function(t){return e(function(e){e.qa.sortBy=t})}}}})},357836:function(e,t,n){n.d(t,{G7:()=>o,Pl:()=>i,q6:()=>a});var r=n(433251),o=Object.freeze({CHAT:"CHAT",PARTICIPANTS:"PARTICIPANTS",QA:"QA"}),i=Object.freeze({SPEAKER:"speaker",GALLERY:"gallery"}),a=(0,r.n)(function(e,t){return{ui:{isSidebarOpen:!1,setIsSidebarOpen:function(t){return e(function(e){e.ui.isSidebarOpen=t})},hideSidebar:function(){return e(function(e){e.ui.isSidebarOpen=!1})},currentTab:o.CHAT,setCurrentTab:function(t){return e(function(e){e.ui.currentTab=t})},displayChat:function(){return e(function(e){e.ui.isSidebarOpen=!0,e.ui.currentTab=o.CHAT,e.ui.hasUnseenChatMessages=!1})},toggleChat:function(){t().ui.isSidebarOpen&&t().ui.currentTab===o.CHAT?t().ui.hideSidebar():t().ui.displayChat()},displayQA:function(){return e(function(e){e.ui.isSidebarOpen=!0,e.ui.currentTab=o.QA,e.ui.hasUnseenQuestions=!1})},toggleQA:function(){t().ui.isSidebarOpen&&t().ui.currentTab===o.QA?t().ui.hideSidebar():t().ui.displayQA()},displayParticipants:function(){return e(function(e){e.ui.isSidebarOpen=!0,e.ui.currentTab=o.PARTICIPANTS,e.ui.hasUnseenChatMessages=!1})},toggleParticipants:function(){t().ui.isSidebarOpen&&t().ui.currentTab===o.PARTICIPANTS?t().ui.hideSidebar():t().ui.displayParticipants()},isCohostsModalOpen:!1,setIsCohostsModalOpen:function(t){return e(function(e){e.ui.isCohostsModalOpen=t})},displayCohostsModal:function(){t().ui.displayParticipants(),t().ui.setIsCohostsModalOpen(!0)},hideCohostsModal:function(){t().ui.setIsCohostsModalOpen(!1)},isMuteParticipantsModalOpen:!1,setIsMuteParticipantsModalOpen:function(t){return e(function(e){e.ui.isMuteParticipantsModalOpen=t})},displayMuteParticipantsModal:function(){t().ui.setIsMuteParticipantsModalOpen(!0)},hideMuteParticipantsModal:function(){t().ui.setIsMuteParticipantsModalOpen(!1)},hasUnseenChatMessages:!1,setHasUnseenChatMessages:function(t){return e(function(e){e.ui.hasUnseenChatMessages=t})},onNewChatMessage:function(){t().ui.isSidebarOpen&&t().ui.currentTab===o.CHAT||t().ui.setHasUnseenChatMessages(!0)},hasUnseenQuestions:!1,setHasUnseenQuestions:function(t){return e(function(e){e.ui.hasUnseenQuestions=t})},onNewQuestion:function(){t().ui.isSidebarOpen&&t().ui.currentTab===o.QA||t().ui.setHasUnseenQuestions(!0)},isRoomInfoOpen:!1,setIsRoomInfoOpen:function(t){return e(function(e){e.ui.isRoomInfoOpen=t})},toggleIsRoomInfoOpen:function(){return e(function(e){e.ui.isRoomInfoOpen=!e.ui.isRoomInfoOpen})},isFullscreen:!1,setIsFullscreen:function(t){return e(function(e){e.ui.isFullscreen=t})},toggleFullscreen:function(){return e(function(e){e.ui.isFullscreen?document.exitFullscreen():document.documentElement.requestFullscreen()})},isPublicStreamNotificationVisible:!1,isPublicStreamNotificationDismissed:!1,setPublicStreamNotificationVisible:function(t){return e(function(e){e.ui.isPublicStreamNotificationVisible=t})},hidePublicStreamNotification:function(){return e(function(e){e.ui.isPublicStreamNotificationVisible=!1,e.ui.isPublicStreamNotificationDismissed=!0})},pipWindow:null,setPipWindow:function(t){return e(function(e){e.ui.pipWindow=t})},pipViewMode:i.GALLERY,setPipViewMode:function(t){return e(function(e){e.ui.pipViewMode=t})}}}})},845024:function(e,t,n){n.d(t,{I:()=>y});var r=n(798104),o=n(354346),i=n(106223),a=n(433251),s=(0,a.n)(function(e,t){return{session:{spectators:{shouldPoll:!0,setShouldPoll:function(t){return e(function(e){e.session.spectators.shouldPoll=t})},isLoading:!1,isFetching:!1,loadFn:null,setLoadFn:function(t){return e(function(e){e.session.spectators.loadFn=t})},load:function(){var n,r=null!=(n=t().session.spectators.loadFn)?n:function(){return Promise.resolve()};e(function(e){e.session.spectators.isLoading=!0}),r().finally(function(){e(function(e){e.session.spectators.isLoading=!1})})},hasNext:!1,setHasNext:function(t){return e(function(e){e.session.spectators.hasNext=t})},loadMoreFn:null,setLoadMoreFn:function(t){return e(function(e){e.session.spectators.loadMoreFn=t})},loadMore:function(){var n,r=null!=(n=t().session.spectators.loadMoreFn)?n:function(){return Promise.resolve()};e(function(e){e.session.spectators.isFetching=!0}),r().finally(function(){e(function(e){e.session.spectators.isFetching=!1})})},total:0,setTotal:function(t){return e(function(e){e.session.spectators.total=t})},data:[],setData:function(t){return e(function(e){e.session.spectators.data=t})}},preJoinChecklist:{hasEnabledMicrophoneOnce:!1,hasEnabledCameraOnce:!1,hasOpenedSettingsModalOnce:!1,markMicrophoneEnabledOnce:function(){e(function(e){e.session.preJoinChecklist.hasEnabledMicrophoneOnce=!0})},markCameraEnabledOnce:function(){e(function(e){e.session.preJoinChecklist.hasEnabledCameraOnce=!0})},markOpenedSettingsModalOnce:function(){e(function(e){e.session.preJoinChecklist.hasOpenedSettingsModalOnce=!0})}}}}}),l=n(534811),c=(0,a.n)(function(e){return{settings:{microphoneEnabled:!0,cameraEnabled:!0,audioInputId:l.w5,audioOutputId:null,videoInputId:l.w5,blurEnabled:!1,mirrorEnabled:!0,noiseSuppression:"basic",gridLayoutPageSize:l.SF,pipLayoutPageSize:l.Fp,speakerLayoutPageSize:l.dF,infinityMirrorAlertDisabled:!1},settingsActions:{toggleMicrophone:function(){return e(function(e){e.settings.microphoneEnabled=!e.settings.microphoneEnabled})},setMicrophoneEnabled:function(t){return e(function(e){e.settings.microphoneEnabled=t})},toggleCamera:function(){return e(function(e){var t;e.settings.cameraEnabled=!(null==(t=e.settings)?void 0:t.cameraEnabled)})},setCameraEnabled:function(t){return e(function(e){e.settings.cameraEnabled=t})},setAudioInputId:function(t){return e(function(e){e.settings.audioInputId=t})},setAudioOutputId:function(t){return e(function(e){e.settings.audioOutputId=t})},setVideoInputId:function(t){return e(function(e){e.settings.videoInputId=t})},toggleBlur:function(){return e(function(e){var t;e.settings.blurEnabled=!(null==(t=e.settings)?void 0:t.blurEnabled)})},toggleMirror:function(){return e(function(e){var t;e.settings.mirrorEnabled=!(null==(t=e.settings)?void 0:t.mirrorEnabled)})},setNoiseSuppression:function(t){return e(function(e){e.settings.noiseSuppression=t})},setBlurEnabled:function(){return e(function(e){e.settings.blurEnabled=!0})},setGridLayoutPageSize:function(t){return e(function(e){var n=Math.min(Math.max(t,l.CH),l.O_);e.settings.gridLayoutPageSize=n})},setSpeakerLayoutPageSize:function(t){return e(function(e){var n=Math.min(Math.max(t,l.fm),l.nX);e.settings.speakerLayoutPageSize=n})},setPipLayoutPageSize:function(t){return e(function(e){var n=Math.min(Math.max(t,l.X2),l.E1);e.settings.pipLayoutPageSize=n})},toggleInfinityMirrorAlert:function(){return e(function(e){e.settings.infinityMirrorAlertDisabled=!e.settings.infinityMirrorAlertDisabled})}}}}),u=n(251630);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var f=(0,a.n)(function(e){return{spotlight:{items:[],errorMessage:void 0,isLoading:!1},spotlightActions:{fetchSpotlightItems:function(t){var n,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e(function(e){e.spotlight.isLoading=!0}),u.Qk.getSpotlightItems({roomId:t,params:(n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},o),r=r={sort:"oldest"},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(r)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}),n)}).then(function(t){e(function(e){e.spotlight.items=t.records,e.spotlight.isLoading=!1})}).catch(function(t){console.error(t),e(function(e){e.spotlight.errorMessage="Failed to fetch spotlight items",e.spotlight.isLoading=!1})})},addSpotlightItem:function(t){e(function(e){var n;e.spotlight.items=((function(e){if(Array.isArray(e))return d(e)})(n=e.spotlight.items)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return d(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}}(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([t])})},deleteSpotlightItem:function(t){e(function(e){e.spotlight.items=e.spotlight.items.filter(function(e){return e.id!==t})})},setSpotlightItems:function(t){e(function(e){e.spotlight.items=t})},clearSpotlightItems:function(t){e(function(e){e.spotlight.items=[]}),u.Qk.clearSpotlightItems({roomId:t})}}}}),m={connectionQualitySeries:[],providerErrors:[]},p=(0,a.n)(function(e){return{telemetry:{data:m,actions:{clearData:function(){e(function(e){e.telemetry.data=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},m)})},addConnectionQualityData:function(t){e(function(e){e.telemetry.data.connectionQualitySeries.push({timestamp:Date.now(),value:t})})},addProviderError:function(t){e(function(e){var n=e.telemetry.data.providerErrors,r=n[n.length-1];(!r||r.message!==t)&&(e.telemetry.data.providerErrors.push({timestamp:Date.now(),message:t}),e.telemetry.data.providerErrors.length>10&&(e.telemetry.data.providerErrors=e.telemetry.data.providerErrors.slice(-10)))})}}}}}),b=n(357836);function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function v(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return h(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var y=(0,r.Ue)()((0,o.tJ)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},c.apply(void 0,v(t)),b.q6.apply(void 0,v(t)),s.apply(void 0,v(t)),i.r.apply(void 0,v(t)),f.apply(void 0,v(t)),p.apply(void 0,v(t)))},{name:"circle-live-storage",version:3,partialize:function(e){return{settings:e.settings}}}))},101924:function(e,t,n){n.d(t,{b:()=>u});var r=n(552676),o=n(275271),i=n(739792),a=n(252484),s=n(178522),l=n(437588),c=n(381636),u=function(e){var t=e.setIsLimitReached,n=e.initialCohostQuantity,u=e.shouldDisplayDisabledSearchMessage,d=((0,s.B)().selectionState||{}).memberCount+(void 0===n?1:n)||1,f=(0,a.oQ)().config,m=(null==f?void 0:f.live_stream_max_host_capacity)||null,p=d>=Number(m);return(0,o.useEffect)(function(){m&&(d<=Number(m)-l.ln?t(!1):t(!0))},[d,m,t]),(0,r.jsxs)("div",{className:"mb-4 text-center",children:[(0,r.jsx)("div",{children:(0,r.jsx)(c.Z.LabelSm,{weight:p?"medium":"normal",children:(0,i.t)("live_streams.room.cohosts_counter_message",{count:Math.min(d,Number(m||0)),hostCapacity:Number(m||0)})})}),void 0!==u&&u&&(0,r.jsx)("div",{children:(0,r.jsx)(c.Z.LabelSm,{children:(0,i.t)("live_streams.room.cohosts_disable_search_message")})})]})}},252484:function(e,t,n){n.d(t,{$v:()=>v,wK:()=>h,lQ:()=>x,Wk:()=>r.W,tm:()=>c,oQ:()=>a,IO:()=>_});var r=n(659361),o=n(131906),i=n(547144),a=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0}).enabled,t=(0,o.useQuery)({queryKey:[i.av.liveStreams.configurations()],enabled:e}),n=t.data,r=t.isLoading,a={};return null==n||n.forEach(function(e){a[e.feature_flag]=e.value}),{isLoading:r,config:a}},s=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0}).enabled,t=(0,o.useQuery)({queryKey:[i.av.liveStreams.usage()],enabled:e}),n=t.data,r=t.isLoading,a={};return null==n||n.forEach(function(e){a[e.type]=e.value}),{isLoading:r,usage:a}},l=n(932699),c=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0}).enabled,t=a({enabled:e}),n=t.config,r=t.isLoading,o=s({enabled:e}),i=o.usage,c=o.isLoading,u=Number(v(l.noop,{enabled:e}).currentQuantity||0),d=(null==i?void 0:i.stream_duration)||0,f=Number((null==n?void 0:n.live_stream_monthly_stream_hours)||0);return{isLoading:r||c,streamingHoursAvailable:d<3600*f+3600*u,streamingTotalPlanHours:f+u}},u=n(739792),d=n(251630),f=n(698173),m=n(824869),p=function(e,t,n){var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{enabled:!0}).enabled,a=(0,m.E)().isCommunityOnTrial,s=(0,o.useQuery)({queryKey:[f.a.communityPlanAddons.show({addonId:e})],enabled:r,staleTime:6e5,retry:function(e,t){return![401,404].includes(null==t?void 0:t.status)}}),l=s.data,c=s.isLoading,p=s.refetch,b=s.isFetching,h=l||{},v=h.id,y=h.max_purchasable_quantity,g=h.name,x=h.quantity,_=h.unit_size,j=!y||"number"==typeof x&&x<y,w=function(e){return!y||"number"==typeof x&&x+e<=y},O=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return a?Promise.resolve().then(function(){return window.location.href=(0,i.xn)()}):v&&x&&w(n)?d.zV.create((e={},t="number"==typeof x?x+n:x,v in e?Object.defineProperty(e,v,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[v]=t,e)):Promise.reject((0,u.t)("addons.community_plan_addon_hook.quantity_not_available_message"))},S=(0,o.useMutation)(function(e){return O(e)},{onSuccess:function(){p(),null==n||n()},onError:function(e){null==t||t(e)}});return{id:v,currentQuantity:x,maxPurchasableQuantity:y,name:g,unitSize:_,canPurchase:j,canPurchaseQuantity:w,purchase:S.mutate,purchaseAsync:S.mutateAsync,refetch:p,isLoading:c,isFetching:b,isPurchasing:S.isLoading}},b=n(60878),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0},t=(0,b.pm)().error;return p("live_stream_spectators",function(){return t((0,u.t)("live_streams.room.attendees_addon_quantity_error"))},l.noop,e)},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.noop,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0},n=(0,b.pm)().error;return p("live_stream_monthly_stream_hours",function(){return n((0,u.t)("live_streams.room.stream_hours_addon_error"))},e,t)},y=function(){var e=v(),t=e.isLoading,n=e.currentQuantity,r=e.refetch,o=h(),i=o.isLoading,a=o.currentQuantity,s=o.refetch;return{streamHoursAddonQuantity:n,attendeeSeatsAddonQuantity:a,isLoading:t||i,refetch:function(){r(),s()}}},g=n(404393),x=function(){var e,t,n=a(),r=n.config,o=n.isLoading,i=s(),l=i.usage,c=i.isLoading,u=y(),d=u.refetch,f=u.isLoading,m=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(u,["refetch","isLoading"]);return{monthlyHourLimit:parseInt(null==r?void 0:r.live_stream_monthly_stream_hours)+parseInt((null==m||null==(e=m.streamHoursAddonQuantity)?void 0:e.toString())||"0"),monthlyHourUsage:((null==l?void 0:l.stream_duration)||0)/3600,hostLimit:null==r?void 0:r.live_stream_max_host_capacity,participantLimit:parseInt(null==r?void 0:r.live_stream_max_spectator_capacity)+parseInt((null==m||null==(t=m.attendeeSeatsAddonQuantity)?void 0:t.toString())||"0"),streamingDurationResetDate:(null==l?void 0:l.streaming_duration_reset_date)?(0,g.bl)(null==l?void 0:l.streaming_duration_reset_date):void 0,isLoading:o||c||f,refetchAddons:d}},_=function(){var e=(0,o.useQuery)({queryKey:[i.av.liveStreams.usageLimit()]}),t=e.data;return{isLoading:e.isLoading,isMonthlyHourLimitReached:null==t?void 0:t.streaming_limit_reached,isStorageLimitReached:null==t?void 0:t.recording_limit_reached}}},659361:function(e,t,n){n.d(t,{W:()=>d});var r=n(131906),o=n(903225),i=n(739792),a=n(251630),s=n(441342),l=n(437588),c=n(547144),u=n(60878),d=function(){var e,t=(0,s.wh)().currentUser,n=(0,u.pm)(),d=n.error,f=n.success,m=(0,o.k6)(),p=(0,r.useQuery)({queryKey:[c.av.liveStreams.liveNow({params:{per_page:1}})]}),b=p.data,h=p.remove,v=null==b||null==(e=b.records)?void 0:e[0],y=(0,r.useMutation)(function(){return a.Qk.endStream({id:null==v?void 0:v.id})},{onSuccess:function(){f((0,i.t)("live_streams.room.".concat((0,l.vX)(v),".end_success"))),h()},onError:function(){return d((0,i.t)("live_streams.room.".concat((0,l.vX)(v),".end_error")))}});return{room:v,canManage:null==v?void 0:v.can_manage,handleNavigateToRoom:function(){if(v){var e=c.dE.room({roomSlug:v.slug});t||((0,l.L6)(v)?e=c.dE.publicRoom({roomSlug:v.slug}):window.location.href=c.dE.room({roomSlug:v.slug})),m.push(e)}},handleEndStream:function(e){null==e||e.stopPropagation(),y.mutate()}}}},412367:function(e,t,n){n.d(t,{T:()=>j});var r=n(552676),o=n(275271),i=n(117383),a=n(739792),s=n(757105),l=n(998471),c=n(66588),u=n(381636),d=n(701168),f=n(751169),m=n(434519),p=n(775148),b=n(437614),h=n(957363),v=function(e){var t=e.direction,n=e.onClick;return(0,r.jsx)("button",{type:"button",className:"bg-primary focus-visible:!outline-secondary flex size-12 items-center justify-center rounded-full shadow focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",onClick:n,children:(0,r.jsx)(h.JO,{size:20,type:"20-arrow-left",className:"right"==(void 0===t?"right":t)?"rotate-180":""})})};function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var x=function(e){var t,n=e.attachments,h=void 0===n?[]:n,y=e.startIndex,x=g((0,o.useState)(void 0===y?0:y),2),_=x[0],j=x[1],w=g((0,o.useState)(!1),2),O=w[0],S=w[1],P=(0,s.dd)();(0,o.useEffect)(function(){});var C=_<h.length-1,k=_>0,I=function(){return C&&j(_+1)},N=function(){return k&&j(_-1)},A=h[_],M=A.image_variants||{},T=c.$.isPDF(A.content_type),E=c.$.isImage(A.content_type),R=!!(null==(t=A.metadata)?void 0:t.voice_message),D=c.$.isNativelySupportedVideo(A.content_type);return(0,i.y1)("left",N,{enabled:k},[k,_,h]),(0,i.y1)("right",I,{enabled:C},[C,_,h]),(0,o.useEffect)(function(){E&&O&&S(!1)},[A]),(0,r.jsxs)(m.u_,{isOpen:P.visible,onClose:function(){return P.remove()},title:A.filename,children:[(0,r.jsx)(m.u_.Overlay,{}),(0,r.jsxs)(m.u_.Content,{size:"full",children:[(0,r.jsxs)(m.u_.Header,{children:[(0,r.jsx)(u.Z.LabelMd,{weight:"medium",children:A.filename}),(0,r.jsxs)(m.u_.HeaderActions,{className:"items-center",children:[(0,r.jsx)(p.h,{ariaLabel:(0,a.t)("download"),name:"download",className:"ml-2 focus:outline-none",iconClassName:"!text-dark",buttonSize:28,iconSize:16,onClick:function(){window.open(A.url,"_blank")},variant:"primary"}),(0,r.jsx)(m.u_.CloseButton,{onClick:P.remove})]})]}),(0,r.jsxs)(m.u_.Body,{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"w-16",children:k&&(0,r.jsx)(v,{direction:"left",onClick:N})}),(0,r.jsxs)("div",{className:"flex max-h-full flex-1 select-none justify-center",children:[T&&(0,r.jsx)(l.X,{src:A.url}),D&&!R&&(0,r.jsx)(b.W,{src:A.url,type:A.content_type,controlsList:"play",autoPlay:!0,poster:M.thumbnail}),E&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{loading:"eager",alt:"",className:(0,d.A)("object-contain",{hidden:!O}),src:A.url,onLoad:function(){return S(!0)},onError:function(){return S(!0)}}),!O&&(0,r.jsx)(f.a,{center:!0})]})]}),(0,r.jsx)("div",{className:"w-16",children:C&&(0,r.jsx)(v,{direction:"right",onClick:I})})]})]})]})},_=s.gk.create(function(e){var t=e.startIndex,n=e.attachments;return(0,r.jsx)(x,{startIndex:t,attachments:n})}),j=function(){return(0,s.dd)(_)}},209339:function(e,t,n){n.d(t,{h:()=>_});var r=n(552676),o=n(932699),i=n(757105),a=n(739792),s=n(617013),l=n(941084),c=n(39905),u=n(767900),d=n(26950),f=n(381636),m=function(e){var t=e.post,n=e.spaces,o=e.isOpen,i=e.isLoading,m=e.isSubmitting,p=e.onSubmit,b=e.onClose;return i?null:(0,r.jsx)(d.u,{title:(0,a.t)("duplicate_post"),variant:"default",show:o,onClose:b,overflowVisible:!0,children:(0,r.jsxs)(u.l,{defaultValues:{space_id:t.space_id,send_notifications:!1},onSubmit:function(e){return p(e)},children:[(0,r.jsx)(u.l.Item,{name:"space_id",label:(0,a.t)("space"),description:(0,a.t)("duplicate_post_to_space"),rules:{required:(0,a.t)("events.create.form.space_required_error")},hideBorder:!0,fullWidth:!0,children:(0,r.jsx)(s.M,{name:"space_id",variant:"form-input",containerClassname:"mt-2",spaces:n})}),(0,l.Hz)(t)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.Z.LabelXs,{color:"text-light",children:(0,a.t)("comments_wont_be_duplicated")}),(0,r.jsx)(u.l.Item,{name:"send_notifications",label:(0,a.t)("duplicate_post_send_notifications"),hideDescription:!0,inlineReverse:!0,hideBorder:!0,fullWidth:!0,children:(0,r.jsx)(u.l.ToggleSwitch,{name:"send_notifications",variant:"small"})})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(c.z,{type:"submit",variant:"primary",disabled:m,children:m?(0,a.t)("duplicating"):(0,a.t)("duplicate")})})]})})},p=n(131906),b=n(534962),h=n(60878),v=function(e){var t=e.post,n=e.onSuccess,r=(0,h.pm)(),i=r.success,s=r.error,l=(0,p.useMutation)(function(e){return(0,b.gX)({spaceId:t.space_id,postSlug:t.slug,payload:{post:{space_id:e.space_id,send_notifications:e.send_notifications}}})},{onSuccess:function(e){i((0,a.t)("duplicated_successfully")),(0,o.isFunction)(n)&&n(e)},onError:function(){s((0,a.t)("duplication_failed"))}});return{duplicate:l.mutate,isDuplicating:l.isLoading}},y=n(441342),g=function(e){var t=e.post,n=e.onSuccess,a=(0,i.dd)(),s=(0,y.nT)(),l=s.isLoading,c=s.helpers,u=v({post:t,onSuccess:function(e){(0,o.isFunction)(n)&&n(e),a.remove()}}),d=u.duplicate,f=u.isDuplicating;return(0,r.jsx)(m,{post:t,spaces:c.imageSpacesWithPostCreationAllowed(),isOpen:a.visible,isLoading:l,isSubmitting:f,onSubmit:d,onClose:a.remove})},x=i.gk.create(function(e){return(0,r.jsx)(g,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),_=function(){return(0,i.dd)(x)}},64282:function(e,t,n){n.d(t,{Z:()=>l});var r=n(552676),o=n(157514),i=n(757105),a=function(e){var t=e.event,n=e.defaultSection,a=e.locationType,s=(0,i.dd)(),l=s.visible,c=s.hide;return(0,r.jsx)(o.G,{isOpen:l,onClose:c,event:t,locationType:a,initialSection:n})},s=i.gk.create(function(e){var t=e.event,n=e.defaultSection,o=e.locationType;return(0,r.jsx)(a,{event:t,defaultSection:n,locationType:o})}),l=function(){return(0,i.dd)(s)}},629662:function(e,t,n){n.d(t,{e:()=>tM});var r,o=n(552676),i=n(932699),a=n(739792),s=n(275271),l=n(39905),c=n(434519);function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d="upload_images",f="adjust_images",m="create_post",p="square",b="landscape",h="portrait",v=(u(r={},p,1),u(r,b,16/9),u(r,h,.8),r),y=n(798104);function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function x(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return g(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var _=function(e){return e.selectedFiles.forEach(function(e){return URL.revokeObjectURL(e.preview)}),{selectedFiles:[]}},j=(0,y.Ue)(function(e){return{currentStep:d,isSubmitting:!1,isFormDirty:!1,isImagesDirty:!1,isScheduledBarPortalRendered:!1,galleryAspectRatio:null,selectedFiles:[],uploadedImages:[],setCurrentStep:function(t){return e({currentStep:t})},setIsSubmitting:function(t){return e({isSubmitting:t})},setIsFormDirty:function(t){return e({isFormDirty:t})},setIsImagesDirty:function(t){return e({isImagesDirty:t})},setIsScheduledBarPortalRendered:function(t){return e({isScheduledBarPortalRendered:t})},updateImage:function(t){e(function(e){var n=e.selectedFiles.findIndex(function(e){return e.preview===t.preview});return e.selectedFiles[n]=t,{selectedFiles:x(e.selectedFiles)}})},addSelectedFiles:function(t){e(function(e){return{selectedFiles:x(e.selectedFiles).concat(x(t))}})},setSelectedFiles:function(t){e({selectedFiles:t})},addUploadedImages:function(t){e(function(e){return{uploadedImages:x(e.uploadedImages).concat(x(t))}})},setUploadedImages:function(t){e({uploadedImages:t})},setGalleryAspectRatio:function(t){t<(v.portrait+v.square)/2?e({galleryAspectRatio:v.portrait}):t>(v.landscape+v.square)/2?e({galleryAspectRatio:v.landscape}):e({galleryAspectRatio:v.square})},resetSelectedFiles:function(){e(_)},reset:function(){e(function(e){var t,n;return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},_(e)),n=n={currentStep:null,uploadedImages:[],galleryAspectRatio:null,isSubmitting:!1,isFormDirty:!1,isImagesDirty:!1,isScheduledBarPortalRendered:!1},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t})}}}),w=n(619803),O=n.n(w),S=n(71068),P=n(381636),C=n(380171),k=n(775148);function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var N=[{format:p,iconType:"16-image-square"},{format:h,iconType:"16-image-portrait"},{format:b,iconType:"16-image-landscape"}],A=function(){var e,t=j(),n=t.galleryAspectRatio,r=t.setGalleryAspectRatio,i=null==(e=Object.entries(v).find(function(e){return(function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return I(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[1]===n}))?void 0:e[0],s="image_space.post_modal.steps.adjust_images.cropping_options";return(0,o.jsx)("div",{className:"text-default flex justify-between",children:N.map(function(e){var t=e.format,n=e.iconType;return(0,o.jsx)(C.T,{content:(0,a.t)("".concat(s,".").concat(t)),children:(0,o.jsx)(k.h,{onClick:function(){r(v[t])},className:O()({"bg-tertiary":i===t}),name:n,iconSize:16,buttonSize:28,iconClassName:O()({"!text-dark":i===t}),ariaLabel:(0,a.t)("".concat(s,".").concat(t))})},t)})})},M=n(918111);function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function R(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var D=function(e){var t,n=e.currentImage,r=(t=(0,s.useState)(null),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return T(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=r[0],l=r[1],c=j(),u=c.updateImage,d=c.galleryAspectRatio,f=c.setGalleryAspectRatio;return((0,s.useEffect)(function(){var e=new Image;e.src=n.preview,e.onload=function(){l(e)}},[n.preview]),(0,s.useEffect)(function(){!d&&a&&f(a.width/a.height)},[d,a]),a&&d)?(0,o.jsx)("div",{className:"relative flex aspect-video max-w-full grow cursor-pointer",children:(0,o.jsx)(M.Z,{image:n.preview,crop:n.crop,aspect:d,zoom:n.zoom,onCropChange:function(e){e!==n.crop&&u(R(E({},(0,i.cloneDeep)(n)),{crop:e}))},onZoomChange:function(e){e!==n.zoom&&u(R(E({},(0,i.cloneDeep)(n)),{zoom:e}))},onCropComplete:function(e,t){u(R(E({},(0,i.cloneDeep)(n)),{croppedAreaPixels:t}))}})}):null},L=n(194556),F=n(957363),U=n(844081),B=n(489213),q=n(49705),z=n(117617),Z=function(e){var t=e.onClick,n=e.index,r=e.currentImageIndex,i=!!(0,U.dw)().activeItem,s=(0,z.en)();return(0,o.jsx)(k.h,{onClick:t,className:O()("bg-tertiary border-secondary outline-tertiary absolute -right-0.5 -top-0.5 z-10 hidden size-4 rounded-full border !p-0 outline outline-2",{"group-hover:!flex":!i},{"!flex":!s&&!i&&n===r}),buttonSize:16,iconClassName:"!text-dark",name:"16-close",ariaLabel:(0,a.t)("delete_image")})},V=function(e){var t,n=e.direction,r=e.scrollableContainerRef;null==r||null==(t=r.current)||t.scroll({left:(null==r?void 0:r.current.scrollLeft)+("left"===n?-200:200),behavior:"smooth"})},H=function(e){var t=e.direction,n=e.scrollableContainerRef,r="left"===t,i="right"===t;return(0,o.jsxs)("div",{className:O()("absolute z-30 flex h-full items-center",{"-left-px":r,"-right-px":i}),children:[i&&(0,o.jsx)("div",{className:"from-primary h-full w-8 bg-gradient-to-l to-transparent"}),(0,o.jsx)("button",{type:"button",onClick:function(){return V({direction:t,scrollableContainerRef:n})},className:"bg-primary group flex h-full cursor-pointer items-center px-2 py-1",children:(0,o.jsx)(F.JO,{size:16,className:O()({"-rotate-90":i,"rotate-90":r},"text-light group-hover:text-darkest"),type:"caret-down-bold"})}),r&&(0,o.jsx)("div",{className:"from-primary h-full w-8 bg-gradient-to-r to-transparent"})]})},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.noop,t=j().addSelectedFiles;return{handleFileSelection:function(n){t(n=n.map(function(e){return{file:e,preview:URL.createObjectURL(e),crop:{x:0,y:0},zoom:1}})),e()}}},Q=n(342417),G=n(60878),$=function(e){var t=e.handleFileSelection,n=e.selectedFiles,r=e.uploadedFilesCount,o=(0,G.pm)(),i="image_space.post_modal.steps.upload_images.errors",s=10-r,l=function(e){e.reduce(function(e,t){var n=t.errors[0].code;return e.includes(n)||e.push(n),e},[]).forEach(function(e){var t={shouldShowCloseButton:!0,shouldUseProgress:!1};switch(e){case"file-invalid-type":return o.error((0,a.t)("".concat(i,".file_invalid_type")),t);case"file-too-large":return o.error((0,a.t)("".concat(i,".file_too_large")),t);case"too-many-files":return o.error((0,a.t)("".concat(i,".too_many_files"),{max_images:10}),t);default:return o.error((0,a.t)("".concat(i,".something_went_wrong")),t)}})},c=(0,Q.uI)({onDrop:function(e,r){r.length>0?l(r):parseInt(n.length)+parseInt(e.length)>s?l([{errors:[{code:"too-many-files"}]}]):t(e)},noClick:!0,accept:{"image/*":[".jpg",".jpeg",".png"]},maxFiles:s,maxSize:2e7,multiple:!0}),u=c.getRootProps,d=c.getInputProps,f=c.isDragAccept,m=c.isDragReject;return{getRootProps:u,getInputProps:d,isDragActive:f||m,open:c.open}},K=function(){var e=j(),t=e.setSelectedFiles,n=e.selectedFiles;return{removeImage:function(e){t(n.filter(function(t){return t!==e}))}}},J=function(e){var t=e.fileStates,n=e.index;return(0,o.jsx)("div",{className:"shrink-0 p-1",children:(0,o.jsxs)("div",{className:"bg-tertiary flex size-12 items-center justify-center rounded-md",children:["completed"===t[n].status&&(0,o.jsx)(F.JO,{type:"20-checkmark-circle-fill",size:20,className:"text-default"}),"uploading"===t[n].status&&(0,o.jsx)(S.D,{percentage:t[n].progress,size:18,strokeWidth:1.5}),"error"===t[n].status&&(0,o.jsx)(P.Z.LabelXs,{color:"text-default",children:(0,a.t)("image_space.post_modal.steps.adjust_images.file_error")})]})})},X=function(e){var t=e.image,n=e.index,r=e.setCurrentImageIndex,i=e.currentImageIndex;return(0,o.jsx)("button",{type:"button",onClick:function(){return r(n)},className:O()("shrink-0 cursor-pointer touch-none select-none rounded-lg border-2 border-transparent p-0.5",{"border-secondary":n===i}),children:(0,o.jsx)("img",{loading:"eager",src:t.preview,className:"size-12 rounded-md object-cover",alt:t.file.name})},t.preview)},Y=function(e){var t=e.isOverlay,n=(0,U.dI)().item;return(0,o.jsx)("div",{className:O()("rounded-lg border-2 border-transparent p-0.5 opacity-50",{"!opacity-100":void 0!==t&&t}),children:(0,o.jsx)("img",{loading:"eager",src:n.preview,className:"size-12 rounded-md object-cover",alt:n.file.name})})};function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function en(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function er(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ee(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var eo=function(e){var t=e.selectedFiles,n=e.setCurrentImageIndex,r=e.currentImageIndex,i=e.status,a=e.fileStates,l=e.editingImageSignedId,u=e.onDeleteAllImages,d=(0,s.useRef)(null),f=er((0,L.A)(),2),m=f[0],p=f[1],b=er((0,L.A)(),2),h=b[0],v=b[1],y=(0,c.UV)().contentPortalElement,g=j(),x=g.uploadedImages,_=g.setSelectedFiles,w=$({handleFileSelection:W(function(){setTimeout(function(){return V({direction:"right",scrollableContainerRef:d})},200)}).handleFileSelection,selectedFiles:t,uploadedFilesCount:x.length}),O=w.getInputProps,S=w.open,P=K().removeImage,C=t.map(function(e){return en(et({},e),{id:e.preview})}),k=C[r],I=!l&&t.length+x.length<10;return(0,o.jsxs)("div",{className:"relative mt-5 flex",children:[!p&&(0,o.jsx)(H,{direction:"left",scrollableContainerRef:d}),(0,o.jsxs)(U.cm,{shouldUseKeyboardSensor:!1,distance:10,items:C,onSort:function(e){var t=e.indexOf(k);t!==r&&n(t),_(e.map(function(e){return en(et({},e),{id:void 0})}))},restrictToParentElement:!0,children:[(0,o.jsx)(U.Fo,{children:(0,o.jsxs)("div",{className:"scrollbar-hide m-auto !flex items-center overflow-x-scroll px-1 pt-1",ref:d,"data-testid":"thumbnails-list",children:[(0,o.jsx)("div",{className:"size-px",ref:m}),t.map(function(e,s){return"uploading"===i||"completed"===i?(0,o.jsx)(J,{fileStates:a,index:s},e.preview):(0,o.jsxs)(q.c,{tabIndex:-1,item:C[s],disabled:1===x.length,placeholder:Y,className:"group relative !w-auto shrink-0",dataTestId:"thumbnail-item",children:[(0,o.jsx)(Z,{onClick:function(){P(e),1===t.length&&u()},index:s,currentImageIndex:r}),(0,o.jsx)(X,{image:e,index:s,setCurrentImageIndex:n,currentImageIndex:r})]},e.preview)}),I&&(0,o.jsxs)("button",{type:"button",className:"hover:bg-secondary text-default ml-1 flex size-12 shrink-0 cursor-pointer items-center justify-center rounded-md border border-dashed",onClick:function(){return"uploading"!==i&&S()},children:[(0,o.jsx)("input",en(et({},O()),{"data-testid":"upload_more_images"})),(0,o.jsx)(F.JO,{type:"20-add-lg",size:20})]}),(0,o.jsx)("div",{className:"size-px",ref:h})]})}),(0,o.jsx)(B.y,{portalTo:y,children:(0,o.jsx)(Y,{isOverlay:!0})})]}),!v&&(0,o.jsx)(H,{direction:"right",scrollableContainerRef:d})]})},ei=n(645555);function ea(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function es(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function el(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var ec=function(e){var t=e.currentImage,n=j().updateImage;return(0,o.jsxs)("div",{className:"text-light flex items-center justify-between",children:[(0,o.jsx)(k.h,{name:"16-zoom-out",onClick:function(){var e=el(es({},(0,i.cloneDeep)(t)),{zoom:t.zoom-.1});e.zoom>=1&&n(e)},className:"mr-3",iconSize:16,buttonSize:28,ariaLabel:(0,a.t)("zoom_out")}),(0,o.jsx)("div",{className:"flex h-4 w-32 items-center",children:(0,o.jsxs)(ei.i.Root,{value:[Math.round(10*t.zoom)/10],max:5,min:1,step:.1,onValueChange:function(e){var r=(function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,1)||function(e,t){if(e){if("string"==typeof e)return ea(e,1);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ea(e,t)}}(e,1)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];r!==t.zoom&&n(el(es({},(0,i.cloneDeep)(t)),{zoom:r}))},children:[(0,o.jsx)(ei.i.Track,{children:(0,o.jsx)(ei.i.Range,{className:"!bg-badge"})}),(0,o.jsx)(ei.i.Thumb,{className:"before:!bg-badge"})]})}),(0,o.jsx)(k.h,{onClick:function(){var e=el(es({},(0,i.cloneDeep)(t)),{zoom:t.zoom+.1});e.zoom<=5&&n(e)},className:"ml-3",name:"16-zoom-in",iconSize:16,buttonSize:28,ariaLabel:(0,a.t)("zoom_in")})]})};function eu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ed=function(e){var t,n=e.status,r=e.overallProgress,i=e.fileStates,l=e.editingImageSignedId,c=e.onDeleteAllImages,u=(t=(0,s.useState)(0),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return eu(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eu(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=u[0],f=u[1],m=j(),p=m.selectedFiles,b=m.uploadedImages,h=p[d],v=(0,s.useRef)(p.length),y=v.current,g=p.length;return(g>0&&d>g-1?f(p.length-1):g>y&&f(y),v.current=g,h)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:O()("border-primary flex grow flex-col overflow-hidden rounded-md border",{"bg-tertiary":"uploading"===n}),children:["idle"===n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(D,{currentImage:h}),(0,o.jsxs)("div",{className:O()("border-primary flex border-t px-4 py-3",{"justify-between":0===d,"justify-end":d>0}),children:[0===b.length&&0===d&&(0,o.jsx)(A,{}),(0,o.jsx)(ec,{currentImage:h})]})]}),("uploading"===n||"completed"===n)&&(0,o.jsxs)("div",{className:"mb-12 mt-1 flex aspect-video flex-col items-center justify-center gap-4",children:[(0,o.jsx)(S.D,{percentage:r,size:22,strokeWidth:1.75}),(0,o.jsx)(P.Z.LabelMd,{color:"text-default",children:(0,a.t)("image_space.post_modal.steps.adjust_images.uploading")})]}),"error"===n&&(0,o.jsx)("div",{className:"mb-12 mt-1 flex aspect-video flex-col items-center justify-center gap-4",children:(0,o.jsx)(P.Z.LabelMd,{color:"text-default",children:(0,a.t)("image_space.post_modal.steps.adjust_images.files_error")})})]}),(0,o.jsx)(eo,{currentImageIndex:d,selectedFiles:p,setCurrentImageIndex:f,fileStates:i,status:n,editingImageSignedId:l,onDeleteAllImages:c})]}):null},ef=n(279460),em=n(547144);function ep(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function eb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function eh(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function ev(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||eg(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ey(e){return function(e){if(Array.isArray(e))return ep(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||eg(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eg(e,t){if(e){if("string"==typeof e)return ep(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ep(e,t)}}var ex=function(){var e=ev((0,s.useState)([]),2),t=e[0],n=e[1],r=ev((0,s.useState)(0),2),o=r[0],i=r[1];return(0,s.useEffect)(function(){var e=t.reduce(function(e,t){return e+t.progress},0);i(t.length?e/t.length:0)},[t]),{status:t.some(function(e){return"error"===e.status})?"error":t.every(function(e){return"idle"===e.status})?"idle":t.every(function(e){return"completed"===e.status})?"completed":"uploading",fileStates:t,overallProgress:o,reset:function(){n([]),i(0)},uploadFiles:function(e){n(e.map(function(){return{progress:0,status:"idle"}})),e.forEach(function(e,t){new ef.TX(e,(0,em.hq)(),{directUploadWillStoreFileWithXHR:function(e){e.upload.addEventListener("loadstart",function(){n(function(e){var n=ey(e);return n[t]=eh(eb({},n[t]),{status:"uploading"}),n})}),e.upload.addEventListener("progress",function(e){n(function(n){var r=ey(n);return r[t]=eh(eb({},r[t]),{progress:e.loaded/e.total*100}),r})})}}).create(function(e,r){if(e)throw n(function(e){var n=ey(e);return n[t]=eh(eb({},n[t]),{status:"error"}),n}),Error("Direct upload failed: ".concat(null==e?void 0:e.message));n(function(e){var n=ey(e);return n[t]=eh(eb({},n[t]),{status:"completed",progress:100,response:eb({blob_url:(0,em.Gd)({signed_id:r.signed_id,filename:encodeURIComponent(r.filename)})},r)}),n})})})}}};function e_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var ej=function(e,t){var n,r,o,i;return e.width/e.height>t?(o=Math.round(e.height*t),i=e.height,n=Math.round((e.width-o)/2),r=0):(o=e.width,i=Math.round(e.width/t),n=0,r=Math.round((e.height-i)/2)),{x:n,y:r,width:o,height:i}},ew=function(){var e=j(),t=e.selectedFiles,n=e.setSelectedFiles,r=e.galleryAspectRatio,o=e.setUploadedImages,i=e.addUploadedImages,a=e.uploadedImages,s=e.setIsImagesDirty,l=ex(),c=l.status,u=l.overallProgress,d=l.reset,f=l.fileStates,m=l.uploadFiles;return{uploadImages:function(){if(!r)throw Error("Gallery aspect ratio not set");Promise.all(t.map(function(e){return new Promise(function(t,n){var o=new Image,i=document.createElement("canvas"),a=i.getContext("2d");if(e.croppedAreaPixels){var s=e.croppedAreaPixels;parseFloat((s.width/s.height).toFixed(2))!==parseFloat(r.toFixed(2))&&(e.croppedAreaPixels=void 0)}o.src=URL.createObjectURL(e.file),o.onload=function(){var n=e.croppedAreaPixels||ej(o,r);i.width=n.width,i.height=n.height,null==a||a.drawImage(o,n.x,n.y,n.width,n.height,0,0,n.width,n.height),i.toBlob(function(r){r&&t({croppedImage:new File([r],e.file.name,{type:"image/jpeg",lastModified:new Date().getTime()}),croppedArea:n})},"image/jpeg")},o.onerror=function(e){n(e)}})})).then(function(e){n(t.map(function(t,n){var r,o;return r=e_({},t),o=o={croppedAreaPixels:e[n].croppedArea},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))}),r})),m(e.map(function(e){return e.croppedImage}))}).catch(function(e){throw Error("Error processing images: ".concat(e))})},overallProgress:u,resetUploads:d,status:c,fileStates:f,updateStoredImages:function(e){if(e){var n=t[0],r={signed_id:f[0].response.signed_id,url:f[0].response.blob_url,original_url:f[0].response.blob_url,filename:f[0].response.filename,width:n.croppedAreaPixels.width,height:n.croppedAreaPixels.height};o(a.map(function(t){return t.signed_id===e?e_({},t,r):t}))}else i(f.map(function(e,n){return{signed_id:e.response.signed_id,url:e.response.blob_url,original_url:e.response.blob_url,filename:e.response.filename,width:t[n].croppedAreaPixels.width,height:t[n].croppedAreaPixels.height}}));s(!0)}}},eO=function(e){var t=e.onClose,n=e.onCompleted,r=void 0===n?i.noop:n,u=e.isOnTop,f=void 0!==u&&u,p=e.editingImageSignedId,b=j(),h=b.setCurrentStep,v=b.resetSelectedFiles,y=ew(),g=y.uploadImages,x=y.overallProgress,_=y.resetUploads,w=y.status,O=y.fileStates,S=y.updateStoredImages,P=function(){v(),f?t():h(d)};return(0,s.useEffect)(function(){"completed"===w?(S(p),_(),v(),h(m),r(),f&&t()):"error"===w&&_()},[f,w]),(0,o.jsxs)(c.u_,{isOpen:!0,onClose:function(){v(),t()},contentPortalId:"adjust-images-modal-portal",children:[(0,o.jsx)(c.u_.Overlay,{}),(0,o.jsxs)(c.u_.Content,{size:"xl",children:[(0,o.jsxs)(c.u_.Header,{children:[(0,o.jsx)(c.u_.Title,{size:"sm",children:(0,a.t)("image_space.post_modal.steps.adjust_images.title")}),(0,o.jsxs)(c.u_.HeaderActions,{className:"!gap-3",children:[(0,o.jsx)(l.z,{type:"button",variant:"secondary",onClick:P,children:(0,a.t)("cancel")}),(0,o.jsx)(l.z,{type:"submit",variant:"circle",disabled:"uploading"===w,onClick:function(){return g()},children:f?(0,a.t)("save"):(0,a.t)("next")})]})]}),(0,o.jsx)(c.u_.Body,{className:"flex flex-col pb-5 pt-4",children:(0,o.jsx)(ed,{status:w,fileStates:O,overallProgress:x,editingImageSignedId:p,onDeleteAllImages:P})})]})]})},eS=n(131906),eP=n(903225),eC=n(227053),ek=n(776810),eI=n(534962);function eN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function eA(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var eM=function(e){var t=e.payload,n=e.space,r=e.uploadedImages;return{post:eA(eN({},(0,i.omit)(t,["gallery"])),{space_id:null==n?void 0:n.id,gallery_attributes:eA(eN({},t.gallery),{images_attributes:r.map(function(e){return{id:e.id,image:e.signed_id,width:e.width,height:e.height}})})})}},eT=function(e){var t=e.space,n=e.post,r=e.onSuccess,o=(0,G.pm)(),i=j(),s=i.setIsSubmitting,l=i.uploadedImages,c=!!n.slug,u=(0,eS.useMutation)(function(e){return n.slug?(0,eI._u)({spaceId:t.id,postSlug:n.slug,payload:e}):(0,eI.x6)({spaceId:t.id,payload:e})},{onSuccess:function(e){s(!1),r(e),o.success((0,a.t)(c?"quick_post.toasts.changes_saved":"quick_post.toasts.".concat(e.status,"_saved")))},onError:function(e){s(!1),o.error(e.errorDetails,{shouldShowCloseButton:!0,shouldUseProgress:!1})}}).mutate;return{onSubmit:function(e){s(!0),u(eM({payload:e,space:t,uploadedImages:l}))}}},eE=n(941084),eR=n(1892),eD=n(441342),eL=n(767900),eF=n(227851),eU=n(119614),eB=n(430009),eq=n(477646),ez=n(60589),eZ=n(805765);function eV(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var eH=function(e){var t,n=e.post,r=(t=(0,s.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return eV(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eV(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=r[0],c=r[1],u=(0,z.j)(),d=(0,eF.Gc)(),f=d.watch,m=d.setValue,p=j(),b=p.isSubmitting,h=p.uploadedImages,v=p.isScheduledBarPortalRendered,y=(0,eD.L2)().data,g=f(),x=g.published_at,_=g.status,w=g.topics,O=(null==y?void 0:y.require_topic_selection)&&0>=Number(null==w?void 0:w.length),S=h.length>0&&!b&&!O,P=!!(null==n?void 0:n.id),k=(0,eE.Hz)(n),I="quick_post.scheduled_post_ui.".concat(b?"submitting_button":"submit_button"),N=[{icon:"16-download",label:(0,a.t)("".concat(I,".save_draft")),value:"draft"},{icon:"16-calendar",label:(0,a.t)("".concat(I,".schedule_post")),value:"scheduled"},{icon:"16-publish",label:(0,a.t)("".concat(I,".publish")),value:"published"}],A=(0,i.find)(N,{value:_||"published"}),M=function(e){"scheduled"===e.value?c(!0):(m("status",e.value),c(!1),T(null))},T=function(e){m("published_at",e)},E=function(){M(N[0])},R=y&&(0,ez.k8)(y)&&!k;return(0,o.jsxs)(o.Fragment,{children:[v&&(0,o.jsx)(eq.e,{publishedAt:x,revertToDraftState:E,status:_,updatePublishedAt:T,variant:u?"2-lines":"default"}),(0,o.jsx)(eU.M,{datePickerVisible:l,onCancel:function(e){e&&e.preventDefault(),c(!1),"scheduled"===_&&E()},value:x,onSave:function(e){T(e),m("status","scheduled"),c(!1)},placement:"bottom-end",saveButtonVariant:"circle",children:R?(0,o.jsx)(C.T,{disabled:!O,content:(0,a.t)("quick_post_v2.error_messages.no_topics"),trigger:"mouseenter click focus focusin",placement:"bottom",children:(0,o.jsx)(eZ.F,{type:"submit",disabled:!S,selectedAction:A,setSelectedAction:M,options:N,variant:"circle"})}):(0,o.jsx)(C.T,{disabled:!O,content:(0,a.t)("quick_post_v2.error_messages.no_topics"),trigger:"mouseenter click focus focusin",placement:"bottom",children:(0,o.jsx)(eB.a,{isEdit:P,isDisabled:!S})})})]})},eW=n(208413),eQ=n(751169);function eG(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function e$(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var eK=function(e){var t=e.isDragActive,n=e.getRootProps,r=e.getInputProps,i=e.open,s=e.className,l="image_space.post_modal.steps.upload_images";return(0,o.jsx)("div",e$(eG({},n()),{className:"group size-full",children:(0,o.jsxs)("button",{type:"button",className:O()("flex size-full flex-col items-center justify-center px-4 text-center",s),onClick:i,children:[(0,o.jsx)("input",e$(eG({},r()),{"data-testid":"upload_multi_image"})),(0,o.jsx)(F.JO,{size:24,type:"24-circle-arrow-up",className:O()("text-default !h-6 !w-6",{"group-hover:text-messaging-info-blue":!t})}),(0,o.jsx)("div",{className:"mb-1 mt-3",children:(0,o.jsxs)(P.Z.LabelMd,{weight:"semibold",color:O()("text-dark",{"group-hover:text-messaging-info-blue":!t}),children:[(0,a.t)("".concat(l,".drag_and_drop_up_to_n_images"),{max_images:10}),t&&" "+(0,a.t)("".concat(l,".here"))]})}),!t&&(0,o.jsx)(P.Z.LabelSm,{color:"text-default group-hover:text-messaging-info-blue",children:(0,a.t)("".concat(l,".recommendation"))})]})}))};function eJ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var eX=function(){var e,t,n,r=(e=(0,s.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return eJ(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eJ(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],a=r[1],l=j(),c=l.selectedFiles,u=l.uploadedImages,d=$({handleFileSelection:W(function(){return a(!0)}).handleFileSelection,selectedFiles:c,uploadedFilesCount:u.length}),f=d.isDragActive,m=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(d,["isDragActive"]);return(0,o.jsxs)("div",{className:O()("flex size-full flex-col items-center justify-center rounded-md px-4 text-center",{"!bg-light-blue":f}),children:[(0,o.jsx)(eK,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({isDragActive:f},m),n=n={className:"pb-0"},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t)),i&&(0,o.jsx)(eO,{onClose:function(){return a(!1)},isOnTop:!0})]})},eY=n(943544),e0=n(719499),e1=function(){var e=j(),t=e.setUploadedImages,n=e.uploadedImages,r=e.setIsImagesDirty;return{removeImage:function(e){t(n.filter(function(t){return t!==e})),r(!0)}}};function e2(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function e3(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function e6(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){e3(i,r,o,a,s,"next",e)}function s(e){e3(i,r,o,a,s,"throw",e)}a(void 0)})}}function e5(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var e4=function(e){var t=e.url,n=e.fileName,r=e.contentType;return e6(function(){return e5(this,function(e){switch(e.label){case 0:return[4,fetch(t)];case 1:return[4,e.sent().blob()];case 2:return[2,new File([e.sent()],n,{type:r,lastModified:new Date().getTime()})]}})})()},e7=function(e){var t,n=e.currentImage,r=(t=(0,s.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return e2(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e2(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],l=r[1],c=e1().removeImage,u=W(function(){return l(!0)}).handleFileSelection,d="image_space.post_modal.steps.create_post.image_options",f=[{value:(0,a.t)("".concat(d,".crop_image")),label:(0,a.t)("".concat(d,".crop_image")),icon:"16-crop",onClick:function(){return e6(function(){return e5(this,function(e){switch(e.label){case 0:return[4,e4({url:n.original_url,fileName:n.filename,contentType:"image/jpeg"})];case 1:return u([e.sent()]),[2]}})})()}},{value:(0,a.t)("".concat(d,".remove")),label:(0,a.t)("".concat(d,".remove")),icon:"16-trash-bin",onClick:function(){c(n)}}];return(0,o.jsxs)(o.Fragment,{children:[i&&(0,o.jsx)(eO,{onClose:function(){return l(!1)},isOnTop:!0,editingImageSignedId:n.signed_id}),(0,o.jsx)(eY.Lt,{direction:"bottom-end",className:"absolute right-4 top-4",button:(0,o.jsx)(k.h,{name:"16-menu-dots-horizontal",iconClassName:"!text-dark",className:"bg-primary border-primary rounded-full border",ariaLabel:(0,a.t)("".concat(d,".label"))}),children:(0,o.jsx)(e0.A,{options:f,linkType:"button"})})]})};function e9(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function e8(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return e9(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e9(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var te=function(e){var t,n=e.currentImageIndex,r=(0,s.useRef)(null),i=(0,s.useRef)(null),a=e8((0,s.useState)(!0),2),l=a[0],c=a[1],u=e8((0,s.useState)(),2),d=u[0],f=u[1],m=j(),p=m.uploadedImages,b=m.galleryAspectRatio,h=m.setGalleryAspectRatio,v=p[n];return((0,s.useEffect)(function(){!b&&v&&h(v.width/v.height)},[b,v,h]),(0,s.useEffect)(function(){if(!l&&i.current){var e=i.current.getBoundingClientRect();f(e.width/e.height)}},[l,i]),v)?(b&&d&&(t=b>d?"w-full my-auto":b<d?"h-full":"h-full w-full"),(0,o.jsxs)("div",{className:"flex justify-center overflow-auto md:grow",ref:i,children:[l&&(0,o.jsx)(eQ.a,{}),(0,o.jsxs)("div",{className:O()("relative",t),children:[(0,o.jsx)(e7,{currentImage:v}),(0,o.jsx)("img",{loading:"eager",ref:r,src:v.url,alt:v.filename,onLoad:function(){return c(!1)},className:O()("rounded-md",{hidden:l},t)})]})]})):(0,o.jsx)(eX,{})};function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tn=function(e){var t,n=e.image,r=e.index,i=e.currentImageIndex,a=e.onClick,l=(t=(0,s.useState)(!0),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return tt(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tt(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=l[0],u=l[1];return(0,o.jsx)("button",{type:"button",onClick:function(){return a(r)},className:O()("cursor-pointer touch-none select-none rounded-lg border-2 border-transparent p-0.5",{"border-secondary":r===i&&!c,"bg-tertiary mx-1 size-12 animate-pulse":c}),children:(0,o.jsx)("img",{loading:"eager",src:n.url,className:O()("size-12 rounded-md object-cover",{hidden:c}),onLoad:function(){return u(!1)},alt:n.filename})})},tr=function(e){var t=e.isOverlay,n=(0,U.dI)().item;return(0,o.jsx)("div",{className:O()("rounded-lg border-2 border-transparent p-0.5 opacity-50",{"!opacity-100":void 0!==t&&t}),children:(0,o.jsx)("img",{loading:"eager",src:n.url,className:"size-12 rounded-md object-cover",alt:n.filename})})};function to(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ti(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function ta(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function ts(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return to(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return to(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var tl=function(e){var t=e.setCurrentImageIndex,n=e.currentImageIndex,r=ts((0,s.useState)(!1),2),i=r[0],a=r[1],l=(0,s.useRef)(null),u=ts((0,L.A)(),2),d=u[0],f=u[1],m=ts((0,L.A)(),2),p=m[0],b=m[1],h=(0,c.UV)().contentPortalElement,v=j(),y=v.uploadedImages,g=v.setUploadedImages,x=v.selectedFiles,_=v.resetSelectedFiles,w=v.setIsImagesDirty,O=$({handleFileSelection:W(function(){return a(!0)}).handleFileSelection,selectedFiles:x,uploadedFilesCount:y.length}),S=O.getInputProps,P=O.open,C=e1().removeImage,k=y.map(function(e){return ta(ti({},e),{id:e.signed_id,originalId:e.id})}),I=k[n];return(0,o.jsxs)("div",{className:"relative mt-5 flex",children:[!f&&(0,o.jsx)(H,{direction:"left",scrollableContainerRef:l}),(0,o.jsxs)(U.cm,{shouldUseKeyboardSensor:!1,distance:10,items:k,onSort:function(e){var r=e.indexOf(I);r!==n&&t(r),g(e.map(function(e){return ta(ti({},e),{id:e.originalId})})),w(!0)},restrictToParentElement:!0,children:[(0,o.jsx)(U.Fo,{children:(0,o.jsxs)("div",{className:"scrollbar-hide m-auto !flex items-center overflow-x-scroll px-1 pt-1",ref:l,children:[(0,o.jsx)("div",{className:"size-px",ref:d}),y.map(function(e,r){return(0,o.jsxs)(q.c,{tabIndex:-1,item:k[r],disabled:1===y.length,placeholder:tr,className:"group relative !w-auto shrink-0",dataTestId:"thumbnail-item",children:[(0,o.jsx)(Z,{onClick:function(){return C(e)},index:r,currentImageIndex:n}),(0,o.jsx)(tn,{image:e,index:r,currentImageIndex:n,onClick:t})]},e.signed_id)}),y.length<10&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("button",{type:"button",className:"hover:bg-secondary text-default ml-1 flex size-12 shrink-0 cursor-pointer items-center justify-center rounded-md border border-dashed",onClick:function(){_(),P()},children:[(0,o.jsx)("input",ti({},S())),(0,o.jsx)(F.JO,{type:"20-add-lg",size:20})]}),i&&(0,o.jsx)(eO,{onClose:function(){return a(!1)},onCompleted:function(){return setTimeout(function(){return V({direction:"right",scrollableContainerRef:l})},200)},isOnTop:!0})]}),(0,o.jsx)("div",{className:"size-px",ref:p})]})}),(0,o.jsx)(B.y,{portalTo:h,children:(0,o.jsx)(tr,{isOverlay:!0})})]}),!b&&(0,o.jsx)(H,{direction:"right",scrollableContainerRef:l})]})};function tc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tu=function(){var e,t=(e=(0,s.useState)(0),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return tc(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tc(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=t[0],r=t[1],i=!(0,z.j)(),a=j(),l=a.uploadedImages,c=a.setIsScheduledBarPortalRendered,u=(0,s.useRef)(l.length),d=u.current,f=l.length;return f>0&&n>f-1?r(l.length-1):f>d&&r(d),u.current=f,(0,s.useEffect)(function(){i&&c(!0)},[i,c]),(0,o.jsxs)("div",{className:"flex max-h-full w-full flex-col justify-center overflow-auto lg:h-full lg:w-3/4",children:[i&&(0,o.jsx)("div",{id:eW.U}),(0,o.jsxs)("div",{className:"flex max-h-full min-h-[20rem] w-full flex-col overflow-auto p-6",children:[(0,o.jsx)(te,{currentImageIndex:n}),l.length>0&&(0,o.jsx)(tl,{currentImageIndex:n,setCurrentImageIndex:r})]})]})},td=n(780754),tf=n(359892),tm=n(912306),tp=n(645111),tb=function(e){var t=e.editor,n=e.portalId;return t?(0,o.jsx)(tm.h,{selectorQuery:"#".concat(n),children:(0,o.jsx)("div",{className:"flex items-center md:pt-2",children:(0,o.jsx)(tp.c,{popoverPanelClassName:"md:!w-[21rem]",onEmojiSelect:function(e){return t.chain().focus().insertContent(e.emoji).run()},targetWrapperClassName:"!flex",target:(0,o.jsx)(k.h,{iconSize:20,buttonSize:28,iconClassName:"!text-dark !w-6 !h-6",name:"20-emoji",ariaLabel:(0,a.t)("emoji_picker")})})})}):null},th=["blockquote","poll","embeds","slash_commands","file","image","horizontal_rule","code_block","headings","cta"],tv=function(e){var t,n=e.space,r=e.post,i=j().setIsFormDirty,l=(0,eF.Gc)().formState.isDirty;return(0,s.useEffect)(function(){i(l)},[l,i]),(0,o.jsxs)("div",{className:"border-b-primary border-y p-6 pb-4 lg:border-t-0",children:[(0,o.jsx)(P.Z.LabelMd,{weight:"semibold",children:(0,a.t)("image_space.post_modal.steps.create_post.caption_label")}),(0,o.jsx)(tf.$,{placeholder:(0,a.t)("image_space.post_modal.steps.create_post.caption_placeholder"),name:"tiptap_body.body",sgidToObjectMap:(null==r||null==(t=r.tiptap_body)?void 0:t.sgids_to_object_map)||{},spaceId:null==n?void 0:n.id,editorClassName:"min-w-full h-40 overflow-y-scroll mt-3",disabledExtensions:th,shouldShowTextModifiersMenu:!1,toolbars:[{portalId:"create-image-post-toolbar",component:tb}]}),(0,o.jsx)("div",{id:"create-image-post-toolbar"})]})},ty=function(e){var t=e.space,n=!!t&&(0,ez.k8)(t);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eL.l.Item,{variant:"extra-bottom-margin",className:"!pt-3",hideBorder:!0,name:"slug",fullWidth:!0,translationRoot:"post",hidePlaceholder:!0,hideDescription:!0,tooltipText:(0,a.t)("post.slug_description"),children:(0,o.jsx)(eL.l.Input,{name:"slug",autoComplete:"off"})}),n&&(0,o.jsx)(eL.l.Item,{variant:"extra-bottom-margin",className:"!pt-4",hideBorder:!0,name:"user_id",translationRoot:"post",fullWidth:!0,hideDescription:!0,tooltipText:(0,a.t)("post.user_id_description"),children:(0,o.jsx)(eL.l.CommunityMemberSelect,{name:"user_id",direction:"up",valueField:"user_id"})})]})},tg=function(e){var t=e.space,n=(0,eC.m)().post,r={hide_meta_info:!0,is_comments_disabled:!0,is_comments_closed:!(0,(0,eF.Gc)().watch)("is_comments_disabled"),is_liking_disabled:!0,is_truncation_disabled:!0,pin_to_top:!!n.id&&(0,eE.Hz)(n),hide_from_featured_areas:!(null==t?void 0:t.hide_from_featured_areas),"gallery.downloadable_images":!0},i=Object.keys(r).filter(function(e){return r[e]});return(0,o.jsx)(o.Fragment,{children:i.map(function(e){return(0,o.jsx)(eL.l.Item,{id:"post_".concat(e),name:e,label:(0,a.t)("post.".concat(e)),labelClassName:"!font-normal !p-0",className:"mb-3 !p-0",hideBorder:!0,hideDescription:!0,inlineReverse:!0,children:(0,o.jsx)(eL.l.ToggleSwitch,{name:e,variant:"small"})},e)})})};function tx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var t_=function(e){var t,n=e.space,r=(t=(0,s.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return tx(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tx(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],l=r[1];return(0,o.jsxs)("div",{className:"border-primary border-b",children:[(0,o.jsxs)("button",{type:"button",className:"flex w-full items-center justify-between px-6 py-5",onClick:function(){return l(!i)},"aria-expanded":i,children:[(0,o.jsx)(P.Z.LabelMd,{weight:"semibold",children:(0,a.t)("image_space.post_modal.steps.create_post.more_options_label")}),(0,o.jsx)(F.JO,{type:i?"cheveron-up":"cheveron-down",size:20})]}),i&&(0,o.jsxs)("div",{className:"mb-5 px-6",children:[(0,o.jsx)(tg,{space:n}),(0,o.jsx)(ty,{space:n})]})]})},tj=function(e){var t=e.post,n=e.space,r=n&&(0,ez.Y_)(n),i=j().setIsScheduledBarPortalRendered,l=(0,z.j)();return(0,s.useEffect)(function(){l&&i(!0)},[l,i]),(0,o.jsxs)("div",{className:"border-primary w-full lg:h-full lg:w-1/4 lg:overflow-scroll lg:border-l",children:[l&&(0,o.jsx)("div",{id:eW.U}),(0,o.jsx)(tv,{space:n,post:t}),(n.topics_count>0||r)&&(0,o.jsx)("div",{className:"border-primary border-b px-6 pb-2",children:(0,o.jsx)(eL.l.Item,{name:"topics",hideDescription:!0,hideBorder:!0,label:(0,a.t)("image_space.post_modal.steps.create_post.topics_label"),labelClassName:"!mb-3",children:(0,o.jsx)(td.w,{containerClassName:"!p-0 -mx-1",name:"topics",spaceId:n.id,creatable:r})})}),(0,ez.Y_)(n)&&(0,o.jsx)(t_,{space:n})]})};function tw(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var tO=function(e){var t=e.onClose,n=e.onPostChange,r=e.shouldSkipRedirectAfterSubmit,s=(0,ek.T)().invalidatePostsApiQueries,u=(0,eC.m)().post,d=(0,eD.L2)().data,f=(0,eP.k6)(),m=(0,eS.useQueryClient)(),p=eT({space:d,post:u,onSuccess:function(e){var o;return(o=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(o){switch(o.label){case 0:return n(u),[4,m.invalidateQueries({queryKey:[eR.j]})];case 1:return o.sent(),[4,s()];case 2:return o.sent(),t(!0),r||f.push((0,eE.RG)({post:e})),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var i=o.apply(e,t);function a(e){tw(i,n,r,a,s,"next",e)}function s(e){tw(i,n,r,a,s,"throw",e)}a(void 0)})})()}}).onSubmit;return(0,o.jsx)(c.u_,{isOpen:!0,onClose:t,contentPortalId:"create-post-modal-portal",children:(0,o.jsxs)(eL.l,{onSubmit:p,defaultValues:(0,i.pick)(u,["tiptap_body","hide_meta_info","is_comments_disabled","is_comments_closed","is_liking_disabled","is_truncation_disabled","pin_to_top","pinned_at","hide_from_featured_areas","gallery.downloadable_images","slug","user_id","status","published_at","topics"]),formClassName:"fixed inset-0 z-[1060]",children:[(0,o.jsx)(c.u_.Overlay,{}),(0,o.jsxs)(c.u_.Content,{size:"full",className:"sm:!max-h-[836px] sm:!max-w-[1312px]",children:[(0,o.jsxs)(c.u_.Header,{className:"z-10 md:!py-4",children:[(0,o.jsx)(P.Z.TitleSm,{weight:"font-semibold",children:(0,a.t)("".concat("image_space.post_modal.steps.create_post",".").concat(u.id?"edit":"create","_title"))}),(0,o.jsxs)(c.u_.HeaderActions,{className:"!gap-3",children:[(0,o.jsx)(l.z,{type:"button",variant:"secondary",onClick:function(){return t(!1)},children:(0,a.t)("cancel")}),(0,o.jsx)(eH,{post:u})]})]}),(0,o.jsxs)(c.u_.Body,{className:"md:border-primary flex flex-wrap content-start !p-0 md:border-t",children:[(0,o.jsx)(tu,{}),(0,o.jsx)(tj,{post:u,space:d})]})]})]})})},tS=function(e){var t,n,r=e.onClose,i=e.onSelection,a=j(),s=a.selectedFiles,l=a.uploadedImages,u=$({handleFileSelection:W(i).handleFileSelection,selectedFiles:s,uploadedFilesCount:l.length}),d=u.isDragActive,f=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(u,["isDragActive"]);return(0,o.jsxs)(c.u_,{isOpen:!0,onClose:r,contentPortalId:"upload-images-modal-portal",children:[(0,o.jsx)(c.u_.Overlay,{}),(0,o.jsxs)(c.u_.Content,{size:"xl",className:O()("aspect-square",{"!bg-light-blue":d}),children:[(0,o.jsxs)(c.u_.Header,{children:[(0,o.jsx)(c.u_.Title,{size:"sm",children:" "}),(0,o.jsx)(c.u_.HeaderActions,{children:(0,o.jsx)(c.u_.CloseButton,{onClick:r,className:O()({"!bg-light-blue":d})})})]}),(0,o.jsx)(c.u_.Body,{className:"flex cursor-pointer flex-col items-center justify-center !p-0",children:(0,o.jsx)(eK,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({isDragActive:d},f),n=n={className:"pb-14"},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))})]})]})},tP=function(e){var t=j(),n=t.setCurrentStep,r=t.setUploadedImages;(0,s.useEffect)(function(){n((null==e?void 0:e.gallery)?m:d),(null==e?void 0:e.gallery)&&r(e.gallery.images)},[null==e?void 0:e.gallery,n,r])},tC=function(e){var t=(0,eR.t)({spaceId:null==e?void 0:e.space_id,postSlug:null==e?void 0:e.slug,disabled:e&&"gallery"in e}),n=t.post;return t.isLoading?null:n||e||{id:null,gallery:null}},tk=n(757105),tI=n(257210),tN=function(e){var t=e.spaceId,n=e.onClose,r=e.currentPost,s=e.onPostChange,l=void 0===s?i.noop:s,c=e.shouldSkipRedirectAfterSubmit,u=(0,tk.dd)(),m=j(),p=m.currentStep,b=m.setCurrentStep,h=m.reset,v=m.isFormDirty,y=m.isImagesDirty,g=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(e||!(v||y)||confirm((0,a.t)("quick_post_v2.accidental_leave_confirmation")))&&(h(),n())},x=tC(r);if(tP(x),!u||!u.visible||!x)return null;var _=[[x.id]];return(0,o.jsx)(eD.mE,{spaceId:t,children:(0,o.jsx)(tI._x,{perPagePostIds:_,children:(0,o.jsxs)(eD.DW,{post:x,children:[p===d&&(0,o.jsx)(tS,{onClose:g,onSelection:function(){return b(f)}}),p===f&&(0,o.jsx)(eO,{onClose:g}),p!==d&&p!==f&&(0,o.jsx)(tO,{onClose:g,onPostChange:l,shouldSkipRedirectAfterSubmit:void 0!==c&&c})]})})})},tA=tk.gk.create(function(e){return(0,o.jsx)(tN,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),tM=function(){return(0,tk.dd)(tA)}},605603:function(e,t,n){n.d(t,{M:()=>l});var r=n(552676),o=n(932699),i=n(739792),a=n(701168),s=n(957363),l=function(e){var t=e.onChange,n=e.searchValue,l=e.onKeyPress,c=e.onClickCancel,u=void 0===c?o.noop:c,d=e.placeholder,f=void 0===d?(0,i.t)("messaging.actions.search_name"):d,m=e.className,p=e.showCancelButton,b=e.shouldAutoFocus;return(0,r.jsx)("div",{className:(0,a.A)("bg-primary isolate z-10 mx-2 flex w-full items-center justify-between gap-4"),children:(0,r.jsxs)("div",{className:(0,a.A)("bg-secondary-dark active:border-very-dark focus-within:bg-primary focus-within:border-very-dark active:bg-primary hover:border-dark hover:focus-within:border-very-dark border-hover group flex h-8 w-full flex-1 items-center gap-2 overflow-hidden rounded-lg border p-3 marker:mr-0 hover:bg-transparent md:p-1",void 0===m?"":m),children:[(0,r.jsx)(s.JO,{type:"16-search-v3",className:"text-light group-focus-within:text-dark group-active:text-dark ml-2",size:16,useWithFillCurrentColor:!0}),(0,r.jsx)("input",{className:"text-darkest placeholder:text-light text-xs-plus w-full rounded bg-transparent font-medium outline-none placeholder:opacity-100 sm:rounded-none",placeholder:f,"data-name":"v2-search","data-testid":"v2-search","aria-autocomplete":"list",value:n,onChange:function(e){return t(e.target.value)},onKeyPress:l,autoFocus:void 0!==b&&b}),(n||void 0!==p&&p)&&(0,r.jsx)(s.JO,{type:"20-close",className:"text-dark mr-2 !h-5 !w-5 cursor-pointer",size:20,useWithFillCurrentColor:!0,onClick:u})]})})}},929090:function(e,t,n){n.d(t,{V:()=>o,f:()=>i});var r=n(739792),o=function(e){return"post"===e?(0,r.t)("flagged_contents.moderation_info.post"):(0,r.t)("flagged_contents.moderation_info.comment")},i=function(e){return!!e.unresolved_flagged_reports_count}},624831:function(e,t,n){n.d(t,{F:()=>N,t:()=>A});var r=n(757105),o=n(552676),i=n(739792),a=n(741331),s=n(818285),l=n(434519),c=n(515863),u=n(131906),d=n(307992),f=n(251805),m=n(257210),p=n(60878),b=n(93199),h=n(547144);function v(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var y="settings.moderation.review_flagged_content_modal",g=function(e,t){var n=(0,p.pm)(),r=n.success,o=n.error,a=function(e,t){var n;return(n=function(){var n,r;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(o){switch(o.label){case 0:return n="post"===t?{post_id:e}:{comment_id:e},[4,(0,b.UT)(h.av.flaggedContent.index({params:n}))];case 1:if((r=o.sent())&&Array.isArray(r.records)&&r.records.length>0)return[2,r.records[0]];return[2,r]}})},function(){var e=this,t=arguments;return new Promise(function(r,o){var i=n.apply(e,t);function a(e){v(i,r,o,a,s,"next",e)}function s(e){v(i,r,o,a,s,"throw",e)}a(void 0)})})()},s=(0,u.useQueryClient)(),l=(0,u.useQuery)(["flagged-content",e,t],function(){return a(e,t)},{enabled:!!e}),c=l.data,g=l.isLoading,x=null==c?void 0:c.id,_=function(){if("post"===t){var n,r,o;(0,m.o1)({postId:e,queryClient:s}).forEach(function(e){s.invalidateQueries(e)})}else"comment"===t&&(s.refetchQueries((0,d.k)({postId:null==c||null==(n=c.flagged_contentable)?void 0:n.post_id,parentCommentId:null==c||null==(r=c.flagged_contentable)?void 0:r.parent_comment_id})),s.refetchQueries((0,f.z)({postId:null==c||null==(o=c.flagged_contentable)?void 0:o.post_id,id:e})))},j=(0,u.useMutation)({mutationFn:function(){var e;return e=String(x),(0,b.gN)(h.av.flaggedContent.approve({id:e}))},onSuccess:function(){_(),r((0,i.t)([y,"success_approving"]))},onError:function(){return o((0,i.t)([y,"error_approving"]))}}),w=j.mutate,O=j.isLoading,S=(0,u.useMutation)({mutationFn:function(e){var t,n,r=e.reason;return t=String(x),n=r,(0,b.gN)(h.av.flaggedContent.reject({id:t}),{action_reason_body:n})},onSuccess:function(){_(),r((0,i.t)([y,"success_rejecting"]))},onError:function(){return o((0,i.t)([y,"error_rejecting"]))}});return{approveFlaggedContent:w,isApproving:O,rejectFlaggedContent:S.mutate,isRejecting:S.isLoading,isLoading:g,flaggedContent:c}};function x(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function _(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){x(i,r,o,a,s,"next",e)}function s(e){x(i,r,o,a,s,"throw",e)}a(void 0)})}}function j(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var w=function(e){var t,n=e.flaggedContentId,u=e.flaggedContentType,d=(0,r.dd)(),f=g(n,u),m=f.approveFlaggedContent,p=f.rejectFlaggedContent,b=f.flaggedContent,h=f.isApproving,v=f.isRejecting,y=null!=b?b:{},x=y.flagged_contentable,w=y.reports,O=void 0===w?[]:w,S=y.status,P=null==x||null==(t=x.type)?void 0:t.toLowerCase(),C=null==O?void 0:O.length;return void 0===S||"post"!==P&&"comment"!==P?null:(0,o.jsxs)(l.u_,{isOpen:d.visible,onClose:d.hide,contentPortalId:"review-modal-content",children:[(0,o.jsx)(l.u_.Overlay,{}),(0,o.jsxs)(l.u_.Content,{size:"lg",children:[(0,o.jsxs)(l.u_.Header,{children:[(0,o.jsx)(l.u_.Title,{size:"sm",children:(0,i.t)("flagged_contents.moderation_info.reports_title",{count:C})}),(0,o.jsx)(l.u_.HeaderActions,{className:"absolute right-0 top-0 mr-6 mt-6",children:(0,o.jsx)(l.u_.CloseButton,{onClick:d.hide})})]}),(0,o.jsxs)(l.u_.Body,{className:"flex flex-col !p-0",children:[(0,o.jsx)(s.z,{content:b}),(0,o.jsx)(a.Q,{reports:O})]}),(0,o.jsx)(l.u_.Footer,{className:"!p-0",children:(0,o.jsx)(c.r,{i18nRoot:"settings.moderation.review_flagged_content_modal",status:S,isApproving:h,isRejecting:v,onApprove:function(){return _(function(){return j(this,function(e){switch(e.label){case 0:return m(),[4,d.hide()];case 1:return e.sent(),[2]}})})()},onReject:function(e){return _(function(){return j(this,function(t){switch(t.label){case 0:return p({reason:e}),[4,d.hide()];case 1:return t.sent(),[2]}})})()},contentType:P})})]})]})},O=r.gk.create(function(e){return(0,o.jsx)(w,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),S=n(900795),P=n(957363),C=n(592768),k=n(381636),I=n(929090),N=Object.assign({},{Regular:function(e){var t=e.record,n=e.contentType,r=A();if(!(0,I.f)(t))return null;var a=(0,I.V)(n);return(0,o.jsx)(C.a,{className:"!py-2",iconEl:(0,o.jsx)(P.JO,{className:"text-v2-warning",type:"20-info",size:20}),children:(0,o.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,o.jsxs)(k.Z.LabelSm,{children:[(0,i.t)("flagged_contents.moderation_info.flagged_report_content",{content:a}),(0,o.jsx)(S.w,{content:(0,i.t)("flagged_contents.moderation_info.flagged_report_count",{count:t.unresolved_flagged_reports_count}),as:"span"})]}),(0,o.jsx)("button",{type:"button",onClick:function(){return r.show({flaggedContentId:String(t.id),flaggedContentType:n})},className:"hover:bg-v2-warning-100 dark:hover:bg-primary rounded-full border border-black bg-transparent px-4 py-1 transition dark:border-white",children:(0,o.jsx)(k.Z.LabelSm,{weight:"semibold",children:(0,i.t)("flagged_contents.moderation_info.review_button")})})]})})},Short:function(e){var t=e.record,n=e.contentType,r=A();if(!(0,I.f)(t))return null;var a=(0,I.V)(n),s=(0,i.t)("flagged_contents.moderation_info.short_content",{content:a});return(0,o.jsx)("button",{type:"button",onClick:function(){return r.show({flaggedContentId:String(t.id),flaggedContentType:n})},className:"dark:bg-primary cursor-pointer rounded-lg bg-amber-50",children:(0,o.jsx)(C.a,{className:"!py-2",iconEl:(0,o.jsx)(P.JO,{className:"text-v2-warning",type:"20-info",size:20}),children:(0,o.jsx)(k.Z.LabelSm,{children:s})})})}}),A=function(){return(0,r.dd)(O)}},150788:function(e,t,n){n.d(t,{a:()=>s});var r=n(552676),o=n(275271),i=n(333448),a=n(767900),s=(0,o.forwardRef)(function(e,t){var n,o,s=e.currency,l=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["currency"]),c=s.code.toUpperCase(),u=s.direction===i.RV.rtl?(0,r.jsx)("div",{className:"px-4 py-2",children:c}):null,d=s.direction===i.RV.ltr?(0,r.jsx)(r.Fragment,{children:c}):null;return(0,r.jsx)(a.l.Input,(n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},l),o=o={ref:t,inputMode:"numeric",prefixWrapperClassName:"bg-primary! border-primary! rounded-l-lg! relative! -mr-px! inline-flex! items-center! space-x-2! border! sm:text-sm!",prefix:u,suffix:d},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}),n))});s.displayName="PaywallCurrencyAmountFormInput"},918:function(e,t,n){n.d(t,{e:()=>b});var r=n(552676),o=n(275271),i=n(131906),a=n(739792),s=n(381881),l=n(546122),c=n(346681),u=n(619803),d=n.n(u),f=function(e){var t=e.value,n=e.handleFeedback,o=e.isFeedbackGiven,i=void 0===o?null:o;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{className:d()("w-full rounded-lg border px-6 py-2.5 align-baseline font-medium",{"text-dark border-gray-300 dark:border-gray-500":null===t||!1===t,"border-circle text-circle border-2":!0===t,"!cursor-not-allowed":i,"hover:border-secondary dark:hover:border-secondary":!i}),onClick:function(){return!0!==t&&n(!0)},type:"button",children:(0,a.t)("support_widget.feedback_yes")}),(0,r.jsx)("button",{className:d()("w-full rounded-lg border px-6 py-2.5 align-baseline font-medium",{"text-dark border-gray-300 dark:border-gray-500":null===t||!0===t,"border-circle text-circle border-2":!1===t,"!cursor-not-allowed":i,"hover:border-secondary dark:hover:border-secondary":!i}),onClick:function(){return!1!==t&&n(!1)},type:"button",children:(0,a.t)("support_widget.feedback_no")})]})};function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var b=function(e){var t=e.post,n=p((0,o.useState)(null),2),u=n[0],d=n[1],m=p((0,o.useState)(!1),2),b=m[0],h=m[1],v=(0,i.useMutation)(function(e){var t=e.postId,n=e.value;return s.R.createPostFeedback({postId:t,helpful:n})}).mutate;return(0,r.jsxs)("div",{className:"mx-auto w-full pt-4",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(c.Di,{weight:"semibold",children:(0,a.t)("support_widget.was_this_article_helpful")})}),(0,r.jsx)("div",{className:"mb-6 flex justify-center gap-4",children:(0,r.jsx)(f,{value:u,handleFeedback:function(e){b||(d(e),v({postId:t.id,value:e}),h(!0))},isFeedbackGiven:b})}),(0,r.jsx)("div",{children:(u||!1===u)&&(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)(l.p,{children:(0,a.t)("support_widget.thank_you_for_article_feedback")})})})]})}},352521:function(e,t,n){n.d(t,{d:()=>s});var r=n(275271),o=n(932699),i=n(903225),a=n(89864),s=function(){var e=(0,i.k6)();if(!e)throw Error("useNavigateToPost must be used within a Router component");return{navigateToPost:(0,r.useCallback)(function(t){var n=t.newPost,r=t.pathname,i=t.prevLocation,s=t.params,l=t.hasNextPage,c=t.shouldFocusOnCommentsSection,u=t.shouldDisableNavigation,d=t.isWithinProfileContext,f=t.profileContextMember,m=i?{pathname:i.pathname,search:i.search,hash:i.hash,state:i.state}:void 0,p=(0,o.pickBy)({prevLocation:m,params:s,hasNextPage:l,shouldFocusOnCommentsSection:void 0!==c&&c,shouldDisableNavigation:void 0!==u&&u,isWithinProfileContext:d,profileContextMember:f},function(e){return void 0!==e});r?e.push(r,p):e.push({pathname:a.x.show({slug:null==n?void 0:n.slug,spaceSlug:null==n?void 0:n.space_slug}),state:p})},[e])}}},171832:function(e,t,n){n.d(t,{Y:()=>ev});var r=n(552676),o=n(275271),i=n(473196),a=n(619803),s=n.n(a),l=n(595693),c=n(441342),u=function(){var e=(0,c.Zh)().record,t=(0,o.useRef)(null),n=(0,o.useRef)(null),a=(0,c.wh)().currentCommunityMember;return((0,o.useEffect)(function(){if(t.current&&(null==e?void 0:e.is_comments_enabled)){var n=new i.do(function(){var e=document.documentElement.scrollHeight;window.parent.postMessage(["setHeight",e],"*")});return n.observe(t.current),function(){return n.disconnect()}}},[null==e?void 0:e.is_comments_enabled]),null==e?void 0:e.is_comments_enabled)?(0,r.jsx)("div",{ref:t,className:s()("post bg-primary border-primary border md:mb-6 md:rounded-lg",{"pb-1 pt-2.5":!!a}),children:(0,r.jsx)(l.o,{commentsFormRef:n,autofocusReplyForm:!1})}):null},d=n(205061),f=n(941084),m=n(227053),p=n(291704),b=n(672851),h=n(322825),v=function(){var e=(0,c.Zh)(),t=e.record,n=e.helpers,o=t.body_trix_content,i=t.tiptap_body,a=!!(null==n?void 0:n.isTiptapPost),s=!!(null==n?void 0:n.isTrixPost),l=(0,m.m)().isPostBodyEmpty;return(0,r.jsxs)(r.Fragment,{children:[!l&&(0,r.jsx)(b.X,{seeMoreClassName:"text-default hover:text-dark",children:(0,r.jsxs)("div",{className:"profile-posts__post__body",children:[s&&o&&(0,r.jsx)(p.P,{content:o}),a&&i&&(0,r.jsx)(h.Rs,{readOnly:!0,value:i.body,sgidToObjectMap:i.sgids_to_object_map,inlineAttachments:i.inline_attachments})]})}),(0,f.Fr)(t)&&(0,r.jsx)(d.l,{className:"!py-2"})]})},y=n(932699),g=n(739792),x=n(96533),_=n(554348),j=n(957363),w=n(663676),O=n(380171),S=n(840905),P=function(e){var t=e.shouldOpenInNewTab,n=(0,c.wh)().isViewOnlyMasquerading,o=(0,x.r)().hide,i=(0,c.Zh)(),a=i.record,l=i.onLikeToggle,u=a.comments_count,d=a.is_comments_enabled,f=a.is_liked_by_current_user,m=a.is_liking_enabled,p=a.user_likes_count,b=a.post_details_loaded,h=(0,c.EU)();return d||m?(0,r.jsxs)("div",{className:s()("profile-posts__post__actions flex items-center",{"justify-between":m,"justify-end":!m}),children:[m&&(0,r.jsx)(O.T,{interactive:!1,content:f?(0,g.t)("profile_tabs.post.unlike_description"):(0,g.t)("profile_tabs.post.like_description"),placement:"bottom",disabled:!h||!b,children:(0,r.jsx)("button",{type:"button",onClick:n?y.noop:l,className:s()("profile-posts__post__like focus-visible:outline-secondary hover:bg-tertiary active:text-default flex space-x-1 rounded-md p-1 text-sm focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"text-default focus:text-default":!f,"liked text-brand focus:text-brand":f,disabled:!h||!b}),children:b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.JO,{type:"like"}),(0,r.jsx)("span",{className:"profile-posts__post__like-count",children:(0,w.HA)(p)})]}):(0,r.jsx)(S.gi,{variant:"row",lg:!0,short:!0})})}),d&&(0,r.jsx)(O.T,{interactive:!1,content:(0,g.t)("profile_tabs.post.comment_description"),placement:"bottom",disabled:!b,children:(0,r.jsxs)(_.s,{post:a,allComments:!0,className:"profile-posts__post__comments-count text-default focus-visible:outline-secondary focus-visible:text-dark hover:text-dark inline-block rounded-md p-1 text-sm focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:o,target:t&&"_blank",children:[b&&(0,g.t)("post.comments",{count:u,formatted_count:(0,w.HA)(u)}),!b&&(0,r.jsx)(S.gi,{variant:"row",lg:!0,long:!0})]})})]}):null},C=n(547144),k=n(248250),I=n(282859),N=n(308683),A=function(e){var t=e.shouldOpenInNewTab,n=void 0!==t&&t,o=(0,x.r)().hide,i=(0,c.Zh)().record,a=function(e){return!(0,I.n2)(e)&&o()},s=i.name,l=i.created_at,u=i.space_name,d=i.space_slug;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.H,{onClick:a,post:i,className:"!rounded-lg",wrapperClassName:"!p-0"}),(0,r.jsxs)("div",{className:"profile-posts__post__meta w-full space-x-2",children:[(0,r.jsxs)("span",{className:"profile-posts__post__author text-default text-sm",children:[(0,g.t)("profile_tabs.post.posted_in")," ",(0,r.jsx)("a",{className:"focus-visible:outline-secondary focus-visible:text-dark text-dark hover:text-darkest font-medium focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",href:C.RZ.show({spaceSlug:d}),children:u})]}),(0,r.jsx)("span",{className:"bg-badge inline-block size-1 rounded-full align-middle"}),(0,r.jsx)(O.T,{interactive:!1,content:(0,f.s4)(l),children:(0,r.jsx)(_.s,{onClick:a,post:i,target:n?"_blank":"_self",className:"text-dark focus-visible:outline-secondary focus-visible:text-dark group inline-flex focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,r.jsx)("span",{className:"profile-posts__post__time text-default group-hover:text-dark text-sm",children:(0,N.TF)(l,{format:N.lc.short})})})})]}),!!s&&(0,r.jsx)(_.s,{onClick:a,post:i,target:n?"_blank":"_self",className:"text-dark focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,r.jsx)("div",{className:"profile-posts__post__title text-darkest break-all text-xl font-semibold leading-7",children:s})})]})},M=function(e){var t=e.onPostChange,n=e.shouldOpenInNewTab,o=(0,c.Zh)().record;if(!o||!o.id)return null;var i=o.updated_at;return(0,r.jsxs)("div",{className:"profile-posts__post bg-primary flex flex-col space-y-3 p-5 md:px-6",children:[(0,r.jsx)(A,{}),(0,r.jsx)(v,{}),(0,r.jsx)(P,{onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},o,e))},shouldOpenInNewTab:n})]},i)};function T(e){var t=e.post,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["post"]);return(0,r.jsx)(M,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({post:t},n))}var E=n(260622),R=function(e){var t=e.post,n=e.comments_count,o=e.className,i=e.showCount,a=e.onCommentsClick,l=e.iconClassName;return(0,r.jsx)("div",{className:s()("col-span-1",o),children:(0,r.jsx)(O.T,{placement:"bottom",content:(0,g.t)("post.comment_description"),interactive:!1,children:(0,r.jsxs)(_.s,{post:t,allComments:!0,ariaLabel:(0,g.t)("post.comment_description"),shouldOpenPostModal:!0,className:s()("action-item action-comment text-default focus-visible:outline-secondary group flex items-center justify-center rounded-md text-center transition-colors focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"hover:text-dark p-1":!(0,f.Fr)(t)}),onClick:a,children:[(0,r.jsx)("span",{className:"action__icon inline-flex align-text-top",children:(0,r.jsx)(j.JO,{"aria-hidden":!0,type:"24-comment",className:s()("group-hover:text-dark mr-1",void 0===l?"text-default":l),useWithFillCurrentColor:!0})}),(void 0===i||i)&&(0,r.jsx)("span",{className:"count text-default group-hover:text-dark text-base font-medium tracking-tight",children:(0,w.dm)(n)})]})})})},D=function(e){var t=e.name,n=e.onLikeToggle,o=e.is_liked_by_current_user,i=e.user_likes_count,a=e.isOrCanBeCommunityMember,l=e.className,u=e.iconClassName,d=e.likedSpanClassName,m=e.showCount,p=(0,c.wh)().isViewOnlyMasquerading,b=(0,c.Zh)().record;return(0,r.jsx)("div",{className:s()("col-span-1",l),children:(0,r.jsx)(O.T,{placement:"bottom",content:(0,g.t)(o?"post.unlike_description":"post.like_description",{name:null!=t?t:""}),interactive:!1,children:(0,r.jsxs)("button",{type:"button",onClick:n,"aria-label":(0,g.t)("like_post_aria_label",{name:null!=t?t:""}),className:s()("action-item action-link action-like post__actions--like text-default focus-visible:outline-secondary group flex items-center justify-center rounded-md text-center transition-colors focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{liked:o,disabled:!a||p,"hover:text-dark":!o,"hover:text-dark min-w-[2.5rem] p-1":!(0,f.Fr)(b)}),children:[(0,r.jsx)("span",{className:s()("action__icon inline-flex align-text-top",o&&d),children:(0,r.jsx)(j.JO,{className:s()("mr-1",void 0===u?"":u),type:o?"24-heart-red-fill":"24-heart-outline"})}),(void 0===m||m)&&(0,r.jsx)("span",{className:s()("count text-base font-medium tracking-tight",{"!text-v2-danger":o}),children:(0,w.dm)(i)})]})})})},L=function(e){var t=e.type,n=void 0===t?"list":t,o=e.wrapperClassName,i=e.commentButtonClassName,a=e.commentIconClassName,l=e.likeButtonClassName,u=e.likeIconClassName,d=e.likedSpanClassName,f=e.showCommentsCount,p=e.showLikesCount,b=e.onCommentsClick,h=void 0===b?y.noop:b,v=(0,m.m)(),g=v.post,x=v.showEngagementActions,_=v.onLikeToggle,j=g.user_likes_count,w=g.is_liking_enabled,O=g.is_comments_enabled,P=g.is_liked_by_current_user,C=g.comments_count,k=g.post_details_loaded,I=g.display_title,N=(0,c.EU)();return x&&(w||O)?k?(0,r.jsxs)("div",{className:s()("post--".concat(n,"__actions post--").concat(n,"__actions-visible"),{"grid grid-cols-2 items-center text-sm md:w-40":"list"===n},{"absolute bottom-4 left-4 flex items-center gap-2":"card"===n},{"flex items-center gap-2 text-sm":"image-card"===n},o),children:[(0,r.jsx)(E.T,{children:w&&(0,r.jsx)(D,{name:I,onLikeToggle:function(e){null==_||_(e)},isOrCanBeCommunityMember:N,user_likes_count:j,is_liked_by_current_user:P,className:l,iconClassName:u,likedSpanClassName:d,showCount:void 0===p||p})}),O&&(0,r.jsx)(R,{comments_count:C,post:g,className:i,iconClassName:a,showCount:void 0===f||f,onCommentsClick:h})]}):(0,r.jsxs)("div",{className:s()("post--".concat(n,"__actions post--").concat(n,"__actions-visible"),{"flex items-center":"list"===n},{"absolute bottom-4 left-4 flex items-center gap-2":"card"===n},o),children:[(0,r.jsx)("div",{className:s()("action-item action-link action-like post__actions--like p-1",l),children:(0,r.jsx)("span",{className:"action__icon",children:(0,r.jsx)(S.gi,{variant:"row",lg:!0,short:!0})})}),(0,r.jsx)("div",{className:s()("action-item action-comment p-1",i),children:(0,r.jsx)("span",{className:"action__icon",children:(0,r.jsx)(S.gi,{variant:"row",lg:!0,short:!0})})})]}):null},F=n(654252),U=n(664657),B=n(117617),q=n(22319),z=n(859834),Z=n(381636);function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){V(e,t,n[t])})}return e}var W=function(e){var t,n,o,i=e.post,a=e.onPostChange,l=e.onPostDestroy,u=(0,z.O)({public_uid:null!=(o=i.community_member.public_uid)?o:"",params:{show_back_link:!0}}),d=(0,q.TC)().isDarkAppearance,m=(0,B.en)(),p=(0,F.F)(),b=(0,c.L2)().data,h=d?"bg-[#2B2E33CC] backdrop-blur-[1px]":"bg-[#FFFFFFCC] backdrop-blur-[1px]";return(0,r.jsxs)("div",{className:s()("mt-2 flex w-full flex-row-reverse items-center justify-between gap-2",{"absolute bottom-2 mt-0 hidden px-2 focus:flex focus-visible:flex group-hover:flex peer-hover:flex peer-focus-visible:flex":m}),children:[(0,r.jsx)("div",{className:"flex shrink-0 items-center justify-end gap-2",children:(0,r.jsx)(L,H({type:"image-card",wrapperClassName:"!mr-0",commentButtonClassName:s()("rounded-md p-1",V({},h,m)),commentIconClassName:"text-selector-active md:!mr-0",likeButtonClassName:s()("rounded-md p-1",V({},h,m)),likeIconClassName:"text-selector-active md:!mr-0",likedSpanClassName:"text-brand",showLikesCount:!m,showCommentsCount:!m},m&&{onCommentsClick:function(e){e.preventDefault(),p.show({post:i,spaceId:null==b?void 0:b.id,onPostChange:a,onPostDestroy:l,autofocusReplyForm:!0})}}))}),!(0,f.A8)(i)&&(0,r.jsxs)("a",(t=H({},u),n=n={className:s()("flex items-center justify-start gap-2 overflow-hidden rounded-md py-1 pl-1 pr-2",V({},h,m)),children:[(0,r.jsx)(U.W,{src:i.community_member.avatar_url||"",name:i.community_member.name||"",size:"5"}),(0,r.jsx)(Z.Z.LabelSm,{weight:"medium",truncate:!0,children:i.community_member.name})]},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))]})},Q=n(701168),G=function(e){var t=e.isSquareGrid,n=void 0===t||t;return(0,r.jsx)("div",{className:(0,Q.A)("bg-secondary flex items-center justify-center rounded-md md:rounded-none",{"aspect-square":n,"min-h-48":!n}),children:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center p-6 text-center",children:[(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)(j.JO,{type:"16-trash-bin-2",size:20})}),(0,r.jsx)(Z.Z.BodyXs,{color:"light",children:(0,g.t)("image_space.file_not_found")})]})})},$=function(e){var t=e.post,n=e.children,o=e.onPostChange,i=e.onPostDestroy,a=(0,F.F)(),s=(0,c.L2)().data;return(0,r.jsx)("button",{type:"button",className:"focus-visible:outline-secondary peer w-full focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2","aria-label":(0,g.t)("image_space.grid_view.open_full_post"),onClick:function(){return a.show({post:t,spaceId:null==s?void 0:s.id,onPostChange:o,onPostDestroy:i})},children:n})},K=function(e){var t=e.post,n=e.children;return(0,r.jsx)(_.s,{post:t,className:"focus-visible:outline-secondary peer inline-block focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:n})},J=function(e){var t=e.post,n=e.isSquareGrid,o=void 0===n||n,i=e.onPostChange,a=e.onPostDestroy,s=(0,B.WJ)()?$:K;return(0,r.jsxs)("div",{className:"group relative",children:[(0,r.jsxs)("div",{className:"absolute right-2 top-2 flex",children:[t.gallery.images.length>1&&(0,r.jsx)(j.JO,{type:"16-multiple-images",size:16}),t.pinned_at_top_of_space&&(0,r.jsx)(j.JO,{type:"16-pin-sm-white",size:16})]}),(0,r.jsx)(s,{post:t,onPostChange:i,onPostDestroy:a,children:t.gallery.images.length>0?(0,r.jsx)("img",{loading:"lazy",src:t.gallery.images[0].url,alt:t.truncated_content,className:(0,Q.A)("pointer-events-none inline-block w-full rounded-md md:rounded-none",{"aspect-square object-cover":o})}):(0,r.jsx)(G,{isSquareGrid:o})}),(0,r.jsx)(W,{post:t,onPostChange:i,onPostDestroy:a})]})},X=function(e){var t=e.post,n=e.onPostChange,o=e.onPostDestroy;return(0,r.jsx)(J,{post:t,onPostChange:n,onPostDestroy:o,isSquareGrid:!1})},Y=n(60589),ee=n(242194),et=n(624831),en=n(929090),er=n(534860),eo=n(524330),ei=n(751169),ea=function(e){var t=e.post,n=t.last_replied_or_posted,o=t.post_details_loaded,i=(null==n?void 0:n.type)==="replied";if(!o)return(0,r.jsx)(S.gi,{variant:"row",lg:!0,almostFull:!0});if(!n)return null;var a=(0,g.t)(n.type);return(0,r.jsxs)(_.s,{post:t,className:"!text-default focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:[i&&(0,r.jsx)(j.JO,{type:"arrow-solid-bottom-right",useWithFillCurrentColor:!0,className:"mr-1 !w-3.5",size:14}),(0,r.jsxs)(O.T,{interactive:!1,content:(0,f.s4)(n.created_at),className:"inline-flex items-center gap-1",children:[(0,r.jsx)("span",{className:"meta-person-action text-sm",children:"".concat(n.user_name," ").concat(a," ")}),(0,r.jsx)("span",{className:"ago post--card__timestamp text-sm",children:(0,N.TF)(n.created_at)})]})]})},es=function(){return(0,r.jsx)(L,{type:"card"})};function el(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var ec=function(e){var t,n,o=e.onPostChange,i=e.onPostDestroy,a=e.refetchPosts,s=(0,c.Zh)(),l=s.record,u=s.isUpdatingCardViewThumbnail,d=(0,q.TC)().isDarkAppearance;if(!l)return null;var f=l.flagged_for_approval_at,m=l.community_member,p=l.hide_meta_info,b=l.display_title,h=l.is_liking_enabled,v=l.is_comments_enabled,x=l.cardview_image_url,j=l.cardview_thumbnail_url,w=l.cover_image_url,O=(0,c.L2)().data,S=(0,Q.A)("post--card post--parent border-primary bg-primary border relative overflow-hidden rounded-2xl",{"flagged-for-approval":f,"has-engagement pb-10":h||v}),P=x||j||w,C=(0,z.O)({public_uid:m.public_uid,params:{show_back_link:!0}});return(0,r.jsxs)("div",{className:S,children:[(0,r.jsxs)("div",{className:"post--card__post text-dark",children:[(0,r.jsx)(_.s,{post:l,className:"post--card__cover text-dark bg-primary focus-visible:outline-secondary focus-visible:text-dark relative block aspect-[2] rounded-t-lg bg-cover bg-center bg-no-repeat focus-visible:rounded-t-lg focus-visible:outline focus-visible:outline-2",style:function(){if(P)return{backgroundImage:'url("'.concat(P,'")')};var e=d?(0,er.aP)("dark-mode-cover-thumbnail-2x.png"):(0,er.aP)("light-mode-cover-thumbnail-2x.png");return{backgroundImage:'url("'.concat(e,'")')}}(),shouldOpenPostModal:!0,children:u&&(0,r.jsx)("div",{className:"bg-primary absolute inset-0 flex items-center justify-center rounded-t-lg",children:(0,r.jsx)(ei.a,{})})}),!p&&(0,r.jsx)("div",{className:"post--card__user has-cover -mt-5 px-5",children:(0,r.jsx)("div",{className:"post__avatar",children:(0,r.jsx)("a",(t=el({className:"user__avatar focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},C),n=n={children:(0,r.jsx)(U.W,{src:m.avatar_url,name:m.name,size:"10"})},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))})}),(0,r.jsx)("div",{className:(0,Q.A)("post--card__body p-5",{"post-meta--hidden":p}),children:(0,r.jsxs)("div",{className:"post--card__content",children:[(0,r.jsx)("div",{className:"post--card__header",children:(0,r.jsxs)("h2",{className:"space-x-2 text-base font-semibold",children:[(0,r.jsx)(_.s,{post:l,className:"!text-darkest overflow-anywhere focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:(0,y.truncate)(b,{length:60})}),!!f&&(0,r.jsx)(eo.g,{className:"post--card__headline-tag !bg-author-in-review border-0 align-text-top uppercase text-white",label:(0,g.t)("in_review")})]})}),!p&&(0,r.jsx)("div",{className:"post--card__meta",children:(0,r.jsx)(ea,{post:l})})]})})]}),(0,r.jsx)(es,{}),(0,r.jsxs)("div",{className:"absolute inset-x-4 top-4 z-[5] flex items-center justify-between",children:[(0,r.jsx)("div",{className:"grow",children:(0,Y.Y_)(O)&&(0,en.f)(l)&&(0,r.jsx)(et.F.Short,{record:l,contentType:"post"})}),(0,r.jsx)("div",{className:"ml-2 shrink-0",children:(0,r.jsx)(ee.p,{onPostDestroy:i,refetchPosts:a,onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(el({},l,e),t)}})})]})]})},eu=function(e){return(0,r.jsx)(ec,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))},ed=function(e){var t=e.post,n=t.last_replied_or_posted;return t.post_details_loaded?n?(0,r.jsxs)(_.s,{post:t,className:"!text-default focus-visible:outline-secondary inline-flex items-center gap-1 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:["replied"===n.type&&(0,r.jsx)(j.JO,{useWithFillCurrentColor:!0,type:"arrow-solid-bottom-right",className:"text-default !w-3.5",size:14}),(0,r.jsxs)(O.T,{interactive:!1,content:(0,f.s4)(n.created_at),className:"inline-flex items-center gap-1",children:[(0,r.jsx)("span",{className:"meta-person-action text-xs",children:"".concat(n.user_name," ").concat(n.type," ")}),(0,r.jsx)("span",{className:"ago post--list__timestamp text-xs",children:(0,N.TF)(n.created_at)})]})]}):null:(0,r.jsx)(S.gi,{variant:"row",lg:!0,half:!0})};function ef(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function em(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var ep=function(e){var t=e.onPostChange,n=e.onPostDestroy,o=e.refetchPosts,i=e.hideTitle,a=void 0!==i&&i,l=(0,c.L2)().data,u=(0,c.Zh)().record,d=(0,B.kK)(),f=u.flagged_for_approval_at,m=u.community_member,p=u.hide_meta_info,b=u.display_title,h=s()("post--list post--parent border-t border-primary px-5 py-3 md:py-4 bg-primary border-b-none last:border-b md:border-x first:md:rounded-t-2xl last:md:rounded-b-2xl",{"flagged-for-approval":f}),v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(ef({},u,e),n)},x=(0,Y.Y_)(l)&&(0,en.f)(u),j=(0,z.O)({public_uid:m.public_uid,params:{show_back_link:!0}});return d?(0,r.jsxs)("div",{className:h,children:[(0,r.jsx)("div",{className:"post--list__post text-dark flex gap-3",children:(0,r.jsxs)("div",{className:"post--list__body flex w-full flex-col gap-2",children:[(0,r.jsx)("div",{className:"post--list__content w-full gap-2 !pr-0 md:gap-0",children:!a&&(0,r.jsxs)("div",{className:s()("post--list__header flex w-full items-start justify-between",{"post-meta--hidden":p}),children:[(0,r.jsxs)("h2",{className:"mr-4 space-x-2 text-base font-medium leading-5",children:[(0,r.jsx)(_.s,{post:u,className:"!text-dark overflow-anywhere focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:(0,y.truncate)(b,{length:110})}),!!f&&(0,r.jsx)(eo.g,{className:"post--list__headline-tag !bg-author-in-review w-full max-w-fit border-0 align-text-top uppercase text-white",label:(0,g.t)("in_review")})]}),(0,r.jsx)(ee.p,{onPostDestroy:n,refetchPosts:o,onChange:v})]})}),!p&&(0,r.jsxs)("div",{className:"flex items-start justify-start space-x-2",children:[(0,r.jsx)("div",{className:"post--list__user",children:(0,r.jsx)("a",em(ef({},j),{className:"focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,r.jsx)(U.W,{src:m.avatar_url,name:m.name,size:"6"})}))}),(0,r.jsxs)("div",{className:"post--list__meta flex w-full items-center justify-between",children:[(0,r.jsx)(ed,{post:u}),(0,r.jsx)("div",{className:"post--list__actions-wrapper gap-2 self-start md:gap-0",children:(0,r.jsx)(L,{})})]})]})]})}),x&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(et.F.Regular,{record:u,contentType:"post"})})]}):(0,r.jsxs)("div",{className:h,children:[(0,r.jsxs)("div",{className:"post--list__post text-dark flex gap-3",children:[!p&&(0,r.jsx)("div",{className:"post--list__user",children:(0,r.jsx)("a",em(ef({},j),{className:"focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,r.jsx)(U.W,{src:m.avatar_url,name:m.name,size:"10"})}))}),(0,r.jsxs)("div",{className:"post--list__body flex w-full items-center justify-between",children:[(0,r.jsxs)("div",{className:s()("post--list__content flex flex-col",{"justify-center":p,"justify-start gap-1":!p}),children:[!a&&(0,r.jsx)("div",{className:s()("post--list__header",{"post-meta--hidden":p}),children:(0,r.jsxs)("h2",{className:"mr-4 flex space-x-2 text-base font-medium leading-5",children:[(0,r.jsx)(_.s,{post:u,className:"!text-dark overflow-anywhere focus-visible:outline-secondary focus-visible:text-dark line-clamp-1 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:b}),!!f&&(0,r.jsx)(eo.g,{className:"post--list__headline-tag !bg-author-in-review w-full max-w-fit shrink-0 border-0 align-text-top uppercase text-white",label:(0,g.t)("in_review")})]})}),!p&&(0,r.jsx)("div",{className:"post--list__meta inline-flex",children:(0,r.jsx)(ed,{post:u})})]}),(0,r.jsxs)("div",{className:"post--list__actions-wrapper flex shrink-0 items-baseline gap-1",children:[(0,r.jsx)(L,{likeButtonClassName:"!inline-flex",commentButtonClassName:"!inline-flex"}),(0,r.jsx)(ee.p,{onPostDestroy:n,refetchPosts:o,onChange:v})]})]})]}),x&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(et.F.Regular,{record:u,contentType:"post"})})]})},eb=function(e){return(0,r.jsx)(ep,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))},eh=n(324921),ev=function(e){var t=e.space,n=void 0===t?{}:t,o=e.post,i=e.isFirst,a=e.forcePostView,s=e.forceSimplifiedView,l=e.forceIframeView,d=e.usedIn,f=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["space","post","isFirst","forcePostView","forceSimplifiedView","forceIframeView","usedIn"]),m=!!o.pinned_at_top_of_space,p=(0,Y.AU)(n),b=(0,Y.G6)(n),h=eh.D;return(0,Y.fq)(n)?h=eh.D:(0,Y.wk)(n)?h=X:(0,Y.HO)(n)?h=J:void 0!==s&&s?h=T:void 0!==l&&l?h=u:void 0!==a&&a||m&&void 0!==i&&i?h=eh.D:p?h=eu:b&&(h=eb),(0,r.jsx)(c.DW,{post:o,usedIn:d,children:(0,r.jsx)(h,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({post:o},f))})}},573384:function(e,t,n){n.d(t,{Fk:()=>a,_t:()=>s});var r=n(552676),o=n(275271),i=(0,o.createContext)({params:{},hasNextPage:!1});i.displayName="PostNavigationContext";var a=function(e){var t=e.children,n=e.params,o=e.hasNextPage;return(0,r.jsx)(i.Provider,{value:{params:void 0===n?{}:n,hasNextPage:void 0!==o&&o},children:t})},s=function(){var e=(0,o.useContext)(i);if(!e)throw Error("usePostNavigationContext must be used within a PostNavigationProvider");return e}},595693:function(e,t,n){n.d(t,{o:()=>t6});var r=n(552676),o=n(275271),i=n(739792),a=n(25593),s=n(701168),l=n(720624),c=n(932699),u=n(60589),d=n(624831),f=n(929090),m=n(441342),p=n(963549),b=n(664657),h=n(227851),v=n(275753),y=n(283095),g=n(359892),x=n(152988),_=n(39905),j=n(117383),w=n(767379),O=n(904614),S=function(e,t,n,r){(0,o.useEffect)(function(){if(e&&e.id!==(null==t?void 0:t.id)&&"CommunityMember"===e.type){var o,i;r((o={},i=e.rich_text_field_sgid,i in o?Object.defineProperty(o,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):o[i]=e,o)),(0,c.defer)(function(){var t,r;null==n||null==(r=n.current)||null==(t=r.chain)||t.call(r).focus("start").insertContent([(0,O.F_)({sgid:e.rich_text_field_sgid}),(0,O.$U)({text:" "})]).run()})}},[e,t,n])},P=function(e,t,n){(0,o.useEffect)(function(){(0,c.defer)(function(){if(t&&!e){var r,o,i;null==n||null==(i=n.current)||null==(o=i.commands)||null==(r=o.focus)||r.call(o,"end")}})},[t,e,n])},C=n(241769);function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var N=function(e){var t=I((0,o.useState)(!1),2),n=t[0],r=t[1],i=I((0,o.useState)(0),2),a=i[0],s=i[1],l=(0,o.useRef)(null),u=(0,o.useRef)(null),d=(0,h.Gc)(),f=d.watch,m=d.reset,p=d.formState,b=p.isSubmitting,v=p.isSubmitSuccessful,y=f("tiptap_body"),g=!(0,C.NU)(y),x=g||b,_=(0,o.useCallback)(function(t){e&&(t||!g?r(!0):r(!1))},[e,g]),j=(0,o.useCallback)(function(){e&&r(!0)},[e]);return(0,o.useEffect)(function(){!g&&e&&r(!0)},[g,e]),(0,o.useEffect)(function(){v&&(e&&r(!1),(0,c.defer)(function(){m(),s(function(e){return e+1})}))},[v,m,e]),{isEditorExpanded:n,setIsEditorExpanded:r,editorKey:a,commentBoxRef:l,toolbarRef:u,formContext:d,isSubmitting:b,isEditorEmpty:g,isSubmitDisabled:x,handleFocusChange:_,handleEditorFocus:j}},A=function(e,t,n){(0,o.useEffect)(function(){if(e){var r=function(){setTimeout(function(){var e,r=document.activeElement,o=null==(e=t.current)?void 0:e.contains(r),i=document.querySelector(".post__reply:not(.reply-to-parent)"),a=null==i?void 0:i.contains(r);o||a?n(!0):n(!1)},0)};return document.addEventListener("focusin",r),document.addEventListener("focusout",r),function(){document.removeEventListener("focusin",r),document.removeEventListener("focusout",r)}}},[e,t,n])},M=function(e){var t=e.editorRef,n=e.autoFocus,r=e.parentCommentId,i=e.communityMemberForReply,a=e.currentCommunityMember,s=e.addToLocalSgidToObjectMap,l=e.usedIn,c=e.toolbarPortalId,u="minimal-post-modal"===l,d=u&&!r,f=N(u),m=f.isEditorExpanded,p=f.editorKey,b=f.commentBoxRef,h=f.toolbarRef,v=f.formContext,y=f.isSubmitting,g=f.isSubmitDisabled,x=f.handleFocusChange,_=f.handleEditorFocus,O=d?m&&!g:!g;return P(d,n,t),(0,o.useEffect)(function(){h.current=document.getElementById(c)},[c,h]),A(u,h,x),S(i,a,t,s),(0,j.y1)("meta+enter, ctrl+enter",function(){(0,w.C)(v)&&v.triggerFormSubmit()},{enableOnContentEditable:!0,enabled:O},[v,O]),{isEditorExpanded:m,commentBoxRef:b,handleEditorFocus:_,editorKey:p,isSubmitDisabled:g,isSubmitting:y,isUsedInMinimalPostModal:u,isPostCommentFormInMinimalPostModal:d}};function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function E(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return T(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var R=function(e){var t=e.autoFocus,n=e.className,o=e.communityMemberForReply,a=e.authorType,l=e.editorRef,c=e.isEdit,u=void 0!==c&&c,d=e.parentCommentId,f=e.placeholder,p=void 0===f?(0,i.t)("comments.form.fields.body_placeholder"):f,b=e.postId,j=e.spaceId,w=e.usedIn,O=e.persistCacheKey,S=(0,m.wh)().currentCommunityMember,P=(0,v.T)(),C=(0,h.Gc)(),k=C.formState.isDirty,I=C.setValue,N=C.watch;(0,y.K)({cacheKey:O,fields:["tiptap_body"],enabled:!u&&!!O&&k});var A="tiptap_body.sgids_to_object_map",T=N(A)||{},R=function(e){I(A,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},T,e))},D="tiptap_body.inline_attachments",L=N(D)||[],F=["post",b,u?"edit":"create",d,"comment-form-toolbar",w].filter(Boolean).join("-"),U=M({editorRef:l,autoFocus:void 0!==t&&t,usedIn:w,parentCommentId:d,communityMemberForReply:o,currentCommunityMember:S,addToLocalSgidToObjectMap:R,toolbarPortalId:F}),B=U.isEditorExpanded,q=U.commentBoxRef,z=U.handleEditorFocus,Z=U.editorKey,V=U.isSubmitDisabled,H=U.isSubmitting,W=U.isUsedInMinimalPostModal,Q=U.isPostCommentFormInMinimalPostModal;return(0,r.jsxs)("div",{ref:q,className:(0,s.A)("border-primary focus-within:border-light active:border-light rounded-lg border transition-all duration-300 ease-in-out",{"pointer-events-none opacity-50":H,"px-4 py-3":!Q,"max-h-[40px] px-4 py-1.5":Q&&!B,"max-h-[440px] px-4 py-3":Q&&B}),children:[(0,r.jsx)("div",{className:(0,s.A)("transition-all duration-300 ease-in-out",{"max-h-[40px] overflow-hidden":W&&!B,"max-h-[400px]":W&&B}),children:(0,r.jsx)(g.$,{editorRef:l,placeholder:p,name:"tiptap_body.body",toolbars:[{portalId:F,component:x.o}],className:(0,s.A)("max-h-[400px] overflow-y-auto",n),editorClassName:"min-h-[30px]",spaceId:j,sgidToObjectMap:T,inlineAttachments:L,onLocalSgidToObjectMapChange:R,onLocalAttachmentsChange:function(e){I(D,Array.from(new Set(E(L).concat(E(e)))))},disabledExtensions:["poll","ai_copilot","cta"],onFocusChange:function(e){e&&z()},isVoiceMessageAllowed:!0,isMediaUploadAllowed:P,allowBubbleMenuOverflow:!1,shouldSupportTables:"CommunityAiAgent"===a})}),(0,r.jsxs)("div",{className:(0,s.A)("flex items-end justify-between transition-all duration-300 ease-in-out",{"invisible max-h-0 overflow-hidden opacity-0":Q&&!B,"visible max-h-[32px] opacity-100":Q&&B,"h-0":Q&&!B,"h-[32px]":Q&&B}),children:[(0,r.jsx)("div",{id:F,className:"transition-opacity duration-300 ease-in-out"}),(0,r.jsx)(_.z,{variant:"primary",type:"submit",disabled:V,className:"!px-4 transition-opacity duration-300 ease-in-out",children:u?H?(0,i.t)("comments.create.actions.saving"):(0,i.t)("comments.create.actions.save"):H?(0,i.t)("comments.create.actions.submitting"):(0,i.t)("comments.create.actions.submit")})]})]},Z)},D=n(5179),L=n(767900),F=n(131906),U=n(93199),B=n(547144),q=n(60878),z=function(e){var t=e.postId,n=e.parentCommentId,r=e.onCreate,o=(0,q.pm)().error;return{createComment:(0,F.useMutation)(function(e){return(0,U.Cu)(B.av.comments.create({postId:t}),{comment:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({parent_comment_id:n},e)})},{onSuccess:r,onError:function(){return o((0,i.t)("comments.create.alerts.failure"))}}).mutateAsync}},Z=function(e){var t=e.spaceId,n=e.postId,o=e.parentCommentId,a=e.communityMemberForReply,l=e.autoFocus,c=e.onCreate,u=e.bodyInputRef,d=e.className,f=e.persistCacheKey,p=(0,D.g)(!!o),h=(0,m.wh)().currentCommunityMember,v=(0,m.Zh)(),g=v.usedIn,x=v.isUsedInMinimalTipTapViewModal,_=(0,(0,y.d)({cacheKey:f}).getPersistedFormFieldValues)(),j=a?(0,i.t)("comments.form.fields.body_reply_placeholder",{name:a.name}):(0,i.t)("comments.form.fields.body_placeholder"),w=z({postId:n,parentCommentId:o,onCreate:c}).createComment;return(0,r.jsxs)("div",{className:(0,s.A)("post__reply flex items-start gap-3 py-2.5 md:py-5",{"md:px-6":"minimal-post-modal"!==g,"reply-to-parent -ml-8 py-2.5 md:ml-0":o&&"full-post-modal"!==g,"reply-to-parent -ml-8 md:ml-[-3.125rem]":o&&"full-post-modal"===g,"reply-to-post bg-primary sticky bottom-0":!o,"md:rounded-b-2xl":!x,"px-5":!o&&!x}),ref:p,children:["full-post-modal"!==g&&(0,r.jsx)(b.W,{src:null==h?void 0:h.avatar_url,name:(null==h?void 0:h.name)||"",size:"10"}),(0,r.jsx)(L.l,{className:"relative w-full",defaultValues:{tiptap_body:null==_?void 0:_.tiptap_body},onSubmit:function(e){return w(e)},children:(0,r.jsx)(R,{autoFocus:void 0!==l&&l,className:d,communityMemberForReply:a,editorRef:u,isEdit:!1,parentCommentId:o,placeholder:j,postId:n,spaceId:t,usedIn:g,persistCacheKey:f})})]})},V=n(72727),H=n(167919),W=n(903225),Q=function(){var e=(0,W.TH)().hash.split(H.q)[1];return{commentId:e&&parseInt(e,10)||null}};function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var $=function(e){var t,n=e.enabled,r=void 0===n||n,i=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return G(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],s=i[1],l=(0,V.L)().isElectron,c=Q().commentId;(0,o.useEffect)(function(){if(!l&&r&&c&&!a){var e=setTimeout(function(){s(!0);var e=document.querySelector("".concat(H.q).concat(c));e&&e.scrollIntoView()},500);return function(){return clearTimeout(e)}}},[r,c,a,l])},K=n(902600),J=n.n(K),X=n(307992),Y=function(e){var t=e.postId,n=e.parentCommentId,r=e.usedIn,o=e.preloaded,i=void 0!==o&&o,a=e.preloadedComments,s=void 0===a?[]:a,l=e.preloadedCommentsTotalCount,u=void 0===l?0:l,d=e.onCommentsUpdate;return(0,F.useInfiniteQuery)((0,X.k)({postId:t,parentCommentId:n,usedIn:r}),function(e){var r=e.pageParam,o={per_page:15,page:void 0===r?1:r},i=n?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({parent_comment_id:n},o):o;return(0,U.UT)(B.av.comments.index({postId:t,params:i}))},{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},onSuccess:function(e){var t=e.pages;d(J()((0,c.flatMap)(t,function(e){return e.records}),"id"))},initialData:function(){if(i)return{pages:[{records:s,page:0,has_next_page:u>s.length}],pageParams:[]}},cacheTime:0,staleTime:1/0,notifyOnChangeProps:"tracked"})},ee=n(608207),et=n.n(ee);function en(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function er(e,t){if(e){if("string"==typeof e)return en(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return en(e,t)}}var eo=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.initialComments,r=(e=(0,o.useState)(void 0===n?[]:n),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||er(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],a=r[1];return{comments:i,setComments:a,addCommentToList:function(e){return a(function(t){return((function(e){if(Array.isArray(e))return en(e)})(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||er(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([e])})},updateCommentInList:function(e){return a(function(t){return t.map(function(t){return t.id===e.id?e:t})})},removeCommentFromList:function(e){var t=e.id;return a(function(e){return et()(e,["id",t])})}}},ei=n(431841),ea=function(e){var t=e.postId,n=e.parentCommentId,r=n?"post-".concat(t,"-comment-").concat(n,"-reply-form-values"):"post-".concat(t,"-comment-form-values"),o=(0,ei._)(r).resetValue;return{persistCacheKey:r,resetPersistedFormValues:o}},es=function(){var e=(0,W.TH)(),t=e.state;return{shouldFocusOnCommentsSection:null==t?void 0:t.shouldFocusOnCommentsSection,location:e,setShouldFocusOnCommentsSection:function(t){e.state.shouldFocusOnCommentsSection=t}}};function el(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ec(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return el(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return el(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var eu=function(e){var t=e.postId,n=e.parentCommentId,r=e.preloaded,i=void 0!==r&&r,a=e.preloadedComments,s=void 0===a?[]:a,l=e.preloadedCommentsTotalCount,c=e.postCommentsClosed,u=e.postLikingDisabled,d=e.usedIn,f=e.isUsedInMinimalTipTapViewModal,p=e.onCommentCreate,b=e.onCommentDelete,h=e.resetCommunityMemberForReply,v=e.space,y=e.showReplyForm,g=e.commentsSectionRef,x=(0,m.N3)(),_=(0,m.Zh)(),j=_.usedIn,w=void 0===j?void 0===d?"post":d:j,O=_.isUsedInMinimalTipTapViewModal,S=eo({initialComments:s||[]}),P=S.comments,C=S.setComments,k=S.addCommentToList,I=S.updateCommentInList,N=S.removeCommentFromList,A=ec((0,o.useState)(c),2),M=A[0],T=A[1],E=ec((0,o.useState)(u),2),R=E[0],D=E[1],L=ec((0,o.useState)(0),2),F=L[0],U=L[1],B=es(),q=B.shouldFocusOnCommentsSection,z=B.setShouldFocusOnCommentsSection,Z=ea({postId:t,parentCommentId:n}),V=Z.persistCacheKey,H=Z.resetPersistedFormValues,W=Y({postId:t,parentCommentId:n,usedIn:w,preloaded:i,preloadedComments:s,preloadedCommentsTotalCount:void 0===l?0:l,onCommentsUpdate:C}),Q=W.isLoading,G=W.isFetchingNextPage,K=W.hasNextPage,J=W.fetchNextPage,X=W.remove,ee=c!==M||u!==R;(0,o.useEffect)(function(){!i&&ee&&(T(c),D(u),C([]),X())},[i,ee,c,u,X,C]);var et=Q&&0===P.length,en=Q||G;(0,o.useEffect)(function(){if(!en&&q){var e;null==g||null==(e=g.current)||e.scrollIntoView({behavior:"smooth"}),z(!1)}},[en,q,z,null==g?void 0:g.current]);var er=x&&v&&void 0!==y&&y&&(!en||P.length>0);return $({enabled:!Q}),{comments:P,isFetchingNextPage:G,hasNextPage:K,fetchNextPage:J,addCommentToList:k,updateCommentInList:I,removeCommentFromList:N,handleCommentCreate:function(e){null==h||h(),k(e),null==p||p(e);var t=document.getElementById("comment_wrapper_".concat(e.id));t&&t.scrollIntoView({behavior:"smooth",block:"center"}),H(),U(function(e){return e+1})},handleCommentDelete:function(e){N(e),null==b||b(e)},formKey:F,persistCacheKey:V,isFirstLoading:et,isAnyLoading:en,shouldShowForm:er,usedIn:w,isUsedInMinimalTipTapViewModal:void 0===O?void 0!==f&&f:O}},ed=function(e){var t=e.space,n=e.post,o=e.parentCommentId,a=e.preloadedComments,c=e.preloadedCommentsTotalCount,u=e.showReplyForm,d=e.autofocusReplyForm,f=e.communityMemberForReply,m=e.onCommentReplyClick,p=e.onCommentCreate,b=e.onCommentDelete,h=e.resetCommunityMemberForReply,v=e.formRef,y=eu({postId:n.id,parentCommentId:o,preloaded:!0,preloadedComments:void 0===a?[]:a,preloadedCommentsTotalCount:void 0===c?0:c,postCommentsClosed:n.is_comments_closed,postLikingDisabled:n.is_liking_disabled,space:t,showReplyForm:void 0!==u&&u,onCommentCreate:p,onCommentDelete:b,resetCommunityMemberForReply:h}),g=y.comments,x=y.hasNextPage,_=y.fetchNextPage,j=y.updateCommentInList,w=y.handleCommentCreate,O=y.handleCommentDelete,S=y.formKey,P=y.persistCacheKey,C=y.isAnyLoading,k=y.shouldShowForm,I=y.isUsedInMinimalTipTapViewModal;return(0,r.jsxs)("div",{className:(0,s.A)({"my-3":!k}),children:[g.map(function(e){return(0,r.jsx)(tN,{space:t,post:n,comment:e,autofocusReplyForm:!0,onReplyClick:m,onUpdate:j,onDelete:O,onReplyCreate:p,onReplyDelete:b},e.id)}),C&&(0,r.jsx)(l.m,{}),!C&&x&&(0,r.jsx)("div",{className:"load-more mb-4 mt-2 pl-5 text-left text-sm font-medium md:pl-6",children:(0,r.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),_()},className:"focus-visible:outline-secondary load-more__replies text-link focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,i.t)("comments.list.show_more_replies")})}),C&&I&&(0,r.jsx)("div",{className:"bg-primary absolute bottom-0 left-0 w-full !px-5 !py-4 md:!px-8",children:(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"bg-tertiary size-10 animate-pulse rounded-full"}),(0,r.jsx)("div",{className:"border-primary h-10 w-full rounded-lg border p-px"})]})}),k&&(0,r.jsx)(Z,{spaceId:t.id,postId:n.id,parentCommentId:o,communityMemberForReply:f,autoFocus:void 0!==d&&d,className:(0,s.A)(I&&"!max-h-[360px]"),onCreate:w,bodyInputRef:v,persistCacheKey:P},S)]})},ef=n(915912),em=n.n(ef),ep=n(715731),eb=n(356345),eh=n(775148),ev=n(943544);function ey(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function eg(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var ex=function(e){var t=e.comment,n=e.canReport,o=e.canReview,a=e.canEdit,l=e.canDestroy,c=e.canBookmark,u=e.isReply,d=e.onReportClick,f=e.onEditClick,m=e.onDeleteClick,p=e.onUpdate,b=(0,ep.I)(),h=[],v=(0,q.pm)().success;n&&h.push({key:"report",label:(0,i.t)("comments.action_menu.report.label"),href:"#",onClick:function(){d()}}),o&&h.push(ey({key:"review",label:(0,i.t)("comments.action_menu.review.label"),to:B.sC.index()},b?{target:"_blank",rel:"noreferrer"}:{})),a&&h.push({key:"edit",label:(0,i.t)("comments.action_menu.edit.label"),onClick:function(){f()}});var y=t.show_url;return(y&&h.push({key:"Copy link",label:(0,i.t)("comments.action_menu.copy_url.label"),href:"#",onClick:function(){em()(y),v((0,i.t)("comments.action_menu.copy_url.url_copied"))}}),l&&h.push({key:"delete",label:(0,i.t)("comments.action_menu.delete.label"),hasDanger:!0,onClick:function(){m()}}),0!==h.length||c)?(0,r.jsx)("div",{className:(0,s.A)("post__actions--comment ml-2 md:ml-4",{"post__actions--reply":u}),"data-testid":"post-comment-actions",children:(0,r.jsxs)(ev.Lt,{menuButtonEl:"div",button:(0,r.jsx)(eh.h,{name:"20-menu-dots-horizontal",iconClassName:"!text-default group-hover:!text-dark !w-5 !h-5",className:"group",variant:"secondary",iconSize:20,buttonSize:28,dataTestId:"action-more",ariaLabel:(0,i.t)("comments.actions")}),children:[(0,r.jsx)(eb.e,{variant:"dropdown",bookmarkType:"comment",record:t,onSuccess:function(e){p(eg(ey({},t),{bookmark_id:e}))}}),h.map(function(e){var t=e.key,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["key"]);return(0,r.jsx)(ev.Lt.ItemWithLink,eg(ey({},n),{children:e.label}),t)})]})}):null},e_=n(693440),ej=n(291704),ew=n(672851),eO=function(e){var t=e.comment,n=t.body_trix_content,o=t.editor,i=t.tiptap_body,a=t.updated_at;return(0,r.jsx)("div",{className:"post__body text-base","data-testid":"comment-body",children:(0,r.jsx)("div",{className:"post__inside text-dark","data-testid":"comment-body-inside",children:(0,r.jsx)(ew.X,{lines:8,children:"tiptap"===o?(0,r.jsx)(e_.G,{tiptapBody:i}):(0,r.jsx)(ej.P,{content:n})})},a)})},eS=n(887279),eP=function(e){var t,n=e.comment,o=e.space,i=e.updateComment;return(0,r.jsx)("div",{className:"text-dark mb-1 whitespace-pre-line text-sm font-normal",children:(0,r.jsx)(eS.l,{onSubmit:i,defaultValues:{tiptap_body:n.tiptap_body},children:(0,r.jsx)(R,{isEdit:!0,postId:n.post_id,spaceId:o.id,autoFocus:!0,authorType:null==(t=n.community_member)?void 0:t.type})})})},eC=n(757105),ek=n(434519),eI=function(e){var t=e.comment,n=e.space,o=e.updateComment,a=(0,eC.dd)();return(0,j.y1)("esc",function(){return a.remove()},{enableOnContentEditable:!0},[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ek.u_.Overlay,{}),(0,r.jsxs)(ek.u_.Content,{size:"lg",className:"!overflow-visible",children:[(0,r.jsxs)(ek.u_.Header,{children:[(0,r.jsx)(ek.u_.Title,{size:"sm",children:(0,i.t)("comments.edit.form.title")}),(0,r.jsx)(ek.u_.HeaderActions,{children:(0,r.jsx)(ek.u_.CloseButton,{onClick:a.remove})})]}),(0,r.jsx)(ek.u_.Body,{className:"!overflow-y-visible pb-6",children:(0,r.jsx)(eP,{comment:t,space:n,updateComment:o})})]})]})},eN=n(240507),eA=n.n(eN),eM=n(212635),eT=n(805116),eE=function(e){var t=e.spaceId,n=e.spaceIsPrivate,o=e.onClose,a=(0,h.Gc)(),s=a.watch,l=a.formState,c=l.isDirty,u=l.isSubmitting,d=l.isSubmitSuccessful,f=s().body,m=u||d,p=!!f&&!m;(0,eM.M)({enabled:p});var b=function(){(!c||confirm((0,i.t)("prevent_accidental_leave_message")))&&o()};return(0,r.jsxs)(ek.u_.Content,{size:"lg",wrapperClassName:"!h-full",className:"!transform-none !overflow-visible",children:[(0,r.jsxs)(ek.u_.Header,{children:[(0,r.jsx)(ek.u_.Title,{children:(0,i.t)("comments.edit.form.title")}),(0,r.jsx)(ek.u_.HeaderActions,{children:(0,r.jsx)(ek.u_.CloseButton,{onClick:b})})]}),(0,r.jsx)(ek.u_.Body,{className:"comment__edit-modal-content-body trix-v2 max-h-[calc(100dvh-82px-65px)] !overflow-visible md:max-h-none",children:(0,r.jsx)(eT.O,{id:"comment-edit-body",name:"body",placeholder:(0,i.t)("comments.form.fields.body_placeholder"),className:"h-full",editorContainerClassName:"flex flex-col h-full",textboxClassName:"overflow-auto rounded-md py-4 sm:max-h-[40vh]",space_id:t,is_private_space:n})}),(0,r.jsxs)(ek.u_.Footer,{className:"bottom-0 flex justify-end space-x-4",children:[(0,r.jsx)(_.z,{type:"button",variant:"secondary",onClick:b,children:(0,i.t)("cancel")}),(0,r.jsx)(_.z,{type:"submit",variant:"primary",disabled:!p,children:m?(0,i.t)("saving_changes"):(0,i.t)("save_changes")})]})]})};eE.propTypes={spaceId:eA().number.isRequired,spaceIsPrivate:eA().bool.isRequired,onClose:eA().func.isRequired};var eR=function(e){var t=e.comment,n=e.onUpdate,r=t.id,o=t.post_id,a=t.body_for_editor,s=(0,q.pm)(),l=s.success,c=s.error;return{defaultValues:{body:a},updateComment:(0,F.useMutation)(function(e){return(0,U.gN)(B.av.comments.update({postId:o,id:r}),{comment:e})},{onSuccess:function(e){n(e),l((0,i.t)("comments.edit.alerts.success"))},onError:function(){return c((0,i.t)("comments.edit.alerts.failure"))}}).mutateAsync}},eD=function(e){var t=e.space,n=e.comment,o=e.onUpdate,a=t.id,s=t.is_private,l=(0,eC.dd)(),u="tiptap"===n.editor,d=eR({comment:n,onUpdate:function(e){o(e),l.hide()}}),f=d.defaultValues,m=d.updateComment;return(0,r.jsx)(ek.u_,{title:(0,i.t)("comments.edit.form.title"),isOpen:l.visible,onClose:c.noop,children:u?(0,r.jsx)(eI,{comment:n,space:t,updateComment:m}):(0,r.jsxs)(L.l,{defaultValues:f,onSubmit:m,className:"h-full",formClassName:"h-full",children:[(0,r.jsx)(ek.u_.Overlay,{}),(0,r.jsx)(eE,{spaceId:a,spaceIsPrivate:s,onClose:l.hide})]})})},eL=eC.gk.create(function(e){var t=e.space,n=e.comment,o=e.onUpdate;return(0,r.jsx)(eD,{space:t,comment:n,onUpdate:o})}),eF=function(e){var t,n,o=e.label,i=e.onClick,a=e.disabled,l=void 0!==a&&a,c=e.isLiked,u=void 0!==c&&c,d=e.className,f=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["label","onClick","disabled","isLiked","className"]);return(0,r.jsx)("button",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({type:"button",className:(0,s.A)("focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",d),onClick:function(e){e.preventDefault(),l||i()},"aria-disabled":l},f),n=n={children:(0,r.jsx)("span",{"aria-checked":u,className:(0,s.A)("hover:text-dark text-sm",{"text-brand font-semibold":u,"text-default font-medium":!u}),children:o})},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))};eF.propTypes={label:eA().string.isRequired,onClick:eA().func.isRequired,disabled:eA().bool,isLiked:eA().bool,className:eA().string};var eU=n(663676),eB=function(e){var t=e.likesCount,n=e.onClick;return(0,r.jsx)("button",{type:"submit",className:"text-default hover:text-dark group ml-auto mr-0 text-sm font-medium","data-testid":"like-count",onClick:n,children:(0,r.jsx)("span",{className:"group-focus-visible:outline-secondary group-focus-visible:rounded-sm group-focus-visible:outline group-focus-visible:outline-2 group-focus-visible:outline-offset-2",children:(0,i.t)("comments.likes",{count:t,formatted_count:(0,eU.HA)(t)})})})},eq=function(e){var t=e.canLike,n=e.canReply,o=e.canSeeLikes,a=e.isLiked,l=e.isLikeDisabled,c=e.likesCount,u=e.onLikeClick,d=e.onLikesCountClick,f=e.onReplyClick,p=(0,m.wh)().currentUser,b=o&&c>0&&(p||t&&n);return(0,r.jsxs)("div",{className:"post__actions post__actions-visible mt-1 flex pl-[3.25rem]",children:[t&&(0,r.jsx)(eF,{className:(0,s.A)("post__actions--like mr-2",{liked:a}),label:(0,i.t)("comments.engagement_actions.".concat(a?"liked":"like")),onClick:u,disabled:l,isLiked:a}),n&&(0,r.jsx)(eF,{className:"post__actions--reply",label:(0,i.t)("comments.engagement_actions.reply"),onClick:f}),b&&(0,r.jsx)(eB,{likesCount:c,onClick:d})]})};eq.propTypes={canLike:eA().bool.isRequired,canReply:eA().bool.isRequired,canSeeLikes:eA().bool.isRequired,isLiked:eA().bool.isRequired,isLikeDisabled:eA().bool.isRequired,likesCount:eA().number.isRequired,onLikeClick:eA().func.isRequired,onLikesCountClick:eA().func.isRequired,onReplyClick:eA().func.isRequired};var ez=n(751169),eZ=n(381636),eV=n(859834),eH=function(e){var t,n,o,i,a=e.communityMember,s=e.hideModal,l=(0,eV.O)({public_uid:null!=(o=a.public_uid)?o:""}),c=l.onClick,u=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(l,["onClick"]);return(0,r.jsxs)("button",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({type:"button",className:"flex w-full items-center gap-3 text-left",onClick:function(e){s(),null==c||c(e)}},u),n=n={children:[(0,r.jsx)("div",{className:"mt-0",children:(0,r.jsx)(b.W,{name:null!=(i=a.name)?i:"",src:a.avatar_url,size:"10"})}),(0,r.jsx)(eZ.Z.LabelSm,{weight:"medium",children:a.name})]},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},eW=n(122612),eQ=n.n(eW),eG=n(25674),e$=n.n(eG),eK=n(283780),eJ=function(e){var t=e.id,n=e.isQueryEnabled,r=e.placeholderLikesCount,o=(0,eK.m)(B.av.comments.userLikes({id:t,params:{per_page:15}}),{enabled:n}),i=o.data,a=o.isLoading,s=o.hasNextPage,l=o.fetchNextPage,c=o.mapPages;return{likedByMembers:J()(eQ()(c(function(e){return e.records})),"id"),totalLikesCount:i?e$()(i.pages).count:r,isLoading:a,hasNextPage:s,fetchNextPage:l}},eX=function(e){var t=e.commentId,n=e.placeholderLikesCount,o=(0,eC.dd)(),s=eJ({id:t,isQueryEnabled:o.visible,placeholderLikesCount:n}),c=s.likedByMembers,u=s.totalLikesCount,d=s.isLoading,f=s.hasNextPage,m=s.fetchNextPage,p=(0,i.t)("comments.likes",{count:u,formatted_count:(0,eU.HA)(u)});return(0,r.jsxs)(ek.u_,{title:p,isOpen:o.visible,onClose:o.hide,children:[(0,r.jsx)(ek.u_.Overlay,{}),(0,r.jsxs)(ek.u_.Content,{children:[(0,r.jsxs)(ek.u_.Header,{children:[(0,r.jsx)(ek.u_.Title,{size:"sm",children:(0,r.jsx)(eZ.Z.LabelLg,{weight:"semibold",children:p})}),(0,r.jsx)(ek.u_.HeaderActions,{children:(0,r.jsx)(ek.u_.CloseButton,{onClick:o.hide})})]}),(0,r.jsx)(ek.u_.Body,{className:"pb-6 pt-4",children:d?(0,r.jsx)(l.m,{}):(0,r.jsx)("div",{id:"comment-likes-modal-".concat(t),className:"max-h-[calc(100dvh-62px-44px-24px)] overflow-auto sm:max-h-80",children:(0,r.jsx)(a.Z,{scrollThreshold:.75,next:m,hasMore:null!=f&&f,loader:(0,r.jsx)(ez.a,{}),scrollableTarget:"comment-likes-modal-".concat(t),dataLength:c.length,className:"flex flex-col space-y-4",children:c.map(function(e){return(0,r.jsx)(eH,{communityMember:e,hideModal:o.hide},e.id)})})})})]})]})};eX.displayName="LikesModalComponent";var eY=eC.gk.create(function(e){var t=e.commentId,n=e.placeholderLikesCount;return(0,r.jsx)(eX,{commentId:t,placeholderLikesCount:n})});eY.displayName="LikesModal";var e0=n(852937),e1=n(15588),e2=n(742613),e3=n(96533),e6=n(709397),e5=n(861853),e4=n(957363),e7=function(e){var t=e.agentProfileInfo,n=e.publicUid,o=e.avatarURL,a=e.name,s=void 0===a?"":a,l=e.closeCard,c=(0,e3.r)(),u=(0,e5.Dk)().setCurrentBotProfile,d=(0,W.k6)();return(0,r.jsxs)(e1.VY,{className:"border-primary bg-primary z-[1059] w-full max-w-[320px] rounded-xl border p-6 shadow-xl",sideOffset:5,side:"right",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"text-dark mr-4 min-w-0 flex-1",children:[(0,r.jsx)(eZ.Z.LabelMd,{weight:"semibold",children:(0,r.jsx)("span",{className:"text-dark",children:s})}),(0,r.jsx)("br",{}),(0,r.jsx)("div",{className:"text-light break-words",children:(0,r.jsx)(eZ.Z.LabelSm,{weight:"regular",children:(0,r.jsx)("span",{className:"text-light",children:null==t?void 0:t.bio})})})]}),(0,r.jsx)("div",{className:"shrink-0",children:(0,r.jsx)(e6.i,{avatarUrl:o,name:s,size:"small"})})]}),(0,r.jsx)("div",{className:"mt-4 space-y-2"}),(0,r.jsxs)("div",{className:"mt-4 flex w-full space-x-2",children:[n&&(0,r.jsxs)(_.z,{className:"!border-primary flex items-center justify-center space-x-2 !px-3 !py-1.5 !font-medium",full:!0,variant:"secondary",onClick:function(){c.show({memberPublicId:n}),l()},children:[(0,r.jsx)(e4.JO,{type:"16-user",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0}),(0,r.jsx)("span",{children:(0,i.t)("view_profile")})]}),(null==t?void 0:t.can_interact)&&(0,r.jsxs)(_.z,{onClick:function(e){var n;e.preventDefault(),e.stopPropagation(),u(null!=(n=null==t?void 0:t.profile)?n:null),d.push({pathname:(0,B.W9)()})},variant:"circle",full:!0,children:[(0,r.jsx)(e4.JO,{type:"plus",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0,className:"mr-1"}),(0,r.jsx)("span",{children:(0,i.t)("community_inbox.new_conversation")})]})]})]})};function e9(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var e8=function(e){var t,n=e.children,i=e.communityMemberId,a=e.publicUid,s=e.avatarURL,l=e.name,c=e.disabled,u=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return e9(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e9(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=u[0],f=u[1],m=(0,e2.z)({agentId:Number(i)}).getAgentProfileInfoQuery.data;return(0,r.jsxs)(e1.fC,{openDelay:300,closeDelay:100,open:d,onOpenChange:f,children:[(0,r.jsx)(e1.xz,{asChild:!0,children:(0,r.jsx)("div",{children:n})}),(0,r.jsx)(e1.h_,{children:!(void 0!==c&&c)&&(0,r.jsx)(e7,{agentProfileInfo:null!=m?m:null,publicUid:a,avatarURL:s,name:void 0===l?"":l,closeCard:function(){return f(!1)}})})]})},te=n(451980),tt=function(e){var t,n,o,i,a,s,l,c=e.comment,u=c.community_member,d=c.author_type,f=(0,eV.O)({public_uid:null!=(o=u.public_uid)?o:"",params:{show_back_link:!0}}),m=(0,e0.W)({id:u.id,params:{show_back_link:!0}});return(0,r.jsx)("div",{className:"post__user flex items-start",children:(0,r.jsx)("div",{className:"post__avatar mr-3",children:(0,r.jsx)("a",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:"user__avatar focus-visible:outline-secondary focus-visible:text-dark block size-10 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},"CommunityAiAgent"===d?m:f),n=n={children:"CommunityAiAgent"===d?(0,r.jsx)(e8,{communityMemberId:u.id,name:u.name,publicUid:u.public_uid,avatarURL:u.avatar_url,children:(0,r.jsx)(b.W,{src:null!=(i=u.avatar_url)?i:"",name:null!=(a=u.name)?a:"",size:"10"})}):(0,r.jsx)(te.C,{communityMemberId:u.id,name:u.name,publicUid:u.public_uid,headline:u.headline,avatarURL:u.avatar_url,children:(0,r.jsx)(b.W,{src:null!=(s=u.avatar_url)?s:"",name:null!=(l=u.name)?l:"",size:"10"})})},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))})})},tn=n(78456),tr=n(308683),to=n(941084),ti=n(117617),ta=n(380171),ts=n(534842),tl=n(524330),tc=n(523386),tu=function(e){var t,n,o=e.comment,a=e.commentLinkProps,l=o.community_member,u=o.created_at,d=(0,ti.kK)(),f="full-post-modal"===(0,m.Zh)().usedIn,p=d||f?(0,c.truncate)(l.headline,{length:60}):l.headline;return p||d||f?(0,r.jsx)("div",{className:"post__meta inline-flex",children:(0,r.jsx)(ta.T,{content:l.headline,shouldUseSpanWrapper:!1,interactive:!1,disabled:!p,children:(0,r.jsx)("button",{type:"button",className:"author__credentials text-default focus-visible:outline-secondary focus-visible:text-dark mt-1 w-full text-left text-xs leading-4 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,r.jsxs)("span",{children:[p&&(0,r.jsx)("span",{className:(0,s.A)("overflow-anywhere mr-2",{"md:line-clamp-1":!f}),children:p}),(d||f)&&!!p&&(0,r.jsx)("span",{className:"bg-badge mr-2 inline-block size-[0.15rem] rounded-full align-middle"}),(d||f)&&(0,r.jsx)("a",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:(0,s.A)("text-default hover:text-dark text-xs leading-5","focus-visible:outline-secondary focus-visible:text-dark mr-2 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2")},a),n=n={children:(0,r.jsx)(ta.T,{content:(0,to.s4)(u),className:"inline-flex",interactive:!1,children:(0,tr.TF)(u,{format:tr.lc.short})})},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t)),(d||f)&&o.flagged_for_approval_at&&(0,r.jsx)(tl.g,{className:"authour__in-review !bg-author-in-review border-0 uppercase text-white",label:(0,i.t)("comments.in_review")})]})})})}):null};function td(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function tf(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var tm=function(e){var t,n=e.post,o=e.comment,a=o.id,l=o.community_member,c=o.member_tags,u=o.flagged_for_approval_at,d=o.created_at,f=o.parent_comment_id,p=o.author_type,b=(0,m.wh)().currentCommunityMember,h="full-post-modal"===(0,m.Zh)().usedIn,v=!!l.admin,y=null==c?void 0:c.filter(function(e){var t;return(null==e?void 0:e.is_public)&&(null==e||null==(t=e.display_locations)?void 0:t.post_bio)}),g=(0,ep.I)(),x=(0,tn.vb)(b),_=(null==y?void 0:y.length)>0||v,j=(0,ti.kK)(),w=j?x:_,O=(0,eV.O)({public_uid:null!=(t=l.public_uid)?t:"",params:{show_back_link:!0}}),S=(0,e0.W)({id:l.id,params:{show_back_link:!0}}),P=td({href:(0,B.LM)({spaceSlug:n.space_slug,slug:n.slug,hash:"".concat(H.q).concat(a)})},g?{target:"_blank",rel:"noreferrer"}:{});return(0,r.jsxs)("div",{className:"post__bio mb-1.5 w-full",children:[(0,r.jsxs)("div",{className:(0,s.A)("author text-darkest flex flex-wrap items-center gap-x-2",{"no-headline":!l.headline}),children:[(0,r.jsx)("div",{className:"author__name flex",children:(0,r.jsx)("a",tf(td({className:"text-dark hover:text-darkest focus-visible:outline-secondary focus-visible:text-dark overflow-anywhere text-sm font-semibold focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},"CommunityAiAgent"===p?S:O),{children:l.name}))}),"CommunityAiAgent"===p&&(0,r.jsx)(ts.c,{}),_&&w&&(0,r.jsx)("div",{className:"author__tags member-tags",children:(0,r.jsx)(tc.m,{memberTags:y,isAdmin:v,limit:j||h||f?1:2,showMoreLabelVariant:"numbers"})}),!j&&!h&&(0,r.jsx)("div",{className:"author__time flex",children:(0,r.jsx)("a",tf(td({className:(0,s.A)("text-default hover:text-dark text-xs","focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2")},P),{children:(0,r.jsx)(ta.T,{content:(0,to.s4)(d),className:"inline-flex",interactive:!1,children:(0,tr.TF)(d,{format:tr.lc.short})})}))}),!j&&!h&&u&&(0,r.jsx)(tl.g,{className:"authour__in-review !bg-author-in-review border-0 uppercase text-white",label:(0,i.t)("comments.in_review")})]}),(0,r.jsx)(tu,{comment:o,commentLinkProps:P})]})},tp=["harassment","spam","incorrect_location","against_guidelines","other"],tb=function(e){var t=e.show,n=e.onClose,o=e.onReportSubmit,a=tp.map(function(e){return{value:e,label:(0,i.t)("flagged_contents.report_reasons.".concat(e))}});return(0,r.jsxs)(ek.u_,{isOpen:t,onClose:n,title:(0,i.t)("comments.report.form.title"),children:[(0,r.jsx)(ek.u_.Overlay,{}),(0,r.jsxs)(ek.u_.Content,{children:[(0,r.jsxs)(ek.u_.Header,{children:[(0,r.jsx)(ek.u_.Title,{size:"sm",children:(0,i.t)("comments.report.form.title")}),(0,r.jsx)(ek.u_.HeaderActions,{children:(0,r.jsx)(ek.u_.CloseButton,{onClick:n})})]}),(0,r.jsx)(ek.u_.Body,{children:(0,r.jsxs)(L.l,{onSubmit:function(e){return o(e)},children:[(0,r.jsx)(L.l.Item,{name:"reported_reason_type",label:(0,i.t)("flagged_contents.form.reported_reason_type"),description:(0,i.t)("flagged_contents.form.reported_reason_type_description"),className:"!pt-0",hideBorder:!0,children:(0,r.jsx)(L.l.SelectNative,{name:"reported_reason_type",options:a})}),(0,r.jsx)(L.l.Item,{name:"reported_reason_body",label:(0,i.t)("flagged_contents.form.reported_reason_body"),description:(0,i.t)("flagged_contents.form.reported_reason_body_description"),hideBorder:!0,fullWidth:!0,children:(0,r.jsx)(L.l.TextArea,{name:"reported_reason_body"})}),(0,r.jsx)("div",{className:"flex justify-end py-4",children:(0,r.jsx)(_.z,{type:"submit",variant:"primary",children:(0,i.t)("report")})})]})})]})]})};function th(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tv=function(e){var t,n=e.comment,r=e.onDelete,a=n.id,s=n.post_id,l=(0,q.pm)(),c=l.success,u=l.error,d=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return th(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return th(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=d[0],m=d[1],p=function(){return m(!1)},b=(0,F.useMutation)(function(){return(0,U.pC)(B.av.comments.destroy({postId:s,id:a}))},{onSuccess:function(){c((0,i.t)("comments.delete.alerts.success"),{duration:"short",shouldUseProgress:!1}),p(),r({id:a})},onError:function(){u((0,i.t)("comments.delete.alerts.failure")),p()}});return{isDeleteConfirmModalOpen:f,openDeleteConfirmModal:function(){return m(!0)},closeDeleteConfirmModal:p,deleteComment:b.mutate,isDeletingComment:b.isLoading}},ty=n(251630);function tg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function tx(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return tg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tg(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var t_="Comment",tj=function(e){var t=e.comment,n=t.id,r=t.is_liking_enabled,a=t.is_liked,s=t.likes_count,l=(0,m.xJ)(),c=(0,m.EU)(),u=(0,ep.I)(),d=tx((0,o.useState)(a),2),f=d[0],p=d[1],b=tx((0,o.useState)(s),2),h=b[0],v=b[1],y=(0,F.useMutation)(function(){return ty.Qd.create({userLikeableId:n,userLikableType:t_,forReactQuery:!0})}),g=y.mutate,x=y.isLoading,_=(0,F.useMutation)(function(){return ty.Qd.destroy({userLikeableId:n,userLikableType:t_,forReactQuery:!0})}),j=_.mutate,w=_.isLoading;return{toggleLike:function(){if(!l){var e=(0,B.j)({params:{notice:(0,i.t)("comments.log_in_to_like_comments"),post_login_redirect:window.location.href}});u?window.open(e,"_blank","noreferrer"):window.location.href=e;return}x||w||(f?(p(!1),v(function(e){return e-1}),j()):(p(!0),v(function(e){return e+1}),g()))},isLiked:f,likesCount:h,canLike:r&&c,canSeeLikes:r,isLoading:x||w}};function tw(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function tO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return tw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tw(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var tS=function(e){var t=e.comment,n=e.showReplyForm,r=e.replyFormRef,a=t.is_replying_enabled,s=(0,m.xJ)(),l=(0,m.EU)(),c=(0,ep.I)(),u=tO((0,o.useState)(n),2),d=u[0],f=u[1],p=tO((0,o.useState)(null),2),b=p[0],h=p[1];return{openReplyForm:function(e){var t,n,o=e.communityMember;if(!s){var a=(0,B.j)({params:{notice:(0,i.t)("comments.log_in_to_add_a_comment"),post_login_redirect:window.location.href}});c?window.open(a,"_blank","noreferrer"):window.location.href=a;return}h(o),f(!0),r.current&&(null==(n=r.current.commands)||null==(t=n.focus)||t.call(n,"end"))},shouldShowReplyForm:d,communityMemberForReply:b,canReply:a&&l,resetCommunityMemberForReply:function(){return h(null)}}},tP=n(601757),tC=n(691525);function tk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tI=function(e){var t,n=e.comment.id,r=(0,q.pm)(),a=r.success,s=r.error,l=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return tk(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tk(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=l[0],u=l[1],d=(0,tC.wh)().currentCommunityMember,f=function(){return u(!1)},m=(0,F.useMutation)(function(e){var t,r;return(0,U.Cu)(B.av.flaggedContent.create(),{flagged_content:(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),r=r={flagged_contentable_id:n,flagged_contentable_type:"Comment"},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}),t)})},{onSuccess:function(){a((0,i.t)("comments.report.alerts.success"),{duration:"short",shouldUseProgress:!1}),f(),(0,tn.vb)(d)&&eC.gk.show(tP.r,{templateKey:"ai_moderate_new_comments"})},onError:function(){s((0,i.t)("comments.report.alerts.failure"))}}).mutate;return{isReportModalOpen:c,openReportModal:function(){return u(!0)},closeReportModal:f,submitReport:m}},tN=function(e){var t=e.space,n=e.post,a=e.comment,l=e.showReplyForm,b=e.autofocusReplyForm,h=e.onReplyClick,v=e.onUpdate,y=void 0===v?c.noop:v,g=e.onDelete,x=void 0===g?c.noop:g,_=e.onReplyCreate,j=void 0===_?c.noop:_,w=e.onReplyDelete,O=void 0===w?c.noop:w,S=(0,m.wh)().isViewOnlyMasquerading,P=(0,m.Zh)().isUsedInMinimalTipTapViewModal,C=a.id,k=a.parent_comment_id,I=a.community_member,N=a.replies,A=a.replies_count,M=a.flagged_for_approval_at,T=a.policies,E=!!M,R=!!k,D=T.can_report&&!E,L=T.can_manage&&E,F=T.can_edit,U=T.can_destroy,B=T.can_bookmark,q=(0,o.useRef)(null),z=tS({comment:a,showReplyForm:void 0!==l&&l,replyFormRef:q}),Z=z.openReplyForm,V=z.shouldShowReplyForm,H=z.communityMemberForReply,W=z.canReply,Q=z.resetCommunityMemberForReply,G=tj({comment:a}),$=G.toggleLike,K=G.isLiked,J=G.likesCount,X=G.canLike,Y=G.canSeeLikes,ee=G.isLoading,et=(0,eC.dd)(eY),en=(0,eC.dd)(eL),er=tI({comment:a}),eo=er.isReportModalOpen,ei=er.openReportModal,ea=er.closeReportModal,es=er.submitReport,el=tv({comment:a,onDelete:x}),ec=el.isDeleteConfirmModalOpen,eu=el.openDeleteConfirmModal,ef=el.closeDeleteConfirmModal,em=el.deleteComment,ep=el.isDeletingComment,eb=h||Z;return(0,r.jsxs)("div",{className:(0,s.A)("post--comment text-dark md:px-0",{"px-5":!R&&!P,"pl-5":R&&!P}),id:"comment_wrapper_".concat(C),children:[(0,r.jsxs)("div",{className:(0,s.A)("post__content py-2.5",{"md:px-6":!P}),children:[(0,r.jsxs)("div",{className:"flex w-full justify-between",children:[(0,r.jsxs)("div",{className:"flex w-full pt-1",children:[(0,r.jsx)(tt,{comment:a}),(0,r.jsxs)("div",{className:"flex w-full flex-col",children:[(0,r.jsx)(tm,{post:n,comment:a}),(0,r.jsx)(eO,{comment:a})]})]}),(0,r.jsx)(ex,{comment:a,canReport:D,canReview:L,canEdit:F,canDestroy:U,canBookmark:B,isReply:R,onReportClick:S?c.noop:ei,onEditClick:S?c.noop:function(){return en.show({space:t,comment:a,onUpdate:y})},onDeleteClick:S?c.noop:eu,onUpdate:y})]}),(0,u.Y_)(t)&&(0,f.f)(a)&&(0,r.jsx)("div",{className:"my-2 pl-[3.25rem]",children:(0,r.jsx)(d.F.Regular,{record:a,contentType:"comment"})}),(0,r.jsx)(eq,{canReply:W,canLike:X,canSeeLikes:Y,isLiked:K,likesCount:J,isLikeDisabled:ee,onReplyClick:S?c.noop:function(){return eb({communityMember:I})},onLikeClick:S?c.noop:$,onLikesCountClick:S?c.noop:function(){return et.show({commentId:C,placeholderLikesCount:J})}}),D&&(0,r.jsx)(tb,{show:eo,onClose:ea,onReportSubmit:es}),U&&(0,r.jsx)(p.c,{isOpen:ec,onClose:ef,onConfirm:em,confirmText:ep?(0,i.t)("deleting"):(0,i.t)("delete"),confirmVariant:"danger",title:(0,i.t)("comments.delete.confirm.title"),disabled:ep,children:(0,i.t)("comments.delete.confirm.description")})]}),!R&&(0,r.jsx)("div",{className:(0,s.A)("post__replies md:ml-[3.125rem]",{"ml-8":!P,"ml-12":P}),children:(0,r.jsx)(ed,{space:t,post:n,parentCommentId:C,preloadedComments:N||[],preloadedCommentsTotalCount:A,showReplyForm:V,autofocusReplyForm:void 0!==b&&b,communityMemberForReply:H,resetCommunityMemberForReply:Q,onCommentReplyClick:Z,onCommentCreate:j,onCommentDelete:O,formRef:q})})]})};function tA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tM=function(e){var t,n=e.space,c=e.post,u=e.preloaded,d=e.preloadedComments,f=e.preloadedCommentsTotalCount,m=e.showReplyForm,p=e.autofocusReplyForm,b=e.onCommentCreate,h=e.onCommentDelete,v=e.formRef,y=e.scrollableTarget,g=e.commentsSectionRef,x=eu({parentCommentId:null,postId:c.id,preloaded:void 0!==u&&u,preloadedComments:void 0===d?[]:d,preloadedCommentsTotalCount:void 0===f?0:f,postCommentsClosed:c.is_comments_closed,postLikingDisabled:c.is_liking_disabled,space:n,showReplyForm:void 0!==m&&m,onCommentCreate:b,onCommentDelete:h,commentsSectionRef:g}),_=x.comments,j=x.hasNextPage,w=x.fetchNextPage,O=x.updateCommentInList,S=x.handleCommentCreate,P=x.handleCommentDelete,C=x.formKey,k=x.persistCacheKey,I=x.isFirstLoading,N=x.isAnyLoading,A=x.isUsedInMinimalTipTapViewModal,M=x.shouldShowForm,T=(t=(0,o.useState)(null),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return tA(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tA(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),E=T[0],R=T[1];return(0,o.useEffect)(function(){var e=null==y?void 0:y.current;e&&R(e)},[null==y?void 0:y.current]),(0,r.jsxs)("div",{className:(0,s.A)({"my-3":!M}),children:[(0,r.jsx)(a.Z,{style:{overflow:"initial"},scrollThreshold:.8,next:w,hasMore:null!=j&&j,loader:(0,r.jsx)(l.m,{}),dataLength:(null==_?void 0:_.length)||0,scrollableTarget:null!=E?E:"panel",children:_.map(function(e){return(0,r.jsx)(tN,{space:n,post:c,comment:e,autofocusReplyForm:!0,onUpdate:O,onDelete:P,onReplyCreate:b,onReplyDelete:h},e.id)})},E?"elementTarget":"idTarget"),j&&!N&&(0,r.jsx)("div",{className:"load-more py-5 text-center",children:(0,r.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),w()},className:"focus-visible:outline-secondary load-more__comments border-hover bg-primary text-dark hover:text-darkest focus-visible:text-darkest inline-block rounded-md border px-6 py-2 text-sm font-semibold leading-normal transition-colors duration-150 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,i.t)("comments.list.show_more_comments")})}),I&&(0,r.jsx)(l.m,{className:(0,s.A)({"mb-16":A})}),N&&A&&(0,r.jsx)("div",{className:"bg-primary absolute bottom-0 left-0 w-full !px-5 !py-4 md:!px-8",children:(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"bg-tertiary size-10 animate-pulse rounded-full"}),(0,r.jsx)("div",{className:"border-primary h-10 w-full rounded-lg border p-px"})]})}),M&&(0,r.jsx)(Z,{spaceId:n.id,postId:c.id,autoFocus:void 0!==p&&p,className:(0,s.A)(A&&"!max-h-[360px]"),onCreate:S,bodyInputRef:v,persistCacheKey:k},C)]})},tT=n(251805),tE=function(e){var t,n=e.space,a=e.post,s=e.id,c=e.showReplyForm,u=e.autofocusReplyForm,d=e.onCommentDelete,f=e.onReplyCreate,m=e.onReplyDelete,p=(0,tT.E)({postId:a.id,id:s,postCommentsClosed:null!=(t=a.is_comments_closed)&&t,postLikingDisabled:a.is_liking_disabled}),b=p.comment,h=p.isLoading,v=p.updateQueryData;return((0,o.useEffect)(function(){if(!h){var e,t;null==(e=(t=window).initialiseTippy)||e.call(t)}},[h]),$({enabled:!h}),h)?(0,r.jsx)(l.m,{}):b?(0,r.jsx)(tN,{space:n,post:a,comment:b,showReplyForm:void 0!==c&&c,autofocusReplyForm:void 0!==u&&u,onUpdate:v,onDelete:d,onReplyCreate:f,onReplyDelete:m}):(0,r.jsx)("div",{className:"post__comment-not-found border-primary text-dark dark:text-lightest bg-v2-warning-100 rounded-b-lg border-t p-2.5 py-4 text-base md:p-5",children:(0,i.t)("comments.hierarchy.not_found")})},tR=n(227053),tD=n(430507),tL=function(e){var t=e.post,n=["post-conversation-summary",t.id],r=(0,F.useQueryClient)(),o=(0,F.useQuery)(n,function(){return(0,U.UT)(B.av.posts.conversationSummary.show({postId:String(t.id)}))},{enabled:!1,staleTime:6e5,retry:function(e,t){return(null==t?void 0:t.status)!==404}}),i=o.data,a=o.isLoading,s=o.refetch,l=function(){r.resetQueries({queryKey:n,exact:!0})},c=(0,F.useMutation)(function(e){return(0,U.gN)(B.av.posts.conversationSummary.update({postId:String(t.id)}),e)},{onSuccess:function(){l()}});return{conversationSummary:i,isLoadingConversationSummary:a,refetchConversationSummary:s,clearConversationSummary:l,updateConversationSummary:c.mutateAsync,isSaving:c.isLoading}},tF="post.conversation_summary",tU=function(e){var t=e.onUndo,n=e.disabled;return(0,r.jsxs)("div",{className:"bg-tertiary group flex items-center justify-between rounded-md p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(e4.JO,{type:"20-stardust",size:20,className:"text-default !h-5 !w-5"}),(0,r.jsx)("span",{className:"text-dark text-sm font-normal normal-case leading-5 tracking-tight",children:(0,i.t)([tF,"disabled_notice"])})]}),(0,r.jsx)(eh.h,{name:"20-undo",ariaLabel:(0,i.t)([tF,"actions","undo"]),tooltipText:(0,i.t)([tF,"actions","undo"]),onClick:t,className:"text-dark",iconSize:20,buttonSize:24,disabled:n})]})};function tB(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function tq(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function tz(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){tq(i,r,o,a,s,"next",e)}function s(e){tq(i,r,o,a,s,"throw",e)}a(void 0)})}}function tZ(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return tB(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tB(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tV(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var tH="post.conversation_summary",tW=function(e){var t=e.post,n=e.className,a=(0,m.wh)().currentCommunityMember,l=(0,tn.vb)(a),c=tL({post:t}),u=c.conversationSummary,d=c.refetchConversationSummary,f=c.clearConversationSummary,p=c.updateConversationSummary,b=c.isSaving,h=tZ((0,o.useState)(!1),2),v=h[0],y=h[1],g=tZ((0,o.useState)(!1),2),x=g[0],_=g[1],j=(0,o.useCallback)(function(){y(!1)},[]),w=!v&&!u,O=!v&&!!u;return t.conversation_summary_overview?x&&l?(0,r.jsx)("div",{className:(0,s.A)("py-5 md:px-6",n),children:(0,r.jsx)(tU,{onUndo:function(){return tz(function(){return tV(this,function(e){switch(e.label){case 0:return[4,p({disabled:!1})];case 1:return e.sent(),_(!1),[2]}})})()},disabled:b})}):(0,r.jsx)("div",{className:(0,s.A)("flex py-5 md:px-6",n),children:(0,r.jsxs)(tD.w,{isCollapsed:w,onCollapseClick:function(){y(!1),f()},onExpandClick:function(){y(!0),d()},className:"pb-4",children:[(0,r.jsxs)(tD.w.Content,{closeButtonPosition:"sidebar",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(tD.w.Header,{animate:v,isHidden:O,children:(0,i.t)([tH,w?"title":"loading"])}),l&&w&&(0,r.jsx)(ev.Lt,{direction:"bottom-end",menuButtonEl:"div",button:(0,r.jsx)(eh.h,{name:"20-dot-menu",iconClassName:"!text-default group-hover:!text-dark",className:"group",variant:"secondary",iconSize:20,buttonSize:24,ariaLabel:(0,i.t)([tH,"actions","title"]),disabled:b}),className:"z-10",transitionWrapperClassName:"z-50",size:"large",buttonLabel:(0,i.t)([tH,"actions","title"]),children:(0,r.jsx)(ev.Lt.ItemLink,{onClick:function(){return tz(function(){return tV(this,function(e){switch(e.label){case 0:return[4,p({disabled:!0})];case 1:return e.sent(),_(!0),[2]}})})()},hasDanger:!0,children:(0,i.t)([tH,"actions","disable"])})})]}),w&&(0,r.jsx)(tD.w.BodyText,{children:t.conversation_summary_overview}),(null==u?void 0:u.content)&&(0,r.jsx)(tD.w.BodyText,{animation:"fade-in",onAnimationComplete:j,children:u.content})]}),t.comments_count>0&&O&&(0,r.jsx)(tD.w.Footer,{children:(0,r.jsx)(tD.w.FooterNote,{children:(0,i.t)([tH,"comments_summarized"],{count:t.comments_count,formatted_count:(0,eU.HA)(t.comments_count)})})})]})}):null},tQ=function(e){var t=e.className;return(0,r.jsx)("div",{className:t,children:(0,r.jsxs)("div",{className:"bg-tertiary flex items-center justify-center gap-2 rounded-md p-3 text-center",children:[(0,r.jsx)(e4.JO,{size:16,type:"lock-v2",className:"text-dark"}),(0,r.jsx)(eZ.Z.LabelSm,{children:(0,i.t)("post.comments_section.comments_closed")})]})})},tG=n(29378);function t$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function tK(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var tJ=function(e){var t=e.isIframeEmbed,n=e.containerClassNames,o=e.currentCommunity,a=t?{target:"_blank",rel:"noreferrer"}:{},s=!!(null==o?void 0:o.private_sign_up_url),l=(0,tG.fs)(o)||s,c=s?o.private_sign_up_url:(0,tG.pn)(o);return(0,r.jsxs)("div",{className:n,children:[(0,r.jsx)("div",{className:"mb-3 text-center",children:(0,r.jsx)(eZ.Z.LabelLg,{weight:"semibold",children:(0,i.t)("login_to_comment")})}),(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,r.jsx)("a",tK(t$({className:"focus-visible:outline-secondary border-hover bg-primary text-dark hover:text-darkest focus-visible:text-darkest rounded-md border px-[18px] py-[6px] text-sm font-semibold transition-colors duration-150 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",href:(0,B.j)({params:{post_login_redirect:window.location.href}})},a),{children:(0,i.t)("log_in")})),l&&(0,r.jsx)("a",tK(t$({className:"signup-link btn btn-primary focus-visible:!outline-secondary !bg-brand !text-brand-button !h-auto !rounded-md !px-[18px] !py-[6px] !text-sm !font-bold !leading-5 !transition-colors !duration-150 hover:!opacity-90 focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",href:c},a),{children:s?o.private_sign_up_label:(0,i.t)("sign_up")}))]})]})},tX=n(589252),tY=function(e){var t=e.lockedPostCtaContent,n=e.containerClassNames;return(0,r.jsxs)("div",{className:n,children:[(0,r.jsx)("div",{children:(0,r.jsx)(eZ.Z.TitleSm,{weight:"semibold",children:t.heading})}),(0,r.jsx)("div",{className:"mt-4",children:t.body&&(0,r.jsx)(eZ.Z.BodyMd,{children:(0,r.jsx)(tX.Z,{html:t.body})})}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(_.z,{onClick:function(){return window.location.href=t.buttonLink},children:t.buttonLabel})}),(0,r.jsxs)("div",{className:"already-member mt-4",children:[(0,r.jsx)(eZ.Z.LabelSm,{children:(0,i.t)("already_a_member")}),(0,r.jsx)("a",{className:"signup-link text-link ml-1 text-sm font-medium",href:(0,B.j)({params:{post_login_redirect:window.location.href}}),children:(0,i.t)("log_in")})]})]})},t0=function(e){var t=e.post,n=e.space,o=(0,m.wh)(),a=o.currentCommunity,l=o.currentUser,c=(0,tR.m)(),d=c.isSharedPostWithTeaserLayout,f=c.showGatedCommentSectionAtBottom,p=c.showGatedCommentSectionAtTop,b=c.isSharedPostViewWithMinimalLayout,h=(0,ep.I)(),v={heading:a.locked_post_cta_heading||(0,i.t)("login_to_comment"),body:a.locked_post_cta_body,buttonLabel:a.locked_post_cta_button_text||(0,i.t)("log_in"),buttonLink:a.locked_post_cta_button_url||(0,B.j)({params:{post_login_redirect:window.location.href}})},y=!!l,g=!y&&d,x=(0,tG.v)(a),_=(0,s.A)("gated-post gated-post--custom-cta py-10 px-7 text-center",{"border-t border-primary":b,post__logged_out_comments:!x,"post__bottom_border border-b border-primary":p&&!b,"post__top_border border-t border-primary":f&&!b,"gated-post--standard-layout":!t.minimal_layout,"gated-post--no-gradient":!g,"gated-post--gradient":g});return(x||!n||(0,u.WB)(n))&&a.custom_cta_for_share_links?(0,r.jsx)(tY,{containerClassNames:_,lockedPostCtaContent:v}):t.is_comments_enabled&&!y?(0,r.jsx)(tJ,{containerClassNames:_,isIframeEmbed:h,currentCommunity:a}):null},t1=function(e){var t=e.post||{},n=t.slug,o=t.space_slug;return(0,r.jsx)("div",{className:"border-primary flex items-center justify-center gap-4 border-t p-12",children:(0,r.jsx)("a",{className:"btn btn-secondary",href:(0,B.LM)({spaceSlug:o,slug:n}),children:(0,i.t)("leave_a_comment")})})};function t2(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function t3(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return t2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t2(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var t6=function(e){var t=e.autofocusReplyForm,n=e.commentsFormRef,a=e.className,l=e.scrollableTarget,c=(0,tR.m)(),u=c.post,d=c.showGatedCommentSectionAtBottom,f=c.showGatedCommentSectionAtTop,p=c.shouldShowLeaveCommentButton,b=c.shouldHideCommentsListForSpace,h=c.refetchPostDetails,v=c.updatePostDetailsQueryCache,y=Q().commentId,g=t3((0,o.useState)(y),2),x=g[0],_=g[1],j=t3((0,o.useState)(y&&u.comments_count>4),2),w=j[0],O=j[1];(0,o.useEffect)(function(){(null==u?void 0:u.comments_count)&&O(y&&u.comments_count>4)},[y,u]);var S=(0,m.L2)().data,P=(0,m.Zh)().isUsedInMinimalTipTapViewModal,C=u.is_comments_closed,k=function(){h&&h()},I=function(){v&&v({comments_count:u.comments_count+1})},N=function(){O(!1),_(null),window.location.hash="#all_comments"},A=b({space:S});(0,o.useEffect)(function(){_(y)},[y]);var M=(0,o.useRef)(null),T=!(p||(0,to.HZ)(u));return(0,r.jsxs)(r.Fragment,{children:[!A&&(0,r.jsx)(tW,{post:u}),(0,r.jsxs)("div",{ref:M,className:(0,s.A)("post__comments trix-v2",{"transition-[margin] duration-150 ease-in-out":P&&!C},void 0===a?"":a),"data-controller":"comments",id:"all_comments","data-post-id":u.id,children:[C&&(0,r.jsx)(tQ,{className:"m-4"}),p&&(0,r.jsx)(t1,{post:u}),T&&f&&(0,r.jsx)(t0,{post:u,space:S}),!A&&w&&x&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"show-all-comments__wrapper px-2.5 py-4 md:p-6",children:(0,r.jsxs)("a",{className:"show-all-comments__link focus-visible:outline-secondary border-hover bg-primary text-dark hover:text-darkest focus-visible:text-darkest inline-flex items-center gap-2 rounded-md border px-4 py-2 text-sm font-semibold leading-normal transition-colors duration-150 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",href:"#all_comments",onClick:function(e){e.preventDefault(),N()},children:[(0,r.jsx)(e4.JO,{type:"arrow-solid-top-left"}),(0,i.t)("post.comments_section.show_all_count_comments",{count:u.comments_count,formatted_count:(0,eU.HA)(u.comments_count)})]})}),(0,r.jsx)(tE,{space:S,post:u,id:x,showReplyForm:!C,autofocusReplyForm:t,onCommentDelete:function(){k(),N()},onReplyCreate:I,onReplyDelete:k})]}),!A&&!w&&(0,r.jsx)(tM,{space:S,post:u,showReplyForm:!C,autofocusReplyForm:t,formRef:n,onCommentCreate:I,onCommentDelete:k,scrollableTarget:l,commentsSectionRef:M}),T&&d&&(0,r.jsx)(t0,{post:u,space:S})]})]})}},930457:function(e,t,n){n.d(t,{S:()=>U});var r=n(552676),o=n(619803),i=n.n(o),a=n(227053),s=n(260622),l=n(903225),c=n(739792),u=n(441342),d=n(131510),f=n(957363),m=n(352521),p=n(573384),b=n(586721),h=n(663676),v=n(840905),y=function(e){var t=e.count,n=e.toggleComment,o=e.hasPostDetailsLoaded,s=e.shouldForceSamePageInteractions,u=void 0!==s&&s,f=(0,a.m)().post,y=(0,b.Z)().usedIn,g=(0,l.TH)(),x=(0,m.d)().navigateToPost,_=(0,p._t)(),j=_.params,w=_.hasNextPage,O=!(0,d.U)()||"profile-modal"===y;return o?(0,r.jsx)("button",{type:"button",className:i()("hover:!text-dark focus-visible:outline-secondary text-default p-0 text-sm font-medium transition-colors duration-150 ease-in-out focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"),"data-testid":"post-comment-count",onClick:function(){O&&!u?x({newPost:f,prevLocation:g,params:j,hasNextPage:w,shouldFocusOnCommentsSection:!0}):n()},children:(0,c.t)("post.comments",{count:t,formatted_count:(0,h.HA)(t)})}):(0,r.jsx)(v.gi,{variant:"row",lg:!0,long:!0})},g=n(729806),x=n(941084),_=function(e){var t=e.likesCount;return e.isLoading?(0,r.jsx)(v.gi,{variant:"row",lg:!0,extraLong:!0}):0===t?null:(0,r.jsx)("span",{className:"overflow-anywhere text-default group-hover:text-dark text-sm font-medium",children:(0,c.t)("likes_count",{localeCount:(0,h.HA)(t),count:t})})},j=n(275271),w=n(932699),O=n(25593),S=n(757105),P=n(720624),C=n(547144),k=n(283780),I=n(434519),N=n(880301),A=function(e){var t,n=e.post,o=(0,S.dd)(),i=(0,k.m)(C.av.posts.userLikesList({postId:String(n.id),params:{per_page:15}}),{enabled:!!(null==n?void 0:n.id)},["post-likes-modal",null==n?void 0:n.id]),a=i.data,s=i.isLoading,l=i.fetchNextPage,u=i.hasNextPage,d=i.mapPages,f=(0,j.useMemo)(function(){return(0,w.flatten)(d(function(e){return e.records}))},[d]),m=null==a||null==(t=a.pages[0])?void 0:t.count;return(0,r.jsxs)(I.u_,{title:(0,c.t)("like_modal_title"),isOpen:o.visible,onClose:o.hide,children:[(0,r.jsx)(I.u_.Overlay,{}),(0,r.jsxs)(I.u_.Content,{children:[(0,r.jsxs)(I.u_.Header,{children:[(0,r.jsx)(I.u_.Title,{size:"sm",children:m?(0,r.jsxs)(r.Fragment,{children:[(0,h.HA)(m)," ",1===m?(0,c.t)("like"):(0,c.t)("likes")]}):(0,c.t)("likes")}),(0,r.jsx)(I.u_.HeaderActions,{children:(0,r.jsx)(I.u_.CloseButton,{onClick:o.hide})})]}),(0,r.jsx)(I.u_.Body,{className:"pb-6 pt-4",children:s?(0,r.jsx)(P.m,{}):(0,r.jsx)("div",{id:"post-likes-modal-".concat(n.id),className:"max-h-[calc(100dvh-62px-44px-24px)] overflow-auto sm:max-h-80",children:(0,r.jsx)(O.Z,{scrollThreshold:.75,next:l,hasMore:u||!1,loader:(0,r.jsx)(P.m,{}),scrollableTarget:"post-likes-modal-".concat(n.id),dataLength:f.length,className:"flex flex-col space-y-4",children:f.map(function(e){return(0,r.jsx)(N.N,{member:e,hideModal:o.hide},e.id)})})})})]})]})},M=S.gk.create(function(e){var t=e.post;return(0,r.jsx)(A,{post:t})}),T=function(e){var t=e.shouldDisplayVerticalDivider,n=(0,a.m)(),o=n.post,s=n.isPostBodyEmpty,l=(0,u.Zh)().usedIn,c=o.user_likes_count,d=o.is_liking_enabled,f=o.sample_user_likes_community_members,m=void 0===f?[]:f,p=o.post_details_loaded,b=(0,S.dd)(M);return p?d&&c&&m.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{type:"button",onClick:function(){return b.show({post:o})},className:"post__engagement focus-visible:outline-secondary group focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2","data-testid":"post-liked-by",children:(0,r.jsx)("div",{className:"engagement__likes flex items-center",children:(0,r.jsxs)("div",{className:"engagement__members border-tertiary flex items-center space-x-2",children:[(0,r.jsx)(g.p,{users:m.slice(0,3).map(function(e){return{src:e.avatar_url,name:e.name}}),isFullRounded:!0,size:"5"}),(0,r.jsx)(_,{likesCount:c,isLoading:!p})]})})}),(void 0===t||t)&&(0,r.jsx)("div",{className:"bg-badge size-0.5 rounded-full"})]}):null:(0,r.jsx)("div",{className:i()("post__engagement",{"!pt-5":(0,x.Fr)(o)&&s,"mx-2":"minimal-post-modal"!==l}),children:(0,r.jsx)(v.gi,{variant:"members-avatar-row-v3"})})},E=function(e){var t,n=e.shouldOpenCommentPage,o=e.showCommentAndFocusCommentForm,s=e.toggleComment,b=e.shouldForceSamePageInteractions,h=(0,u.EU)(),v=(0,l.TH)(),g=(0,m.d)().navigateToPost,x=(0,p._t)(),_=x.params,j=x.hasNextPage,w=(0,a.m)().post,O=w.is_comments_closed,S=w.is_comments_enabled,P=w.comments_count,C=w.post_details_loaded,k=!(0,d.U)();return S&&!n?(0,r.jsxs)(r.Fragment,{children:[!O&&h&&(0,r.jsx)("button",{type:"button",onClick:function(){k?g({newPost:w,prevLocation:v,params:_,hasNextPage:j}):o()},"aria-label":(0,c.t)("cap_comment_aria_label",{title:null!=(t=null==w?void 0:w.name)?t:(0,c.t)("this_post")}),className:i()("action-comment text-default hover:!text-dark focus-visible:outline-secondary flex items-center px-1 py-0.5 text-sm font-medium transition-colors duration-150 ease-in-out focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"),"data-testid":"post-comment-button",children:(0,r.jsx)("span",{className:"action__icon",children:(0,r.jsx)(f.JO,{type:"24-comment",size:24})})}),(0,r.jsxs)("div",{className:"engagement__comments ml-auto mr-0 flex items-center gap-2","data-testid":"engagement-comments",children:[(0,r.jsx)(T,{}),(0,r.jsx)(y,{count:void 0===P?0:P,toggleComment:s,hasPostDetailsLoaded:C,shouldForceSamePageInteractions:void 0!==b&&b})]})]}):(0,r.jsx)("div",{className:"engagement__comments ml-auto mr-0 flex items-center gap-2",children:(0,r.jsx)(T,{shouldDisplayVerticalDivider:!1})})},R=n(554348),D=function(e){var t=e.shouldOpenCommentPage,n=e.toggleComment,o=e.shouldForceSamePageInteractions,i=(0,a.m)().post,s=i.is_comments_enabled,l=i.comments_count,u=i.post_details_loaded;return s&&t?(0,r.jsxs)(R.s,{post:i,allComments:!0,className:"flex w-full !items-center !justify-between",shouldOpenPostModal:!1,children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"action__icon",children:(0,r.jsx)(f.JO,{type:"message",className:"!text-dark",useWithFillCurrentColor:!0})}),(0,r.jsx)("span",{className:"count !text-dark",children:(0,c.t)("cap_comment")})]}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(y,{count:void 0===l?0:l,toggleComment:n,hasPostDetailsLoaded:u,shouldForceSamePageInteractions:void 0!==o&&o})})]}):null};function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var F=function(){var e,t,n=(e=(0,j.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return L(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],s=n[1],l=(0,u.EU)(),d=(0,a.m)(),m=d.post,p=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(d,["post"]),b=m.is_liking_enabled,h=m.is_liked_by_current_user,v=m.post_details_loaded;return b&&l?(0,r.jsx)("button",{type:"button","aria-label":(0,c.t)("like_post_aria_label",{name:null!=(t=null==m?void 0:m.name)?t:""}),onClick:function(e){var t;s(!0),setTimeout(function(){s(!1)},200),null==(t=p.onLikeToggle)||t.call(p,e)},className:i()("action-link post__actions--like hover:!text-dark focus-visible:outline-secondary flex items-center px-1 py-0.5 text-sm transition-all duration-200 ease-in-out focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"liked text-brand font-semibold":h,"text-default font-medium":!h,"cursor-not-allowed":!v},o?"scale-110":"scale-100"),children:(0,r.jsx)(f.JO,{type:h?"24-heart-red-fill":"24-heart-outline",size:24})}):null},U=function(e){var t=e.toggleComment,n=e.showCommentAndFocusCommentForm,o=e.shouldOpenCommentPage,l=void 0!==o&&o,c=e.shouldForceSamePageInteractions,u=e.className;return(0,a.m)().showEngagementActions?(0,r.jsxs)("div",{className:i()("post__actions post__actions-visible border-primary flex items-center gap-1 border-t px-3 py-2.5 md:px-4",void 0===u?"":u),"data-testid":"post-engagement-actions",children:[(0,r.jsx)(s.T,{children:(0,r.jsx)(F,{})}),(0,r.jsx)(E,{shouldOpenCommentPage:l,showCommentAndFocusCommentForm:n,toggleComment:t,shouldForceSamePageInteractions:void 0!==c&&c}),(0,r.jsx)(D,{shouldOpenCommentPage:l,toggleComment:t})]}):null}},880301:function(e,t,n){n.d(t,{N:()=>l});var r=n(552676),o=n(664657),i=n(451980),a=n(859834),s=n(381636),l=function(e){var t=e.member,n=e.hideModal,l=t.name,c=t.avatar_url,u=t.public_uid,d=t.headline,f=(0,a.O)({public_uid:u}),m=f.onClick,p=f["aria-label"],b=f.href,h=f.rel,v=f.target;return(0,r.jsxs)("a",{className:"flex items-center gap-3",onClick:function(e){n(),m&&m(e)},"aria-label":p,href:b,rel:h,target:v,children:[(0,r.jsx)("div",{className:"mt-0",children:(0,r.jsx)(i.C,{communityMemberId:t.id,name:l,publicUid:u,headline:d,avatarURL:c,children:(0,r.jsx)(o.W,{name:l,src:c,size:"10"})})}),(0,r.jsx)(s.Z.LabelSm,{weight:"medium",children:l})]})}},327265:function(e,t,n){n.d(t,{c:()=>u});var r=n(552676),o=n(619803),i=n.n(o),a=n(739792),s=n(117617),l=n(957363),c=n(381636),u=function(e){var t=e.post,n=e.mobileWrapperClassName,o=(0,s.kK)();return t.pinned_at_top_of_space?o?(0,r.jsxs)("div",{className:i()("mx-5 mt-5 flex items-center gap-2",void 0===n?"":n),children:[(0,r.jsx)(l.JO,{size:20,type:"20-pinned-post",className:"text-dark"}),(0,r.jsx)(c.Z.LabelXxs,{children:(0,a.t)("post.pinned_post")})]}):(0,r.jsx)("div",{className:"post__pin post__pin--pinned inline-flex p-1",children:(0,r.jsx)(l.JO,{type:"20-pin-post",className:"text-default !h-5 !w-5",size:20,useWithStrokeCurrentColor:!0})}):null}},413737:function(e,t,n){n.d(t,{Z:()=>v});var r=n(552676),o=n(131906),i=n(903225),a=n(739792),s=n(617013),l=n(441342),c=n(93199),u=n(941084),d=n(547144),f=n(39905),m=n(767900),p=n(434519),b=n(60878),h=n(381636),v=function(e){var t=e.spaceId,n=e.postId,v=e.postSlug,y=e.postTitle,g=e.hasNoteAboutExceptions,x=e.isOpen,_=e.onClose,j=e.onDuplicateSuccess,w=(0,i.k6)(),O=(0,b.pm)(),S=O.success,P=O.error,C=(0,l.nT)(),k=C.isLoading,I=(0,C.helpers.basicSpacesWithPostCreationAllowed)(),N=(0,o.useMutation)(function(e){return(0,c.aU)(d.av.posts.duplicate({spaceId:t,postSlug:v}),{post:{post_id:n,space_id:e.space_id,send_notifications:e.send_notifications}})},{onSuccess:function(e){S((0,a.t)("duplicated_successfully")),_(),w.push((0,u.RG)({post:e,editMode:!0})),j&&j(e)},onError:function(){P((0,a.t)("duplication_failed"))}}),A=N.mutate,M=N.isLoading;return k?null:(0,r.jsxs)(p.u_,{isOpen:void 0!==x&&x,onClose:_,children:[(0,r.jsx)(p.u_.Overlay,{}),(0,r.jsxs)(p.u_.Content,{className:"!overflow-visible",children:[(0,r.jsxs)(p.u_.Header,{children:[(0,r.jsx)(p.u_.Title,{children:(0,a.t)("duplicate_post_title",{post_title:y||(0,a.t)("duplicate_post_title_untitled")})}),(0,r.jsx)(p.u_.CloseButton,{onClick:_})]}),(0,r.jsx)(p.u_.Body,{className:"!overflow-visible",children:(0,r.jsxs)(m.l,{onSubmit:function(e){return A(e)},defaultValues:{space_id:t,send_notifications:!1},id:"duplicate-post-form",children:[(0,r.jsx)(m.l.Item,{name:"space_id",hideBorder:!0,fullWidth:!0,label:(0,a.t)("space"),description:(0,a.t)("duplicate_post_to_space"),rules:{required:(0,a.t)("events.create.form.space_required_error")},children:(0,r.jsx)(s.M,{spaces:I,name:"space_id",variant:"form-input",defaultValue:t,containerClassname:"mt-2"})}),(void 0===g||g)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.Z.LabelXs,{color:"text-light",children:(0,a.t)("comments_wont_be_duplicated")}),(0,r.jsx)(m.l.Item,{name:"send_notifications",hideBorder:!0,fullWidth:!0,label:(0,a.t)("duplicate_post_send_notifications"),hideDescription:!0,inlineReverse:!0,children:(0,r.jsx)(m.l.ToggleSwitch,{variant:"small",name:"send_notifications"})})]})]})}),(0,r.jsx)(p.u_.Footer,{children:(0,r.jsx)(f.z,{type:"submit",variant:"primary",disabled:M,form:"duplicate-post-form",children:M?(0,a.t)("duplicating"):(0,a.t)("duplicate")})})]})]})}},872826:function(e,t,n){n.d(t,{u:()=>l});var r=n(552676),o=n(1892),i=n(7011),a=n(441342),s=n(751169),l=function(e){var t=e.show,n=e.closeModal,l=e.post,c=e.shouldSkipRedirectAfterSubmit,u=e.onChange,d=e.onSubmitSuccess;if(!t)return null;var f=(0,o.t)({spaceId:l.space_id,postSlug:l.slug,context:"edit-post-modal"}),m=f.isLoading,p=f.post,b=f.remove;return m?(0,r.jsx)(s.a,{variant:"fullscreen"}):(0,r.jsx)(a.DW,{post:p,onPostChange:u,children:(0,r.jsx)(i.Y,{show:t,closeModal:function(){n&&n(),b()},shouldSkipRedirectAfterSubmit:void 0!==c&&c,onSubmitSuccess:d})})}},124012:function(e,t,n){n.d(t,{m:()=>I});var r=n(552676),o=n(131906),i=n(739792),a=n(651714),s=n(537291),l=n(78456),c=n(114735),u=n(686785),d=n(559709),f=n(434754),m=n(298324),p=n(842953),b=n(64282),h=n(227053),v=n(441342),y=n(117617),g=n(624804),x=n(356345),_=n(957363),j=n(963549),w=n(775148),O=n(434519),S=n(524330),P=n(943544),C=n(60878);function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var I=function(e){var t,n=e.onChange,I=e.onPostDestroy,N=(0,h.m)(),A=N.post,M=N.canUpdatePost,T=N.canDuplicatePost,E=N.canDestroyPost,R=N.canManagePost,D=N.refetchPostDetails,L=(0,b.Z)(),F=(0,C.pm)(),U=F.success,B=F.error,q=(0,v.L2)().refetch,z=(0,y.kK)(),Z=(t=(0,g.k)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return k(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),V=Z[0],H=Z[1],W=(0,f.B)({event:A}),Q=W.onDeleteClickHandler,G=W.isConfirmationModalOpen,$=W.toggleConfirmationModal,K=W.isRecurringModalOpen,J=W.toggleRecurringModal,X=(0,v.wh)(),Y=X.isViewOnlyMasquerading,ee=X.currentCommunityMember,et=(0,l.vb)(ee)&&"draft"!==A.status,en=(0,s.x)(),er=en.onSendAnnouncement,eo=en.isLoading,ei=(0,O.UV)().contentPortalElement,ea=(0,o.useMutation)(function(e){return a.S.destroy({event:A,params:{delete_mode:e}})},{onSuccess:function(){I(A.id),U((0,p.Km)(A),{duration:"short",shouldUseProgress:!1}),null==q||q()},onError:function(){return B((0,i.t)("event_dropdown_actions.delete_failed"))}});return M||T||E?Y?(0,r.jsx)(_.JO,{type:"menu-dots","aria-label":(0,i.t)("events.event_actions"),className:"cursor-not-allowed"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(P.Lt,{direction:"bottom-end",menuButtonEl:"div",button:(0,r.jsx)(w.h,{name:"20-menu-dots-horizontal",iconClassName:"!text-default group-hover:!text-dark !w-5 !h-5",className:"group",variant:"secondary",iconSize:20,buttonSize:28,ariaLabel:(0,i.t)("events.event_actions"),dataTestId:"action-more"}),className:"z-10",transitionWrapperClassName:"z-50",size:"large",appendTo:null!=ei?ei:document.body,children:[(0,r.jsx)(x.e,{variant:"dropdown",bookmarkType:"event",record:A,onSuccess:D}),z&&(0,r.jsx)(m.i,{onChange:function(){return n()},button:(0,r.jsx)(P.Lt.ItemLink,{children:(0,i.t)("events.event_actions_dropdown.share_event")})}),M&&(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){return L.show({event:A})},forceClose:!0,children:(0,i.t)("edit_event")}),T&&(0,r.jsx)(P.Lt.ItemLink,{onClick:H,children:(0,i.t)("duplicate_event")}),E&&(0,r.jsx)(P.Lt.ItemLink,{onClick:Q,forceClose:!0,children:(0,r.jsx)("span",{className:"text-v2-danger",children:(0,i.t)("delete_event")})}),et&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.Lt.Separator,{}),(0,r.jsx)(P.Lt.ItemLink,{"data-testid":"send-announcement-event-action",disabled:eo,onClick:function(){return er({eventId:A.id})},children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,i.t)("share_via_broadcast"),(0,r.jsx)(S.g,{label:(0,i.t)("new"),square:!0})]})})]}),R&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.Lt.Separator,{}),(0,r.jsx)(d.E,{event:A,canEdit:M})]})]}),(0,r.jsx)(j.c,{isOpen:G,title:(0,i.t)("delete_event_confirmation"),onClose:$,onCancel:$,onConfirm:function(){return ea.mutate("")},confirmVariant:"danger",disabled:ea.isLoading,confirmText:ea.isLoading?(0,i.t)("deleting"):(0,i.t)("confirm"),children:(0,i.t)("delete_event_descriptor")}),(0,r.jsx)(u.D,{event:A,show:V,onClose:H}),!(0,p.yl)(A)&&(0,r.jsx)(c.t,{show:K,isDeleting:ea.isLoading,onConfirm:function(e){return ea.mutate(e)},onCloseModal:J})]}):null}},242194:function(e,t,n){n.d(t,{p:()=>ed});var r=n(552676),o=n(227053),i=n(441342),a=n(124012),s=n(619803),l=n.n(s),c=n(932699),u=n(131906),d=n(739792),f=n(629662),m=n(474520),p=n(524330),b=n(941084),h=n(251630),v=n(209339),y=n(440274),g=n(29378),x=n(78456),_=n(547144),j=n(356345),w=n(963549),O=n(775148),S=n(60878),P=n(943544),C=n(434519),k=n(684969),I=n(93199),N=n(479840),A=function(e){var t=e.post,n=e.handleClose,i=void 0===n?c.noop:n,a=(0,S.pm)(),s=a.success,l=a.error,f=!!t.post_follower_id,m=(0,o.m)().onPostFollow,p=(0,u.useMutation)(f?function(){return(0,I.pC)(_.av.postFollowers.destroy({postId:t.id,postFollowerId:t.post_follower_id}))}:function(){return(0,I.Cu)(_.av.postFollowers.create({postId:t.id}))},{onSuccess:function(e){var t;m({post_follower_id:f?null:null==e||null==(t=e.post_follower)?void 0:t.id}),i(),s(I18n.t(f?"post_unfollow.success":"post_follow.success"))},onError:function(){return l(I18n.t(f?"post_unfollow.error":"post_follow.error"))}});return(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){p.mutate()},children:(0,r.jsx)(N.sI,{label:(0,d.t)("follow_post"),field:"follow_post",value:f,variant:"small"})})};function M(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var T=function(e){var t=e.post,n=e.onChange,o=e.refetchPosts,i=e.handleClose,a=void 0===i?c.noop:i,s=(0,S.pm)(),l=s.success,f=s.error,m=t.pinned_at_top_of_space,p=(0,u.useMutation)(function(){return h.Fv.pin({post:t,formData:{is_pinned:!m,pin_to_top:!0}})},{onSuccess:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:if(n(e,{refetch:!1}),!(0,c.isFunction)(o))return[3,2];return[4,o()];case 1:t.sent(),t.label=2;case 2:return l(I18n.t(m?"post_unpinned":"post_pinned")),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){M(i,r,o,a,s,"next",e)}function s(e){M(i,r,o,a,s,"throw",e)}a(void 0)})})()},onError:function(){f(I18n.t(m?"post_unpinned_error":"post_pinned_error"))},onSettled:a});return(0,r.jsx)(P.Lt.ItemLink,{onClick:p.mutate,children:(0,r.jsx)(N.sI,{label:(0,d.t)("pin_to_top"),field:"pin_to_top",value:m,variant:"small"})})},E=n(323583);function R(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var D=function(e){var t=e.post,n=e.handleClose,o=e.onChange,i=!!(null==t?void 0:t.pinned_at),a=(0,u.useQueryClient)(),s=(0,S.pm)(),l=s.success,c=s.error,f=(0,E.P)().refetch,m=(0,u.useMutation)(function(){var e,n;return h.Fv.pin({post:t,formData:(e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},t),n=n={is_pinned:!i,pin_to_top:!1},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}),e)})},{onSuccess:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return null==o||o(e,{refetch:!1}),[4,f()];case 1:return t.sent(),[4,a.invalidateQueries({queryKey:["posts"]})];case 2:return t.sent(),l((0,d.t)(i?"post_unpinned_from_sidebar":"post_pinned_to_sidebar")),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){R(i,r,o,a,s,"next",e)}function s(e){R(i,r,o,a,s,"throw",e)}a(void 0)})})()},onError:function(){c((0,d.t)(i?"post_unpinned_error":"post_pinned_error"))},onSettled:n});return(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){return m.mutate()},children:(0,r.jsx)(N.sI,{label:(0,d.t)("pin_post"),field:"pin_post",value:i,variant:"small"})})},L=function(e){var t=e.post,n=e.handleClose,o=e.onChange,i=!!(null==t?void 0:t.is_comments_disabled),a=i?"post.enable_comments":"post.disable_comments",s=(0,S.pm)(),l=s.success,c=s.error,f=(0,u.useMutation)(function(){return(0,I.gN)(_.av.posts.update({spaceId:null==t?void 0:t.space_id,postSlug:null==t?void 0:t.slug}),{post:{space_id:null==t?void 0:t.space_id,is_comments_disabled:!i}})},{onSuccess:function(e){null==o||o(e,{refetch:!1}),l((0,d.t)("".concat(a,".alerts.success")))},onError:function(){c((0,d.t)("".concat(a,".alerts.failure")))},onSettled:n}).mutate;return(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){return f()},children:(0,r.jsx)(N.sI,{label:(0,d.t)("post.action_menu.disable_comments"),field:"disable_comments",value:i,variant:"small"})})},F=function(e){var t=e.post,n=e.handleClose,o=e.onChange,i=!!(null==t?void 0:t.is_comments_closed),a=i?"post.open_comments":"post.close_comments",s=(0,S.pm)(),l=s.success,c=s.error,f=(0,u.useMutation)(function(){return(0,I.gN)(_.av.posts.update({spaceId:null==t?void 0:t.space_id,postSlug:null==t?void 0:t.slug}),{post:{space_id:null==t?void 0:t.space_id,is_comments_closed:!i}})},{onSuccess:function(e){null==o||o(e,{refetch:!1}),l((0,d.t)("".concat(a,".alerts.success")))},onError:function(){c((0,d.t)("".concat(a,".alerts.failure")))},onSettled:n}).mutate;return(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){return f()},children:(0,r.jsx)(N.sI,{label:(0,d.t)("post.action_menu.close_comments"),field:"close_comments",value:i,variant:"small"})})},U=n(601757),B=n(757105);function q(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var z=function(e){var t=e.post,n=e.handleClose,o=void 0===n?c.noop:n,a=e.onChange,s=e.refetchPosts,l=t.hide_from_featured_areas,f=(0,S.pm)(),m=f.success,p=f.error,b=(0,i.wh)().currentCommunityMember,v=(0,u.useMutation)(function(){return l?h.Fv.showInFeaturedAreas({post:t}):h.Fv.hideFromFeaturedAreas({post:t})},{onSuccess:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:if(a(e,{refetch:!1}),!(0,c.isFunction)(s))return[3,2];return[4,s()];case 1:t.sent(),t.label=2;case 2:return m(I18n.t(l?"post.marked_unhidden":"post.marked_hidden")),!l&&(0,x.vb)(b)&&B.gk.show(U.r,{templateKey:"ai_curate_home_feed"}),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){q(i,r,o,a,s,"next",e)}function s(e){q(i,r,o,a,s,"throw",e)}a(void 0)})})()},onError:function(){p(I18n.t("something_went_wrong"))}});return(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){o(),v.mutate()},children:(0,r.jsx)(N.sI,{label:(0,d.t)("post.hide_from_featured_areas"),field:"hide_from_featured_areas",value:l,variant:"small"})})},Z=function(e){var t=e.post,n=e.onChange,o=t.is_liking_disabled,i=o?"post.enable_liking":"post.disable_liking",a=(0,S.pm)(),s=a.success,l=a.error,c=(0,u.useMutation)(function(){return(0,I.gN)(_.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:{space_id:t.space_id,is_liking_disabled:!o}})},{onSuccess:function(e){n(e,{refetch:!1}),s((0,d.t)("".concat(i,".alerts.success")))},onError:function(){l((0,d.t)("".concat(i,".alerts.failure")))}}).mutate;return(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){return c()},children:(0,r.jsx)(N.sI,{label:(0,d.t)("post.action_menu.disable_liking"),field:"disable_liking",value:o,variant:"small"})})},V=n(413737),H=n(872826),W=n(691525),Q=n(39905),G=n(767900),$=["harassment","spam","incorrect_location","against_guidelines","other"],K=function(e){var t=e.onClose,n=e.show,o=e.post,i=(0,S.pm)(),a=(0,W.wh)().currentCommunityMember,s=(0,u.useMutation)(function(e){return(0,I.t5)(_.av.flaggedContent.create(),{method:"POST",forReactQuery:!0,body:JSON.stringify({flagged_content:e})})},{onSuccess:function(){i.success((0,d.t)("report_post_success")),(0,x.vb)(a)&&B.gk.show(U.r,{templateKey:"ai_moderate_new_posts"}),t()},onError:function(){i.error((0,d.t)("something_went_wrong"))}}),l=$.map(function(e){return{value:e,label:(0,d.t)("flagged_contents.report_reasons.".concat(e))}});return(0,r.jsxs)(C.u_,{isOpen:n,onClose:t,title:(0,d.t)("flagged_contents.form.report_post"),children:[(0,r.jsx)(C.u_.Overlay,{}),(0,r.jsx)(C.u_.Content,{children:(0,r.jsxs)(G.l,{defaultValues:{flagged_contentable_id:o.id,flagged_contentable_type:"Post"},onSubmit:function(e){return s.mutate(e)},children:[(0,r.jsxs)(C.u_.Header,{children:[(0,r.jsx)(C.u_.Title,{size:"sm",children:(0,d.t)("flagged_contents.form.report_post")}),(0,r.jsx)(C.u_.HeaderActions,{children:(0,r.jsx)(C.u_.CloseButton,{onClick:t})})]}),(0,r.jsxs)(C.u_.Body,{children:[(0,r.jsx)(G.l.Item,{name:"reported_reason_type",label:(0,d.t)("flagged_contents.form.reported_reason_type"),description:(0,d.t)("flagged_contents.form.reported_reason_type_description"),hideBorder:!0,children:(0,r.jsx)(G.l.SelectNative,{name:"reported_reason_type",options:l})}),(0,r.jsx)(G.l.Item,{name:"reported_reason_body",label:(0,d.t)("flagged_contents.form.reported_reason_body"),description:(0,d.t)("flagged_contents.form.reported_reason_body_description"),hideBorder:!0,fullWidth:!0,children:(0,r.jsx)(G.l.TextArea,{name:"reported_reason_body"})})]}),(0,r.jsxs)(C.u_.Footer,{className:"flex justify-end",children:[(0,r.jsx)(Q.z,{type:"button",variant:"secondary",onClick:t,className:"mr-2",disabled:s.isLoading,children:(0,d.t)("cancel")}),(0,r.jsx)(Q.z,{type:"submit",variant:"circle",disabled:s.isLoading,"data-testid":"report_post_submit",children:(0,d.t)("report")})]})]})})]})},J=n(227851),X=n(887279),Y=n(61641),ee=function(e){var t=e.post,n=e.onSuccess,r=e.onError,o=(0,S.pm)(),i=o.success,a=o.error;return(0,u.useMutation)({mutationFn:function(e){return(0,I.gN)(_.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({space_id:t.space_id},e)})},onSuccess:function(e){(0,c.isFunction)(n)&&n(e),i((0,d.t)("changes_saved"))},onError:function(){(0,c.isFunction)(r)&&r(),a((0,d.t)("failed_to_save_changes"))}})},et=function(e){var t,n,o=e.post,a=e.isOpen,s=e.onClose,l=e.onChange,c=(0,i.Zh)().setIsUpdatingCardViewThumbnail,u=ee({post:o,onSuccess:function(e){l(e,{refetch:!1}),null==c||c(!1)},onError:function(){null==c||c(!1)}}),f=(0,J.cI)({defaultValues:{cardview_thumbnail:o.cardview_thumbnail}});return(0,r.jsx)(X.l,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},f),n=n={onSubmit:function(e){u.mutate(e)},className:"hidden",children:function(e){var t=e.triggerFormSubmit;return(0,r.jsx)(Y.a,{isOpen:a,name:"cardview_thumbnail",onClose:function(){s()},aspectRatio:2,title:(0,d.t)("upload_a_cardview_thumbnail"),renderer:function(){return(0,r.jsx)(r.Fragment,{})},onImageAttachSuccess:t,onProcessing:function(e){return e&&(null==c?void 0:c(e))}})}},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},en=n(903225),er=n(60589),eo=n(117617),ei=n(624804);function ea(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function es(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ea(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ea(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var el=function(e){var t=e.onPostDestroy,n=(0,i.L2)(),r=n.data,a=n.refetch,s=(0,o.m)(),l=s.post,c=s.showShareOnWebOptions,f=(0,i.Zh)().usedIn,m=(0,en.k6)(),p=es((0,ei.k)(!1),2),v=p[0],y=p[1],g=es((0,ei.k)(!1),2),x=g[0],_=g[1],j=es((0,ei.k)(!1),2),w=j[0],O=j[1],P=es((0,ei.k)(!1),2),C=P[0],k=P[1],I=es((0,ei.k)(!1),2),N=I[0],A=I[1],M=(0,b.hm)(l),T=(0,eo.kK)(),E=(0,S.pm)(),R=E.success,D=E.error,L=M&&!(null==r?void 0:r.hide_right_sidebar)&&!(0,er.AU)(r),F=(0,er.AU)(r)||(0,er.G6)(r),U=!!(0,en.$B)("/c/:spaceSlug/:postSlug"),B=l.pinned_at_top_of_space,q=!U&&!B&&F,z=T||"full-post-modal"===f,Z=z?c(r):q&&c(r),V=(0,er.AU)(r)&&!B&&(0,er.Y_)(r);return{shouldShowPinToSidebar:L,isPostCardOrListView:F,isPostDetailsPage:U,isCurrentPostPinnedAtTopOfSpace:B,isEligibleForSharing:q,isRenderedOnSmallScreensOrFullPostModal:z,shouldShowShareOnWebOptions:Z,shouldShowSetThumbnailOptionForPosts:V,shouldShowEditPostModal:v,toggleEditPostModal:y,shouldShowDuplicatePostModal:x,toggleDuplicatePostModal:_,shouldShowReportPostModal:w,toggleReportPostModal:O,shouldShowConfirmationModal:C,toggleConfirmationModal:k,deleteMutation:(0,u.useMutation)(function(){return h.Fv.destroy({post:l})},{onSuccess:function(){t(l.id),R((0,d.t)("post_dropdown_actions.delete_successful")),a()},onError:function(){return D((0,d.t)("post_dropdown_actions.delete_failed"))}}),redirectToPost:function(e){return m.push((0,b.RG)({post:e}))},shouldShowSetThumbnailModal:N,toggleSetThumbnailModal:A}},ec=function(e){var t=e.refetchPosts,n=e.currentCommunity,a=e.onPostDestroy,s=e.onChange,I=(0,o.m)(),N=I.post,M=I.showModerationInActionsDropdown,E=I.canManagePost,R=I.canUpdatePost,U=I.canDestroyPost,B=I.canDuplicatePost,q=I.canReportPost,W=I.refetchPostDetails,Q=I.isTiptapPost,G=(0,i.Zh)(),$=G.usedIn,J=G.isUsedInMinimalTipTapViewModal,X=(0,i.wh)(),Y=X.currentCommunitySettings,ee=X.isViewOnlyMasquerading,en=X.currentCommunityMember,er=(0,y.L)().show,eo=(0,f.e)(),ei=(0,v.h)(),ea=(0,b.Fr)(N),es=(0,b.hm)(N),ec=(0,C.UV)(),eu=ec.contentPortalElement,ed=ec.onClose,ef=(0,i.L2)().data,em=(0,x.vb)(en),ep=(null==Y?void 0:Y.kb_post_action_enabled)&&em,eb=(0,m.$)(),eh=eb.onShareViaBroadcast,ev=eb.isLoading,ey=(0,S.pm)(),eg=ey.success,ex=ey.error,e_=(0,u.useMutation)(function(){return h.Fv.updateKnowledgeBasePost({post:N})},{onSuccess:function(){eg((0,d.t)("post_dropdown_actions.update_knowledge_base_post_successful"))},onError:function(){return ex((0,d.t)("post_dropdown_actions.update_knowledge_base_post_failed"))}}),ej=el({onPostDestroy:a}),ew=ej.shouldShowPinToSidebar,eO=ej.shouldShowShareOnWebOptions,eS=ej.shouldShowSetThumbnailOptionForPosts,eP=ej.shouldShowEditPostModal,eC=ej.toggleEditPostModal,ek=ej.shouldShowDuplicatePostModal,eI=ej.toggleDuplicatePostModal,eN=ej.shouldShowReportPostModal,eA=ej.toggleReportPostModal,eM=ej.shouldShowConfirmationModal,eT=ej.toggleConfirmationModal,eE=ej.deleteMutation,eR=ej.redirectToPost,eD=ej.shouldShowSetThumbnailModal,eL=ej.toggleSetThumbnailModal;return ee?(0,r.jsx)(O.h,{name:"16-menu-dots-horizontal",iconClassName:"!text-dark cursor-not-allowed",ariaLabel:(0,d.t)("post_actions"),dataTestId:"action-more",disabled:!0}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(P.Lt,{direction:"bottom-end",menuButtonEl:"div",button:(0,r.jsx)(O.h,{name:"20-dot-menu",iconClassName:"!text-default group-hover:!text-dark",className:"group",variant:"secondary",iconSize:20,buttonSize:J?32:28,ariaLabel:(0,d.t)("post_actions"),dataTestId:"action-more"}),className:l()("z-10",{"inline-flex h-8 w-8":J}),transitionWrapperClassName:"z-50",size:"large",buttonLabel:(0,d.t)("post_actions"),appendTo:null!=eu?eu:document.body,children:[(0,r.jsx)(j.e,{variant:"dropdown",bookmarkType:"post",record:N,onSuccess:W}),eO&&(0,r.jsx)(k.P,{onChange:s,button:(0,r.jsx)(P.Lt.ItemLink,{children:(0,d.t)("post.share.share_post_actions_label")}),shouldRenderCustomMenuButton:!0}),R&&es&&(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){ee?(0,c.noop)():er({post:N,onPostChange:s,shouldSkipRedirectAfterSubmit:J})},children:(0,d.t)("edit_post")}),R&&ea&&(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){eo.show({spaceId:null==ef?void 0:ef.id,onClose:function(){return eo.remove()},onPostChange:s,currentPost:N,shouldSkipRedirectAfterSubmit:"full-post-modal"===$})},children:(0,d.t)("edit_post")}),es&&B&&(0,r.jsx)(P.Lt.ItemLink,{onClick:eI,children:(0,d.t)("duplicate_post")}),ea&&B&&(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){"full-post-modal"===$&&ed(),ei.show({post:N,onSuccess:eR})},children:(0,d.t)("duplicate_post")}),eS&&(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){eL()},children:(0,d.t)("set_thumbnail")}),q&&(0,r.jsx)(P.Lt.ItemLink,{onClick:ee?c.noop:eA,children:(0,d.t)("report_post")}),M&&(0,r.jsx)(P.Lt.ItemWithLink,{to:_.sC.index(),children:(0,d.t)("flagged_contents.review")}),U&&(0,r.jsx)(P.Lt.ItemLink,{onClick:ee?c.noop:eT,children:(0,r.jsx)("span",{className:"text-v2-danger",children:(0,d.t)("delete_post")})}),ep&&(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){e_.mutate()},children:(0,d.t)("post_dropdown_actions.update_knowledge_base_post_dropdown_label")}),em&&es&&Q&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.Lt.Separator,{}),(0,r.jsx)(P.Lt.ItemLink,{"data-testid":"send-announcement-post-action",disabled:ev,onClick:function(){return eh({postId:N.id})},children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,d.t)("post_dropdown_actions.share_via_broadcast"),(0,r.jsx)(p.g,{label:(0,d.t)("new"),square:!0})]})})]}),(R||B||q||M||U)&&(0,r.jsx)(P.Lt.Separator,{}),(0,r.jsx)(A,{post:N}),E&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T,{post:N,onChange:s,refetchPosts:t}),ew&&(0,r.jsx)(D,{post:N,onChange:s}),(0,r.jsx)(Z,{post:N,onChange:s}),(0,r.jsx)(L,{post:N,onChange:s}),N.is_comments_enabled&&(0,r.jsx)(F,{post:N,onChange:s}),!!n&&(0,g.Nf)(n)&&(0,r.jsx)(z,{post:N,onChange:s,refetchPosts:t})]})]}),(0,r.jsx)(et,{post:N,onChange:s,onClose:eL,isOpen:eD}),(0,r.jsx)(H.u,{show:eP,closeModal:eC,post:N,onChange:s}),(0,r.jsx)(V.Z,{spaceId:N.space_id,postId:N.id,postSlug:N.slug,postTitle:N.name,isOpen:ek,onClose:eI}),(0,r.jsx)(K,{post:N,show:eN,onClose:eA}),(0,r.jsx)(w.c,{isOpen:eM,title:(0,d.t)("delete_post_confirmation"),onClose:eT,onCancel:eT,onConfirm:eE.mutate,confirmVariant:"danger",disabled:eE.isLoading,confirmText:eE.isLoading?(0,d.t)("deleting"):(0,d.t)("confirm"),children:(0,d.t)("delete_post_descriptor")})]})},eu=function(e){var t=e.onChange,n=e.onPostDestroy,i=e.refetchPosts,s=e.currentCommunity,l=(0,o.m)(),c=l.isBasicPost,u=l.isEventPost,d=l.isImagePost;return(0,r.jsxs)(r.Fragment,{children:[(c||d)&&(0,r.jsx)(ec,{onChange:t,onPostDestroy:n,refetchPosts:i,currentCommunity:s}),u&&(0,r.jsx)(a.m,{onChange:t,onPostDestroy:n})]})},ed=function(e){var t=e.onChange,n=e.onPostDestroy,a=e.refetchPosts,s=(0,o.m)(),l=s.showPostActions,c=s.canUpdatePost,u=s.canDestroyPost,d=s.isEventPost,f=(0,i.wh)().currentCommunity;return l&&(!d||c||u)?(0,r.jsx)(eu,{onChange:t,onPostDestroy:n,refetchPosts:a,currentCommunity:f}):null}},562068:function(e,t,n){n.d(t,{y:()=>x});var r=n(552676),o=n(619803),i=n.n(o),a=n(589252),s=n(903225),l=n(739792),c=n(941084),u=n(547144),d=n(227053),f=n(441342),m=n(22319),p=n(291704),b=n(672851),h=n(322825),v=n(918),y=n(352521),g=n(573384),x=function(e){var t=e.enableTruncation,n=e.noPadding,o=(0,d.m)(),x=o.post,_=o.isSharedPostWithTeaserLayout,j=o.isSharedPostViewWithMinimalLayout,w=o.isTiptapPost,O=o.isTrixPost,S=o.isBasicPost,P=o.isPostBodyEmpty,C=(0,s.TH)(),k=(0,y.d)().navigateToPost,I=(0,g._t)(),N=I.params,A=I.hasNextPage,M=(0,m.wC)().minimal_layout,T=(0,f.Zh)(),E=T.usedIn,R=T.isUsedInMinimalTipTapViewModal,D=["help","help-en"].includes(x.community_slug)&&S,L=!(void 0!==t&&t),F=j&&_,U=!R&&(0,c.HZ)(x)&&!L,B=x.body_trix_content,q=x.tiptap_body,z=x.internal_custom_html,Z=x.pinned_at_top_of_space,V=x.updated_at;if(P)return null;var H=8;return Z?H=2:F&&(H=4),(0,r.jsx)("div",{className:i()("post__body",{"!p-0":void 0!==n&&n,"px-5 pb-5 md:px-6":(0,c.Fr)(x)&&!R,"mt-5":"minimal-post-modal"===E}),"data-testid":"post-body",children:(0,r.jsxs)("div",{className:"post__inside trix-v2 w-full","data-testid":"post-body-inside",children:[(0,r.jsxs)(b.X,{lines:H,disabled:L,hideToggle:_||U,children:[O&&B&&(0,r.jsx)(p.P,{content:B,contentParentPath:u.xu.show({slug:x.slug,spaceSlug:x.space_slug})}),w&&q&&(0,r.jsx)(h.Rs,{readOnly:!0,disableMentionClicks:M,value:q.body,sgidToObjectMap:q.sgids_to_object_map,inlineAttachments:q.inline_attachments}),z&&(0,r.jsx)(a.Z,{html:z},"internal_custom_html"),D&&(0,r.jsx)(v.e,{post:x})]}),U&&(0,r.jsx)("button",{type:"button",className:"text-default hover:text-dark mt-2 text-base",onClick:function(){k({newPost:x,params:N,hasNextPage:A,prevLocation:C})},children:(0,l.t)("see_more")})]})},V)}},248250:function(e,t,n){n.d(t,{H:()=>c});var r=n(552676),o=n(739792),i=n(701168),a=n(839931),s=n(941084),l=n(554348),c=function(e){var t,n,c,u,d,f,m=e.post,p=e.className,b=e.wrapperClassName,h=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["post","className","wrapperClassName"]),v=(0,s.HZ)(m);return(null!=(u=null==(c=m.cover_image_variants)?void 0:c.large)?u:m.cover_image_url)?(0,r.jsx)("div",{className:(0,i.A)("px-5 pt-5 md:p-0",void 0===b?"":b),children:(0,r.jsx)(l.s,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({shouldOpenPostModal:!0,post:m,className:"post__cover focus-visible:outline-secondary focus-visible:text-dark block focus-visible:rounded-lg focus-visible:outline focus-visible:outline-2 focus-visible:md:rounded-b-none"},h),n=n={children:m.cover_image_variants&&(0,r.jsx)(a.Q,{src:null!=(d=m.cover_image_url)?d:"",srcVariants:m.cover_image_variants,alt:(0,o.t)("post.cover_image_alt"),className:(0,i.A)("w-full object-cover",void 0===p?"":p,{"md:rounded-b-none":!v,"rounded-lg":v,"rounded-2xl":!v})},null!=(f=m.cover_image_url)?f:"")},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))}):null}},261410:function(e,t,n){n.d(t,{m:()=>S});var r=n(552676),o=n(619803),i=n.n(o),a=n(903225),s=n(739792),l=n(60589),c=n(624831),u=n(929090),d=n(441342),f=n(941084),m=n(117617),p=n(524330),b=n(227053),h=n(886307),v=n(356345),y=n(327265),g=n(242194),x=n(684969),_=n(459331),j=function(e){var t=e.post,n=e.onChange,o=e.onPostDestroy,a=e.refetchPosts,s=e.hideShareLink,l=e.hidePinnedToTopIcon,c=e.hideBookmarkButton,u=e.hideSummarizeButton,p=(0,b.m)(),j=p.refetchPostDetails,w=p.isSharedPostView,O=(0,m.kK)(),S=(0,f.Fr)(t),P=(0,f.hm)(t),C=(0,d.Zh)().isUsedInMinimalTipTapViewModal,k=(0,h.Z)({post:t}).toggleSummary,I=!c&&!w&&!O,N=!s&&!O,A=!l&&!w&&!O,M=!C;return I||M||N||A?(0,r.jsxs)("div",{className:"post__actions-container text-dark flex items-center gap-0.5","data-testid":"post-header-actions",children:[t.has_summary&&!u&&(0,r.jsx)(_.k,{onClick:k}),I&&(0,r.jsx)(v.e,{bookmarkType:S||P?"post":"event",record:t,onSuccess:j,className:i()("!text-default",{"group-hover:!text-dark":!t.bookmark_id})}),N&&(0,r.jsx)(x.P,{onChange:n}),M&&(0,r.jsx)(g.p,{onChange:n,onPostDestroy:o,refetchPosts:a}),A&&(0,r.jsx)(y.c,{post:t})]}):null},w=n(397281),O=n(472034),S=function(e){var t,n,o=e.hideAuthorHeadline,b=void 0!==o&&o,h=e.hideBookmarkButton,v=e.hideSummarizeButton,y=e.hidePinnedToTopIcon,g=e.hideShareLink,x=e.isRenderedOutsideTheSpace,_=void 0!==x&&x,S=e.metaInfoWrapperClassName,P=e.onChange,C=e.onPostDestroy,k=e.post,I=e.refetchPosts,N=e.tagsLimit,A=e.tagsShowMoreLabelVariant,M=(0,d.L2)().data,T=(0,d.Zh)(),E=T.usedIn,R=T.isUsedInMinimalTipTapViewModal,D=null==k?void 0:k.cover_image_url,L=(0,m.kK)(),F=null==(t=(0,a.$B)("/home"))?void 0:t.isExact,U=null==(n=(0,a.$B)("/feed"))?void 0:n.isExact,B=_||F||U||L||"minimal-post-modal"===E;return(0,r.jsxs)(r.Fragment,{children:[(0,l.Y_)(M)&&(0,u.f)(k)&&(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(c.F.Regular,{record:k,contentType:"post"})}),(0,r.jsxs)("div",{className:i()("flex items-start justify-between gap-3",{"mb-5":R&&(0,f.Fr)(k)}),children:[(0,r.jsxs)("div",{className:"flex grow flex-col items-start justify-between space-y-4 md:space-y-5",children:[(null==k?void 0:k.flagged_for_approval_at)&&(0,r.jsx)(p.g,{className:"!bg-author-in-review post__headline-tag align mt-1 border-0 align-middle uppercase text-white",label:(0,s.t)("in_review")}),B?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.c,{isRenderedOutsideTheSpace:_,doesPostHaveCoverImage:D,space:M,tagsLimit:N,tagsShowMoreLabelVariant:A,wrapperClassName:i()("mt-1",S),hideAuthorHeadline:b}),(0,r.jsx)(O.p,{})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O.p,{}),(0,r.jsx)(w.c,{isRenderedOutsideTheSpace:_,doesPostHaveCoverImage:D,space:M,tagsLimit:N,tagsShowMoreLabelVariant:A,wrapperClassName:i()("mt-1",S),hideAuthorHeadline:b})]})]}),(0,r.jsx)(j,{post:k,onChange:P,refetchPosts:I,onPostDestroy:C,hideShareLink:void 0!==g&&g,hidePinnedToTopIcon:void 0!==y&&y,hideBookmarkButton:void 0!==h&&h,hideSummarizeButton:void 0!==v&&v})]})]})}},397281:function(e,t,n){n.d(t,{c:()=>I});var r=n(552676),o=n(275271),i=n(739792),a=n(227053),s=n(441342),l=n(117617),c=n(619803),u=n.n(c),d=n(554348),f=n(282859),m=n(308683),p=n(941084),b=n(380171),h=n(523386),v=n(932699),y=(0,o.forwardRef)(function(e,t){var n=e.headline,o=e.post,i=o.community_member,a=o.created_at,c=(0,l.kK)(),f=(0,s.Zh)().usedIn,p=c||"full-post-modal"===f,h=p?(0,v.truncate)(n,{length:60}):n;return n||p?(0,r.jsx)("div",{className:"post__meta inline-flex flex-wrap items-center gap-x-2",children:(0,r.jsx)(b.T,{content:n,shouldUseSpanWrapper:!1,interactive:!1,disabled:!n,children:(0,r.jsx)("button",{type:"button",className:u()("author__credentials text-default focus-visible:outline-secondary focus-visible:text-dark mt-1 text-left text-xs focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"is-admin":!!i.is_admin}),children:(0,r.jsxs)("span",{className:"space-x-2",children:[n&&(0,r.jsx)("span",{className:u()("overflow-anywhere",{"md:line-clamp-1":"full-post-modal"!==f}),children:h}),p&&!!n&&(0,r.jsx)("span",{className:"bg-badge inline-block size-[0.15rem] rounded-full align-middle"}),p&&(0,r.jsx)("span",{className:"author__time",children:(0,r.jsx)(d.s,{post:o,className:"ago text-default hover:text-dark focus-visible:outline-secondary focus-visible:text-dark text-xs focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",forwardedRef:t,children:(0,m.TF)(a,{format:m.lc.short})})})]})})})}):null});y.displayName="AuthorHeadline";var g=n(859834),x=n(22319),_=function(e){var t,n,o,i=e.children,a=e.post,s=e.className,l=void 0===s?"":s,c=a.community_member,d=(0,x.wC)().minimal_layout,f=(0,g.O)({public_uid:null!=(o=c.public_uid)?o:"",params:{show_back_link:!0},name:c.name});return d?(0,r.jsx)("div",{className:l,children:i}):(0,r.jsx)("a",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},f),n=n={className:u()("focus-visible:outline-secondary hover:text-dark inline-block focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",l),"data-testid":"post-avatar",children:i},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},j=n(664657),w=n(451980),O=n(31960),S=function(e){var t,n,o=e.post,i=o.community_member,a=(0,O.E)().member;return(0,r.jsx)("div",{className:"post__avatar",children:(0,r.jsx)(w.C,{communityMemberId:i.id,publicUid:i.public_uid,avatarURL:i.avatar_url,name:null!=(t=i.name)?t:"",headline:i.headline,disabled:!!a,children:(0,r.jsx)(_,{post:o,className:"mr-3",children:(0,r.jsx)(j.W,{src:i.avatar_url,name:null!=(n=i.name)?n:"",size:"10"})})})})},P=(0,o.forwardRef)(function(e,t){var n,o,i=e.doesPostHaveCoverImage,a=e.className,s=e.children,c=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["doesPostHaveCoverImage","className","children"]),d=(0,l.kK)();return(0,r.jsx)("div",(n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:u()("post__user flex items-stretch",{"md:!mb-2 md:!mt-1":d&&void 0!==i&&i},a),ref:t},c),o=o={children:s},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}),n))});P.displayName="PostViewListItemWrapper";var C=function(e){var t=e.communityMember,n=e.containerRef,o=e.doesPostHaveCoverImage,a=e.hasTags,s=e.headline,l=e.hideAuthorHeadline,c=void 0!==l&&l,v=e.isAdmin,g=e.isSmScreen,x=e.pageLinkRef,j=e.post,w=e.posterJoinedDate,O=e.shouldDisplayMemberTags,C=e.tagsShowMoreLabelVariant,k=e.visibleMemberTags,I=e.wrapperClassName,N=!!s;return(0,r.jsxs)(P,{doesPostHaveCoverImage:void 0!==o&&o,ref:n,className:I,"data-testid":"post-meta-info-regular",children:[(0,r.jsx)(S,{post:j}),(0,r.jsxs)("button",{type:"button",className:"post__bio focus-visible:outline-secondary flex flex-col justify-between self-center text-left focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:function(e){var t,n;if(t=e.target,(null!=(n=HTMLAnchorElement)&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!n[Symbol.hasInstance](t):!(t instanceof n))&&x.current)if((0,f.n2)(e)){var r=x.current.href;window.open(r,"_blank","noreferrer"),e.preventDefault()}else x.current.click()},children:[(0,r.jsxs)("div",{className:u()("author flex flex-wrap items-baseline gap-x-2 gap-y-px",{"no-headline":!(null==t?void 0:t.headline)&&j.name,"has-tags":void 0!==a&&a}),children:[(0,r.jsx)("div",{className:"author__name inline-flex",children:(0,r.jsx)(_,{post:j,className:"!text-dark overflow-anywhere text-sm font-semibold leading-5",children:null==t?void 0:t.name})}),void 0!==O&&O&&(0,r.jsx)("div",{className:"author__tags member-tags self-center",children:(0,r.jsx)(h.m,{memberTags:k,isAdmin:void 0!==v&&v,limit:void 0!==g&&g||(0,p.Fr)(j)?1:2,showMoreLabelVariant:C})}),(0,r.jsx)("div",{className:"author__time inline-flex",children:(0,r.jsx)(d.s,{post:j,className:"ago text-default hover:text-dark focus-visible:outline-secondary focus-visible:text-dark flex items-baseline text-xs focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",forwardedRef:x,children:(0,r.jsx)(b.T,{interactive:!1,content:(0,p.s4)(j.created_at),children:(0,m.TF)(j.created_at,{format:m.lc.short})})})})]}),!c&&(0,r.jsx)(y,{headline:s,post:j}),!(N&&!c)&&!!w&&(0,r.jsx)("div",{className:"text-light mt-1 flex text-xs",children:(0,i.t)("post.member_since",{date:w})})]})]})},k=function(e){var t=e.communityMember,n=e.containerRef,o=e.doesPostHaveCoverImage,i=e.hasTags,a=e.headline,s=e.hideAuthorHeadline,l=e.isAdmin,c=e.pageLinkRef,d=e.post,f=e.shouldDisplayMemberTags,m=e.tagsLimit,p=e.tagsShowMoreLabelVariant,b=e.visibleMemberTags,v=e.wrapperClassName;return(0,r.jsxs)(P,{doesPostHaveCoverImage:void 0!==o&&o,ref:n,className:v,"data-testid":"post-meta-info-small",children:[(0,r.jsx)(S,{post:d}),(0,r.jsxs)("button",{type:"button",className:"post__bio focus-visible:outline-secondary flex flex-col justify-between gap-1 self-center text-left focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:function(e){var t,n;t=e.target,(null!=(n=HTMLAnchorElement)&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?n[Symbol.hasInstance](t):t instanceof n)||!c.current||c.current.click()},children:[(0,r.jsxs)("div",{className:u()("author flex flex-wrap items-center gap-x-2 gap-y-1",{"no-headline":!(null==t?void 0:t.headline)&&d.name,"has-tags":void 0!==i&&i}),children:[(0,r.jsx)("div",{className:"author__name inline-flex",children:(0,r.jsx)(_,{post:d,className:"!text-dark text-sm font-semibold leading-5",children:null==t?void 0:t.name})}),void 0!==f&&f&&(0,r.jsx)("div",{className:"author__tags member-tags !m-0",children:(0,r.jsx)(h.m,{memberTags:b,isAdmin:void 0!==l&&l,limit:m,showMoreLabelVariant:p})})]}),!(void 0!==s&&s)&&(0,r.jsx)(y,{headline:a,post:d,ref:c})]})]})},I=function(e){var t=e.doesPostHaveCoverImage,n=void 0!==t&&t,c=e.hideAuthorHeadline,u=void 0!==c&&c,d=e.isRenderedOutsideTheSpace,f=e.space,m=e.tagsLimit,p=e.tagsShowMoreLabelVariant,b=void 0===p?"numbers":p,h=e.wrapperClassName,v=(0,a.m)(),y=v.post,g=v.isSharedPostView,x=v.posterJoinedDate,_=(0,s.Zh)().usedIn,j=!!(null==y?void 0:y.hide_meta_info),w=null==y?void 0:y.community_member,O=(null==y?void 0:y.member_tags)||[],S=null==w?void 0:w.id,P=null==O?void 0:O.filter(function(e){var t;return!!((null==e?void 0:e.is_public)&&(null==e||null==(t=e.display_locations)?void 0:t.post_bio))}),I=(0,o.useMemo)(function(){return!!(S&&(null==P?void 0:P.length)>0)},[S,P]),N=(0,l.kK)(),A=(0,o.useRef)(null),M=(0,o.useRef)(null);if(j||!f)return null;var T=void 0!==d&&d?"".concat((0,i.t)("post.posted_in")," ").concat(f.name):null==w?void 0:w.headline,E=!!(null==w?void 0:w.admin),R=!g&&(I||E);return N||"full-post-modal"===_?(0,r.jsx)(k,{communityMember:w,containerRef:A,doesPostHaveCoverImage:n,hasTags:I,headline:T,hideAuthorHeadline:u,isAdmin:E,pageLinkRef:M,post:y,shouldDisplayMemberTags:R,tagsLimit:m,tagsShowMoreLabelVariant:b,visibleMemberTags:P,wrapperClassName:h}):(0,r.jsx)(C,{communityMember:w,containerRef:A,doesPostHaveCoverImage:n,hasTags:I,headline:T,hideAuthorHeadline:u,isAdmin:E,isSmScreen:N,pageLinkRef:M,post:y,posterJoinedDate:x,shouldDisplayMemberTags:R,tagsShowMoreLabelVariant:b,visibleMemberTags:P,wrapperClassName:h})}},472034:function(e,t,n){n.d(t,{p:()=>v});var r=n(552676),o=n(619803),i=n.n(o),a=n(739792),s=n(404393),l=n(308683),c=n(701168),u=n(125152),d=function(e){var t=e.startsAt,n=e.endsAt,o=e.status,i=(void 0===o?null:o)===u.Q_.DRAFT,d=(0,s.aA)(n),f=(0,s.aA)(t),m=null;return m=!f||d||i?i?(0,a.t)("events.details.draft"):d?(0,a.t)("events.details.finished",{time_string:(0,l.TF)(n)}):(0,a.t)("events.details.starts",{time_string:(0,l.TF)(t)}):(0,a.t)("events.details.in_progress"),(0,r.jsx)("div",{className:(0,c.A)("event-counter-badge",{"event-counter-badge--finished":d,"event-counter-badge--draft":i}),children:"".concat(m)})},f=n(554348),m=n(227053),p=n(441342),b=n(117617),h=n(381636),v=function(){var e=(0,m.m)(),t=e.post,n=e.canManagePost,o=(0,p.Zh)().usedIn,a=(0,b.kK)();if(!t.name||"minimal-post-modal"===o&&!a)return null;if("minimal-post-modal"===o&&a)return(0,r.jsx)("div",{className:"overflow-anywhere",children:(0,r.jsx)(h.Z.TitleMd,{children:t.name})});var s=(t||{}).event_setting_attributes||{},l=s.starts_at,c=s.ends_at,u=i()("post__header",{"post-meta--hidden":t.hide_meta_info});return(0,r.jsxs)("div",{className:u,"data-testid":"post-header",children:[l&&c&&(0,r.jsx)(d,{startsAt:l,endsAt:c,status:null==t?void 0:t.status}),(0,r.jsx)("h1",{className:i()("post__title text-2xl font-bold leading-7",{"with-admin-actions":n}),"data-testid":"post-title",children:(0,r.jsx)(f.s,{post:t,className:"!text-darkest overflow-anywhere focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:t.name})})]})}},684969:function(e,t,n){n.d(t,{P:()=>w});var r=n(552676),o=n(619803),i=n.n(o),a=n(739792),s=n(58664),l=n(441342),c=n(957363),u=n(39905),d=n(479840),f=n(381636),m=n(943544),p=n(275271),b=n(915912),h=n.n(b),v=n(547144),y=n(60878);function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var x=function(e){var t,n=e.post,r=e.getSharePostLink,o=e.sharePostData,i=(0,y.pm)().success,s=(0,l.wh)().currentCommunity,c=(0,l.L2)().data,u=(t=(0,p.useState)({post:{show_post_teaser:!!(null==n?void 0:n.show_post_teaser),share_to_web:!!(null==n?void 0:n.share_post_enabled),share_post_enabled:!!(null==n?void 0:n.share_post_enabled),minimal_layout:!!(null==n?void 0:n.minimal_layout)}}),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return g(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=u[0],f=u[1],m=(0,v.LM)({spaceSlug:null==n?void 0:n.space_slug,slug:null==n?void 0:n.slug});return(0,p.useEffect)(function(){n.share_post_enabled&&!o&&r({postId:null==n?void 0:n.id,body:d})},[null==n?void 0:n.share_post_enabled,o,d,r,null==n?void 0:n.id]),{onClickCopyLink:function(e){h()(e||window.location.origin+m),i((0,a.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},onChange:function(e){f(function(t){var o={post:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},t.post,e)};return r({postId:null==n?void 0:n.id,body:o}),o})},formData:d,currentCommunity:s,currentSpace:c}},_=function(e){var t=e.getSharePostLink,n=e.post,o=e.sharePostData,p=x({post:n,getSharePostLink:t,sharePostData:o}),b=p.onClickCopyLink,h=p.onChange,v=p.formData,y=p.currentCommunity,g=p.currentSpace,_=(0,l.wh)().isViewOnlyMasquerading;return y.is_private||(null==g?void 0:g.is_private)?(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Lt.ItemLink,{disabled:_,onClick:function(){h({share_to_web:!v.post.share_to_web})},children:(0,r.jsx)(d.sI,{label:(0,a.t)("post.share.share_to_web"),tooltipText:(0,a.t)("post.share.share_to_web_on_description"),field:"share_to_web",value:v.post.share_to_web,variant:"small",disabled:_,className:i()({"cursor-not-allowed":_})})}),v.post.share_to_web&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex flex-row items-center",children:(0,r.jsx)("div",{className:"mb-4 mt-1 flex-1 px-5",children:(0,r.jsx)(s.I,{disabled:!0,value:null==o?void 0:o.share_post_link,rightAddon:(0,r.jsx)("button",{type:"submit",onClick:function(){return b(null==o?void 0:o.share_post_link)},children:(0,r.jsx)(c.JO,{type:"20-copy"})})})})}),(0,r.jsx)(m.Lt.ItemLink,{onClick:function(){h({show_post_teaser:!v.post.show_post_teaser})},children:(0,r.jsx)(d.sI,{label:(0,a.t)("post.share.show_teaser"),tooltipText:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:(0,a.t)("post.share.show_teaser_description_title")}),(0,r.jsx)("a",{href:"/settings#field-custom_cta_for_share_links",children:(0,a.t)("post.share.show_teaser_description_link")})]}),field:"show_post_teaser",value:v.post.show_post_teaser,variant:"small"})}),!(null==y?void 0:y.is_private)&&(0,r.jsx)(m.Lt.ItemLink,{onClick:function(){return h({minimal_layout:!v.post.minimal_layout})},children:(0,r.jsx)(d.sI,{label:(0,a.t)("post.share.minimal_layout"),tooltipText:(0,a.t)("post.share.minimal_layout_description"),field:"minimal_layout",value:v.post.minimal_layout,variant:"small"})})]})]}):(0,r.jsxs)("div",{className:"flex flex-row items-center px-4 py-2",children:[(0,r.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,r.jsx)(f.Z.LabelMd,{weight:"bold",children:(0,a.t)("post.share.share_to_web")}),(0,r.jsx)(f.Z.LabelSm,{children:(0,a.t)("post.share.post_is_public")})]}),(0,r.jsx)("div",{children:(0,r.jsx)(u.z,{variant:"secondary",onClick:function(){return b()},children:(0,a.t)("copy_link")})})]})},j=n(227053),w=function(e){var t=e.onChange,n=e.button,o=e.shouldRenderCustomMenuButton,s=e.menuButtonEl,u=e.appendTo,d=(0,j.m)({onChangeSharePost:t}),p=d.showShareOnWebOptions,b=d.post,h=d.getSharePostLink,v=d.sharePostData,y=(0,l.L2)().data,g=null!=n?n:(0,r.jsx)(c.JO,{type:"20-arrow-box-up",size:20});return p(y)?(0,r.jsx)(m.Lt,{size:"extra-large",direction:"bottom-end",menuButtonEl:void 0===s?"button":s,className:"w-full",appendTo:u,buttonClassName:i()("w-full focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-1",{"p-1 hover:bg-tertiary rounded group flex items-center":!o}),button:o?g:(0,r.jsx)(f.Z.LabelSm,{weight:"medium",color:"text-default group-hover:text-dark",children:(0,a.t)("post.share.title")}),children:(0,r.jsx)(_,{post:b,getSharePostLink:h,sharePostData:v})}):null}},516882:function(e,t,n){n.d(t,{Y:()=>f});var r=n(552676),o=n(275271),i=n(739792),a=n(701168),s=n(886307),l=n(430507),c=n(381636);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var d="post.summary",f=function(e){var t,n=e.post,f=e.className,m=e.shouldScrollIntoView,p=void 0!==m&&m,b=(0,s.Z)({post:n}),h=b.summary,v=b.isLoadingSummary,y=b.clearSummary,g=(0,o.useRef)(null),x=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return u(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),_=x[0],j=x[1],w=!!h||v,O=!_&&!!h;(0,o.useEffect)(function(){v&&j(!0)},[v]),(0,o.useEffect)(function(){p&&g.current&&w&&g.current.scrollIntoView({behavior:"smooth"})},[w,p]);var S=(0,o.useCallback)(function(){j(!1)},[]);return n.has_summary?(0,r.jsx)("div",{className:(0,a.A)("bg-ai-summary flex px-5 transition-all duration-500 ease-in-out md:px-6",{"h-0 py-0 opacity-0 md:py-0":!w,"h-auto py-4 opacity-100":w},f),ref:g,children:w&&(0,r.jsx)(l.w,{onCollapseClick:function(){j(!1),y()},children:(0,r.jsxs)(l.w.Content,{className:"gap-4",children:[(0,r.jsx)(l.w.Header,{animate:_,isHidden:O,children:(0,i.t)([d,"loading"])}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)(c.Z.LabelSm,{color:"text-default",leading:"leading-tight",children:(0,i.t)([d,"title"])}),(0,r.jsx)(c.Z.TitleMd,{children:n.name})]}),(null==h?void 0:h.content)&&(0,r.jsx)(l.w.BodyText,{animation:"fade-in",onAnimationComplete:S,children:h.content})]})})}):null}},554348:function(e,t,n){n.d(t,{s:()=>h});var r=n(552676),o=n(903225),i=n(918594),a=n(167919),s=n(31960),l=n(131510),c=n(941084),u=n(547144),d=n(715731),f=n(434519),m=n(573384);function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function b(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var h=function(e){var t=e.post,n=e.ariaLabel,h=e.allComments,v=e.forwardedRef,y=e.onClick,g=e.children,x=e.shouldOpenPostModal,_=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["post","ariaLabel","allComments","forwardedRef","onClick","children","shouldOpenPostModal"]),j=(0,s.E)().member,w=(0,o.UO)().postSlug,O=(0,d.I)(),S=(0,f.UV)(),P=S.isInsideModal,C=S.onClose,k=(0,o.TH)(),I=(0,m._t)(),N=I.params,A=I.hasNextPage,M=!(0,l.U)(),T=(0,u.LM)({spaceSlug:t.space_slug,slug:t.slug,hash:void 0!==h&&h?a.Q:""});return O?(0,r.jsx)("a",b(p({href:T,target:"_blank",rel:"noreferrer","aria-label":n},_,v&&{ref:v}),{children:g})):(0,c.Sb)(t,{postSlugInUrl:w})?(0,r.jsx)("a",b(p({href:T,"aria-label":n},_,v&&{ref:v}),{children:g})):void 0!==x&&x&&M?(0,r.jsx)(i.rU,b(p({to:{pathname:u.xu.show({slug:t.slug,spaceSlug:t.space_slug}),state:{prevLocation:k,params:N,hasNextPage:A,isWithinProfileContext:!!j,profileContextMember:j}},"aria-label":n},_,v&&{ref:v}),{children:g})):(0,r.jsx)(i.rU,b(p({to:T,"aria-label":n},_,v&&{ref:v}),{onClick:P?C:y,children:g}))}},459331:function(e,t,n){n.d(t,{k:()=>l});var r=n(552676),o=n(739792),i=n(22319),a=n(380171),s=n(775148),l=function(e){var t=e.onClick,n=e.buttonSize,l=(0,i.TC)().isDarkAppearance;return(0,r.jsx)(a.T,{content:(0,o.t)("post.summarize"),interactive:!1,children:(0,r.jsx)(s.h,{name:l?"20-stardust":"20-stardust-gradient",iconSize:20,className:"group",iconClassName:"group-hover:animate-spin-pause-reverse",onClick:t,buttonSize:void 0===n?28:n,ariaLabel:(0,o.t)("post.summarize")})})}},324921:function(e,t,n){n.d(t,{D:()=>er});var r=n(552676),o=n(275271),i=n(619803),a=n.n(i),s=n(903225),l=n(205061),c=n(595693),u=n(930457),d=n(327265),f=n(227053),m=n(441342),p=n(941084),b=n(117617),h=n(892640),v=n(589252),y=n(739792),g=n(22319),x=n(322825),_=n(573384),j=n(352521),w=["image","file","embed","poll","video"],O=function(e){return"paragraph"===e.type&&(!e.content||0===e.content.length)||void 0!==e.text&&""===e.text.trim()&&" "!==e.text},S=function(e){return e.filter(function(e){return!O(e)}).map(function(e){if(e.content){var t,n;return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),n=n={content:S(e.content)},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}return e})},P=function(e){return!(e&&e.content&&Array.isArray(e.content))||0===e.content.length},C=function(e){return"string"==typeof e.type&&w.includes(e.type)},k=n(932699);function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function N(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var A=function(e){if(!e)return{truncatedContent:[],mediaContent:null,hasTruncatedContent:!1,hasMediaAttachmentsBeforeTruncation:!1};var t={charCount:0,mediaCount:0,truncatedContent:[],mediaContent:null,hasTruncatedContent:!1,textLengthCache:new Map,hasMediaAttachmentsBeforeTruncation:!1};return D(e,t),{truncatedContent:S(t.truncatedContent),mediaContent:t.mediaContent,hasTruncatedContent:t.hasTruncatedContent,hasMediaAttachmentsBeforeTruncation:t.hasMediaAttachmentsBeforeTruncation}},M=function(e,t){return!t.mediaContent&&(t.mediaContent=e,!0)},T=function(e,t){C(e)?L(e,t):e.content&&Array.isArray(e.content)?E(e,t):F(e,t)},E=function(e,t){var n=N(I({},e),{content:[]});if(t.truncatedContent.push(n),e.content){var r=!0,o=!1,i=void 0;try{for(var a,s=e.content[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if(t.hasTruncatedContent)break;var c=B(l,t),u=250-t.charCount;c<=u?(T(l,N(I({},t),{truncatedContent:n.content})),t.charCount+=c):(U(l,u,N(I({},t),{truncatedContent:n.content})),t.hasTruncatedContent=!0),R(t)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}},R=function(e){(e.charCount>250||e.mediaCount>3)&&(e.hasTruncatedContent=!0)},D=function(e,t){return(0,k.some)(e,function(e){if(O(e))return!1;var n,r=t.hasTruncatedContent&&C(e),o=t.hasTruncatedContent&&Array.isArray(e.content);return!!(r&&M(e,t))||(t.hasTruncatedContent||(T(e,t),R(t)),o&&D(null!=(n=e.content)?n:[],t))})},L=function(e,t){t.hasMediaAttachmentsBeforeTruncation=!0,t.mediaCount<3?(t.mediaCount+=1,t.truncatedContent.push(I({},e))):(M(e,t),t.hasTruncatedContent=!0)},F=function(e,t){var n=B(e,t),r=250-t.charCount;n<=r?(t.charCount+=n,t.truncatedContent.push(I({},e))):(U(e,r,t),t.hasTruncatedContent=!0)},U=function(e,t,n){var r=I({},e);"string"==typeof e.text?(r.text=e.text.slice(0,t),r.text&&(t<e.text.length&&(r.text+="..."),n.truncatedContent.push(r),n.charCount+=r.text.length)):e.content&&Array.isArray(e.content)&&(r.content=[],n.truncatedContent.push(r),D(e.content,N(I({},n),{truncatedContent:r.content})))},B=function(e,t){if(t.textLengthCache.has(e)){var n;return null!=(n=t.textLengthCache.get(e))?n:0}var r=0;return"string"==typeof e.text?r=e.text.length:e.content&&Array.isArray(e.content)&&(r=e.content.reduce(function(e,n){return e+B(n,t)},0)),t.textLengthCache.set(e,r),r},q=function(e){var t,n,r=e.params,i=void 0===r?{}:r,a=e.hasNextPage,l=void 0!==a&&a,c=(0,f.m)().post,u=(0,j.d)().navigateToPost,d=(0,s.TH)(),m=(0,o.useMemo)(function(){var e,t;return A(null==c||null==(t=c.tiptap_body)||null==(e=t.body)?void 0:e.content)},[null==c||null==(n=c.tiptap_body)||null==(t=n.body)?void 0:t.content]),p=m.truncatedContent,b=m.mediaContent,h=m.hasTruncatedContent,v=m.hasMediaAttachmentsBeforeTruncation,y=(0,o.useMemo)(function(){return{type:"doc",content:p}},[p]),g=(0,o.useMemo)(function(){return b?{type:"doc",content:[b]}:null},[b]),x=(0,o.useMemo)(function(){return P(g)},[g]),_=(0,o.useMemo)(function(){return P(y)},[y]),w=h&&p&&!_,O=p&&!_,S=!v&&!!b&&!x;return{truncatedContent:y,mediaContent:g,redirectToPostModal:(0,o.useCallback)(function(){u({newPost:c,prevLocation:d,params:i,hasNextPage:l})},[c,d,i,l,u]),tiptapBody:null==c?void 0:c.tiptap_body,shouldShowSeeMoreButton:w,shouldRenderTruncatedContent:O,shouldRenderMediaContent:S}},z=function(){var e=(0,g.wC)().minimal_layout,t=(0,f.m)().post,n=(0,_._t)(),o=n.params,i=n.hasNextPage,a=t.internal_custom_html,s=q({params:o,hasNextPage:i}),l=s.mediaContent,c=s.truncatedContent,u=s.shouldRenderTruncatedContent,d=s.shouldRenderMediaContent,m=s.tiptapBody,p=s.redirectToPostModal,b=s.shouldShowSeeMoreButton;return(0,r.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[u&&(0,r.jsx)(x.Rs,{readOnly:!0,disableMentionClicks:e,value:c,shouldRefetch:!0,sgidToObjectMap:m.sgids_to_object_map,inlineAttachments:m.inline_attachments}),a&&(0,r.jsx)(v.Z,{html:a},"internal_custom_html"),b&&(0,r.jsx)("button",{type:"button",className:"text-light hover:text-dark focus-visible:text-dark inline-flex text-base","data-testid":"see-more-post",onClick:p,children:(0,y.t)("see_more")}),d&&(0,r.jsx)(x.Rs,{readOnly:!0,disableMentionClicks:e,sgidToObjectMap:m.sgids_to_object_map,inlineAttachments:m.inline_attachments,value:l,shouldRefetch:!0,className:"w-full"})]})},Z=n(547144),V=n(672851),H=n(291704),W=n(918),Q=function(){var e=(0,f.m)(),t=e.post,n=e.isTrixPost,o=t.body_trix_content,i=t.internal_custom_html,a=t.pinned_at_top_of_space,l=(0,j.d)().navigateToPost,c=(0,s.TH)(),u=(0,_._t)(),d=u.params,m=u.hasNextPage,b=4;a&&(b=2);var h=["help","help-en"].includes(t.community_slug)&&(0,p.hm)(t);return(0,r.jsxs)("div",{className:"flex w-full flex-col items-start justify-start gap-2",children:[(0,r.jsxs)(V.X,{lines:b,hideToggle:!0,children:[n&&o&&(0,r.jsx)(H.P,{content:o,contentParentPath:Z.xu.show({slug:t.slug,spaceSlug:t.space_slug})}),i&&(0,r.jsx)(v.Z,{html:i},"internal_custom_html"),h&&(0,r.jsx)(W.e,{post:t})]}),(0,r.jsx)("button",{type:"button",className:"text-default hover:text-dark text-base",onClick:function(){l({newPost:t,params:d,hasNextPage:m,prevLocation:c})},children:(0,y.t)("see_more")})]})},G=function(e){var t=e.noPadding,n=(0,f.m)(),o=n.post,i=n.isTiptapPost,s=n.isPostBodyEmpty,l=o.updated_at;return s?null:(0,r.jsx)("div",{className:a()("post__body",{"!p-0":void 0!==t&&t,"px-5 pb-5 md:px-6":(0,p.Fr)(o)}),"data-testid":"post-body",children:(0,r.jsx)("div",{className:"post__inside trix-v2 w-full","data-testid":"post-body-inside",children:i?(0,r.jsx)(z,{}):(0,r.jsx)(Q,{})})},l)},$=n(562068),K=function(e){var t,n,o=e.children,i=(0,f.m)(),l=i.isImagePost,c=i.isPostBodyEmpty,u=i.isPostMetaHidden,d=i.isSharedPostWithTeaserLayout,p=(0,m.Zh)().usedIn,b=null==(t=(0,s.$B)("/home"))?void 0:t.isExact,h=null==(n=(0,s.$B)("/feed"))?void 0:n.isExact,v="full-post-modal"===p,y=c&&!b&&!h&&!u&&!l;return(0,r.jsx)("div",{className:a()("post__content text-dark",{"p-5 md:px-6":!l&&u,"px-5 pb-5 pt-4 md:px-6 md:py-5":!l&&!u,"pt-5":l&&!v&&u,"pt-4 md:pt-5":l&&!v&&!u,"py-5":l&&v,"!pb-0":l&&v&&!c,"pb-5":y,relative:d}),"data-testid":"post-content-wrapper",children:o})},J=n(248250),X=n(261410),Y=n(516882);function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ee(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var en=function(e){var t,n=e.autofocusReplyForm,i=e.className,v=e.defaultShowComment,y=e.hideAuthorHeadline,g=e.hideBookmarkButton,x=e.hidePinnedToTopIcon,_=void 0!==x&&x,j=e.hideShareLink,w=e.isRenderedOutsideTheSpace,O=e.metaInfoWrapperClassName,S=e.onPostChange,P=e.onPostDestroy,C=e.pageSupportsContentTruncation,k=e.refetchPosts,I=e.shouldOpenCommentPage,N=e.tagsLimit,A=e.tagsShowMoreLabelVariant,M=e.shouldForceSamePageInteractions,T=void 0!==M&&M,E=e.scrollableTarget,R=(0,o.useRef)(null),D=(0,m.Zh)(),L=D.record,F=D.usedIn,U=(0,f.m)(),B=U.isPostBodyEmpty,q=U.showPostActions,z=et((0,o.useState)(void 0!==v&&v),2),Z=z[0],V=z[1],H=et((0,o.useState)(void 0!==n&&n),2),W=H[0],Q=H[1],ee=(0,b.kK)(),en=L.name,er=L.is_truncation_disabled,eo=L.is_comments_enabled,ei=L.flagged_for_approval_at,ea=L.hide_meta_info,es=L.pinned_at_top_of_space,el=L.post_details_loaded,ec=null==(t=(0,s.$B)("/c/:spaceSlug/:postSlug"))?void 0:t.isExact,eu=(0,p.hm)(L)&&!ec&&!er&&!T,ed=(0,m.wh)().currentUser,ef=(0,f.m)(),em=ef.isSharedPostView,ep=ef.isSharedPostWithTeaserLayout,eb=(void 0===C||C)&&!er||ep,eh=(0,p.Fr)(L)||(0,p.hm)(L),ev="full-post-modal"===F,ey=!q&&"full-post-modal"===F&&ea;if(!L||!L.id)return null;var eg=(0,o.useCallback)(function(){return(0,h.p)(R.current)&&R.current.focus()},[R]);(0,o.useEffect)(function(){W&&eg()},[eg]);var ex=a()("post post--parent bg-primary border-primary rounded-none border first:mt-5 first:md:mt-0 md:rounded-2xl",{"post--shared":em,"post--shared__truncated":ep&&!ed,"is-truncation-disabled":!eb,"flagged-for-approval":ei,"post-name--empty":!en,"post-meta--hidden":ea,"is-pinned":es,"!shadow-none !rounded-none !border-0":ev,"!mb-5 md:!mb-6":!ev},i),e_=(0,o.useCallback)(function(){if(V(!0),Q(!0),R.current)if((0,h.p)(R.current))(0,h.p)(R.current)&&R.current.focus();else{var e,t;null==(t=R.current.commands)||null==(e=t.focus)||e.call(t,"end")}},[]);return(0,r.jsxs)("div",{className:ex,"data-testid":"post-container",children:[!_&&ee&&eh&&(0,r.jsx)(d.c,{post:L}),(0,r.jsx)(J.H,{post:L}),!eb&&(0,r.jsx)("div",{className:a()("overflow-hidden bg-transparent md:rounded-t-2xl",{"rounded-t-none md:rounded-t-none":ev||!!L.cover_image_url}),children:(0,r.jsx)(Y.Y,{post:L})}),(0,r.jsx)("div",{className:"post__post",children:(0,r.jsxs)(K,{children:[(0,r.jsx)("div",{className:a()({"mb-5":!B,"px-5 md:px-6":(0,p.Fr)(L),hidden:ey}),children:(0,r.jsx)(X.m,{post:L,isRenderedOutsideTheSpace:void 0!==w&&w,onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};S(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},L,e),t)},refetchPosts:k,onPostDestroy:P,hideShareLink:void 0!==j&&j,hidePinnedToTopIcon:_,hideBookmarkButton:void 0!==g&&g,hideSummarizeButton:eb,tagsLimit:ee?1:void 0===N?3:N,tagsShowMoreLabelVariant:void 0===A?"numbers":A,metaInfoWrapperClassName:O,hideAuthorHeadline:void 0!==y&&y})}),(0,p.Fr)(L)&&"full-post-modal"!==F&&(0,r.jsx)(l.l,{onPostChange:S,onPostDestroy:P}),eu?(0,r.jsx)(G,{}):(0,r.jsx)($.y,{enableTruncation:eb}),ep&&(0,r.jsx)("div",{className:"to-primary absolute bottom-0 left-0 z-10 h-1/2 w-full bg-gradient-to-b from-transparent"})]})}),(0,r.jsx)("div",{className:"mt-auto",children:(0,r.jsx)(u.S,{toggleComment:function(){Q(!1),V(function(e){return!e})},showCommentAndFocusCommentForm:e_,shouldOpenCommentPage:void 0!==I&&I,shouldForceSamePageInteractions:T})}),el&&eo&&Z&&(0,r.jsx)(c.o,{commentsFormRef:R,autofocusReplyForm:W,scrollableTarget:E})]})},er=function(e){return(0,r.jsx)(en,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}},227053:function(e,t,n){n.d(t,{m:()=>b});var r=n(131906),o=n(903225),i=n(93199),a=n(441342),s=n(29378),l=n(78456),c=n(285122),u=n(941084),d=n(60589),f=n(715731);function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var p=function(e,t,n,r,o){var i=u.Sb(e,{postSlugInUrl:r}),a=!!(i&&e.minimal_layout),s=!!(i&&e.show_post_teaser),l=!t&&u.GT(e,{currentUser:n,postSlugInUrl:r}),c=!!(!n&&e.is_comments_enabled&&!e.is_comments_closed||s),d=c&&e.comments_count>5,f=c&&e.comments_count<=5,m=!!(e.flagged_for_approval_at&&o),p=!!(!a&&(e.is_liking_enabled||e.is_comments_enabled));return{isSharedPostView:i,isSharedPostViewWithMinimalLayout:a,isSharedPostWithTeaserLayout:s,showSpaceName:a,showGatedCommentSection:c,showGatedCommentSectionAtBottom:f,showGatedCommentSectionAtTop:d,showModerationInActionsDropdown:m,showPostActions:l,showEngagementActions:p}},b=function(){var e,t,n,b=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onChangeSharePost,h=(0,o.UO)().postSlug,v=(0,f.I)(),y=(0,a.Zh)(),g=y.record,x=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(y,["record"]),_=(null==g||null==(n=g.community_member)?void 0:n.created_at)?(0,c.ie)(g.community_member.created_at,{month:"long",year:"numeric",day:"numeric"}):"",j=(0,a.wh)(),w=j.currentUser,O=j.currentCommunity,S=j.currentCommunityMember,P={canManagePost:u.ou(g),canUpdatePost:u.sN(g),canDuplicatePost:u.Vr(g),canDestroyPost:u.$2(g),canReportPost:u.KX(g)},C=p(g,v,w,h,P.canManagePost),k=u.hm(g),I=u.HZ(g),N=u.Fr(g),A=u.s8(g),M=u.Iz(g),T=u.Vt(g),E=u.A8(g),R=!!(C.isSharedPostViewWithMinimalLayout&&S),D=(0,r.useMutation)(function(e){var t=e.postId,n=e.body;return(0,i.aU)("/posts/".concat(t,"/share"),n)},{onSuccess:function(e){b&&b(m({},g,e),{refetch:!1})}}),L=D.mutate,F=D.data,U=D.isLoading;return e=m({post:g},x,P,C),t=t={getSharePostLink:L,isBasicPost:k,isEventPost:I,isImagePost:N,isLoadingSharePostData:U,isPostBodyEmpty:T,isPostMetaHidden:E,isTiptapPost:A,isTrixPost:M,posterJoinedDate:_,sharePostData:F,shouldHideCommentsListForSpace:function(e){var t=e.space,n=(0,s.aF)(O)||S,r=(0,d.fL)(t)||(0,d.J$)(t)||(0,l.vb)(S);return!(n&&r)||C.isSharedPostViewWithMinimalLayout||C.isSharedPostWithTeaserLayout},shouldShowLeaveCommentButton:R,showShareOnWebOptions:function(e){return!C.isSharedPostView&&!v&&u.Pu(g,O,e)}},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}},923782:function(e,t,n){n.d(t,{s:()=>a});var r=n(552676),o=n(928321),i=n(528601),a=function(e){var t=e.profileFields,n=t.visible,a=t.not_visible;return(0,r.jsxs)(i.$,{dataTestId:"profile-fields-section",children:[(0,r.jsx)(o.s,{fields:n}),(0,r.jsx)(o.s,{fields:a,isHidden:!0})]})}},306193:function(e,t,n){n.d(t,{C:()=>s});var r=n(552676),o=n(619803),i=n.n(o),a=n(957363),s=function(e){var t=e.iconType,n=e.iconProps,o=e.info,s=e.dataTestId,l=e.className,c=e.iconClassName;return o?(0,r.jsxs)("div",{className:i()("profile-drawer__about__block whitespace-pre-line [word-break:break-word]",void 0===l?"":l),"data-testid":s,children:[t?(0,r.jsx)(a.JO,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({useWithFillCurrentColor:!0,className:i()("text-dark",void 0===c?"":c),type:t},void 0===n?{}:n)):null," ",(0,r.jsx)("p",{children:o})]}):null}},424650:function(e,t,n){n.d(t,{o:()=>a});var r=n(552676),o=n(259459),i=n(306193),a=function(e){var t=e.link,n=e.iconType;return t?(0,r.jsx)(i.C,{iconType:n,info:(0,r.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:(0,o.B)(t)})}):null}},528601:function(e,t,n){n.d(t,{$:()=>a});var r=n(552676),o=n(240507),i=n.n(o),a=function(e){var t=e.title,n=e.children,o=e.dataTestId;return(0,r.jsxs)("div",{className:"profile-drawer__about__section","data-testid":o,children:[t&&(0,r.jsx)("div",{className:"profile-drawer__about__heading",children:t}),n]})};a.propTypes={title:i().string,children:i().oneOfType([i().arrayOf(i().node),i().node]),dataTestId:i().string}},674776:function(e,t,n){n.d(t,{Z:()=>o});var r=n(552676);function o(e){var t=e.title,n=e.subtitle;return(0,r.jsxs)("div",{className:"profile-drawer__empty",children:[(0,r.jsx)("div",{className:"profile-drawer__empty__title",children:t}),(0,r.jsx)("div",{className:"profile-drawer__empty__subtitle",children:n})]})}},451980:function(e,t,n){n.d(t,{C:()=>E});var r=n(552676),o=n(275271),i=n(15588),a=n(701168),s=n(709397),l=n(737840),c=n(754503),u=n(786976),d=n(381636),f=n(739792),m=n(113131),p=n(316026),b=n(981261),h=n(208054),v=n(119323),y=n(96533),g=n(441342),x=n(957363),_=n(39905),j=n(636477),w=n(932699),O=n(131906),S=n(903225),P=n(403697),C=n(547144),k=n(905326),I=function(e){var t=e.communityMemberId,n=e.closeCard,o=(0,S.k6)(),i=(0,g.wh)().isViewOnlyMasquerading,a=(0,k.p)().findOrCreateChatRoom,s=(0,O.useMutation)(function(){return a({kind:P.g8,community_member_ids:[t]})},{onSuccess:function(e){o.push((0,C.co)({url:(0,C.so)({uuid:e})}))}}),l=s.mutate,c=s.isLoading;return(0,r.jsxs)(_.z,{onClick:function(){i?(0,w.noop)():l(),n()},className:"!border-primary flex items-center space-x-2 !px-3 !py-1.5 !font-medium",variant:"secondary",children:[(0,r.jsx)(x.JO,{type:c?"loader":"16-chat",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0}),(0,r.jsx)("span",{children:(0,f.t)("message")})]})},N={page_name:b.$q.PROFILE_VIEW},A=function(e){var t=e.communityMemberId,n=e.publicUid,o=e.messagingEnabled,i=e.closeCard,a=(0,y.r)(),s=(0,g.wh)().currentCommunityMember,l=(null==s?void 0:s.id)===t,c=!l&&(null==s?void 0:s.messaging_enabled)&&o,u=(0,h.P$)({publicId:l?void 0:n,params:N}).getProfileInfoQuery,d=(0,v.y)(),b=u.data,w=u.isLoading,O=null==b?void 0:b.connection_to_current_community_member,S=(0,p.N)(O),P=S.isEmpty,C=S.isActive;return(0,r.jsxs)("div",{className:"mt-4 flex w-full space-x-2",children:[!l&&w&&d&&(0,r.jsx)(_.z,{variant:"secondary",disabled:!0,className:"!border-primary !h-8 w-full gap-2 !px-4 !font-medium",children:(0,r.jsx)(x.JO,{type:"loader",viewBox:"0 0 16 16"})}),!w&&!l&&P&&!l&&d&&b&&(0,r.jsx)(m.N,{recipient:b}),!w&&C&&(0,r.jsx)(j.I,{className:"!bg-secondary"}),!w&&c&&(0,r.jsx)(I,{closeCard:i,communityMemberId:t}),n&&(0,r.jsxs)(_.z,{className:"!border-primary flex items-center justify-center space-x-2 !px-3 !py-1.5 !font-medium",full:!c,variant:"secondary",onClick:function(){a.show({memberPublicId:n}),i()},children:[(0,r.jsx)(x.JO,{type:"16-user",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0}),(0,r.jsx)("span",{children:(0,f.t)("view_profile")})]})]})},M=function(e){var t=e.communityMemberId,n=e.publicUid,o=e.messagingEnabled,f=e.avatarURL,m=e.name,p=void 0===m?"":m,b=e.headline,h=void 0===b?"":b,v=e.side,y=e.sideOffset,g=e.closeCard,x=(0,u.c8)().data,_=(0,c.Y)({member_ids:[t]}),j=_.isLoading,w=_.data,O=null==w?void 0:w.find(function(e){return Number(e.community_member_id)===Number(t)}),S=!!(null==x?void 0:x.enabled);return(0,r.jsxs)(i.VY,{className:"border-primary bg-primary z-[1061] w-full min-w-[350px] max-w-[360px] rounded-xl border p-6 shadow-xl",sideOffset:y,side:v,children:[(0,r.jsxs)("div",{className:(0,a.A)("flex justify-between",h?"items-start":"items-center"),children:[(0,r.jsxs)("div",{className:"text-dark mr-4 truncate",children:[(0,r.jsx)(d.Z.LabelLg,{weight:"semibold",children:(0,r.jsx)("span",{className:"text-dark",children:p})}),(0,r.jsx)("br",{}),h&&(0,r.jsx)("div",{className:"text-light truncate",children:(0,r.jsx)(d.Z.LabelSm,{weight:"regular",children:(0,r.jsx)("span",{className:"text-light",children:h})})}),S&&(0,r.jsx)("div",{className:"mt-2",children:j?(0,r.jsx)("div",{className:"bg-tertiary mb-2 h-7 w-32 animate-pulse rounded-full text-center text-transparent md:text-left"}):(null==O?void 0:O.current_level)&&(0,r.jsx)(l.U,{level:null==O?void 0:O.current_level,levelName:null==O?void 0:O.current_level_name})})]}),(0,r.jsx)("div",{className:"flex flex-1 justify-end",children:(0,r.jsx)(s.i,{avatarUrl:f,name:p,size:"small",progress:null==O?void 0:O.level_progress,level:null==O?void 0:O.current_level})})]}),(0,r.jsx)("div",{className:"mt-4 space-y-2"}),(0,r.jsx)(A,{communityMemberId:t,publicUid:n,messagingEnabled:o,closeCard:g})]})};function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var E=function(e){var t,n=e.children,a=e.communityMemberId,s=e.publicUid,l=e.messagingEnabled,c=e.avatarURL,u=e.name,d=e.headline,f=e.disabled,m=e.side,p=e.sideOffset,b=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return T(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),h=b[0],v=b[1];return(0,r.jsxs)(i.fC,{openDelay:300,closeDelay:100,open:h,onOpenChange:v,children:[(0,r.jsx)(i.xz,{asChild:!0,children:(0,r.jsx)("span",{children:n})}),(0,r.jsx)(i.h_,{children:!(void 0!==f&&f)&&(0,r.jsx)(M,{communityMemberId:a,publicUid:s,avatarURL:c,name:void 0===u?"":u,headline:void 0===d?"":d,messagingEnabled:l,closeCard:function(){return v(!1)},side:void 0===m?"right":m,sideOffset:void 0===p?5:p})})]})}},754503:function(e,t,n){n.d(t,{Y:()=>a});var r=n(131906),o=n(93199),i=n(547144),a=function(e){var t=e.member_ids,n=e.enabled;return(0,r.useQuery)(["gamificationMember",t],function(){return(0,o.UT)(i.av.gamification.members({params:{member_ids:t}}))},{cacheTime:6e4,enabled:void 0===n||n})}},253035:function(e,t,n){n.d(t,{N:()=>eN});var r=n(552676),o=n(619803),i=n.n(o),a=n(932699),s=n(739792),l=n(95146),c=n(411944),u=n(535756),d=n(456918),f=n(285122),m=n(308683),p=n(981261),b=n(32589),h=n(413847),v=n(117617),y=n(935565),g=n(546272),x=n(604320),_=n(523386),j=n(381636),w=n(923782),O=n(306193),S=n(424650),P=n(528601),C=function(e){var t,n=e.member,o=Object.prototype.hasOwnProperty.call(n,"email"),i=(0,x.a)(),a=(0,x.R)(),l=(0,h.rV)(),c=(0,b.V)(),u=(0,v.kK)(),C=null==(t=n.member_tags)?void 0:t.filter(function(e){var t;return(null==e?void 0:e.is_public)&&(null==e||null==(t=e.display_locations)?void 0:t.profile_page)}),k=(null==C?void 0:C.length)>0;return(0,r.jsxs)("div",{className:"profile-drawer__about",children:[!i&&n.bio&&(0,r.jsx)(P.$,{dataTestId:"biography-section",title:(0,s.t)("profile_drawer.biography"),children:(0,r.jsx)(O.C,{info:n.bio,dataTestId:"profile-member-bio"})}),(0,r.jsxs)(P.$,{dataTestId:"profile-info-section",children:[!c&&o&&(0,r.jsx)(O.C,{iconType:"at-symbol",info:n.email,dataTestId:"profile-member-email"}),!i&&(0,r.jsx)(O.C,{iconType:"map-pin",iconProps:{viewBox:"0 0 14 18"},info:n.location,dataTestId:"profile-member-location"}),(0,r.jsx)(O.C,{iconType:"calendar",info:(0,s.t)("profile_drawer.member_since",{member_since:(0,f.ie)(n.created_at,{month:"long",year:"numeric",day:"numeric"})}),dataTestId:"profile-member-since"}),!!n.last_seen_at&&(0,r.jsx)(O.C,{iconType:"16-clock",info:(0,s.t)("profile_drawer.last_seen",{last_seen:(0,m.TF)(n.last_seen_at)}),iconProps:{viewBox:"0 0 18 18",className:"text-dark ml-0.5 mt-0.5"}})]}),l&&(0,r.jsx)(P.$,{dataTestId:"activity-score-section",children:(0,r.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,r.jsx)(j.Z.LabelSm,{weight:"semibold",children:(0,s.t)("activity_score.activity_score_title")}),(0,r.jsx)(y.XR,{ids:[n.id],children:(0,r.jsx)(d.z,{memberId:n.id})})]})}),k&&!u&&(0,r.jsx)(P.$,{title:(0,s.t)("profile_drawer.tags"),children:(0,r.jsx)("div",{className:"profile-drawer__about__tags",children:(0,r.jsx)(_.m,{limit:1/0,memberTags:C})})}),a&&(0,r.jsx)(P.$,{title:(0,s.t)("profile_fields.upgrade_flow.title"),children:(0,r.jsx)(g.I,{})}),i&&(0,r.jsx)(w.s,{profileFields:n.profile_fields}),!i&&(0,p.sR)(n)&&(0,r.jsxs)(P.$,{title:(0,s.t)("profile_drawer.social"),children:[(0,r.jsx)(S.o,{iconType:"globe",link:n.website_url}),(0,r.jsx)(S.o,{iconType:"facebook",link:n.facebook_url}),(0,r.jsx)(S.o,{iconType:"twitter",link:n.twitter_url}),(0,r.jsx)(S.o,{iconType:"linkedin",link:n.linkedin_url}),(0,r.jsx)(S.o,{iconType:"instagram",link:n.instagram_url})]})]})},k=function(){return(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)(j.Z.LabelSm,{children:(0,s.t)("something_went_wrong")})})},I=function(e){return(0,r.jsx)(u.S,{renderFunc:k,children:(0,r.jsx)(C,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))})},N=n(25593),A=n(720624),M=n(177201),T=n(674776),E=n(918594),R=n(693440),D=n(282859),L=n(941084),F=n(547144),U=n(380171),B=n(291704);function q(e){var t=e.comment,n=e.onClose,o=e.shouldOpenInNewTab,i="tiptap"===t.editor;return(0,r.jsx)(E.rU,{to:(0,F.LM)({slug:t.post_slug,spaceSlug:t.space_slug})+"#comment_wrapper_".concat(t.id),onClick:function(e){return!(0,D.n2)(e)&&n()},className:"profile-comments__item bg-primary focus-visible:outline-secondary hover:outline-secondary flex items-start p-5 transition-colors duration-150 md:px-6",target:o&&"_blank",children:(0,r.jsxs)("div",{className:"profile-comments__content text-darkest flex w-full flex-col space-y-3 text-base",children:[(0,r.jsx)("div",{className:"profile-comments__meta text-default flex flex-row space-x-3 text-sm font-normal",children:(0,r.jsxs)("div",{className:"space-x-2",children:[(0,r.jsxs)("span",{className:"profile-comments__post-name text-default break-all",children:[(0,s.t)("profile_drawer.comments.commented_on")," ",(0,r.jsx)("span",{className:"text-dark font-medium",children:t.post_name||t.post_truncated_content})]}),(0,r.jsx)("span",{className:"bg-badge inline-block size-1 rounded-full align-middle"}),(0,r.jsx)(U.T,{interactive:!1,content:(0,L.s4)(t.created_at),className:"inline-flex",children:(0,r.jsx)("span",{children:(0,m.TF)(t.created_at,{format:m.lc.short})})})]})}),i?(0,r.jsx)(R.G,{tiptapBody:t.tiptap_body},t.updated_at):(0,r.jsx)(B.P,{content:t.body_trix_content})]})})}var z=function(e){var t=e.memberPublicId,n=e.member,o=e.onClose,i=e.shouldOpenInNewTab,a=e.scrollableTarget,l=(0,M.F)({memberPublicId:t}),c=l.fetchNextPage,u=l.comments,d=l.hasNextPage;return l.isLoading?(0,r.jsx)(A.m,{}):u.length<1?(0,r.jsx)(T.Z,{title:s.ZP.t("profile_drawer.comments.empty_state.title"),subtitle:s.ZP.t("profile_drawer.comments.empty_state.subtitle")}):(0,r.jsx)("div",{className:"profile-comments bg-tertiary h-full overflow-auto",id:"profile-comments-scrollable-target",children:(0,r.jsx)(N.Z,{scrollThreshold:.5,next:c,hasMore:!!d,loader:(0,r.jsx)(A.m,{}),dataLength:u.length,scrollableTarget:(void 0===a?"panel":a)||"profile-comments-scrollable-target",className:"flex flex-col space-y-2",children:u.map(function(e){return(0,r.jsx)(q,{onClose:o,comment:e,member:n,shouldOpenInNewTab:i},e.id)})})})},Z=n(171832),V=n(441342),H=n(257210),W=n(62025),Q=function(e){var t=e.memberPublicId,n=e.shouldOpenInNewTab,o=e.scrollableTarget,i=(0,W.t)({memberPublicId:t}),a=i.fetchNextPage,l=i.posts,c=i.data,u=i.hasNextPage,d=i.isLoading,f=i.onPostChange;if(d)return(0,r.jsx)(A.m,{});if(l.length<1)return(0,r.jsx)(T.Z,{title:(0,s.t)("profile_drawer.posts.empty_state.title"),subtitle:(0,s.t)("profile_drawer.posts.empty_state.subtitle")});var m=null==c?void 0:c.pages.map(function(e){return e.records.map(function(e){return e.id})});return(0,r.jsx)(H._x,{perPagePostIds:m,children:(0,r.jsx)("div",{className:"profile-posts bg-tertiary h-full overflow-auto",id:"profile-posts-scrollable-target",children:(0,r.jsx)(N.Z,{style:{overflow:"initial"},scrollThreshold:.5,next:a,hasMore:!!u,loader:(0,r.jsx)(A.m,{}),dataLength:l.length,scrollableTarget:(void 0===o?"panel":o)||"profile-posts-scrollable-target",className:"space-y-2",children:l.map(function(e){return(0,r.jsx)(V.mE,{spaceId:e.space_id,children:(0,r.jsx)(Z.Y,{forceSimplifiedView:!0,onPostChange:f,post:e,shouldOpenInNewTab:n},e.id)},e.id)})})})})},G=n(532602),$=n(624310),K=n(260622),J=function(e){var t=e.member,n=t.is_deleted?(0,s.t)("deactivated"):t.admin?(0,s.t)("admin"):t.moderator?(0,s.t)("moderator"):null;return n?(0,r.jsx)("div",{className:i()("text-badge m-0 inline-block select-none overflow-hidden rounded-2xl bg-clip-padding px-2 py-[2px] text-[9px] font-bold uppercase",{"bg-[#ef4444] text-white":t.is_deleted,"bg-brand text-brand-button":!t.is_deleted}),children:n}):null},X=n(915912),Y=n.n(X),ee=n(39905),et=n(60878),en=n(957363),er=function(e){var t=e.member.public_uid,n=e.large,o=(0,et.pm)().success,a=(0,F.zd)({public_uid:t});return(0,r.jsx)(U.T,{placement:"bottom",content:(0,s.t)("post.share.copy_link_to_profile"),interactive:!1,children:(0,r.jsx)("div",{children:(0,r.jsx)(ee.z,{type:"button",variant:"secondary","aria-label":(0,s.t)("post.share.copy_link_to_profile"),onClick:function(){Y()(window.location.origin+a),o((0,s.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},"data-testid":"copy-link-profile",large:n,className:i()({"!px-2.5":n}),children:(0,r.jsx)(en.JO,{type:"link",size:16,useWithFillCurrentColor:!0})})})})},eo=function(e){var t=e.toggleDrawer,n=e.isFullPageProfile,o=e.memberId;return(0,r.jsx)(U.T,{placement:"bottom",content:(0,s.t)("post.share.edit_profile"),interactive:!1,children:(0,r.jsx)(ee.z,{variant:"secondary",onClick:function(){n?window.location.href=F.bf.edit({memberId:String(o)}):t()},"aria-label":(0,s.t)("post.share.edit_profile"),children:(0,r.jsx)(en.JO,{type:"pencil",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0})})})},ei=n(903225),ea=n(664657),es=n(403697),el=n(905326),ec=n(925820);function eu(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var ed=function(e){var t=e.member,n=e.onSendMessageClick,o=e.isFullPageProfile,a=void 0!==o&&o,l=e.shouldHideMessageButton,c=e.shouldAutoNavigate,u=void 0===c||c,d=(0,el.p)().findOrCreateChatRoom,f=(0,ei.k6)(),m=(0,ec.w)({memberPublicId:t.public_id,member:t,isFullPageProfile:a,shouldHideMessageButton:void 0!==l&&l}),b=m.shouldShowEditProfileButton,h=m.onClickOpenEditProfileDrawer,v=m.handleCopyProfileLink,y=m.shouldShowMemberChatIcon,g=function(e){var t;return(t=function(){var t;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:return[4,d({kind:es.g8,community_member_ids:[e]})];case 1:return t=r.sent(),u&&f.push((0,F.co)({url:(0,F.so)({uuid:t})})),n(t),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){eu(i,r,o,a,s,"next",e)}function s(e){eu(i,r,o,a,s,"throw",e)}a(void 0)})})()};return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 p-6",children:[(0,r.jsx)(ea.W,{name:null==t?void 0:t.name,size:"16",src:null==t?void 0:t.avatar_url}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Z.TitleSm,{weight:"font-bold",textAlign:"text-center",children:null==t?void 0:t.name}),(0,r.jsx)(j.Z.BodySm,{textAlign:"text-center",children:null==t?void 0:t.headline})]}),(0,p.cT)(t)&&(0,r.jsx)(_.m,{limit:1/0,memberTags:t.member_tags}),y&&(0,r.jsx)(ee.z,{full:!0,variant:"circle",onClick:function(){return g(t.id)},children:(0,s.t)("message")}),a&&(0,r.jsxs)("div",{className:i()("grid gap-2",{"grid-cols-2":b}),children:[(0,r.jsx)(ee.z,{full:!0,variant:"secondary-light",onClick:v,children:(0,s.t)("profile_drawer.dropdown.copy_profile_link")}),b&&(0,r.jsx)(ee.z,{full:!0,variant:"secondary-light",onClick:h,children:(0,s.t)("profile_drawer.dropdown.edit_member_profile")})]})]})},ef=n(381040),em=n(857487),ep=n(415307),eb=n(271561),eh=n(786518),ev=n(144102),ey=function(e){var t=e.member,n=e.onSendMessageClick,o=e.isFullPageProfile,i=e.shouldHideMessageButton,a=e.shouldOpenInNewTab,l=e.refetch,c=(0,v.kK)(),u=(0,(0,ep.q)().canBlockMemberDm)(t),d=(0,ec.w)({memberPublicId:t.public_id,member:t,isFullPageProfile:o,shouldHideMessageButton:i}),f=d.shouldShowEditProfileButton,m=d.onClickOpenEditProfileDrawer,p=d.shouldShowMemberChatIcon,b=d.canEditProfile,h=d.canViewOnlyMasquerade,y=(0,eb.U)({onSuccess:function(){null==l||l()},memberName:t.name}),g=y.isUnblocking,x=y.unBlockMember,_=y.setIsBlockDmsModalOpen,w=y.isBlockDmsModalOpen,O=y.isBlocking,S=y.blockMember;if(c)return(0,r.jsx)(ed,{member:t,shouldAutoNavigate:!a,onSendMessageClick:n,shouldHideMessageButton:i,isFullPageProfile:o});var P=[];return h&&P.push({label:(0,s.t)("post.share.view_as",{member_first_name:t.first_name}),icon:"16-eye-open",onClick:function(){(0,ev.g)({entityId:t.id,entityType:"CommunityMember"}).then(function(e){return window.open(e.masquerade_url,"_self")}).catch(function(e){return console.error(e)})},testId:"view-only-masquerade-button"}),u&&(t.is_blocked_by_current_community_member?P.push({label:(0,s.t)("messaging.unblock_direct_messages"),icon:"20-circle-check",iconSize:20,onClick:function(){return!g&&x({memberId:t.id})},testId:"unblock-direct-messages-button"}):P.push({label:(0,s.t)("messaging.block_direct_messages"),icon:"20-block-dms",iconSize:20,iconClassName:"text-feedback-error",onClick:function(){return _(!0)},testId:"block-direct-messages-button",textColor:"text-feedback-error"})),(0,r.jsxs)("div",{className:"profile-drawer__header",children:[(0,r.jsxs)("div",{className:"relative flex items-center justify-center",children:[(0,r.jsx)(G.s,{size:"24",src:t.avatar_url,name:t.name,isFullRounded:!0}),(0,r.jsx)("div",{className:"absolute -bottom-2 flex items-center gap-1",children:(0,r.jsx)(J,{member:t})})]}),(0,r.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,r.jsx)("div",{children:(0,r.jsx)("h3",{className:"profile-drawer__header__name",children:t.name})}),(null==t?void 0:t.headline)&&(0,r.jsx)("div",{className:"!mt-1",children:(0,r.jsx)(j.Z.BodySm,{textAlign:"text-start",weight:"font-medium",color:"text-light",children:t.headline})}),t.is_blocked_by_current_community_member&&(0,r.jsx)("div",{className:"pb-1",children:(0,r.jsx)(ef.g,{})}),(0,r.jsxs)(K.T,{children:[(0,r.jsxs)("div",{className:"profile-drawer__header__actions",children:[p&&(0,r.jsx)($.k,{communityMemberId:t.id,onClick:n,shouldAutoNavigate:!a,variant:h?"icon":"button"}),f&&(0,r.jsx)(eo,{toggleDrawer:m,memberId:t.public_id}),o?b&&(0,r.jsx)(eo,{toggleDrawer:m,memberId:t.public_id}):(0,r.jsx)(er,{member:t}),(0,r.jsx)(em.m,{actions:P,isRenderedInProfileHeader:!0})]}),(0,r.jsx)(eh._,{showModal:w,onClose:function(){return _(!1)},onConfirm:function(){S({memberId:t.id}),_(!1)},memberName:t.name,isLoading:O})]})]})]})},eg=n(240507),ex=n.n(eg),e_=n(988159),ej=n(22319),ew=n(151433),eO=n(78456),eS=n(280219),eP=function(e){var t=e.onClose,n=e.space,o=n.emoji,i=n.custom_emoji_url,a=n.custom_emoji_dark_url,l=n.hide_members_count,c=n.name,u=n.slug,d=n.member_count,f=n.is_private,m=n.show_lock_icon_for_non_members,p=n.is_space_member,b=e.shouldOpenInNewTab,h=(0,ej.TC)().currentAppearance,v=(0,V.wh)().currentCommunityMember,y=(0,eO.vb)(v),g=(0,ew.$)({shouldShowLockIconForNonMembers:m&&!p,isPrivate:f,isAdmin:y});return(0,r.jsxs)(E.rU,{to:(0,F._v)({spaceSlug:u}),onClick:function(e){return!(0,D.n2)(e)&&t()},className:"profile-spaces__item",target:b&&"_blank",children:[(0,r.jsx)(eS.S,{wrapperClassName:"profile-spaces__emoji self-start",className:"gated-or-not with-emoji",emoji:o,customEmojiUrl:i,customEmojiDarkUrl:a,appearance:h,shouldUseLockIcon:g,lockIcon:(0,r.jsx)("span",{className:"gated-or-not",children:(0,r.jsx)(en.JO,{type:"lock",useWithFillCurrentColor:!0,className:"text-dark"})})}),(0,r.jsxs)("div",{className:"profile-spaces__details",children:[(0,r.jsx)("p",{className:"profile-spaces__title",children:c}),!l&&(0,r.jsx)("p",{className:"profile-spaces__members",children:(0,s.t)("profiles.members",{count:d})})]})]})};eP.propTypes={space:ex().shape({emoji:ex().string,custom_emoji_url:ex().string,custom_emoji_dark_url:ex().string,name:ex().string.isRequired,slug:ex().string.isRequired,member_count:ex().number.isRequired,is_private:ex().bool.isRequired})};var eC=function(e){var t=e.memberPublicId,n=e.onClose,o=e.shouldOpenInNewTab,i=e.scrollableTarget,a=(0,e_.u)({memberPublicId:t}),s=a.spaces,l=a.isLoading,c=a.fetchNextPage,u=a.hasNextPage;return l?(0,r.jsx)(A.m,{}):s.length<1?(0,r.jsx)(T.Z,{title:I18n.t("profile_drawer.spaces.empty_state.title"),subtitle:I18n.t("profile_drawer.spaces.empty_state.subtitle")}):(0,r.jsx)("div",{className:"h-full overflow-auto",id:"profile-spaces-scrollable-target",children:(0,r.jsx)(N.Z,{scrollThreshold:.5,next:c,hasMore:u,loader:(0,r.jsx)(A.m,{}),dataLength:s.length,className:"profile-spaces",scrollableTarget:(void 0===i?"panel":i)||"profile-spaces-scrollable-target",children:s.map(function(e){return(0,r.jsx)(eP,{onClose:n,space:e,shouldOpenInNewTab:o},e.id)})})})};eC.propTypes={memberPublicId:ex().string.isRequired,onClose:ex().func.isRequired,shouldOpenInNewTab:ex().bool,scrollableTarget:ex().string};var ek={ABOUT:(0,s.t)("profile_tabs.about"),POSTS:(0,s.t)("profile_tabs.posts"),COMMENTS:(0,s.t)("profile_tabs.comments"),SPACES:(0,s.t)("profile_tabs.spaces")},eI=Object.values(ek).map(function(e){return{label:e}}),eN=function(e){var t=e.member,n=e.onClose,o=void 0===n?a.noop:n,s=e.onOpenMessaging,u=e.memberPublicId,d=e.isFullPageProfile,f=e.shouldOpenInNewTab,m=void 0!==f&&f,p=e.shouldHideMessageButton,b=e.shouldHideBadge,h=e.isRenderedOnRailBar,v=void 0!==h&&h,y=e.shouldFixTabsOnTop,g=e.refetch,x=t.comments_count,_=t.posts_count,j=t.spaces_count,w=void 0!==b&&b?eI:[{label:ek.ABOUT},{label:ek.POSTS,badge:{value:_}},{label:ek.COMMENTS,badge:{value:x}},{label:ek.SPACES,badge:{value:j}}],O=d?"panel":null;return(0,r.jsx)("div",{className:i()({"profile-full-page":d,"profile-drawer trix-v2":!d,"flex h-full":t.is_deleted}),children:t.is_deleted?(0,r.jsx)(l.d8,{}):(0,r.jsxs)(c.O.Group,{className:i()("flex flex-col !overflow-hidden",{"!h-[calc(100vh-50px)] md:!h-[calc(100vh-60px)]":!d&&!v,"!h-[calc(100dvh-24px)] md:!h-[calc(100vh-2.5rem-64px)]":v&&!d}),children:[(0,r.jsxs)("div",{className:i()({"sticky top-0 z-30":void 0!==y&&y}),children:[(0,r.jsx)(ey,{member:t,onSendMessageClick:d?a.noop:function(e){s?s(e):o()},isFullPageProfile:d,shouldHideMessageButton:void 0!==p&&p,shouldOpenInNewTab:m,refetch:g}),(0,r.jsx)("div",{className:"border-primary bg-primary border-b px-6",children:(0,r.jsx)(c.O.List,{children:Object.values(w).map(function(e){return(0,r.jsxs)(c.O,{className:"text-sm",children:[e.label,(0,r.jsx)(c.O.Counter,{children:e.badge&&e.badge.value>0&&e.badge.value})]},e.label)})})})]}),(0,r.jsxs)(c.O.Panels,{className:i()({"h-full grow":!d}),children:[(0,r.jsx)(c.O.Panel,{children:(0,r.jsx)(I,{member:t})}),(0,r.jsx)(c.O.Panel,{children:(0,r.jsx)(Q,{memberPublicId:u,onClose:d?a.noop:o,shouldOpenInNewTab:m,scrollableTarget:O})}),(0,r.jsx)(c.O.Panel,{children:(0,r.jsx)(z,{memberPublicId:u,member:t,onClose:d?a.noop:o,shouldOpenInNewTab:m,scrollableTarget:O})}),(0,r.jsx)(c.O.Panel,{children:(0,r.jsx)(eC,{memberPublicId:u,onClose:d?a.noop:o,shouldOpenInNewTab:m,scrollableTarget:O})})]})]})})};eN.displayName="Profile"},273511:function(e,t,n){n.d(t,{S:()=>a});var r=n(441342),o=n(532701),i=n(932699),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.shouldHideMessageButton,n=void 0!==t&&t,a=(0,r.wh)(),s=a.currentCommunityMember,l=a.currentCommunity,c=(0,o.L7)();return{shouldShowMessageOption:function(e){if(!(0,i.isObject)(e))return!1;var t,r=null==s?void 0:s.is_admin,o=e.admin,a=e.profile_confirmed_at&&!e.is_deleted,u=null!=(t=e.community_member_id)?t:e.id,d=(null==s?void 0:s.id)==u,f=!(null==l?void 0:l.messaging_enabled);return!n&&!e.is_blocked_by_current_community_member&&!e.has_blocked_current_community_member&&!!a&&!d&&!f&&(!o||!!(e.messaging_enabled_by_member&&e.messaging_enabled_by_admin))&&(!!r||(!!o||!!r||!!c)&&e.messaging_enabled_by_member&&e.messaging_enabled_by_admin&&(null==s?void 0:s.messaging_enabled_by_member)&&(null==s?void 0:s.messaging_enabled_by_admin))}}}},925820:function(e,t,n){n.d(t,{w:()=>d});var r=n(915912),o=n.n(r),i=n(739792),a=n(441342),s=n(547144),l=n(514598),c=n(60878),u=n(273511),d=function(e){var t=e.member,n=e.memberPublicId,r=e.isFullPageProfile,d=e.shouldHideMessageButton,f=(0,c.pm)().success,m=(0,s.zd)({public_uid:n}),p=(0,l.H)(),b=p.showOwnProfileEdit,h=p.showMemberProfileEdit,v=(0,a.wh)().currentCommunityMember,y=(null==v?void 0:v.id)==(null==t?void 0:t.id),g=null==v?void 0:v.is_admin;return{shouldShowEditProfileButton:!(void 0!==r&&r)&&!(null==t?void 0:t.is_deleted)&&(y||g),onClickOpenEditProfileDrawer:function(){y?b():g&&h({member:t})},handleCopyProfileLink:function(){o()(window.location.origin+m),f((0,i.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},shouldShowMemberChatIcon:(0,(0,u.S)({shouldHideMessageButton:void 0!==d&&d}).shouldShowMessageOption)(t),canEditProfile:!(null==t?void 0:t.is_deleted)&&g,canViewOnlyMasquerade:g&&(null==v?void 0:v.id)!==t.id}}},636477:function(e,t,n){n.d(t,{I:()=>l});var r=n(552676),o=n(739792),i=n(957363),a=n(701168),s=n(39905),l=function(e){var t=e.className;return(0,r.jsxs)(s.z,{variant:"secondary",disabled:!0,className:(0,a.A)("flex items-center gap-x-2",t),children:[(0,r.jsx)(i.JO,{type:"check",viewBox:"0 0 16 16"}),(0,o.t)("profile_drawer.connect_banner.states.active")]})}},999896:function(e,t,n){n.d(t,{w:()=>b});var r=n(552676),o=n(113131),i=n(882724),a=n(316026),s=n(636477),l=n(739792),c=n(957363),u=n(701168),d=n(39905),f=n(83697),m=n(724980),p=function(e){var t=e.memberPublicUid,n=e.memberName,o=e.connectionId,i=e.shouldShowOnlyIcon,a=void 0!==i&&i,s=e.shouldShowAcceptAtLeft,p=(0,f.T)({memberPublicUid:t,memberName:n}),b=p.acceptConnectionForUser,h=p.isAccepting,v=(0,m.E)({memberPublicUid:t}),y=v.ignoreConnectionForUser,g=v.isIgnoring;return(0,r.jsxs)("div",{className:(0,u.A)("flex gap-x-2",void 0!==s&&s&&"flex-row-reverse justify-end"),children:[(0,r.jsx)(d.z,{variant:"secondary",onClick:function(){o&&y(o)},disabled:g||h,"aria-label":(0,l.t)("profile_drawer.connect_banner.states.ignore"),className:(0,u.A)(a&&"!h-8 !w-8 !p-0"),children:g?(0,r.jsx)(c.JO,{type:"loader",viewBox:"0 0 16 16"}):a?(0,r.jsx)(c.JO,{type:"20-close",size:20}):(0,l.t)("profile_drawer.connect_banner.states.ignore")}),(0,r.jsx)(d.z,{variant:"primary",onClick:function(){o&&b(o)},disabled:h||g,"aria-label":(0,l.t)("profile_drawer.connect_banner.states.accept"),className:(0,u.A)(a&&"!h-8 !w-8 !p-0 text-white dark:text-black"),children:h?(0,r.jsx)(c.JO,{type:"loader",viewBox:"0 0 16 16"}):a?(0,r.jsx)(c.JO,{type:"20-checkmark",size:20,useWithFillCurrentColor:!0}):(0,l.t)("profile_drawer.connect_banner.states.accept")})]})},b=function(e){var t=e.member,n=e.shouldShowOnlyIcon,l=e.shouldShowAcceptAtLeft,c=e.recommendationId,u=null==t?void 0:t.connection_to_current_community_member,d=(0,a.N)(u),f=d.isEmpty,m=d.isCurrentUserSentConnection,b=d.isOtherUserSentConnection,h=d.isActive;return t.name&&t.public_uid?f?(0,r.jsx)(o.N,{recipient:t,recommendationId:c}):h?(0,r.jsx)(s.I,{}):m?(0,r.jsx)(i.C,{memberPublicUid:t.public_uid,recipient:t.name,connectionId:null==u?void 0:u.id.toString(),fullWidth:!1}):b&&u?(0,r.jsx)(p,{shouldShowAcceptAtLeft:void 0!==l&&l,memberName:t.name,memberPublicUid:t.public_uid,connectionId:u.id.toString(),shouldShowOnlyIcon:void 0!==n&&n}):null:null}},169594:function(e,t,n){n.d(t,{H:()=>d});var r=n(552676),o=n(275271),i=n(739792),a=n(381636),s=n(701168),l=n(889228);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var d=function(e){var t=e.note,n=e.collapse,c=void 0!==n&&n,d=e.lineClamp,f=e.className,m=u((0,o.useState)(!1),2),p=m[0],b=m[1],h=u((0,o.useState)(!1),2),v=h[0],y=h[1],g=(0,o.useRef)(null);(0,o.useEffect)(function(){if(c&&g.current){var e=g.current;y(e.scrollHeight>e.clientHeight)}},[t,c]);var x=(0,l.D)();return(0,r.jsx)("div",{className:(0,s.A)("bg-secondary !mt-2 w-full rounded-xl px-3 py-2.5",x?"mb-1":"mb-3",f),children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{ref:g,className:(0,s.A)(c&&"whitespace-pre-wrap",c&&!p&&"line-clamp-".concat(void 0===d?3:d)),children:(0,r.jsx)(a.Z.BodyXs,{color:"text-darkest",weight:"normal",children:t})}),c&&v&&!p&&(0,r.jsx)("div",{className:"bg-secondary absolute bottom-0 right-0 pl-2",children:(0,r.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),e.stopPropagation(),b(!0)},className:"text-dark text-xs font-semibold",children:(0,i.t)("settings.connect_audience.see_more")})})]})})}},83697:function(e,t,n){n.d(t,{T:()=>b});var r=n(552676),o=n(131906),i=n(739792),a=n(518121),s=n(302451),l=n(60878),c=n(251630),u=n(993228),d=n(273511);function f(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function m(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,s,"next",e)}function s(e){f(i,r,o,a,s,"throw",e)}a(void 0)})}}function p(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var b=function(e){var t,n=e.memberPublicUid,f=e.memberName,b=e.onSuccess,h=e.user,v=(0,l.pm)(),y=(0,o.useQueryClient)(),g=(0,(0,d.S)().shouldShowMessageOption)(h),x=(0,a.c)(),_=x.handleMessageMember,j=x.isLoading,w=(t={onSuccess:function(){return m(function(){var e,t,o;return p(this,function(a){switch(a.label){case 0:return[4,new Promise(function(e){return setTimeout(e,2e3)})];case 1:return a.sent(),[4,(0,u._)(y,null!=(e=null!=n?n:null==h?void 0:h.public_uid)?e:"")];case 2:return a.sent(),(0,s.uQ)({queryClient:y}),v.success((0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{children:(0,i.t)("profile_drawer.connect_banner.messages.connection_accepted",{memberName:null!=(o=null!=(t=null==h?void 0:h.name)?t:f)?o:""})}),g&&(null==h?void 0:h.id)&&(0,r.jsx)("button",{type:"button",className:"hover:text-light underline transition-colors",onClick:function(){return m(function(){return p(this,function(e){switch(e.label){case 0:return[4,_(h.id.toString())];case 1:return e.sent(),[2]}})})()},children:(0,i.t)("message")})]}),{duration:"long"}),null==b||b(),[2]}})})()},onError:function(){v.error((0,i.t)("profile_drawer.connect_banner.messages.connection_accept_error"))}},(0,o.useMutation)(function(e){return c.e5.acceptConnection(e)},t));return{acceptConnectionForUser:w.mutate,isAccepting:w.isLoading||j}}},724980:function(e,t,n){n.d(t,{E:()=>u});var r=n(131906),o=n(739792),i=n(302451),a=n(60878),s=n(251630),l=n(993228);function c(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var u=function(e){var t,n=e.memberPublicUid,u=(0,a.pm)(),d=(0,r.useQueryClient)(),f=(t={onSuccess:function(){var e;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return[4,(0,l._)(d,null!=n?n:"")];case 1:return e.sent(),(0,i.uQ)({queryClient:d}),u.success((0,o.t)("profile_drawer.connect_banner.messages.connection_ignored")),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)})})()},onError:function(){u.error((0,o.t)("profile_drawer.connect_banner.messages.connection_ignore_error"))}},(0,r.useMutation)(function(e){return s.e5.ignoreConnection(e)},t));return{ignoreConnectionForUser:f.mutate,isIgnoring:f.isLoading}}},993228:function(e,t,n){n.d(t,{_:()=>a});var r=n(981261),o=n(208054);function i(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var a=function(e,t){var n;return(n=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(n){switch(n.label){case 0:return[4,Promise.all([e.invalidateQueries({queryKey:["recommendations"]}),e.invalidateQueries({queryKey:[o.Wx,t,{page_name:r.$q.PROFILE_VIEW}]}),e.invalidateQueries({queryKey:["community-members"]}),e.invalidateQueries({queryKey:["audience"]})])];case 1:return n.sent(),[2]}})},function(){var e=this,t=arguments;return new Promise(function(r,o){var a=n.apply(e,t);function s(e){i(a,r,o,s,l,"next",e)}function l(e){i(a,r,o,s,l,"throw",e)}s(void 0)})})()}},137385:function(e,t,n){n.d(t,{Z:()=>o});var r=n(552676);function o(e){var t=e.title,n=e.subtitle;return(0,r.jsxs)("div",{className:"profile-drawer__empty",children:[(0,r.jsx)("div",{className:"profile-drawer__empty__title",children:t}),(0,r.jsx)("div",{className:"profile-drawer__empty__subtitle",children:n})]})}},857487:function(e,t,n){n.d(t,{m:()=>c});var r=n(552676),o=n(701168),i=n(957363),a=n(39905),s=n(943544),l=n(381636),c=function(e){var t=e.actions,n=e.isRenderedInProfileHeader;return 0===t.length?null:(0,r.jsx)(s.Lt,{size:"large",button:(0,r.jsx)(a.z,{type:"button",variant:"secondary","data-testid":"actions-dropdown-button",className:(0,o.A)({"!px-2.5":!n}),large:!n,children:(0,r.jsx)(i.JO,{type:"16-menu-dots-horizontal",size:16,useWithFillCurrentColor:!0})}),menuButtonEl:"div",children:t.map(function(e){var t,n;return(0,r.jsx)(s.Lt.ItemWithLink,{linkType:"button",onClick:e.onClick,"data-testid":e.testId,children:(0,r.jsxs)(s.Lt.IconContainer,{children:[(0,r.jsx)(i.JO,{type:e.icon,size:null!=(t=e.iconSize)?t:16,className:(0,o.A)("mr-2",e.iconClassName)}),(0,r.jsx)(l.Z.LabelSm,{weight:"regular",color:null!=(n=e.textColor)?n:"text-very-dark",children:e.label})]})},e.label)})})}},381040:function(e,t,n){n.d(t,{g:()=>l});var r=n(552676),o=n(957363),i=n(381636),a=n(739792),s=n(441342),l=function(){var e=(0,s.wh)().currentCommunitySettings;return(null==e?void 0:e.live_pulse_block_dms_enabled)?(0,r.jsxs)("div",{className:"border border-feedback-error rounded-lg px-2 py-0.5 items-center justify-center flex gap-1 bg-[#EF44441A]/10",children:[(0,r.jsx)(o.JO,{type:"16-circle-x",size:16,className:"text-feedback-error !w-4"}),(0,r.jsx)(i.Z.LabelXs,{weight:"medium",color:"text-feedback-error","data-testid":"member-blocked",children:(0,a.t)("profile_drawer.blocked_dms")})]}):null}},259092:function(e,t,n){n.d(t,{E:()=>l});var r=n(552676),o=n(932699),i=n(701168),a=n(381636),s=n(320784),l=function(e){var t=e.title,n=e.isActive,l=e.onClick,c=e.count,u=e.hasBlip;return(0,r.jsx)("button",{type:"button",className:(0,i.A)("bg-primary border-primary hover:bg-secondary focus-visible:outline-secondary text-darkest cursor-pointer rounded-full border px-4 py-2 text-sm transition-colors duration-75 focus-visible:rounded-full focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"border-secondary":n}),onClick:l,children:(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[u&&(0,r.jsx)("div",{className:"size-2 rounded-full bg-red-500"}),(0,r.jsx)(a.Z.LabelSm,{color:"text-darkest",weight:"medium",children:t}),(0,o.isNumber)(c)&&c>0&&(0,r.jsx)(a.Z.LabelSm,{color:"text-light",children:(0,s.V)(c,!1)})]})})}},478188:function(e,t,n){n.d(t,{t:()=>o});var r=n(552676),o=function(){return(0,r.jsxs)("div",{className:"border-primary rounded-xl border px-5 pt-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"bg-tertiary size-10 animate-pulse rounded-full"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"bg-tertiary h-5 w-36 animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-3 w-20 animate-pulse rounded-md duration-300"})]})]}),(0,r.jsxs)("div",{className:"mb-5 mt-10 space-y-3",children:[(0,r.jsx)("div",{className:"bg-tertiary h-3 w-full animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-3 w-full animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-3 w-64 animate-pulse rounded-md duration-300"})]}),(0,r.jsxs)("div",{className:"border-primary -mx-5 flex h-12 items-center justify-between space-x-2 border-t px-5",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"bg-tertiary size-6 animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary size-6 animate-pulse rounded-md duration-300"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"bg-tertiary h-6 w-12 animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-6 w-16 animate-pulse rounded-md duration-300"})]})]})]})}},982942:function(e,t,n){n.d(t,{J:()=>a});var r=n(552676),o=n(619803),i=n.n(o),a=function(e){var t=e.isFullPageView;return(0,r.jsx)("div",{className:i()("border-primary col-span-full w-full overflow-auto border-r p-4 md:col-span-4",{"!md:w-1/3":t}),children:(0,r.jsxs)("div",{className:"flex flex-col items-center py-9",children:[(0,r.jsx)("div",{className:"bg-tertiary size-24 animate-pulse rounded-full duration-300"}),(0,r.jsxs)("div",{className:"mt-7 flex flex-col items-center space-y-1.5",children:[(0,r.jsx)("div",{className:"bg-tertiary h-4 w-32 animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-4 w-48 animate-pulse rounded-md duration-300"})]}),(0,r.jsxs)("div",{className:"mt-4 flex flex-col items-center space-y-2",children:[(0,r.jsx)("div",{className:"bg-tertiary h-6 w-56 animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-5 w-32 animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-5 w-24 animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-5 w-44 animate-pulse rounded-md duration-300"})]}),(0,r.jsxs)("div",{className:"mt-8 flex items-center justify-between space-x-3",children:[(0,r.jsx)("div",{className:"bg-tertiary h-[34px] w-24 animate-pulse rounded-full duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary size-[34px] animate-pulse rounded-full duration-300"})]})]})})}},739265:function(e,t,n){n.d(t,{y:()=>o});var r=n(552676),o=function(){return(0,r.jsxs)("div",{className:"mb-6 flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"bg-tertiary w-18 h-[38px] animate-pulse rounded-full duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary w-18 h-[38px] animate-pulse rounded-full duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-[38px] w-[106px] animate-pulse rounded-full duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-[38px] w-[84px] animate-pulse rounded-full duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-[38px] w-[90px] animate-pulse rounded-full duration-300"})]})}},754951:function(e,t,n){n.d(t,{o:()=>e7});var r=n(552676),o=n(275271),i=n(932699),a=n(739792),s=n(701168),l=n(119323),c=n(737840),u=n(923782),d=n(306193),f=n(424650),m=n(528601),p=n(754503),b=n(456918),h=n(981261),v=n(32589),y=n(413847),g=n(117617),x=n(935565),_=n(546272),j=n(604320),w=n(523386),O=n(381636),S=function(e){var t,n=e.member,o=(0,p.Y)({enabled:!!(null==n?void 0:n.id),member_ids:[null==n?void 0:n.id]}).data,s=null==o?void 0:o[0],l=!(0,i.isEmpty)(n.email),S=(0,j.a)(),P=(0,j.R)(),C=(0,y.rV)(),k=(0,v.V)(),I=(0,g.kK)(),N=null==(t=n.member_tags)?void 0:t.filter(function(e){var t;return(null==e?void 0:e.is_public)&&(null==e||null==(t=e.display_locations)?void 0:t.profile_page)}),A=(null==N?void 0:N.length)>0,M=l&&!k;return(0,r.jsxs)("div",{className:"text-dark px-0 py-4 text-sm",children:[s&&(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)(c.U,{level:s.current_level,levelName:s.current_level_name}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(O.Z.LabelXs,{weight:"regular",color:"text-light",children:(0,a.t)("leaderboard.n_points",{count:s.total_points})}),(0,r.jsx)(O.Z.LabelXs,{weight:"regular",color:"text-light",children:(0,a.t)("separator_dot")}),(0,r.jsx)(O.Z.LabelXs,{weight:"regular",color:"text-light",children:(0,a.t)("leaderboard.n_to_level_up",{count:s.points_to_next_level})})]})]}),!S&&n.bio&&(0,r.jsx)(m.$,{dataTestId:"biography-section",title:(0,a.t)("profile_drawer.biography"),children:(0,r.jsx)(d.C,{info:n.bio,dataTestId:"profile-member-bio"})}),(M||n.location)&&(0,r.jsxs)(m.$,{dataTestId:"profile-info-section",children:[M&&(0,r.jsx)(d.C,{iconType:"at-symbol",info:n.email,dataTestId:"profile-member-email"}),!S&&(0,r.jsx)(d.C,{iconType:"map-pin",iconProps:{viewBox:"0 0 14 18"},info:n.location,dataTestId:"profile-member-location"})]}),C&&(0,r.jsx)(m.$,{dataTestId:"activity-score-section",children:(0,r.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,r.jsx)(O.Z.LabelSm,{weight:"semibold",children:(0,a.t)("activity_score.activity_score_title")}),(0,r.jsx)(x.XR,{ids:[n.id],children:(0,r.jsx)(b.z,{memberId:n.id})})]})}),A&&!I&&(0,r.jsx)(m.$,{title:(0,a.t)("profile_drawer.tags"),children:(0,r.jsx)("div",{className:"profile-drawer__about__tags",children:(0,r.jsx)(w.m,{limit:1/0,memberTags:N})})}),P&&(0,r.jsx)(m.$,{title:(0,a.t)("profile_fields.upgrade_flow.title"),children:(0,r.jsx)(_.I,{})}),!S&&(0,h.sR)(n)&&(0,r.jsxs)(m.$,{title:(0,a.t)("profile_drawer.social"),children:[(0,r.jsx)(f.o,{iconType:"globe",link:n.website_url}),(0,r.jsx)(f.o,{iconType:"facebook",link:n.facebook_url}),(0,r.jsx)(f.o,{iconType:"twitter",link:n.twitter_url}),(0,r.jsx)(f.o,{iconType:"linkedin",link:n.linkedin_url}),(0,r.jsx)(f.o,{iconType:"instagram",link:n.instagram_url})]}),S&&(0,r.jsx)(u.s,{profileFields:n.profile_fields})]})},P=n(31960),C=function(){var e=(0,P.E)().member;return(0,r.jsx)(S,{member:e})},k=n(25593),I=n(720624),N=n(177201),A=n(137385),M=n(532602),T=n(217123),E=n(918594),R=n(693440),D=n(941084),L=n(547144),F=n(380171),U=n(291704),B=function(e){var t=e.comment,n=e.onClose,o=e.member,i=(0,T.default)(new Date(t.created_at),"MMM dd");return(0,r.jsxs)(E.rU,{to:(0,L.LM)({slug:t.post_slug,spaceSlug:t.space_slug})+"#comment_wrapper_".concat(t.id),onClick:n,className:"flex items-start space-x-3 py-5 first:pt-0",children:[(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)(M.s,{isFullRounded:!0,name:o.name,src:o.avatar_url,size:"10"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between space-x-2",children:[(0,r.jsxs)("div",{className:"text-default w-full flex-1 truncate text-sm",children:[(0,a.t)("profile_drawer.comments.commented_on")," ",(0,r.jsx)("span",{className:"text-darkest font-medium",children:t.post_name||t.post_truncated_content})]}),(0,r.jsx)("div",{children:(0,r.jsx)(F.T,{interactive:!1,content:(0,D.s4)(t.created_at),children:(0,r.jsx)("span",{className:"text-default text-sm",children:i})})})]}),"tiptap"===t.editor?(0,r.jsx)(R.G,{tiptapBody:t.tiptap_body},t.updated_at):(0,r.jsx)(U.P,{content:t.body_trix_content})]})]})},q=function(){var e=(0,P.E)(),t=e.member,n=e.onClose,o=(0,N.F)({memberPublicId:t.public_uid}),i=o.fetchNextPage,s=o.comments,l=o.hasNextPage;return o.isLoading?(0,r.jsx)(I.m,{}):s.length<1?(0,r.jsx)(A.Z,{title:(0,a.t)("profile_drawer.comments.empty_state.title"),subtitle:(0,a.t)("profile_drawer.comments.empty_state.subtitle")}):(0,r.jsx)(k.Z,{style:{overflow:"initial"},scrollThreshold:.5,next:i,hasMore:!!l,loader:(0,r.jsx)(I.m,{}),dataLength:s.length,scrollableTarget:eM,className:"divide-primary space-y-2 divide-y",children:s.map(function(e){return(0,r.jsx)(B,{onClose:function(){return null==n?void 0:n()},comment:e,member:t},e.id)})})},z=n(171832),Z=n(573384),V=n(441342),H=n(257210),W=n(62025),Q=function(){var e=(0,P.E)().member,t=(0,W.t)({memberPublicId:e.public_uid}),n=t.fetchNextPage,o=t.posts,i=t.data,s=t.hasNextPage,l=t.isLoading,c=t.onPostChange;if(l)return(0,r.jsx)(I.m,{});if(o.length<1)return(0,r.jsx)(A.Z,{title:(0,a.t)("profile_drawer.posts.empty_state.title"),subtitle:(0,a.t)("profile_drawer.posts.empty_state.subtitle")});var u=null==i?void 0:i.pages.map(function(e){return e.records.map(function(e){return e.id})});return(0,r.jsx)(H._x,{perPagePostIds:u,children:(0,r.jsx)(Z.Fk,{hasNextPage:!!s,children:(0,r.jsx)(k.Z,{style:{overflow:"initial"},scrollThreshold:.5,next:n,hasMore:!!s,loader:(0,r.jsx)(I.m,{}),dataLength:o.length,scrollableTarget:eM,className:"space-y-2",children:o.map(function(e){return(0,r.jsx)(V.mE,{spaceId:e.space_id,children:(0,r.jsx)(z.Y,{onPostChange:c,post:e,shouldForceSamePageInteractions:!1,usedIn:"profile-modal",className:"!rounded-2xl"},e.id)},e.id)})})})})},G=n(674776),$=n(987132),K=n(131906),J=n(93199),X=n(698173),Y="rewards",ee=function(e){var t,n,r=(0,K.useInfiniteQuery)([Y,e],function(t){var n,r=t.pageParam;return n=void 0===r?1:r,(0,J.UT)(X.a.gamification.pointAwards({params:{member_id:e,page:n}}))},{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),a=(0,o.useMemo)(function(){var e,t;return r.isLoading?[]:(0,i.uniqBy)((0,i.flatten)(null!=(t=null==(e=r.data)?void 0:e.pages.map(function(e){return e.records}))?t:[]),function(e){return"".concat(e.id,"-").concat(e.event_name)})},[r.data]);return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},r),n=n={rewards:a},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t},et=function(e){var t=e.pointAwardId,n=(0,K.useQueryClient)();return(0,K.useMutation)({mutationFn:function(){return(0,J.pC)(X.a.gamification.revokePointAward({pointAwardId:t}))},onSuccess:function(){n.invalidateQueries({queryKey:[Y]})}})},en=n(78456),er=n(134870),eo=n(957363),ei=n(60878),ea=n(943544),es=n(39905),el=n(434519),ec="profile_drawer.rewards",eu=function(e){var t=e.isOpen,n=e.onClose,o=e.onConfirm,i=e.points,s=e.isLoading;return(0,r.jsxs)(el.u_,{isOpen:t,onClose:n,children:[(0,r.jsx)(el.u_.Overlay,{}),(0,r.jsxs)(el.u_.Content,{size:"md",children:[(0,r.jsx)(el.u_.Header,{children:(0,r.jsx)(el.u_.Title,{children:(0,a.t)("".concat(ec,".revoke_confirmation.title"))})}),(0,r.jsx)(el.u_.Body,{children:(0,r.jsx)("div",{className:"flex flex-col gap-4",children:(0,r.jsx)(O.Z.BodyMd,{color:"text-default",children:(0,a.t)("".concat(ec,".revoke_confirmation.description"),{points:Math.abs(i)})})})}),(0,r.jsx)(el.u_.Footer,{children:(0,r.jsxs)("div",{className:"flex justify-end gap-x-3",children:[(0,r.jsx)(es.z,{variant:"secondary",onClick:n,children:(0,a.t)("cancel")}),(0,r.jsx)(es.z,{onClick:o,disabled:s,children:(0,a.t)("".concat(ec,".revoke_confirmation.confirm"))})]})})]})]})};function ed(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ef="profile_drawer.rewards",em=function(e){var t,n=e.reward,i=(0,V.wh)().currentCommunityMember,s=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return ed(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ed(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=s[0],c=s[1],u=(0,ei.pm)(),d=n.points,f=n.triggered_at,m=n.reason,p=n.id,b=n.event_name,h=n.revoked,v=(0,$.default)(f),y=(0,er.w)({dateTime:v,format:er.f.short_month_and_date_with_year}),g=et({pointAwardId:p}),x=g.mutate,_=g.isLoading,j="gamification.member.points_revoked"===b,w=(0,en.vb)(i);return(0,r.jsxs)("div",{className:"border-primary mt-3 flex items-center justify-between border-b pb-3 pt-2 first:mt-0 last:border-b-0",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("div",{children:(0,r.jsx)(O.Z.LabelSm,{weight:"semibold",color:"text-dark",children:(0,a.t)("".concat(ef,".n_points"),{points:j?"-"+d:"+"+d})})}),(0,r.jsxs)("div",{className:"text-default flex items-center gap-1",children:[(0,r.jsx)("div",{children:(0,r.jsx)(O.Z.LabelSm,{weight:"regular",color:"text-default",children:(0,a.t)("".concat(ef,".").concat(j?"revoked":"rewarded"),{date:y})})}),n.reason&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-[10px]",children:(0,a.t)("separator_dot")}),(0,r.jsx)(O.Z.LabelSm,{weight:"regular",color:"text-default",children:m})]})]})]}),!j&&!h&&w&&(0,r.jsx)(ea.Lt,{buttonClassName:"flex items-center h-9 w-9 flex justify-center !rounded-lg p-1 transition-colors duration-150 hover:bg-tertiary focus-visible:outline-secondary focus-visible:rounded-lg focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:bg-tertiary",button:(0,r.jsx)(eo.JO,{className:"text-default",type:"20-menu-dots-horizontal",size:20,"aria-label":(0,a.t)("".concat(ef,".actions"))}),children:(0,r.jsx)(ea.Lt.ItemLink,{onClick:function(){return c(!0)},forceClose:!0,children:(0,a.t)("".concat(ef,".revoke_points"))})}),(0,r.jsx)(eu,{isOpen:l,onClose:function(){return c(!1)},onConfirm:function(){x(void 0,{onSuccess:function(){u.success((0,a.t)("".concat(ef,".revoke_success"))),c(!1)},onError:function(){u.error((0,a.t)("".concat(ef,".revoke_error")))}})},points:d,isLoading:_})]})},ep=function(){var e=ee((0,P.E)().member.id),t=e.rewards,n=e.fetchNextPage,o=e.hasNextPage;return e.isLoading?(0,r.jsx)(I.m,{}):t.length<1?(0,r.jsx)(G.Z,{title:(0,a.t)("profile_drawer.rewards.empty_state.title"),subtitle:(0,a.t)("profile_drawer.rewards.empty_state.subtitle")}):(0,r.jsx)(k.Z,{style:{overflow:"initial"},scrollThreshold:.5,next:n,hasMore:!!o,loader:(0,r.jsx)(I.m,{}),dataLength:t.length,scrollableTarget:eM,children:t.map(function(e){return(0,r.jsx)(em,{reward:e},e.id+e.event_name)})})},eb=n(988159),eh=n(22319),ev=n(151433),ey=n(282859),eg=n(280219),ex=function(e){var t=e.onClose,n=e.space,o=n.emoji,i=n.custom_emoji_url,s=n.custom_emoji_dark_url,l=n.hide_members_count,c=n.name,u=n.slug,d=n.member_count,f=n.is_private,m=n.show_lock_icon_for_non_members,p=n.is_space_member,b=(0,eh.TC)().currentAppearance,h=(0,V.wh)().currentCommunityMember,v=(0,en.vb)(h),y=(0,ev.$)({shouldShowLockIconForNonMembers:m&&!p,isPrivate:f,isAdmin:v});return(0,r.jsxs)(E.rU,{to:(0,L._v)({spaceSlug:u}),onClick:function(e){return!(0,ey.n2)(e)&&t()},className:"hover:bg-secondary bg-primary flex items-center space-x-3 rounded-md px-4 py-3.5",children:[(0,r.jsx)(eg.S,{wrapperClassName:"profile-spaces__emoji self-start",className:"gated-or-not with-emoji",emoji:o,customEmojiUrl:i,customEmojiDarkUrl:s,appearance:b,shouldUseLockIcon:y,lockIcon:(0,r.jsx)("span",{className:"gated-or-not",children:(0,r.jsx)(eo.JO,{type:"lock",useWithFillCurrentColor:!0,className:"text-dark"})})}),(0,r.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,r.jsx)("span",{className:"text-darkest leading-none",children:(0,r.jsx)(O.Z.LabelMd,{weight:"semibold",children:c})}),!l&&(0,r.jsx)("span",{className:"text-light leading-none",children:(0,r.jsx)(O.Z.LabelSm,{children:(0,a.t)("profiles.members",{count:d})})})]})]})},e_=function(){var e=(0,P.E)(),t=e.member,n=e.onClose,o=(0,eb.u)({memberPublicId:t.public_uid}),i=o.spaces,s=o.isLoading,l=o.fetchNextPage,c=o.hasNextPage;return s?(0,r.jsx)(I.m,{}):i.length<1?(0,r.jsx)(A.Z,{title:(0,a.t)("profile_drawer.spaces.empty_state.title"),subtitle:(0,a.t)("profile_drawer.spaces.empty_state.subtitle")}):(0,r.jsx)(k.Z,{scrollThreshold:.5,next:l,hasMore:!!c,loader:(0,r.jsx)(I.m,{}),dataLength:i.length,scrollableTarget:eM,children:i.map(function(e){return(0,r.jsx)(ex,{onClose:function(){return null==n?void 0:n()},space:e},e.id)})})},ej=n(786976),ew=n(396354),eO=n(316026),eS=n(999896),eP=n(169594),eC=function(e){var t=null==e?void 0:e.connection_to_current_community_member;return t&&"detached"!==t.status&&"ignored"!==t.status&&"withdrawn"!==t.status?(null==t?void 0:t.status)==="active"?(0,a.t)("profile_drawer.connect_banner.description.connected",{date:(0,er.w)({dateTime:new Date(e.connection_to_current_community_member.created_at),format:er.f.long_date})}):(null==t?void 0:t.status)==="pending"?t.initiator.id===e.id?(0,a.t)("profile_drawer.connect_banner.description.received",{memberName:e.first_name}):(0,a.t)("profile_drawer.connect_banner.description.sent",{memberName:e.first_name}):"":(0,a.t)("profile_drawer.connect_banner.description.default",{memberName:e.first_name})},ek=function(e){var t,n,o=e.recommendationId,i=(0,P.E)().member,s=(0,V.wh)().currentCommunityMember,l=(0,g.kK)(),c=i.connection_to_current_community_member,u=(0,eO.N)(c).isOtherUserSentConnection;return(0,r.jsxs)("div",{className:"border-primary mb-7 rounded-2xl border px-5 py-3 shadow-md",children:[(0,r.jsxs)("div",{className:"flex w-full flex-col gap-3 md:flex-row md:items-center md:justify-between md:gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"size-9 overflow-hidden rounded-full",children:(0,r.jsx)(M.s,{size:"9",name:null!=(t=null==i?void 0:i.name)?t:"",src:null==i?void 0:i.avatar_url})}),(0,r.jsx)("div",{className:"relative -ml-3 flex size-10 items-center justify-center overflow-hidden rounded-full bg-white",children:(0,r.jsx)("div",{className:"size-9 overflow-hidden rounded-full",children:(0,r.jsx)(M.s,{size:"9",name:null!=(n=null==s?void 0:s.name)?n:"",src:null==s?void 0:s.avatar_url})})})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col justify-center",children:[(0,r.jsx)(O.Z.LabelSm,{weight:"semibold",children:(0,a.t)("profile_drawer.connect_banner.title")}),(0,r.jsx)(O.Z.BodyXs,{children:eC(i)})]})]}),u&&(null==c?void 0:c.note)&&(0,r.jsx)("div",{className:"flex md:hidden",children:(0,r.jsx)(eP.H,{note:c.note,lineClamp:2,collapse:!0,className:"!m-0"})}),(0,r.jsx)("div",{className:"w-fit",children:(0,r.jsx)(eS.w,{member:i,shouldShowAcceptAtLeft:l,recommendationId:o})})]}),u&&(null==c?void 0:c.note)&&(0,r.jsx)("div",{className:"hidden md:flex",children:(0,r.jsx)(eP.H,{note:c.note,lineClamp:1,collapse:!0})})]})},eI=n(259092);function eN(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var eA=["posts","comments","spaces","about","rewards"],eM="profile-scrollable-target",eT=function(e){var t,n=e.recommendationId,c=(0,P.E)(),u=c.member,d=c.isFullPageView,f=(0,V.wh)().currentCommunityMember,m=(t=(0,o.useState)("about"),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return eN(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eN(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=m[0],b=m[1],h=(0,ej.c8)().data,v=(0,l.y)(),y=(null==f?void 0:f.id)===u.id,g=(0,en.vb)(f),x=(y||(null==h?void 0:h.is_member_rewards_tab_public)||g)&&(null==h?void 0:h.enabled),_=(0,ew.t)().tab;return(0,o.useEffect)(function(){(0,i.isString)(_)&&-1!==eA.findIndex(function(e){return e===_})&&b(_)},[_]),(0,r.jsxs)("div",{className:(0,s.A)("bg-primary flex flex-col overflow-auto",{"!md:pl-14 w-full p-4 !pl-8 md:w-2/3 md:p-8":d,"col-span-12 p-8 md:col-span-8":!d}),children:[v&&!y&&(0,r.jsx)(ek,{recommendationId:n}),(0,r.jsxs)("div",{className:"mb-2 flex items-center space-x-2 overflow-x-auto pb-4","data-testid":"tab-list",children:[(0,r.jsx)(eI.E,{onClick:function(){return b("about")},title:(0,a.t)("profile_drawer.about"),isActive:"about"===p}),(0,r.jsx)(eI.E,{onClick:function(){return b("posts")},title:(0,a.t)("profile_drawer.posts.title"),isActive:"posts"===p,count:u.posts_count}),(0,r.jsx)(eI.E,{onClick:function(){return b("comments")},title:(0,a.t)("profile_drawer.comments.title"),isActive:"comments"===p,count:u.comments_count}),(0,r.jsx)(eI.E,{onClick:function(){return b("spaces")},title:(0,a.t)("profile_drawer.spaces.title"),isActive:"spaces"===p,count:u.spaces_count}),x&&(0,r.jsx)(eI.E,{onClick:function(){return b("rewards")},title:(0,a.t)("profile_drawer.rewards.title"),isActive:"rewards"===p})]}),(0,r.jsx)("div",{id:eM,className:"flex-1 overflow-auto pb-6","data-testid":"profile-modal-tab-content",children:(0,r.jsx)({posts:Q,comments:q,spaces:e_,about:C,rewards:x?ep:function(){return null}}[p],{})})]})},eE=n(619803),eR=n.n(eE),eD=n(709397),eL=n(756993),eF=n(903225),eU=n(786518),eB=n(861853),eq=n(144102),ez=n(925820),eZ=n(260622),eV=n(905326),eH=n(403697),eW=n(857487),eQ=n(271561);function eG(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var e$=function(){var e=(0,V.wh)().currentCommunitySettings,t=null==e?void 0:e.live_pulse_block_dms_enabled,n=(0,V.wh)(),o=n.isViewOnlyMasquerading,s=n.currentCommunityMember,l=(0,eV.p)().findOrCreateChatRoom,c=(0,eB.nC)().setLiveChatRoomUuid,u=(0,eF.k6)(),d=(0,P.E)(),f=d.member,m=d.onClose,p=d.refetchProfileInfo,b=(0,K.useQueryClient)(),h=(0,eQ.U)({onSuccess:function(){null==p||p(),b.invalidateQueries(["blocked-members-list"])},memberName:f.name}),v=h.blockMember,y=h.isBlocking,g=h.unBlockMember,x=h.isUnblocking,_=h.isBlockDmsModalOpen,j=h.setIsBlockDmsModalOpen,w=(0,ez.w)({memberPublicId:f.public_uid,member:f,isFullPageProfile:!1,shouldHideMessageButton:!1}),O=w.onClickOpenEditProfileDrawer,S=w.shouldShowMemberChatIcon,C=w.canEditProfile,k=w.canViewOnlyMasquerade,I=w.handleCopyProfileLink,N=f.id===(null==s?void 0:s.id),A=t&&!(N||o||f.admin),M=[];S&&M.push({label:(0,a.t)("message"),icon:"chat",onClick:o?i.noop:function(){var e;return(e=function(){var e;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return[4,l({kind:eH.g8,community_member_ids:[f.id]})];case 1:if(!(e=t.sent()))return[2];if(u.location.pathname.includes("/live"))return c(e),[2];return u.push((0,L.co)({url:(0,L.so)({uuid:e})})),null==m||m(),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){eG(i,r,o,a,s,"next",e)}function s(e){eG(i,r,o,a,s,"throw",e)}a(void 0)})})()},isPrimary:!0,testId:"chat-button",variant:"primary"}),(N||C)&&M.push({label:(0,a.t)("profile_drawer.edit"),icon:"16-edit",onClick:O,isPrimary:!M.some(function(e){return e.isPrimary}),testId:"edit-profile-button",variant:M.some(function(e){return e.isPrimary})?"secondary":"primary"}),k&&M.push({label:(0,a.t)("post.share.view_as",{member_first_name:f.first_name}),icon:"16-eye-open",onClick:function(){(0,eq.g)({entityId:f.id,entityType:"CommunityMember"}).then(function(e){return window.open(e.masquerade_url,"_self")}).catch(function(e){return console.error(e)})},testId:"view-only-masquerade-button"}),M.push({label:(0,a.t)("post.share.copy_link_to_profile"),icon:"16-link",onClick:I,testId:"copy-profile-link-button"}),A&&(f.is_blocked_by_current_community_member?M.push({label:(0,a.t)("messaging.unblock_direct_messages"),icon:"20-circle-check",iconSize:20,onClick:function(){return!x&&g({memberId:f.id})},testId:"unblock-direct-messages-button"}):M.push({label:(0,a.t)("messaging.block_direct_messages"),icon:"20-block-dms",iconSize:20,iconClassName:"text-feedback-error",onClick:function(){return j(!0)},testId:"block-direct-messages-button",textColor:"text-feedback-error"}));var T=M.find(function(e){return e.isPrimary}),E=M.filter(function(e){return!e.isPrimary});return(0,r.jsxs)(eZ.T,{children:[(0,r.jsxs)("div",{className:"flex space-x-3",children:[T&&(0,r.jsx)(es.z,{variant:T.variant,onClick:T.onClick,"aria-label":T.label,"data-testid":T.testId,large:!0,children:T.label}),E.length>0&&(1===E.length?(0,r.jsx)(es.z,{variant:"secondary",onClick:E[0].onClick,"aria-label":E[0].label,"data-testid":E[0].testId,large:!0,className:"!px-2.5",children:(0,r.jsx)(eo.JO,{type:E[0].icon,size:16,useWithFillCurrentColor:!0})}):(0,r.jsx)(eW.m,{actions:E}))]}),(0,r.jsx)(eU._,{showModal:_,onClose:function(){return j(!1)},onConfirm:function(){v({memberId:f.id}),j(!1)},memberName:f.name,isLoading:y})]})},eK=function(e){var t=e.iconType,n=e.iconProps,o=e.info,i=e.dataTestId,a=e.className,s=e.iconClassName,l=e.color;return o?(0,r.jsxs)("div",{className:eR()("flex items-start space-x-1.5 whitespace-pre-line [word-break:break-word]",void 0===a?"":a),"data-testid":i,children:[t?(0,r.jsx)(eo.JO,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({useWithFillCurrentColor:!0,className:void 0===s?"":s,type:t,size:16},void 0===n?{}:n)):null," ",(0,r.jsx)(O.Z.LabelSm,{color:void 0===l?"text-default":l,weight:"regular",children:o})]}):null},eJ=n(285122),eX=n(308683),eY=n(381040),e0=function(){var e,t,n,o,i=(0,P.E)(),l=i.member,c=i.isLoading,u=(0,p.Y)({enabled:!c,member_ids:[null==l?void 0:l.id]}).data,d=null==u?void 0:u[0],f=null==l||null==(o=l.member_tags)?void 0:o.filter(function(e){var t;return(null==e?void 0:e.is_public)&&(null==e||null==(t=e.display_locations)?void 0:t.profile_page)}),m=(null==f?void 0:f.length)>0,b=(0,eL.O)(null==d?void 0:d.current_level);return(0,r.jsxs)("div",{className:(0,s.A)("flex flex-col items-center px-4 py-9 pb-0",(e={},t=b.bgGradient,n=!!d,t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e)),"data-testid":"profile-modal-header",children:[(0,r.jsx)(eD.i,{name:l.name,avatarUrl:l.avatar_url,size:"large",level:null==d?void 0:d.current_level,progress:null==d?void 0:d.level_progress}),(0,r.jsxs)("div",{className:"mt-4 flex flex-col items-center space-y-2 px-4 text-center",children:[(0,r.jsx)(O.Z.LabelLg,{weight:"semibold",color:"text-dark","data-testid":"member-name",children:l.name}),l.is_blocked_by_current_community_member&&(0,r.jsx)(eY.g,{}),l.last_seen_at&&(0,r.jsx)(eK,{iconType:"16-clock",info:(0,a.t)("profile_drawer.last_seen",{last_seen:(0,eX.TF)(l.last_seen_at)}),dataTestId:"profile-member-email",className:"text-light"}),(0,r.jsx)(eK,{iconType:"16-calendar",info:(0,a.t)("profile_drawer.member_since",{member_since:(0,eJ.ie)(l.created_at,{month:"long",year:"numeric",day:"numeric"})}),dataTestId:"profile-member-since",className:"text-light"})]}),m&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(w.m,{limit:1/0,memberTags:f,className:"justify-center"})}),(0,r.jsx)("div",{className:"mt-7",children:(0,r.jsx)(e$,{})})]})},e1=function(){var e=(0,P.E)(),t=e.isLoading,n=e.isFullPageView;return t?null:(0,r.jsx)("div",{className:eR()("border-primary bg-primary overflow-auto border-r",n?"w-full md:w-1/3":"col-span-full md:col-span-4"),children:(0,r.jsx)(e0,{})})},e2=n(637538),e3=n(478188),e6=n(982942),e5=n(739265),e4=function(e){var t=e.isFullPageView;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e6.J,{isFullPageView:t}),(0,r.jsxs)("div",{className:eR()("col-span-12 flex flex-col overflow-auto px-4 pb-9 md:col-span-8 md:p-8",{"!md:pl-14 pl-4":t}),children:[(0,r.jsx)(e5.y,{}),(0,r.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,r.jsx)(e3.t,{}),(0,r.jsx)(e3.t,{}),(0,r.jsx)(e3.t,{}),(0,r.jsx)(e3.t,{})]})]})]})},e7=function(e){var t=e.member,n=e.isLoading,o=e.isFullPageView,i=e.onClose,a=e.recommendationId,s=e.refetchProfileInfo;return(0,r.jsx)(P.w,{isFullPageView:void 0!==o&&o,member:t,isLoading:n,onClose:i,refetchProfileInfo:s,children:t?t.is_deleted?(0,r.jsx)(e2.d,{wrapperClassName:"text-dark col-span-full"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e1,{}),(0,r.jsx)(eT,{recommendationId:a})]}):(0,r.jsx)(e4,{})})}},31960:function(e,t,n){n.d(t,{E:()=>s,w:()=>l});var r=n(552676),o=n(275271),i=n(932699),a=(0,o.createContext)({member:null,isLoading:!0,isFullPageView:!1,onClose:function(){},refetchProfileInfo:function(){}});a.displayName="ProfileContext";var s=function(){return(0,o.useContext)(a)},l=function(e){var t=e.member,n=e.isFullPageView,o=e.isLoading,s=e.children,l=e.onClose,c=void 0===l?i.noop:l,u=e.refetchProfileInfo;return(0,r.jsx)(a.Provider,{value:{member:t,isLoading:o,isFullPageView:void 0!==n&&n,onClose:c,refetchProfileInfo:u},children:s})}},119614:function(e,t,n){n.d(t,{M:()=>m});var r=n(552676),o=n(275271),i=n(787086),a=n(932699),s=n(160027),l=n(125533),c=n(739792),u=n(957363),d=n(39905);function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var m=function(e){var t,n=e.cancelButtonText,m=void 0===n?(0,c.t)("quick_post.scheduled_post_ui.cancel"):n,p=e.children,b=e.className,h=e.datePickerVisible,v=e.enableTime,y=void 0===v||v,g=e.minDate,x=void 0===g?new Date:g,_=e.onCancel,j=e.onClickOutside,w=e.onSave,O=e.placement,S=e.saveButtonVariant,P=e.appendTo,C=e.value,k=(t=(0,o.useState)(C),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return f(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),I=k[0],N=k[1];return(0,r.jsx)(i.ZP,{placement:void 0===O?"top-end":O,className:b,onClickOutside:j,content:(0,r.jsxs)("div",{className:"bg-primary border-primary rounded-lg border shadow-xl",style:{maxWidth:"284px"},children:[(0,r.jsx)(l.default,{options:{enableTime:y,dateFormat:y?"F d, Y G:i K":"F d, Y",disableMobile:!0,inline:!0,altInput:!0,altInputClass:"hidden",minDate:x,animate:!1,prevArrow:(0,s.renderToString)((0,r.jsx)(u.JO,{type:"20-chevron-left",size:20})),nextArrow:(0,s.renderToString)((0,r.jsx)(u.JO,{type:"20-chevron-right",size:20})),minuteIncrement:y?1:void 0},value:C,onValueUpdate:function(e){if((0,a.first)(e)){var t=e[0];y?N(t.toISOString()):N(new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),12,0,0)).toISOString())}}}),(0,r.jsxs)("div",{className:"border-primary flex gap-3 border-t px-5 py-3",children:[(0,r.jsx)(d.z,{type:"button",variant:"secondary",onClick:_,full:!0,children:m}),(0,r.jsx)(d.z,{type:"button",variant:void 0===S?"primary":S,disabled:!I,onClick:function(e){e&&e.preventDefault(),w(I)},full:!0,children:(0,c.t)("quick_post.scheduled_post_ui.save")})]})]}),visible:h,allowHTML:!0,interactive:!0,duration:0,arrow:!1,delay:0,theme:"modal-footer-actions",appendTo:P||"parent",children:(0,r.jsx)("div",{children:p})})}},7011:function(e,t,n){n.d(t,{Y:()=>eh});var r=n(552676),o=n(240507),i=n.n(o),a=n(932699),s=n(903225),l=n(739792),c=n(251630),u=n(403697),d=n(941084),f=n(283095),m=n(441342),p=n(767900),b=n(751169),h=n(60878),v=n(275271),y=n(227851),g=n(39905),x=function(e){var t=e.submitDisabled,n=e.post,o=e.isSubmitting,i=!!n.id,a=["quick_post","scheduled_post_ui"];a.push(o?"submitting_button":"submit_button"),n.status!==d.lv?a.push("publish_post"):a.push(i?"save":"post");var s=(0,l.t)(a.join("."));return(0,r.jsx)(g.z,{type:"submit",variant:"primary",disabled:t,children:s})};x.propTypes={post:i().object.isRequired,submitDisabled:i().bool.isRequired,isSubmitting:i().bool.isRequired};var _=n(60589),j=n(117617),w=n(619803),O=n.n(w),S=n(119614),P=n(624804),C=n(134870),k=n(957363),I=n(920220);function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var A=function(e){var t,n=e.publishedAt,o=e.updatePublishedAt,i=e.status,a=e.revertToDraftState,s=(t=(0,P.k)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,3)||function(e,t){if(e){if("string"==typeof e)return N(e,3);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}}(t,3)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=s[0],c=s[1],u=s[2],f=(0,v.useMemo)(function(){return n?(0,C.w)({dateTime:new Date(n),format:"date_time_with_short_timezone"}):null},[n]);return i!==d.W3?null:(0,r.jsx)(S.M,{value:n,datePickerVisible:l,onCancel:function(){event&&event.preventDefault(),u(!1)},onSave:function(e){o(e),u(!1)},children:(0,r.jsx)(I.C,{onButtonClick:function(e){e&&e.preventDefault(),c()},onClick:function(e){e&&e.preventDefault(),a(),u(!1)},children:(0,r.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,r.jsx)(k.JO,{type:"16-calendar",className:"text-default",size:16}),(0,r.jsx)("span",{className:"font-medium",children:f})]})})})};A.propTypes={publishedAt:i().string,status:i().string.isRequired,updatePublishedAt:i().func.isRequired,revertToDraftState:i().func.isRequired};var M=n(805765);function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var E=function(e){var t,n=e.submitDisabled,o=e.isSubmitting,i=void 0!==o&&o,s=e.datepickerPlacement,c=void 0===s?"top":s,u=function(e){var t=["quick_post","scheduled_post_ui"];return t.push(i?"submitting_button":"submit_button"),t.push(e),(0,l.t)(t.join("."))},d={icon:"16-download",label:u("save_draft"),value:"draft"},f={icon:"16-calendar",label:u("schedule_post"),value:"scheduled"},m=[d,f,{icon:"16-publish",label:u("publish_post"),value:"published"}],p=(0,y.Gc)(),b=p.watch,h=p.setValue,v=b(),g=v.published_at,x=v.status,_=(t=(0,P.k)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,3)||function(e,t){if(e){if("string"==typeof e)return T(e,3);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}}(t,3)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),j=_[0],w=_[2],C=(0,a.find)(m,{value:x}),k=function(e){h("published_at",e)},I=function(e){(null==e?void 0:e.value)===f.value?w(!0):(h("status",null==e?void 0:e.value),w(!1),k(null))},N=function(){I(d)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A,{publishedAt:g,updatePublishedAt:k,status:x,revertToDraftState:N}),(0,r.jsx)(S.M,{datePickerVisible:j,onCancel:function(e){e&&e.preventDefault(),w(!1),x===f.value&&N()},value:g,onSave:function(e){k(e),h("status",f.value),w(!1)},className:O()({"-bottom-11":"top"===c,"-top-7":"bottom"===c}),children:j?(0,r.jsx)("span",{}):(0,r.jsx)(M.F,{type:"submit",disabled:void 0!==n&&n,selectedAction:C,setSelectedAction:I,options:m})})]})},R=function(e){var t=e.post,n=e.space,o=e.submitDisabled,i=e.isSubmitting,a=e.datepickerPlacement,s=!(0,j.Fs)()&&n&&(0,_.k8)(n)&&!(0,d.Hz)(t);return(0,r.jsx)(r.Fragment,{children:s?(0,r.jsx)(E,{submitDisabled:o,isSubmitting:i,datepickerPlacement:a}):(0,r.jsx)(x,{post:t,submitDisabled:o,isSubmitting:i})})};R.propTypes={post:i().object.isRequired,space:i().object,submitDisabled:i().bool.isRequired,isSubmitting:i().bool.isRequired,datepickerPlacement:i().string};var D=n(531829),L=n(212635),F=n(250420),U=n(493025),B=n(274343),q=n(673327),z=n(617013),Z=n(237919),V=n(206394),H=n(805116),W=n(405521),Q=function(e){var t=e.space,n=e.showAddCoverBtn,o=(0,(0,y.Gc)().watch)("id")?void 0:(0,W.k)();return(0,r.jsxs)("div",{className:"quickpost-modal__post-form",children:[(0,d.J4)(t)&&(0,r.jsx)("div",{className:"quickpost-modal__cover-image-container",children:(0,r.jsx)(V.D,{name:"cover_image",alt:"",showAddCoverBtn:n})}),(0,d.tp)(t)&&(0,r.jsx)("div",{className:"form-section__title-input",children:(0,r.jsx)(Z.D,{ref:o,name:"name",autoComplete:"title",placeholder:(0,l.t)("quick_post_v2.title_placeholder"),maxLength:"255",size:"255",type:"text",id:"post_name",tabIndex:0})}),(0,r.jsx)("div",{className:"trix-content trix-content--post",children:(0,r.jsx)(H.O,{ref:(0,d.tp)(t)?void 0:o,preventAccidentalLeave:!1,id:"post_body",name:"body",is_private_space:!1,space_id:t&&t.id,placeholder:(0,l.t)("quick_post_v2.body_placeholder"),tabIndex:0})})]})},G=n(227053),$=n(78456),K=n(813248),J=n(773262),X=n(61641),Y=n(330889);function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function et(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var en=(0,v.forwardRef)(function(e,t){return(0,r.jsx)("textarea",et(ee({},e),{ref:t}))});en.displayName="TextArea";var er=(0,v.forwardRef)(function(e,t){return(0,r.jsx)("input",et(ee({},e),{ref:t}))});er.displayName="Input";var eo=function(e){var t=e.name,n=e.variant,o=e.label,i=void 0===o?"":o,a=e.description,s=void 0===a?"":a,l=e.autofocus,c=e.fullWidth;i=i||I18n.t("post.".concat(t)),s=s||I18n.t("post.".concat(t,"_description"));var u=(0,y.Gc)().register,d="post_".concat(t),f=er;return"textarea"===(void 0===n?"":n)&&(f=en),(0,r.jsxs)("div",{className:w("form-group",{"form-group--column":void 0!==c&&c}),children:[(0,r.jsx)(Y.Q,{field:d,label:i,description:s}),(0,r.jsx)("div",{className:"form-input",children:(0,r.jsx)(f,et(ee({},u(t)),{id:d,className:"form-control placeholder:text-light placeholder:opacity-100",name:t,autofocus:void 0!==l&&l}))})]})},ei=["meta_title","meta_description","opengraph_title","opengraph_description"],ea=function(){return(0,r.jsxs)("div",{className:"form-section","data-controller":"toggle",children:[(0,r.jsx)("div",{className:"form-section__header has-toggle",children:(0,r.jsx)("button",{type:"button","data-action":"click->toggle#toggle","data-target":"toggle.toggleTrigger","data-open":"false",className:"block-toggle",children:(0,l.t)("meta_tag_attributes.meta_tags")})}),(0,r.jsxs)("div",{className:"form-section__content","data-target":"toggle.toggleable",children:[ei.map(function(e){return(0,r.jsx)(eo,{id:e,label:(0,l.t)("meta_tag_attributes.".concat(e)),description:(0,l.t)("meta_tag_attributes.".concat(e,"_description"),{obj:"post"}),name:"meta_tag_attributes.".concat(e)},e)}),(0,r.jsxs)("div",{className:"form-group form-group--two-columns",children:[(0,r.jsx)(Y.Q,{field:"opengraph_image",label:(0,l.t)("meta_tag_attributes.open_graph_image")}),(0,r.jsx)(X.a,{name:"meta_tag_attributes.opengraph_image",aspectRatio:u.pI.OPEN_GRAPH})]})]})]})},es=function(e){var t=e.name;return(0,r.jsx)(p.l.Item,{id:"post_".concat(t),name:t,label:(0,l.t)("post.".concat(t)),hideBorder:!0,hideDescription:!0,inlineReverse:!0,children:(0,r.jsx)(p.l.ToggleSwitch,{variant:"small"})})};es.propTypes={name:i().string.isRequired};var el=function(e){var t=e.space,n=(0,G.m)().post,o=(0,y.Gc)().watch,i=o("created_at"),a=o("is_comments_disabled"),s=!!(0,_.k8)(t||{}),c=(0,m.nT)().helpers.spacesWithPostCreationAllowed(),u=(0,m.wh)().currentCommunityMember,f=new Date().toUTCString(),h=(0,K.k)({enabled:(0,$.vb)(u)}),v=h.data,g=h.isLoading,x=!!n.id&&(0,d.Hz)(n);return g?(0,r.jsx)(b.a,{}):(0,r.jsx)("div",{className:"settings-menu__wrapper",children:(0,r.jsx)("div",{className:"form-wrapper quickpost-modal__form-settings",children:(0,r.jsxs)("div",{className:"form-content",children:[(0,r.jsxs)("div",{className:"-space-y-2",children:[(0,r.jsx)(es,{name:"hide_meta_info"}),(0,r.jsx)(es,{name:"is_comments_disabled"}),!a&&(0,r.jsx)(es,{name:"is_comments_closed"}),(0,r.jsx)(es,{name:"is_liking_disabled"}),(0,r.jsx)(es,{name:"is_truncation_disabled"}),x&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(es,{name:"pin_to_top"}),(0,r.jsx)(es,{name:"pinned_at"})]}),!t.hide_from_featured_areas&&(0,r.jsx)(es,{name:"hide_from_featured_areas"}),x&&(0,r.jsxs)("div",{className:"form-group form-group--column !mt-0",children:[(0,r.jsx)(Y.Q,{field:"created_at",label:(0,l.t)("publish_date"),description:(0,l.t)("publish_date_description")}),(0,r.jsx)(J.W,{name:"created_at",maxDate:f})]})]}),(0,r.jsx)(B.If,{condition:(0,d.rq)(t),children:(0,r.jsxs)("div",{className:"form-group form-group--two-columns",children:[(0,r.jsx)(Y.Q,{field:"cardview_thumbnail",label:(0,l.t)("cardview_thumbnail")}),(0,r.jsx)(X.a,{name:"cardview_thumbnail",aspectRatio:2})]})}),(0,$.vb)(u)&&(void 0===v?{}:v).internal_custom_html_enabled&&(0,r.jsx)(eo,{name:"internal_custom_html",variant:"textarea",fullWidth:!0}),(0,r.jsx)(p.l.Item,{name:"space_id",translationRoot:"post",fullWidth:!0,children:(0,r.jsx)(z.M,{name:"space_id",variant:"form-input",spaces:c})}),(0,r.jsx)(eo,{name:"slug",fullWidth:!0}),(0,r.jsx)(B.If,{condition:s,children:(0,r.jsx)(p.l.Item,{name:"user_id",translationRoot:"post",fullWidth:!0,children:(0,r.jsx)(p.l.CommunityMemberSelect,{direction:"up",valueField:"user_id"})})}),(0,r.jsx)(B.If,{condition:!!i,children:(0,r.jsx)(ea,{})})]})})})};function ec(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function eu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ec(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ec(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}el.propTypes={space:i().object.isRequired};var ed=function(e){var t=e.show,n=e.closeModal,o=eu((0,v.useState)(!1),2),i=o[0],a=o[1],s=eu((0,v.useState)(!1),2),c=s[0],d=s[1],p=eu((0,v.useState)(),2),b=p[0],h=p[1],g=(0,m.nT)(),x=(0,m.Zh)().helpers.postForTrixEditor(),w=(0,j.kK)(),O=g.helpers.isDataLoaded()&&x,S=g.helpers.basicSpacesWithPostCreationAllowed(),P=(0,y.Gc)(),C=P.watch,I=P.formState,N=I.dirtyFields,A=I.errors,M=I.isSubmitting,T=I.isDirty,E=I.isSubmitSuccessful,Z=C(),V=Z.space_id,H=Z.name,W=Z.body,G=Z.id,$=S.find(function(e){return e.id===V}),K=function(){a(!1)},J=!H&&!W||M||E,X=function(){Object.keys(N).length>0?confirm((0,l.t)("post.errors.unsaved_post_warning"))&&n():n()};(0,L.M)({enabled:!J}),(0,D.T)(T&&!E);var Y=!!G,ee=G?"Save":"Post";return(M||E)&&(ee=G?"Saving...":"Posting..."),(0,f.K)({cacheKey:u._7,fields:["name","body","space_id","cover_image"],enabled:!Y&&!E}),(0,r.jsxs)(q.Js,{show:t,onClose:X,fullscreen:!0,closeOnEscape:!i,trixMode:"quickpost-modal ".concat(c&&"quickpost-modal__fullpage"),children:[(0,r.jsxs)(q.Js.Header,{onClose:!i&&X,children:[(0,r.jsxs)("div",{className:"modal__header__inside",children:[(0,r.jsxs)("div",{className:"mr-4 flex items-center gap-4",children:[(0,r.jsxs)(B.If,{condition:!i,children:[(0,r.jsx)(B.If,{condition:!w,children:(0,r.jsx)("button",{type:"button",onClick:function(){return d(!c)},children:(0,r.jsx)(k.JO,{type:c?"shrink":"expand",size:16})})}),(0,r.jsx)(B.If,{condition:(0,_.Y_)($),children:(0,r.jsx)("button",{type:"button",onClick:function(){return a(!0)},children:(0,r.jsx)(k.JO,{type:"settings"})})})]}),(0,r.jsx)(B.If,{condition:!!i,children:(0,r.jsx)("button",{className:"flex",type:"button",onClick:K,children:(0,r.jsx)(k.JO,{type:"back-arrow-v2",size:16})})})]}),(0,r.jsxs)("div",{className:"modal__header--center",children:[(0,r.jsxs)("span",{className:"quickpost-modal__title",children:[(0,r.jsx)(B.If,{condition:i,children:(0,l.t)("post.post_settings")}),(0,r.jsxs)(B.If,{condition:!i,children:[Y?"Edit Post":"Create Post",(0,r.jsx)("span",{className:"title-separator",children:"/"})]})]}),(0,r.jsx)(B.If,{condition:!i,children:(0,r.jsx)(z.M,{spaces:S,name:"space_id",rules:{required:(0,l.t)("post.errors.space_is_required")}})})]}),(0,r.jsxs)("div",{className:"modal__header--right",children:[!i&&c&&O&&(0,r.jsx)("div",{className:"flex items-center justify-end gap-4",children:(0,r.jsx)(R,{post:x,space:$,submitDisabled:J,isSubmitting:M||E,datepickerPlacement:"bottom"})}),(0,r.jsx)(B.If,{condition:i,children:(0,r.jsx)("button",{type:"submit",onClick:K,className:"btn modal__btn--save",children:(0,l.t)("post.done")})})]})]}),(0,r.jsx)(B.If,{condition:!i,children:(0,r.jsx)(U.X,{errors:A})})]}),(0,r.jsx)(q.Js.Body,{children:(0,r.jsx)("div",{className:"form-section form-section__topic-content trix-v2",children:(0,r.jsxs)("div",{className:"form-section__content",onMouseEnter:function(){return h(!0)},onMouseLeave:function(){return h(!1)},children:[$&&(0,_.Y_)($)&&i&&(0,r.jsx)(el,{space:$,spaces:S}),(0,r.jsx)(F.L,{condition:!!i,children:(0,r.jsx)(Q,{space:$,showAddCoverBtn:b})})]})})}),!i&&!c&&(0,r.jsx)("div",{className:"quickpost-modal__footer",children:(0,r.jsx)("div",{className:"quickpost-modal__footer--actions h-8 gap-4",children:(0,r.jsx)(R,{post:x,space:$,submitDisabled:J,submitButtonText:ee,isSubmitting:M||E})})})]})};ed.propTypes={show:i().bool,closeModal:i().func};var ef=n(681111),em=function(e){var t=e.open,n=e.onClose,o=e.children,i=e.version,a=e.maxZIndexEnabled;return(0,r.jsx)(ef.V,{className:O()("z-150 standard-layout-modal fixed inset-0 md:overflow-y-auto",{"quick-post-wrapper--v2":2===(void 0===i?2:i)},{"z-2000":void 0!==a&&a}),open:t,onClose:n,children:(0,r.jsxs)("div",{className:"flex min-h-screen items-end justify-center px-4 pb-20 pt-4 text-center sm:block sm:p-0",children:[(0,r.jsx)(ef.V.Overlay,{className:"fixed inset-0 transition-opacity"}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true",style:{content:"&#8203;"}}),(0,r.jsx)("div",{children:o})]})})};function ep(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function eb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}em.propTypes={open:i().bool,onClose:i().func.isRequired,version:i().number,children:i().node,maxZIndexEnabled:i().bool};var eh=function(e){var t=e.maxZIndexEnabled,n=e.shouldSkipRedirectAfterSubmit,o=void 0!==n&&n,i=e.onSubmitSuccess,v=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["maxZIndexEnabled","shouldSkipRedirectAfterSubmit","onSubmitSuccess"]),y=v.show,g=v.closeModal,x=(0,m.nT)(),_=(0,m.Zh)(),j=_.helpers.postForTrixEditor(),w=x.helpers.isDataLoaded()&&_.record,O=(0,s.k6)(),S=(0,f.d)({cacheKey:u._7}).resetValues,P=(0,h.pm)(),C=P.success,k=P.error,I=function(e){var t=e.responseData,n=(0,d.RG)({post:t});_.onPostChange(t),O?(t.status===j.status?C((0,l.t)("quick_post.toasts.changes_saved")):C((0,l.t)("quick_post.toasts.".concat(t.status,"_saved"))),g(),S(),o||O.push(n)):(g(),S(),o||(window.location.href=n)),i&&i(t)},N=function(){j.id?k((0,l.t)("quick_post.toasts.failed_to_update")):k((0,l.t)("quick_post.toasts.failed_to_create"))},A=eb({status:d.lv},j);return w?(0,r.jsx)("div",{children:(0,r.jsx)(em,{open:y,onClose:a.noop,version:2,maxZIndexEnabled:void 0!==t&&t,children:(0,r.jsx)(p.l,{onSubmit:function(e){var t;return(t=function(){var t;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(n){switch(n.label){case 0:var r,o;return[4,c.Fv.createOrUpdate({post:(r=eb({},j),o=o={space_id:j.space_id||e.space_id},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))}),r),formData:e})];case 1:if(!(t=n.sent()).ok)return[3,3];return[4,t.json()];case 2:return I({responseData:n.sent()}),[2,!0];case 3:return N(),[2,Promise.reject(Error("Failed to create or update the post"))]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){ep(i,r,o,a,s,"next",e)}function s(e){ep(i,r,o,a,s,"throw",e)}a(void 0)})})()},defaultValues:A,children:(0,r.jsx)(ed,eb({},v))})})}):(0,r.jsx)(b.a,{variant:"fullscreen"})};eh.propTypes={show:i().bool,closeModal:i().func.isRequired,maxZIndexEnabled:i().bool,shouldSkipRedirectAfterSubmit:i().bool,onSubmitSuccess:i().func}},430009:function(e,t,n){n.d(t,{a:()=>s});var r=n(552676),o=n(739792),i=n(843515),a=n(39905),s=function(e){var t=e.isDisabled,n=e.isEdit,s=(0,i.L)().isSubmitting;return(0,r.jsx)(a.z,{disabled:t,type:"submit",variant:"circle",children:(0,o.t)("quick_post.scheduled_post_ui.".concat(s?"submitting_button":"submit_button",".").concat(n?"save":"publish"))})}},477646:function(e,t,n){n.d(t,{e:()=>p});var r=n(552676),o=n(275271),i=n(739792),a=n(134870),s=n(119614),l=n(208413),c=n(957363),u=n(775148),d=n(912306),f=n(381636);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var p=function(e){var t,n=e.publishedAt,p=e.updatePublishedAt,b=e.status,h=e.revertToDraftState,v=e.variant,y=void 0===v?"default":v,g=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return m(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),x=g[0],_=g[1],j=function(){return _(!1)},w=(0,a.w)({dateTime:new Date(n),format:"short_date_at_short_time"});return"scheduled"!==b?null:(0,r.jsx)(d.h,{selectorQuery:"#".concat(l.U),children:(0,r.jsx)(s.M,{value:n,datePickerVisible:x,onCancel:j,onSave:function(e){p(e),j()},placement:"bottom-end",saveButtonVariant:"circle",children:(0,r.jsxs)("div",{className:"border-primary bg-secondary -mt-px flex flex-col border-y px-5 py-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(c.JO,{type:"16-clock",size:16}),(0,r.jsx)(f.Z.LabelSm,{weight:"2-lines"===y?"semibold":"medium",children:"default"===y?(0,i.t)("quick_post_v2.scheduled_for",{date:w}):(0,i.t)("quick_post_v2.post_scheduled")})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(u.h,{variant:"secondary",name:"16-edit",iconClassName:"!text-dark",onClick:function(){return _(!0)},ariaLabel:(0,i.t)("edit")}),(0,r.jsx)(u.h,{variant:"secondary",name:"16-trash-bin",iconClassName:"!text-dark",onClick:h,ariaLabel:(0,i.t)("delete")})]})]}),"2-lines"===y&&(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)(f.Z.LabelSm,{weight:"normal",children:w})})]})})})}},417757:function(e,t,n){n.d(t,{$:()=>k,F:()=>C});var r=n(552676),o=n(912306),i=n(932699),a=n(739792),s=n(701168),l=n(275271),c=n(227851),u=n(119614),d=n(430009),f=n(477646),m=n(187394),p=n(843515),b=n(241769),h=n(441342),v=n(941084),y=n(60589),g=n(380171),x=n(805765);function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var j=function(){var e,t,n=(0,h.wh)().currentCommunitySettings,o=!!(null==n?void 0:n.tiptap_post_enabled),s=(0,c.Gc)(),j=s.watch,w=s.setValue,O=s.getValues,S=j(),P=S.published_at,C=S.status,k=(e=(0,l.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return _(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),I=k[0],N=k[1],A=(0,p.L)().isSubmitting,M=O(),T=M.name,E=M.body,R=M.tiptap_body,D=M.space_id,L=M.topics,F=(0,h.Zh)(),U=F.record,B=F.helpers,q=F.isSubmitEnabled,z=!!(null==B?void 0:B.isTiptapPost),Z=!!(null==U?void 0:U.id),V=(0,v.Hz)(U),H=(Z?z:o)?(0,b.NU)(R):(0,b.bG)(E),W="quick_post.scheduled_post_ui.".concat(A?"submitting_button":"submit_button"),Q=[{icon:"16-download",label:(0,a.t)("".concat(W,".save_draft")),value:"draft"},{icon:"16-calendar",label:(0,a.t)("".concat(W,".schedule_post")),value:"scheduled"},{icon:"16-publish",label:(0,a.t)("".concat(W,".publish")),value:"published"}],G=(0,i.find)(Q,{value:C||"published"}),$=function(e){"scheduled"===e.value?N(!0):(w("status",e.value),N(!1),K(null))},K=function(e){w("published_at",e)},J=function(){$(Q[0])},X=j("space_id"),Y=(0,h.nT)();(0,m.f)(Y)&&(t=Y.helpers.findById(X));var ee=(0,l.useMemo)(function(){return(0,b.r1)(T)||H?D?(null==t?void 0:t.require_topic_selection)&&0>=Number(null==L?void 0:L.length)?(0,a.t)("quick_post_v2.error_messages.no_topics"):null:(0,a.t)("quick_post_v2.error_messages.no_space"):(0,a.t)("quick_post_v2.error_messages.no_title_or_body")},[T,D,H,L,t]),et=!!ee||A||!q,en=t&&(0,y.k8)(t)&&!V;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.e,{publishedAt:P,revertToDraftState:J,status:C,updatePublishedAt:K}),(0,r.jsx)(u.M,{datePickerVisible:I,onCancel:function(e){e&&e.preventDefault(),N(!1),"scheduled"===C&&J()},value:P,onSave:function(e){K(e),w("status","scheduled"),N(!1)},className:"-bottom-11",saveButtonVariant:"circle",children:(0,r.jsx)(g.T,{disabled:!et,content:ee,trigger:"mouseenter click focus focusin",children:en?(0,r.jsx)(x.F,{type:"submit",disabled:et,selectedAction:G,setSelectedAction:$,options:Q,variant:"circle"}):(0,r.jsx)(d.a,{isEdit:Z,isDisabled:et})})})]})},w=n(957363),O=n(617013),S=n(117617),P=n(381636),C=function(e){var t;return!!(null==e||null==(t=e.helpers)?void 0:t.basicSpacesWithPostCreationAllowed)},k=function(){var e=(0,S.Be)(),t=(0,h.nT)(),n=C(t)?t.helpers.basicSpacesWithPostCreationAllowed():[];return(0,r.jsxs)("footer",{className:"border-primary flex items-center justify-between border-t px-5 py-4","data-testid":"quick-post-footer",children:[(0,r.jsx)("nav",{"aria-label":(0,a.t)("quick_post_v2.footer_menu_aria_label"),id:"quick-post-v2-footer-toolbar"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(o.h,{selectorQuery:"#space-select-for-mobile",disablePortal:e,children:(0,r.jsx)(O.M,{dropdownClassName:e?"bottom-14":"bottom-32 right-1",spaces:n,containerClassname:(0,s.A)("!max-w-full",{"border-t border-primary":!e}),name:"space_id",customButton:function(t){var n=t.toggleDropdown,o=t.selectedSpace,l=t.isOpen;return(0,r.jsxs)("button",{type:"button",className:(0,s.A)("hover:bg-secondary focus-visible:bg-secondary flex w-full cursor-pointer items-center rounded-md",{"bg-secondary":l,"px-5 py-4":!e,"px-3 py-2":e}),onClick:n,children:[(0,r.jsx)("div",{className:(0,s.A)("flex items-center space-x-1",{"flex-1":!e}),children:(null==o?void 0:o.name)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(P.Z.LabelSm,{weight:"medium",color:"text-default",children:[(0,a.t)("quick_post_v2.posting_in")," "]}),(0,r.jsx)(P.Z.LabelSm,{weight:"medium",color:"text-default",children:(0,r.jsx)("span",{className:"text-dark",title:o.name,children:(0,i.truncate)(o.name,{length:e?24:36})})})]}):(0,r.jsx)(P.Z.LabelSm,{weight:"medium",color:"text-default",children:(0,r.jsx)("span",{className:"text-light",children:(0,a.t)("quick_post_v2.choose_a_space")})})}),(0,r.jsx)(w.JO,{className:"!text-dark",type:"16-chevron-down",size:16})]})}})}),(0,r.jsx)(j,{})]})]})}},780754:function(e,t,n){n.d(t,{w:()=>ew});var r=n(552676),o=n(227851),i=n(808782),a=n(971691),s=n(843335),l=n(230967),c=n(739792),u=n(380171),d=n(701168),f=n(775148),m=n(932699),p=n(957363),b=n(230457),h=function(e){var t=e.searchQuery,n=e.isCreatingTopic,o=e.onCreateTopic;return(0,r.jsxs)(b.W,{option:"create",onClick:function(e){e.preventDefault(),e.stopPropagation(),n||o(t)},className:"flex items-center",children:[(0,r.jsx)(p.JO,{className:"mr-1",size:16,type:n?"loader":"plus-v2"}),(0,c.t)(n?"quick_post_v2.topics.creating":"quick_post_v2.topics.create"),(0,r.jsx)("span",{className:"text-dark ml-1 font-semibold",children:(0,c.t)("quick_post_v2.topics.topic_quoted",{topic:t})})]},"create")},v=n(381636),y=function(){return(0,r.jsx)("div",{className:"px-5 py-1.5",children:(0,r.jsx)(v.Z.LabelSm,{color:"text-light",children:(0,c.t)("quick_post_v2.topics.loading")})})},g=n(73458),x=n(330021),_=function(e){var t,n,o=e.searchQuery,i=e.topics,a=e.isLoading,s=e.isCreatingTopic,l=e.onCreateTopic,u=e.shouldShowCreateTopic,f=e.shouldShowDropdown,p=e.style,_=e.attributes,j=e.popperRef;return(0,r.jsx)("div",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:(0,d.A)("z-10 max-w-[min(90vw,288px)]",{invisible:!f}),ref:j,style:p},_),n=n={children:(0,r.jsx)(g.E,{className:"!relative",dataTestId:"topics-dropdown-list",children:(0,r.jsxs)(x.H,{children:[a&&(0,r.jsx)(y,{}),i.map(function(e){return(0,r.jsx)(b.W,{option:e,children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(v.Z.LabelSm,{children:(0,m.truncate)(e.name,{length:25})}),e.admin_only&&(0,r.jsx)(v.Z.LabelXs,{color:"text-light",children:(0,c.t)("quick_post_v2.topics.admin_only")})]})},e.id)}),u&&(0,r.jsx)(h,{isCreatingTopic:s,onCreateTopic:l,searchQuery:o})]})})},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},j=function(e){var t=e.value,n=e.onChange,o=e.activeOption,i=e.maxTopicsAllowed,a=e.isCreatingTopic,l=e.onCreateTopic,u=e.onRemoveLastTopic,d=e.onRemoveAllTopics,f=e.searchInputRef,m=e.buttonRef;return(0,r.jsx)(s.h.Input,{className:"min-w-[200px] flex-1 border-none bg-transparent p-0 px-1 py-[5px] text-sm focus:ring-0",ref:f,value:t,placeholder:(0,c.t)("quick_post_v2.topics.search",{count:i}),onChange:function(e){return n(e.target.value)},onFocus:function(){var e;return null==(e=m.current)?void 0:e.click()},onKeyDown:function(e){var n=e.key,r=e.ctrlKey,i=e.metaKey;(r||i)&&"Backspace"===n?d():"Backspace"===n&&0===t.length?u():"Enter"===n&&"create"===o&&!a&&t.trim().length>0&&(e.preventDefault(),l(t))}})},w=function(e){var t=e.topic,n=e.isDraggable,o=e.isDragging,i=e.isRemovable,a=void 0!==i&&i,s=e.onRemove;return(0,r.jsx)(u.T,{placement:"top",content:(0,c.t)("quick_post_v2.topics.admin_only"),interactive:!1,disabled:a,trigger:"mouseenter click focus focusin",children:(0,r.jsxs)("div",{className:(0,d.A)("border-primary bg-primary text-dark inline-flex items-center justify-start gap-1.5 whitespace-nowrap rounded-[32px] border py-1.5 pr-2",void 0!==o&&o?"rotate-1 scale-[1.01] opacity-75 shadow-lg":void 0!==n&&n?"cursor-move":"cursor-default",a?"pl-3.5":"pointer-events-none pl-2"),children:[(0,r.jsx)(v.Z.LabelXs,{weight:"medium",children:t.name}),a&&(0,r.jsx)(p.JO,{className:"cursor-pointer",onClick:s,type:"12-close",size:12})]})})},O=n(978434);function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var P=function(e){var t,n,o=e.topic,i=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["topic"]),s=(0,a.nB)({id:o.id}),l=s.attributes,c=s.listeners,u=s.setNodeRef,d=s.transform,f=s.transition,m=s.isDragging,p={transform:O.ux.Translate.toString(d),transition:f,opacity:m?.33:1};return(0,r.jsx)("div",(t=S({ref:u,style:p},l,c),n=n={children:(0,r.jsx)(w,S({topic:o},i))},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},C=n(437435),k=n(275271);function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var N=function(e){var t,n=e.topics,r=e.onReorderTopics,o=(t=(0,k.useState)(null),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return I(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=o[0],l=o[1],c=(0,k.useCallback)(function(e){l(e.active.id)},[]),u=(0,k.useCallback)(function(e){var t=e.active,o=e.over;o&&t.id!==o.id&&r((0,a.Rp)(n,n.findIndex(function(e){return e.id===t.id}),n.findIndex(function(e){return e.id===o.id}))),l(null)},[n,r]),d=(0,i.Dy)((0,i.VT)(i.we,{activationConstraint:{distance:10}}),(0,i.VT)(i.Lg,{coordinateGetter:a.is}));return{draggedTopic:n.find(function(e){return e.id===s}),handleDragStart:c,handleDragEnd:u,sensors:d}},A=n(321405),M=n(548298),T=n(664904),E=n(131906),R=n(366249),D=n(93199),L=n(547144);function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var U=function(e){var t=e.spaceId,n=e.ids,r=e.query,o=e.queryOptions;return(0,E.useQuery)(F({queryKey:t?[R.Jl,t,n,r]:[R.Jl,n,r],queryFn:function(){return(0,D.UT)(t?L.av.topics.spaceTopics({spaceId:t,params:F({},n&&n.length>0&&{ids:n},r&&{query:r})}):L.av.settings.topics.index({params:F({per_page:100},n&&n.length>0&&{ids:n},r&&{query:r})}))}},o))};function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function q(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return B(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var z=function(e){var t=e.spaceId,n=e.searchQuery,r=e.selectedTopics,o=e.hasMaxTopicsSelected,i=e.canSelectTopic,a=e.canCreateTopics,s=e.searchInputRef,l=(0,k.useRef)(null),c=(0,k.useRef)(null),u=U({spaceId:t,query:(0,M.c)(n,200),queryOptions:{keepPreviousData:!0}}),d=u.data,f=u.isLoading,m=(0,k.useMemo)(function(){var e,t=null!=(e=null==d?void 0:d.records)?e:[],n=r.map(function(e){return e.id});return t.filter(function(e){return i(e)&&!n.includes(e.id)})},[d,r,i]),p=(0,A.D)(s.current,l.current,{placement:"top-start",strategy:"absolute",modifiers:[T.Z,{name:"offset",options:{offset:[0,2]}}]}),b=p.styles,h=p.attributes,v=p.forceUpdate;(0,k.useEffect)(function(){null==v||v()},[v,r]);var y=(0,k.useMemo)(function(){return!!a&&!o&&0!==n.length&&!q(r.map(function(e){return e.name.toLowerCase()})).concat(q(m.map(function(e){return e.name.toLowerCase()}))).includes(n.toLowerCase())},[a,o,n,r,m]),g=!o&&(f||y||m.length>0);return{isLoading:f,dropdownTopics:m,shouldShowCreateTopic:y,shouldShowDropdown:g,styles:b,attributes:h,popperRef:l,buttonRef:c}};function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var V=function(e){return((function(e){if(Array.isArray(e))return Z(e)})(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Z(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort(function(e,t){return e.admin_only&&!t.admin_only?-1:!e.admin_only&&t.admin_only?1:0})},H=n(60878);function W(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var Q=function(e){var t=e.onSuccess,n=e.spaceId,r=(0,H.pm)();return(0,E.useMutation)({mutationFn:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){return[2,(0,D.Cu)(L.av.settings.topics.create(),{topic:{name:e,space_ids:[n]}})]})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){W(i,r,o,a,s,"next",e)}function s(e){W(i,r,o,a,s,"throw",e)}a(void 0)})})()},onSuccess:t,onError:function(e){"Name has already been taken"===e.errorDetails&&r.error("A topic with this name already exists. Add it to your space instead from the customize space screen.")}})};function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||J(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e){return function(e){if(Array.isArray(e))return G(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||J(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}}var X=function(e){var t=e.spaceId,n=e.value,r=e.onChange,o=e.onTopicCreated,i=e.maxTopicsAllowed,a=void 0===i?C.q:i,s=e.sortable,l=void 0!==s&&s,c=e.canRemoveTopic,u=$((0,k.useState)(n),1)[0],d=$((0,k.useState)([]),2),f=d[0],m=d[1],p=$((0,k.useState)(!1),2),b=p[0],h=p[1],v=U({spaceId:t,ids:u}).data,y=Q({spaceId:t,onSuccess:function(e){m(function(t){return K(t).concat([e])}),null==o||o(e)}}),g=y.mutate,x=y.isLoading,_=(0,k.useMemo)(function(){return f.map(function(e){return e.id})},[f]),j=(0,k.useCallback)(function(e){m(l?e:V(e))},[l]);(0,k.useEffect)(function(){!b&&(null==v?void 0:v.records)&&(j(u.length>0?K(v.records).sort(function(e,t){return u.indexOf(e.id)-u.indexOf(t.id)}):[]),h(!0))},[b,v,u,j]),(0,k.useEffect)(function(){b&&(null==r||r(_))},[r,b,_]);var w=(0,k.useCallback)(function(e){m(function(t){return t.filter(function(t){return t.id!==e.id})})},[]),O=(0,k.useCallback)(function(){m(function(e){return e.filter(function(e){return!c(e)})})},[c]),S=(0,k.useCallback)(function(){var e=f[f.length-1];e&&c(e)&&w(e)},[f,c,w]),P=!!v&&v.count>0,I=f.length>0,N=f.length>=a;return{selectedTopics:f,selectedTopicIds:_,updateSelectedTopics:j,hasTopicsForPicker:P,hasTopicsSelected:I,hasMaxTopicsSelected:N,createTopic:g,isCreatingTopic:x,removeTopic:w,removeAllTopics:O,removeLastTopic:S}},Y=n(441342),ee=n(78456),et=function(e){var t=e.creatable,n=e.deletable,r=void 0===n||n,o=(0,Y.wh)().currentCommunityMember,i=(0,ee.vb)(o)||(0,ee.I$)(o);return{canSelectTopic:(0,k.useCallback)(function(e){return i||!e.admin_only},[i]),canRemoveTopic:(0,k.useCallback)(function(e){return r&&(i||!e.admin_only)},[i,r]),canCreateTopics:void 0!==t&&t,canRemoveAllTopics:r}};function en(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var er=function(){var e,t=(0,k.useRef)(null),n=(e=(0,k.useState)(""),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return en(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return en(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=n[0],o=n[1],i=(0,k.useCallback)(function(){t.current&&(t.current.value=""),o("")},[]);return{searchQuery:r,setSearchQuery:o,resetSearchInput:i,searchInputRef:t}},eo=function(e){var t=e.value,n=e.onChange,o=e.spaceId,m=e.maxTopicsAllowed,p=void 0===m?C.q:m,b=e.sortable,h=void 0!==b&&b,v=e.creatable,y=e.deletable,g=e.containerClassName,x=et({creatable:void 0!==v&&v,deletable:void 0===y||y}),O=x.canSelectTopic,S=x.canRemoveTopic,k=x.canCreateTopics,I=x.canRemoveAllTopics,A=er(),M=A.searchQuery,T=A.setSearchQuery,E=A.resetSearchInput,R=A.searchInputRef,D=X({spaceId:o,value:void 0===t?[]:t,onChange:n,onTopicCreated:E,maxTopicsAllowed:p,sortable:h,canRemoveTopic:S}),L=D.selectedTopics,F=D.selectedTopicIds,U=D.updateSelectedTopics,B=D.hasTopicsForPicker,q=D.hasTopicsSelected,Z=D.hasMaxTopicsSelected,V=D.removeTopic,H=D.removeLastTopic,W=D.removeAllTopics,Q=D.isCreatingTopic,G=D.createTopic,$=z({spaceId:o,searchQuery:M,selectedTopics:L,hasMaxTopicsSelected:Z,canSelectTopic:O,canCreateTopics:k,searchInputRef:R}),K=$.isLoading,J=$.dropdownTopics,Y=$.shouldShowCreateTopic,ee=$.shouldShowDropdown,en=$.styles,eo=$.attributes,ei=$.popperRef,ea=$.buttonRef,es=N({topics:L,onReorderTopics:U}),el=es.draggedTopic,ec=es.handleDragStart,eu=es.handleDragEnd,ed=es.sensors;return B||k?(0,r.jsx)(s.h,{value:L,onChange:function(e){U(e),E()},multiple:!0,nullable:!0,children:function(e){var t=e.activeOption;return(0,r.jsxs)("div",{className:(0,d.A)("text-dark flex items-start justify-between p-2",g),children:[(0,r.jsxs)("div",{id:"quickpost-topics-picker-sortable",className:"w-full","data-testid":"topics-list",children:[(0,r.jsx)(s.h.Button,{className:"hidden",ref:ea}),(0,r.jsxs)(i.LB,{sensors:ed,collisionDetection:i.ey,onDragStart:ec,onDragEnd:eu,children:[(0,r.jsx)(a.Fo,{items:F,strategy:a.U2,disabled:!h,children:(0,r.jsxs)("div",{className:"flex w-full flex-row flex-wrap items-center gap-2",children:[L.map(function(e){return(0,r.jsx)(P,{topic:e,isDraggable:h,isRemovable:S(e),onRemove:function(){return V(e)}},e.id)}),!Z&&(0,r.jsx)(j,{value:M,onChange:T,activeOption:t,maxTopicsAllowed:p,isCreatingTopic:Q,onCreateTopic:G,onRemoveLastTopic:H,onRemoveAllTopics:W,searchInputRef:R,buttonRef:ea})]})}),(0,l.createPortal)((0,r.jsx)(i.y9,{zIndex:99999,children:el&&(0,r.jsx)(w,{topic:el,isDragging:!0,isRemovable:S(el),onRemove:function(){return V(el)}})}),document.body)]}),(0,r.jsx)(_,{searchQuery:M,topics:J,isLoading:K,isCreatingTopic:Q,onCreateTopic:G,shouldShowCreateTopic:Y,shouldShowDropdown:ee,style:en.popper,attributes:eo.popper,popperRef:ei})]}),q&&I&&(0,r.jsx)(u.T,{content:(0,c.t)("quick_post_v2.topics.remove_all"),placement:"top-end",children:(0,r.jsx)(f.h,{className:"size-7",iconClassName:"!text-dark",onClick:W,name:"16-trash-bin-2",ariaLabel:(0,c.t)("quick_post_v2.topics.remove_all")})})]})}}):null},ei=n(99594),ea=n.n(ei),es=function(e){var t=e.filter,n=e.createTopicMutation;return(0,r.jsxs)(b.W,{option:"create",onClick:function(e){e.preventDefault(),e.stopPropagation(),n.isLoading||n.mutate(t)},className:"flex items-center",children:[(0,r.jsx)(p.JO,{className:"mr-1",size:16,type:n.isLoading?"loader":"plus-v2"}),(0,c.t)(n.isLoading?"quick_post_v2.topics.creating":"quick_post_v2.topics.create"),(0,r.jsx)("span",{className:"text-dark ml-1 font-semibold",children:(0,c.t)("quick_post_v2.topics.topic_quoted",{topic:t})})]},"create")},el=function(){return(0,r.jsx)("div",{className:"px-5 py-1.5",children:(0,r.jsx)(v.Z.LabelSm,{color:"text-light",children:(0,c.t)("quick_post_v2.topics.loading")})})},ec=function(e){var t,n,o=e.shouldShowDropdown,i=e.popperElement,a=e.styles,s=e.attributes,l=e.isLoading,u=e.filter,f=e.filteredTopics,p=e.shouldShowCreateTopic,h=e.createTopicMutation;return(0,r.jsx)("div",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:(0,d.A)("z-10 max-w-[min(90vw,288px)]",{invisible:!o}),ref:i,style:a.popper},s.popper),n=n={children:(0,r.jsx)(g.E,{className:"!relative",dataTestId:"topics-dropdown-list",children:(0,r.jsxs)(x.H,{children:[l&&(0,r.jsx)(el,{}),f.map(function(e){return(0,r.jsx)(b.W,{option:e.id,children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(v.Z.LabelSm,{children:(0,m.truncate)(e.name,{length:25})}),e.admin_only&&(0,r.jsx)(v.Z.LabelXs,{color:"text-light",children:(0,c.t)("quick_post_v2.topics.admin_only")})]})},e.id)}),p&&(0,r.jsx)(es,{createTopicMutation:h,filter:u})]})})},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},eu=function(e){var t=e.targetElement,n=e.filter,o=e.maxTopicsAllowed,i=e.setFilter,a=e.buttonElement,l=e.activeOption,u=e.createTopicMutation,d=e.resetSelectedTopics,f=e.removeLastTopic;return(0,r.jsx)(s.h.Input,{className:"min-w-[200px] flex-1 border-none bg-transparent p-0 px-1 py-[5px] text-sm focus:ring-0",ref:t,value:n,placeholder:(0,c.t)("quick_post_v2.topics.search",{count:o}),onChange:function(e){return i(e.target.value)},onFocus:function(){var e;return null==a||null==(e=a.current)?void 0:e.click()},onKeyDown:function(e){(e.ctrlKey||e.metaKey)&&"Backspace"===e.key&&d(),"Backspace"===e.key&&(null==n?void 0:n.length)===0&&f(),"Enter"===e.key&&(null==n?void 0:n.trim())&&"create"===l&&(e.preventDefault(),u.isLoading||u.mutate(n))}})},ed=function(e){var t=e.topic,n=e.isDragOverlay,o=e.isDraggable,i=e.isDeletable,a=e.setActiveTopicIDs,s=(0,Y.wh)().currentCommunityMember,l=(0,ee.vb)(s)||(0,ee.I$)(s),f=!l&&t.admin_only;return(0,r.jsx)(u.T,{placement:"top",content:(0,c.t)("quick_post_v2.topics.admin_only"),interactive:!1,disabled:!f,trigger:"mouseenter click focus focusin",children:(0,r.jsxs)("div",{className:(0,d.A)("border-primary bg-primary text-dark inline-flex items-center justify-start gap-1.5 whitespace-nowrap rounded-[32px] border py-1.5 pr-2",n?"rotate-1 scale-[1.01] opacity-75 shadow-lg":o?"cursor-move":"cursor-default",f?"pl-2":"pl-3.5",{"pointer-events-none":f}),children:[(0,r.jsx)(v.Z.LabelXs,{weight:"medium",children:null==t?void 0:t.name}),(l||!t.admin_only)&&i&&(0,r.jsx)(p.JO,{className:"cursor-pointer",onClick:function(){null==a||a(function(e){return e.filter(function(e){return e!==t.id})})},type:"12-close",size:12})]})})};function ef(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var em=function(e){var t=e.onSuccess,n=e.spaceId,r=(0,H.pm)();return(0,E.useMutation)({mutationFn:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){return[2,(0,D.Cu)(L.av.settings.topics.create(),{topic:{name:e,space_ids:[n]}})]})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){ef(i,r,o,a,s,"next",e)}function s(e){ef(i,r,o,a,s,"throw",e)}a(void 0)})})()},onSuccess:t,onError:function(e){"Name has already been taken"===e.errorDetails&&r.error("A topic with this name already exists. Add it to your space instead from the customize space screen.")}})},ep=function(e){var t=e.spaceId;return(0,E.useQuery)({queryKey:t?[R.Jl,t]:[R.Jl],queryFn:function(){return(0,D.UT)(t?L.av.topics.spaceTopics({spaceId:t}):L.av.settings.topics.index({params:{per_page:250}}))}})},eb=function(e){var t=e.activeTopicIDs,n=e.topics,r=e.skipSort;return t.map(function(e){return null==n?void 0:n.records.find(function(t){return t.id===e})}).filter(function(e){return!!e}).sort(function(e,t){return r?0:e.admin_only&&!t.admin_only?-1:!e.admin_only&&t.admin_only?1:0})},eh=function(e){var t=e.activeTopicIDs,n=e.topics;return t.sort(function(e,t){var r=null==n?void 0:n.records.find(function(t){return t.id===e}),o=null==n?void 0:n.records.find(function(e){return e.id===t});return(null==r?void 0:r.admin_only)&&!(null==o?void 0:o.admin_only)?-1:!(null==r?void 0:r.admin_only)&&(null==o?void 0:o.admin_only)?1:0})};function ev(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var ey=function(e){var t,n,o=e.topic,i=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["topic"]),s=(0,a.nB)({id:(null==o?void 0:o.id)||""}),l=s.attributes,c=s.listeners,u=s.setNodeRef,d=s.transform,f=s.transition,m=s.isDragging,p={transform:O.ux.Translate.toString(d),transition:f,opacity:m?.33:1};return(0,r.jsx)("div",(t=ev({ref:u,style:p},l,c),n=n={children:(0,r.jsx)(ed,ev({topic:o},i))},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))};function eg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ex(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||e_(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e_(e,t){if(e){if("string"==typeof e)return eg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eg(e,t)}}var ej=function(e){var t=e.value,n=e.onChange,o=e.spaceId,m=e.maxTopicsAllowed,p=void 0===m?5:m,b=e.sortable,h=void 0!==b&&b,v=e.creatable,y=e.deletable,g=void 0===y||y,x=e.containerClassName,_=ex((0,k.useState)(void 0===t?[]:t),2),j=_[0],w=_[1],O=ex((0,k.useState)(""),2),S=O[0],P=O[1],C=ex((0,k.useState)(null),2),I=C[0],N=C[1],M=(0,Y.wh)().currentCommunityMember,E=(0,k.useRef)(null),R=(0,k.useRef)(null),D=(0,k.useRef)(null),L=(null==j?void 0:j.length)>0,F=(null==j?void 0:j.length)>=p,U=ep({spaceId:o}),B=U.data,q=U.isLoading,z=U.refetch,Z=(0,i.Dy)((0,i.VT)(i.we,{activationConstraint:{distance:10}}),(0,i.VT)(i.Lg,{coordinateGetter:a.is})),V=function(){return w((0,ee.vb)(M)?[]:j.filter(function(e){var t=null==B?void 0:B.records.find(function(t){return t.id===e});return null==t?void 0:t.admin_only}))},H=function(){return w(function(e){var t=h?e:eh({activeTopicIDs:e,topics:B}),n=null==B?void 0:B.records.find(function(e){return e.id===t[t.length-1]});return!(0,ee.vb)(M)&&(null==n?void 0:n.admin_only)?e:e.slice(0,-1)})};(0,k.useEffect)(function(){B&&w(function(e){return e.filter(function(e){return null==B?void 0:B.records.some(function(t){return t.id===e})})})},[B]),(0,k.useEffect)(function(){null==n||n(j.filter(function(e){return!isNaN(Number(e))}))},[n,j]);var W=(0,A.D)(E.current,R.current,{placement:"top-start",strategy:"absolute",modifiers:[T.Z,{name:"offset",options:{offset:[0,2]}}]}),Q=W.styles,G=W.attributes,$=W.forceUpdate,K=function(){P(""),E.current&&(E.current.value="")},J=em({spaceId:o,onSuccess:function(e){K(),z(),null==$||$(),w(function(t){return((function(e){if(Array.isArray(e))return eg(e)})(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||e_(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([e.id])})}}),X=((null==B?void 0:B.records)||[]).filter(function(e){return!e.admin_only||(0,ee.vb)(M)||(0,ee.I$)(M)}).filter(function(e){return!j.includes(e.id)}),et=X.map(function(e){return e.name}),en=ea().go(S,et,{all:!0}).map(function(e){return e.target}),er=X.filter(function(e){return en.includes(e.name)}),eo=void 0!==v&&v&&!F&&S.length>0&&!et.includes(S);o&&(eo=eo&&20>Number(null==B?void 0:B.count));var ei=(q||er.length>0||eo)&&j.length<p;(0,k.useEffect)(function(){null==$||$()},[$,j]);var es=function(e){return N(e.active.id)},el=function(e){var t=e.active,n=e.over;t.id!==n.id&&w(function(e){return(0,a.Rp)(e,e.indexOf(t.id),e.indexOf(n.id))}),N(null)},ef=null==B?void 0:B.records.find(function(e){return e.id===I});return(null==B?void 0:B.records)&&(null==B?void 0:B.records.length)||(0,ee.vb)(M)?(0,r.jsx)(s.h,{value:j,onChange:function(e){w(e),K()},multiple:!0,nullable:!0,children:function(e){var t=e.activeOption;return(0,r.jsxs)("div",{className:(0,d.A)("text-dark flex items-start justify-between p-2",x),children:[(0,r.jsxs)("div",{id:"quickpost-topics-picker-sortable",className:"w-full","data-testid":"topics-list",children:[(0,r.jsx)(s.h.Button,{className:"hidden",ref:D}),(0,r.jsxs)(i.LB,{sensors:Z,collisionDetection:i.ey,onDragStart:es,onDragEnd:el,children:[(0,r.jsx)(a.Fo,{items:j,strategy:a.U2,disabled:!h,children:(0,r.jsxs)("div",{className:"flex w-full flex-row flex-wrap items-center gap-2",children:[eb({activeTopicIDs:j,topics:B,skipSort:h}).map(function(e){return(0,r.jsx)(ey,{topic:e,isDraggable:h,isDeletable:g,setActiveTopicIDs:w},e.id)}),!F&&(0,r.jsx)(eu,{buttonElement:D,filter:S,setFilter:P,maxTopicsAllowed:p,targetElement:E,activeOption:t,createTopicMutation:J,resetSelectedTopics:V,removeLastTopic:H})]})}),(0,l.createPortal)((0,r.jsx)(i.y9,{zIndex:99999,children:ef?(0,r.jsx)(ed,{isDragOverlay:!0,topic:ef,isDeletable:g}):null}),document.body)]}),(0,r.jsx)(ec,{shouldShowDropdown:ei,popperElement:R,styles:Q,filter:S,attributes:G,isLoading:q,filteredTopics:er,shouldShowCreateTopic:eo,createTopicMutation:J})]}),L&&g&&(0,r.jsx)(u.T,{content:(0,c.t)("quick_post_v2.topics.remove_all"),placement:"top-end",children:(0,r.jsx)(f.h,{className:"size-7",iconClassName:"!text-dark",onClick:V,name:"16-trash-bin-2",ariaLabel:(0,c.t)("quick_post_v2.topics.remove_all")})})]})}}):null},ew=function(e){var t=e.name,n=e.rules,i=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["name","rules"]),a=(0,o.Gc)().control,s=(0,Y.wh)().currentCommunitySettings,l=(null==s?void 0:s.cms_topics_picker_backend_filtering_enabled)?eo:ej;return(0,r.jsx)(o.Qr,{control:a,name:t,rules:n,render:function(e){var t=e.field;return(0,r.jsx)(l,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({value:t.value,onChange:t.onChange},i))}})}},437435:function(e,t,n){n.d(t,{q:()=>r,t:()=>o});var r=5,o=20},208413:function(e,t,n){n.d(t,{V:()=>B,U:()=>U});var r=n(552676),o=n(275271),i=n(227851),a=n(117383),s=n(843515),l=n(403697),c=n(441342),u=n(767379),d=n(283095),f=n(739792),m=n(60589),p=n(903225),b=n(701168),h=n(72727),v=n(313087),y=n(775148),g=n(117617),x=n(380171),_=n(381636),j="quick-post-v2-thumbnail-button",w=function(){var e=(0,s.L)(),t=e.isFullscreen,n=e.toggleFullscreen,o=e.isDirty,a=(0,v.c)({shouldPrevent:o}),l=(0,p.k6)(),u=(0,c.Zh)().record,d=(0,c.nT)(),w=(0,i.Gc)().watch,O=!!(null==u?void 0:u.id),S=w("space_id"),P=d.helpers.findById(S),C=(0,g.kK)(),k=(0,h.L)().isElectron;return(0,r.jsxs)("header",{className:(0,b.A)("border-primary flex items-center justify-between border-b px-5 py-4",{"mt-6":k&&t}),"data-testid":"quick-post-header",children:[(0,r.jsx)(_.Z.TitleSm,{weight:"semibold",children:(0,f.t)(O?"quick_post_v2.edit_title":"quick_post_v2.create_title")}),(0,r.jsxs)("ul",{className:"text-darkest flex list-none items-center space-x-2",children:[(0,r.jsx)("li",{id:j}),P&&(0,m.Y_)(P)&&(0,r.jsx)("li",{children:(0,r.jsx)(x.T,{placement:"bottom",content:(0,f.t)("quick_post_v2.header.settings"),children:(0,r.jsx)(y.h,{variant:"secondary",iconSize:20,iconClassName:"!text-dark",name:"20-settings",onClick:function(){return l.push("/settings")},ariaLabel:(0,f.t)("quick_post_v2.header.settings")})})}),!C&&(0,r.jsx)("li",{children:(0,r.jsx)(x.T,{placement:"bottom",content:(0,f.t)("quick_post_v2.header.fullscreen"),children:(0,r.jsx)(y.h,{variant:"secondary",iconSize:20,className:"hidden sm:flex",onClick:n,iconClassName:"!text-dark",name:t?"20-fullscreen-exit":"20-fullscreen",ariaLabel:(0,f.t)("quick_post_v2.header.fullscreen")})})}),(0,r.jsx)("li",{children:(0,r.jsx)(x.T,{placement:"bottom",content:(0,f.t)("quick_post_v2.header.close"),children:(0,r.jsx)(y.h,{variant:"secondary",iconSize:20,onClick:a,iconClassName:"!text-dark",name:"20-close",ariaLabel:(0,f.t)("quick_post_v2.header.close")})})})]})]})},O=n(780754),S=n(187394),P=n(196619),C=n(359892),k=n(941084),I=n(275753),N=n(405521),A=n(206394),M=n(912306),T=n(805116),E=n(152988);function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function D(e){return function(e){if(Array.isArray(e))return R(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return R(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var L=function(){var e,t=(0,c.wh)().currentCommunitySettings,n=!!(null==t?void 0:t.tiptap_post_enabled),o=(0,I.T)(),a=(0,i.Gc)(),s=a.watch,u=a.setValue,d=s("tiptap_body.sgids_to_object_map")||{},p=s("name"),h="tiptap_body.inline_attachments",v=s(h)||[],g=(0,c.Zh)(),_=g.record,w=g.helpers,R=!!(null==w?void 0:w.isTiptapPost),L=(0,N.k)(),F=_||{},U=F.id,B=F.tiptap_body,q=s("space_id"),z=s("cover_image"),Z=(0,c.nT)();(0,S.f)(Z)&&(e=Z.helpers.findById(q));var V=e&&(0,m.Y_)(e);return(0,r.jsx)("div",{className:"flex-1 overflow-auto px-5 py-4","data-ai-scrollable":!0,children:(0,r.jsxs)("div",{className:"trix-v2 mx-auto grid h-full max-w-3xl grid-rows-[auto,auto,1fr]",children:[(0,r.jsx)("div",{children:(0,k.J4)(e)&&(0,r.jsx)(A.D,{name:"cover_image",className:(0,b.A)("relative",{"mb-2":!!z}),showAddCoverBtn:!0,aspectRatio:l.pI.DEFAULT,changeImageText:(0,f.t)("replace"),customAddCoverBtn:(0,r.jsx)(M.h,{selectorQuery:"#".concat(j),children:(0,r.jsx)(x.T,{placement:"bottom",content:(0,f.t)("quick_post_v2.header.add_cover"),children:(0,r.jsx)(y.h,{variant:"secondary",iconSize:20,iconClassName:"!text-dark",name:"20-cover-image",ariaLabel:(0,f.t)("quick_post_v2.header.add_cover")})})})})}),(0,r.jsx)("div",{children:(0,k.tp)(e)&&(0,r.jsx)(P.n,{maxLength:255,draggable:!1,name:"name",autoFocus:!0,ref:L,placeholder:(0,f.t)("quick_post_v2.title_placeholder"),className:"bg-primary text-dark mb-2 block w-full resize-none border-none p-0 text-2xl font-bold focus:ring-0",rows:1,onKeyPress:function(e){"Enter"===e.key&&e.preventDefault()},tabIndex:0,"data-testid":"post_name"})}),(0,r.jsx)("div",{children:(U?R:n)?(0,r.jsx)(C.$,{placeholder:(0,f.t)("quick_post_v2.body_placeholder"),name:"tiptap_body.body",toolbars:[{portalId:"quick-post-v2-footer-toolbar",component:E.o}],className:"h-full",editorClassName:"h-full quick-post-modal--v2",spaceId:q,sgidToObjectMap:null==B?void 0:B.sgids_to_object_map,inlineAttachments:null==B?void 0:B.inline_attachments,onLocalSgidToObjectMapChange:function(e){u("tiptap_body.sgids_to_object_map",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},d,e))},onLocalAttachmentsChange:function(e){return u(h,D(v).concat(D(e)))},aiCopilotTitle:p,isVoiceMessageAllowed:!0,isMediaUploadAllowed:o}):(0,r.jsx)(T.O,{id:"post_body",name:"body",is_private_space:!1,space_id:q,placeholder:(0,f.t)("quick_post_v2.body_placeholder"),tabIndex:0,toolbarPortalId:"quick-post-v2-footer-toolbar"})}),!!q&&(0,r.jsx)(M.h,{selectorQuery:"#topics-picker-portal",children:(0,r.jsx)(O.w,{containerClassName:"border-t border-primary",name:"topics",spaceId:q,creatable:null!=V&&V})})]})})},F=n(417757),U="scheduled-post-date-render-portal",B=function(){var e=(0,s.L)().setIsDirty,t=(0,i.Gc)(),n=t.formState,f=n.isDirty,m=n.isSubmitSuccessful,p=(0,c.Zh)().record,b=!!(null==p?void 0:p.id);return(0,o.useEffect)(function(){e(f)},[e,f]),(0,d.K)({cacheKey:l._7,fields:["name","body","tiptap_body","space_id","cover_image"],enabled:!b&&!m}),(0,a.y1)("meta+enter, ctrl+enter",function(){(0,u.C)(t)&&t.triggerFormSubmit()},{enableOnContentEditable:!0,enableOnFormTags:["INPUT","TEXTAREA"]},[t]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w,{}),(0,r.jsx)("div",{id:U}),(0,r.jsx)(L,{}),(0,r.jsx)("div",{id:"space-select-for-mobile"}),(0,r.jsx)("div",{id:"topics-picker-portal"}),(0,r.jsx)(F.$,{})]})}},440274:function(e,t,n){n.d(t,{L:()=>w});var r=n(552676),o=n(932699),i=n(757105),a=n(434519),s=n(751169),l=function(){return(0,r.jsx)(a.u_.Content,{className:"flex min-h-[400px] items-center justify-center",children:(0,r.jsx)(s.a,{})})},c=n(986214),u=n(441342),d=n(257210),f=n(1892),m=function(e){var t=e.post,n=e.onSubmitSuccess,o=e.onPostChange,i=e.shouldSkipRedirectAfterSubmit,a=(0,f.t)({spaceId:t.space_id,postSlug:t.slug,queryOptions:{cacheTime:0},context:"edit-post-modal"}),s=a.post,m=a.isLoading,p=(0,d.hD)(t.id).isLoading;return m||p?(0,r.jsx)(l,{}):(0,r.jsx)(u.DW,{post:s,onPostChange:o,children:(0,r.jsx)(c.H,{shouldSkipRedirectAfterSubmit:i,onSubmitSuccess:n})})},p=n(843515),b=n(720987),h=n(313087),v=n(391149),y=n(856516),g=n(179895),x=n(706233),_=function(e){var t=e.post,n=e.onSubmitSuccess,s=e.onPostChange,l=e.shouldSkipRedirectAfterSubmit,c=(0,i.dd)(),u=(0,p.L)().isDirty,f=(0,h.c)({shouldPrevent:u}),_=(0,g.Z)(),j=(0,x.d)(),w=(0,y.d)(),O=_.visible||j.visible||w.visible;return(0,b.u)({disabled:O,onClose:f}),(0,r.jsxs)(a.u_,{isOpen:c.visible,onClose:o.noop,className:"quick-post-v2-modal w-full max-w-3xl",children:[(0,r.jsx)(a.u_.Overlay,{onClick:f}),(0,r.jsx)(v.H,{children:(0,r.jsx)(d._x,{perPagePostIds:[[t.id]],queryOptions:{cacheTime:0},queryContext:"edit-post-modal",children:(0,r.jsx)(m,{post:t,onPostChange:s,onSubmitSuccess:n,shouldSkipRedirectAfterSubmit:l})})})]})},j=i.gk.create(function(e){return(0,r.jsx)(_,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),w=function(){return(0,i.dd)(j)}},986214:function(e,t,n){n.d(t,{H:()=>F});var r=n(552676),o=n(275271),i=n(619803),a=n.n(i),s=n(932699),l=n(131906),c=n(903225),u=n(739792),d=n(78456),f=n(251630),m=n(757105),p=n(208413),b=n(187394),h=n(775148),v=n(39905),y=n(381636),g=function(){var e=(0,c.k6)(),t=function(){return e.push("/")};return(0,r.jsxs)("div",{className:"border-primary bg-primary sticky top-0 z-10 flex items-center justify-between border-b px-5 py-3.5 sm:rounded-t-2xl",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(h.h,{name:"20-arrow-left",iconSize:20,className:"!p-0",iconClassName:"!h-5 !w-5",onClick:t,ariaLabel:(0,u.t)("previous")}),(0,r.jsx)(y.Z.TitleSm,{weight:"semibold",children:(0,u.t)("quick_post_v2.settings")})]}),(0,r.jsx)(v.z,{type:"button",onClick:t,variant:"circle",children:(0,u.t)("quick_post_v2.done")})]})},x=function(){return(0,r.jsxs)("div",{className:"h-full overflow-auto",children:[(0,r.jsx)(g,{}),(0,r.jsx)(b.l,{})]})},_=n(843515),j=n(241769),w=n(403697),O=n(441342),S=n(941084),P=n(283095),C=n(434519),k=n(767900),I=n(60878),N=n(497202),A=n(390431),M=n(957363),T=n(431089),E=n(57851),R=n(474520),D=m.gk.create(function(e){var t=e.post,n=(0,N.dd)(),o=(0,R.$)(),i=o.onShareViaBroadcast,a=o.isLoading;return(0,r.jsx)(A.o,{isOpen:n.visible,onClose:n.hide,title:(0,u.t)("quick_post_v2.connection_modal.title"),description:(0,u.t)("quick_post_v2.connection_modal.description",{space_name:t.space_name}),isLoading:a,"data-testid":"post-momentum-modal",children:(0,r.jsx)(E.X,{children:(0,r.jsx)(T.K,{iconEl:(0,r.jsx)(M.JO,{type:"20-page-edit-text",size:20}),onClick:function(){i({postId:t.id,onSuccess:function(){n.hide()}})},disabled:a,"data-testid":"send-announcement-button",children:(0,u.t)("momentum_modal.share_broadcast.review_draft")})})})});function L(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var F=function(e){var t=e.shouldSkipRedirectAfterSubmit,n=e.onSubmitSuccess,i=(0,m.dd)(),b=(0,_.L)(),h=b.isFullscreen,v=b.setIsSubmitting,y=(0,I.pm)(),g=y.success,N=y.error,A=(0,c.k6)(),M=(0,O.wh)(),T=M.currentCommunitySettings,E=M.currentCommunityMember,R=!!(null==T?void 0:T.tiptap_post_enabled),F=(0,O.Zh)(),U=F.onPostChange,B=F.helpers,q=null==B?void 0:B.postForTrixEditor,z=!!(null==B?void 0:B.isTiptapPost),Z=q&&q(),V=!!Z.id,H=(0,d.vb)(E),W=(0,P.d)({cacheKey:w._7}).resetValues,Q=(0,l.useMutation)(function(e){return f.Fv.createOrUpdate({post:{id:Z.id,slug:Z.slug,space_id:Z.space_id||e.space_id},formData:e})},{onSuccess:function(e){var r;return(r=function(){var r,o,a;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(l){switch(l.label){case 0:return[4,e.json()];case 1:return r=l.sent(),(0,s.isFunction)(U)&&U(r),(0,s.isFunction)(n)&&n(),V||W(),o=function(){if(V)return void g((0,u.t)("quick_post.toasts.changes_saved"));var e="published"===r.status;if(H&&e)return void m.gk.show(D,{post:r});g((0,u.t)("quick_post.toasts.".concat(r.status,"_saved")))},i.remove(),o(),a=(0,S.RG)({post:r}),t||A.push(a),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function a(e){L(i,n,o,a,s,"next",e)}function s(e){L(i,n,o,a,s,"throw",e)}a(void 0)})})()},onError:function(){return N((0,u.t)("quick_post.toasts.failed_to_create"))}});return(0,o.useEffect)(function(){v(Q.isLoading)},[Q.isLoading,v]),(0,r.jsx)(k.l,{id:"quick-post-form",defaultValues:Z,mode:"all",className:"h-full",formClassName:"h-full flex flex-col",onSubmit:function(e){return Q.mutate(e)},validationSchema:(V?z:R)?j.vY:j.gR,children:(0,r.jsx)(C.u_.Content,{size:h?"screen":"auto",className:a()("overflow-visible",{"max-h-none":h,"h-full max-h-full max-w-[720px] !rounded-t-none sm:h-full sm:!rounded-t-lg md:max-h-[80vh] lg:max-h-[550px]":!h}),animations:"fadeIn",children:(0,r.jsx)(c.VA,{children:(0,r.jsxs)(c.rs,{children:[(0,r.jsx)(c.AW,{component:p.V,path:"/",exact:!0}),(0,r.jsx)(c.AW,{component:x,path:"/settings"})]})})})})}},187394:function(e,t,n){n.d(t,{l:()=>C,f:()=>P});var r=n(552676),o=n(227851),i=n(739792),a=n(227053),s=n(330889),l=n(617013),c=n(441342),u=n(78456),d=n(941084),f=n(60589),m=n(813248),p=n(773262),b=n(767900),h=n(61641),v=n(751169),y=function(e){var t;return"function"==typeof(null==e||null==(t=e.helpers)?void 0:t.basicSpacesWithPostCreationAllowed)},g=function(e){var t;return"object"==((t=null==e?void 0:e.current_user_roles)&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t)},x=function(e){var t,n=e.space,o=(0,a.m)().post,x=!!g(n)&&!!(0,f.k8)(n),_=(0,c.nT)();y(_)&&(t=_.helpers.basicSpacesWithPostCreationAllowed());var j=(0,c.wh)().currentCommunityMember,w=new Date().toUTCString(),O=(0,m.k)({enabled:(0,u.vb)(j)}),S=O.data,P=void 0===S?{}:S,C=O.isLoading,k=(null==P?void 0:P.internal_custom_html_enabled)!==void 0&&P.internal_custom_html_enabled,I=!!o.id&&(0,d.Hz)(o);return C?(0,r.jsx)(v.a,{}):(0,r.jsxs)(r.Fragment,{children:[I&&(0,r.jsxs)("div",{className:"form-group form-group--column !mt-0",children:[(0,r.jsx)(s.Q,{field:"created_at",label:(0,i.t)("publish_date"),description:(0,i.t)("publish_date_description")}),(0,r.jsx)(p.W,{name:"created_at",maxDate:w})]}),(0,d.rq)(n)&&(0,r.jsxs)("div",{className:"form-group form-group--two-columns",children:[(0,r.jsx)(s.Q,{field:"cardview_thumbnail",label:(0,i.t)("cardview_thumbnail")}),(0,r.jsx)(h.a,{name:"cardview_thumbnail",aspectRatio:2,title:(0,i.t)("upload_a_cardview_thumbnail")})]}),(0,u.vb)(j)&&k&&(0,r.jsx)(b.l.Item,{hideBorder:!0,name:"internal_custom_html",fullWidth:!0,translationRoot:"post",hidePlaceholder:!0,variant:"extra-bottom-margin",children:(0,r.jsx)(b.l.TextArea,{name:"internal_custom_html"})}),(0,r.jsx)(b.l.Item,{variant:"extra-bottom-margin",hideBorder:!0,name:"space_id",translationRoot:"post",fullWidth:!0,children:(0,r.jsx)(l.M,{name:"space_id",variant:"form-input",spaces:t})}),(0,r.jsx)(b.l.Item,{variant:"extra-bottom-margin",hideBorder:!0,name:"slug",fullWidth:!0,translationRoot:"post",hidePlaceholder:!0,children:(0,r.jsx)(b.l.Input,{name:"slug"})}),x&&(0,r.jsx)(b.l.Item,{variant:"extra-bottom-margin",hideBorder:!0,name:"user_id",translationRoot:"post",fullWidth:!0,children:(0,r.jsx)(b.l.CommunityMemberSelect,{name:"user_id",direction:"up",valueField:"user_id"})})]})},_=n(403697),j=["meta_title","meta_description","opengraph_title","opengraph_description"],w=function(){return(0,r.jsx)("div",{className:"form-section",children:(0,r.jsxs)("div",{className:"form-section__content",children:[j.map(function(e){return(0,r.jsx)(b.l.Item,{label:(0,i.t)("meta_tag_attributes.".concat(e)),description:(0,i.t)("meta_tag_attributes.".concat(e,"_description"),{obj:"post"}),name:"meta_tag_attributes.".concat(e),hideBorder:!0,variant:"extra-bottom-margin",children:(0,r.jsx)(b.l.Input,{id:e,name:"meta_tag_attributes.".concat(e)},e)},e)}),(0,r.jsx)(b.l.Item,{name:"meta_tag_attributes.opengraph_image",label:(0,i.t)("meta_tag_attributes.opengraph_image"),hideBorder:!0,hideDescription:!0,variant:"extra-bottom-margin",children:(0,r.jsx)(h.a,{name:"meta_tag_attributes.opengraph_image",aspectRatio:_.pI.OPEN_GRAPH})})]})})},O=function(e){var t=e.name;return(0,r.jsx)(b.l.Item,{id:"post_".concat(t),name:t,label:(0,i.t)("post.".concat(t)),hideBorder:!0,hideDescription:!0,inlineReverse:!0,children:(0,r.jsx)(b.l.ToggleSwitch,{name:t,variant:"small"})})},S=function(e){var t=e.space,n=(0,a.m)().post,i=(0,(0,o.Gc)().watch)("is_comments_disabled"),s=!!n.id&&(0,d.Hz)(n);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O,{name:"hide_meta_info"}),(0,r.jsx)(O,{name:"is_comments_disabled"}),!i&&(0,r.jsx)(O,{name:"is_comments_closed"}),(0,r.jsx)(O,{name:"is_liking_disabled"}),(0,r.jsx)(O,{name:"is_truncation_disabled"}),s&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O,{name:"pin_to_top"}),!(null==t?void 0:t.hide_right_sidebar)&&(0,r.jsx)(O,{name:"pinned_at"})]}),!(null==t?void 0:t.hide_from_featured_areas)&&(0,r.jsx)(O,{name:"hide_from_featured_areas"})]})},P=function(e){var t;return"function"==typeof(null==e||null==(t=e.helpers)?void 0:t.findById)},C=function(){var e,t=(0,o.Gc)().watch,n=t("created_at"),i=t("space_id"),a=(0,c.nT)();return P(a)&&(e=a.helpers.findById(i)),(0,r.jsxs)("div",{className:"mx-auto max-w-3xl px-5 pb-5 pt-2",children:[(0,r.jsx)(S,{space:e}),(0,r.jsx)("div",{className:"my-4"}),(0,r.jsx)(x,{space:e}),!!n&&(0,r.jsx)(w,{})]})}},843515:function(e,t,n){n.d(t,{L:()=>r});var r=(0,n(798104).Ue)(function(e){return{isFullscreen:!1,toggleFullscreen:function(){return e(function(e){return{isFullscreen:!e.isFullscreen}})},isSubmitting:!1,setIsSubmitting:function(t){return e({isSubmitting:t})},isDirty:!1,setIsDirty:function(t){return e({isDirty:t})}}})},720987:function(e,t,n){n.d(t,{u:()=>o});var r=n(117383),o=function(e){var t=e.disabled,n=e.onClose;(0,r.y1)("esc",n,{enabled:!t,enableOnContentEditable:!0,enableOnFormTags:["INPUT","TEXTAREA"]},[t])}},474520:function(e,t,n){n.d(t,{$:()=>s});var r=n(903225),o=n(326371),i=n(343832),a=n(999037),s=function(){var e=(0,r.k6)(),t=(0,a.l)(),n=t.mutate,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,["mutate"]),l=(0,i.g)();return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({onShareViaBroadcast:function(t){var r=t.postId,i=t.onSuccess;if(!l){e.push(o.e.list()),null==i||i();return}n({source_content_id:r,source_content_type:"Post"},{onSuccess:function(t){null==i||i(),e.push(o.e.edit({broadcastId:t.broadcast.id}))}})}},s)}},313087:function(e,t,n){n.d(t,{c:()=>i});var r=n(739792),o=n(757105),i=function(e){var t=e.shouldPrevent,n=e.message,i=(0,o.dd)();return function(){(!t||confirm(n||(0,r.t)("quick_post_v2.accidental_leave_confirmation")))&&i.remove()}}},241769:function(e,t,n){n.d(t,{NU:()=>s,bG:()=>o,gR:()=>c,r1:()=>i,vY:()=>u});var r=n(779774),o=function(e){return!!e},i=function(e){return!!e},a=["image","file","embed","mention","horizontalRule"],s=function(e){var t,n;return null!=e&&null!=(n=e.body)&&null!=(t=n.content)&&!!t.length&&e.body.content.some(function(e){return!!e.content||a.includes(e.type)})},l=r.Ry().shape({space_id:r.Rx().required()}),c=r.Ry().shape({name:r.Z_().when("body",{is:function(e){return!o(e)},then:r.Z_().required(),otherwise:r.Z_().nullable()}),body:r.Z_().when("name",{is:function(e){return!i(e)},then:r.Z_().required(),otherwise:r.Z_().nullable()})},[["name","body"]]).concat(l),u=r.Ry().shape({name:r.Z_().when("tiptap_body",{is:function(e){return!s(e)},then:r.Z_().required(),otherwise:r.Z_().nullable()}),tiptap_body:r.Ry().when("name",{is:function(e){return!i(e)},then:r.Ry().test({test:function(e){return s(e)}}),otherwise:r.Ry().nullable()})},[["name","tiptap_body"]]).concat(l)},734335:function(e,t,n){n.d(t,{V:()=>r});var r={thumbsup:"\uD83D\uDC4D",heart:"❤️",tada:"\uD83C\uDF89",joy:"\uD83E\uDD23",open_mouth:"\uD83D\uDE2E",cry:"\uD83D\uDE22",pray:"\uD83D\uDE4F"}},965344:function(e,t,n){n.d(t,{D:()=>O});var r=n(552676),o=n(275271),i=n(383294),a=n(619803),s=n.n(a),l=n(230967),c=n(321405),u=n(739792),d=n(447640),f=n(315346),m=n(957363),p=n(936353),b=n(380171),h=n(734335),v=n(932699),y=n(441342),g=n(993441),x=function(e){var t=e.emoji,n=e.reactionableId,o=e.reactionableType,i=e.currentCommunityMemberId,a=e.onClose,s=e.reactions,l=(0,y.wh)().isViewOnlyMasquerading,c=h.V[t],u=(0,g.z)({currentCommunityMemberId:i,emoji:t,reactionableId:n}),d=u.addReaction,f=u.removeReaction;return c?(0,r.jsx)("button",{type:"button",className:"hover:bg-secondary focus-visible:!outline-secondary relative flex gap-1 rounded-md border-transparent px-2 py-0.5 text-sm focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",onClick:l?v.noop:function(){var e,r=(o in(e={emoji:t})?Object.defineProperty(e,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[o]=n,e),l=s.find(function(e){return e.emoji===t});l&&l.community_member_ids.includes(i)?f(r):d(r),a()},children:c}):null},_=function(e){var t=e.reactionableId,n=e.reactionableType,o=e.reactions,i=e.onClose,a=e.currentCommunityMemberId;return(0,r.jsx)("div",{className:"bg-primary flex gap-1 rounded-lg p-1","data-testid":"popover-content",children:Object.keys(h.V).map(function(e){return(0,r.jsx)(x,{emoji:e,reactionableId:t,reactionableType:n,reactions:o,onClose:i,currentCommunityMemberId:a},e)})})};function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var O=function(e){var t=e.reactions,n=e.currentCommunityMemberId,a=e.reactionableId,h=e.reactionableType,v=e.showBorder,y=void 0!==v&&v,g=e.setActiveMessageId,x=e.isMessageThread,j=void 0!==x&&x,O=e.isRenderedOnHeader,S=w((0,o.useState)(null),2),P=S[0],C=S[1],k=w((0,o.useState)(null),2),I=k[0],N=k[1],A=(0,c.D)(P,I,{placement:y?"top-start":"bottom-end"}),M=A.styles,T=A.attributes,E=(0,p.Op)().scrollerId,R=(0,d.D)().frameDocument,D=null;return j&&(D=R.getElementById("message-thread-scroll-view")),!D&&void 0!==O&&O&&(D=R.getElementById("threads-scroll-view")),!D&&E&&(D=R.getElementById(E)),D||(D=(0,f.j_)(R)),(0,r.jsx)(i.J,{className:"relative",children:function(e){var o,c,d=e.open,p=e.close;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.J.Button,{ref:C,className:s()("hover:bg-secondary focus:bg-secondary flex h-[1.625rem] items-center justify-center rounded px-1.5 transition-transform",{"border-primary rounded-full border px-1 hover:border-gray-400":y,"h-6 w-6":!y}),onClick:function(){return!d&&g&&g((0,f.h7)(a,j))},children:(0,r.jsx)(b.T,{placement:"bottom",interactive:!1,content:(0,u.t)("tiptap.add_reaction"),dataTestId:"add_reaction",className:"flex",children:(0,r.jsx)(m.JO,{"aria-label":(0,u.t)("tiptap.add_reaction"),type:"16-reaction",viewBox:"-2 -2 20 20",className:"text-default"})})}),D&&(0,l.createPortal)((0,r.jsx)(i.J.Panel,(o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({ref:N,style:M.popper,className:"z-[21]","data-testid":"filter_component"},T.popper),c=c={children:(0,r.jsx)("div",{className:"border-primary mt-1 rounded-lg border shadow-xl",children:(0,r.jsx)(_,{reactions:t,reactionableId:a,reactionableType:h,onClose:p,currentCommunityMemberId:n})})},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(c)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(c)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(c,e))}),o)),D)]})}})}},993441:function(e,t,n){n.d(t,{z:()=>c});var r=n(275271),o=n(131906),i=n(251630),a=n(579528),s=n(26674);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var c=function(e){var t,n=e.currentCommunityMemberId,c=e.emoji,u=e.reactionableId,d=e.reactionableType,f=e.setCommunityMembers,m=e.communityMemberIds,p=void 0===m?[]:m,b=(0,a.Q)(),h=b.createReactionFromMessage,v=b.removeReactionFromMessage,y=(0,s.N)(),g=y.createReactionFromThread,x=y.removeReactionFromThread,_=(t=(0,r.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return l(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),j=_[0],w=_[1],O=(0,o.useMutation)(function(e){return i.ob.addReaction(e)},{onSettled:function(){w(!1)}}).mutateAsync,S=(0,o.useMutation)(function(e){return i.ob.removeReaction(e)},{onSettled:function(){w(!1)}}).mutateAsync,P=(0,o.useQuery)(["reaction",u,d,c],function(){return i.ob.fetchCommunityMemberDetails({ids:p.join(",")})},{onSuccess:function(e){f&&f(e)},enabled:!1}).refetch,C=function(e){null==h||h(e),null==g||g(e)},k=function(e){null==v||v(e),null==x||x(e)};return{addReaction:function(e){w(!0),C({communityMemberId:n,emoji:e.emoji,reactionableId:e.chat_room_message}),O(e)},removeReaction:function(e){w(!0),k({communityMemberId:n,emoji:e.emoji,reactionableId:e.chat_room_message}),S(e)},fetchCommunityMembers:P,isLoading:j}}},637927:function(e,t,n){n.d(t,{D:()=>h});var r=n(552676),o=n(275271),i=n(932699),a=n(125533),s=n(756468),l=n(739792),c=n(22319),u=n(957363),d=n(187461),f=(0,o.forwardRef)(function(e,t){var n,o;return(0,r.jsx)("input",(n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),o=o={className:"text-darkest placeholder:text-light min-w-0 flex-1 cursor-pointer truncate border-none bg-transparent p-0 text-center text-sm font-medium placeholder:opacity-100 focus:outline-none focus:ring-0 sm:min-w-[16rem] sm:flex-none",ref:t},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}),n))});f.displayName="DatePickerInput";var m=n(467767);function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var h=function(e){var t=e.defaultDateRange,n=e.onChange,p=e.minDate,h=e.maxDate,v=e.predefinedRange,y=e.predefinedRangePickerOptions,g=void 0===y?m.rG:y,x=(0,c.ww)().section,_=(0,o.useRef)(null),j=b((0,o.useState)(function(){if(v){var e=g.find(function(e){return e.value===v});if(e&&e.value!==m.l7.value)return e}return t?m.l7:m.WJ}),2),w=j[0],O=j[1];return(0,r.jsxs)("div",{className:"flex flex-col gap-y-2 sm:flex-row sm:items-center sm:gap-y-0",children:[(0,r.jsx)(d.R,{value:w,options:g,onChange:function(e){var t,r=b(e.onSelect(),2),o=r[0],i=r[1],a=null==(t=_.current)?void 0:t.flatpickr;(0,s.Z)(a,"flatPickrInstance is null"),a.setDate([o,i],!1),n([o,i],e),O(e)},className:"min-w-[12rem] rounded-s-md sm:rounded-r-none sm:rounded-s-md md:min-w-[13rem] lg:min-w-[14rem]"}),(0,r.jsx)(a.default,{ref:_,options:{mode:"range",dateFormat:"M d, Y",defaultDate:w&&w.value!==m.l7.value?w.onSelect():t||void 0,minDate:p,maxDate:h,onReady:function(){x!==c.kS.USER&&(0,i.defer)(function(){var e,t=null==(e=_.current)?void 0:e.flatpickr;(0,s.Z)(t,"flatPickrInstance is null"),t.calendarContainer.classList.add("settings-app")})}},render:function(e,t){return(0,r.jsxs)("button",{type:"button",className:"border-dark focus-within:bg-secondary -ml-px flex h-10 w-full min-w-0 max-w-full cursor-pointer items-center gap-x-2 rounded-r-md border border-l-0 px-3 py-2 sm:min-w-0 sm:max-w-none sm:rounded-l-none",onClick:function(){var e,t,n;null==(n=_.current)||null==(t=n.flatpickr)||null==(e=t.open)||e.call(t)},"aria-label":(0,l.t)("date_range.open_date_picker"),children:[(0,r.jsx)(u.JO,{type:"16-calendar",size:16,className:"text-default shrink-0"}),(0,r.jsx)(f,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({ref:t},e))]})},onChange:function(e){var t=b(e,2),r=t[0],o=t[1];r&&o&&(n([r,o],m.l7),O(m.l7))}})]})}},467767:function(e,t,n){n.d(t,{WJ:()=>m,l7:()=>f,rG:()=>d});var r=n(664586),o=n(204423),i=n(345585),a=n(11343),s=n(742537),l=n(405201),c=n(739792),u="date_range",d=[{label:(0,c.t)([u,"last_7_days"]),value:"last_7_days",onSelect:function(){return[(0,r.default)(new Date,7),new Date]}},{label:(0,c.t)([u,"last_4_weeks"]),value:"last_4_weeks",onSelect:function(){return[(0,o.default)(new Date,4),new Date]}},{label:(0,c.t)([u,"last_3_months"]),value:"last_3_months",onSelect:function(){return[(0,i.default)(new Date,3),new Date]}},{label:(0,c.t)([u,"last_12_months"]),value:"last_12_months",onSelect:function(){return[(0,i.default)(new Date,12),new Date]}},{label:(0,c.t)([u,"month_to_date"]),value:"month_to_date",onSelect:function(){return[(0,a.default)(new Date),new Date]}},{label:(0,c.t)([u,"quarter_to_date"]),value:"quarter_to_date",onSelect:function(){return[(0,s.default)(new Date),new Date]}},{label:(0,c.t)([u,"year_to_date"]),value:"year_to_date",onSelect:function(){return[(0,l.default)(new Date),new Date]}}],f={label:(0,c.t)([u,"custom"]),value:"custom",onSelect:function(){return[new Date,new Date]}},m=d[2]},187461:function(e,t,n){n.d(t,{R:()=>u});var r=n(552676),o=n(275271),i=n(967949),a=n(598222),s=n(701168),l=n(957363),c=n(381636);function u(e){var t=e.buttonLabel,n=e.value,u=e.options,d=e.onChange,f=e.className,m=e.showButtonDescription,p=void 0===m||m?n.description:void 0;return(0,r.jsx)(i.R,{value:n,onChange:d,children:function(e){var d=e.open;return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)(i.R.Button,{className:(0,s.A)("focus-within:bg-secondary border-dark flex h-10 items-center justify-between gap-x-2 border px-3 py-2",{"bg-secondary":d},f),children:[(0,r.jsxs)("div",{className:"flex-1 truncate text-left",children:[(0,r.jsx)(c.Z.LabelSm,{weight:"medium",children:null!=t?t:n.label}),p?(0,r.jsx)("span",{className:"text-default mt-1 block",children:(0,r.jsx)(c.Z.LabelXs,{children:p})}):null]}),(0,r.jsx)(l.JO,{type:"16-chevron-down",size:16,className:(0,s.A)("shrink-0",d?"text-darkest":"text-default")})]}),(0,r.jsx)(a.u,{as:o.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)(i.R.Options,{className:"bg-primary absolute !z-50 mt-1 max-h-96 w-full overflow-auto rounded-md py-2 shadow-2xl",children:u.map(function(e){return(0,r.jsx)(i.R.Option,{value:e,className:"hover:text-dark hover:bg-secondary cursor-pointer list-none px-5 py-2",children:function(t){var n=t.selected;return(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)(c.Z.LabelSm,{weight:n?"medium":void 0,color:n?"text-selector-active":void 0,children:e.label}),e.description&&(0,r.jsx)("span",{className:"text-default mt-1",children:(0,r.jsx)(c.Z.LabelXs,{children:e.description})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.upgradeDetails&&(0,r.jsx)(l.JO,{type:"16-lock"}),n&&(0,r.jsx)(l.JO,{type:"20-checkmark",className:"text-selector-active"})]})]})}},e.value)})})})]})}})}},466056:function(e,t,n){n.d(t,{p:()=>s});var r=n(552676),o=n(739792),i=n(408306),a=n(381636),s=function(e){var t=e.data,n=e.rootLocale,s=e.headerLabel,l=e.trendDeltaPercentage,c=t.total_members||t.new_members||t.active_members||0;return(0,r.jsxs)("div",{className:"bg-primary w-max rounded-lg p-4 shadow-md",children:[s&&(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)(a.Z.LabelSm,{weight:"semibold",children:s})}),(0,r.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,r.jsxs)(a.Z.LabelSm,{weight:"semibold",children:[(0,o.t)([n,"members"]),":"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(a.Z.LabelSm,{weight:"semibold",children:c.toLocaleString()}),"number"==typeof l?(0,r.jsx)(i.E,{deltaPercentage:l,withBackground:!1}):null]})]})]})}},903640:function(e,t,n){n.d(t,{EC:()=>a});var r=["#2563EB","#7C3AED","#06B6D4","#60A5FA","#8B5CF6","#0EA5E9","#A78BFA","#38BDF8","#93C5FD","#C084FC","#22D3EE","#DDD6FE"],o=function(e){for(var t=0,n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n)|0;return Math.abs(t)},i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n="number"==typeof e?e:(o(String(e))+Math.abs(t))%r.length;return r[n%r.length]},a=function(e,t){return Array.from({length:e},function(e,n){return i(t?"".concat(t,"-").concat(n):n)})}},203468:function(e,t,n){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{B9:()=>a,He:()=>o,Nb:()=>s,ad:()=>i});var o=function(e){return"number"==typeof e?e:Number(e||0)},i=function(e,t){if(Number.isFinite(e)&&Number.isFinite(t)&&0!==t)return(e-t)/Math.abs(t)*100},a=function(e){if(e&&0!==e.length){var t=new Map;return e.forEach(function(e){t.set(String(e.id),Number(e.value)||0)}),t.size>0?t:void 0}},s=function(e,t,n){var o;return["analyticsV4"].concat(function(e){if(Array.isArray(e))return r(e)}(o=e.split("."))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return r(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}}(o)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[t,n.start_date,n.end_date,n.date_grouping,JSON.stringify(n.filters||{})])}},168204:function(e,t,n){n.d(t,{Kj:()=>o,Rm:()=>i,pC:()=>r});var r="text-[#6C58E8]",o="copilot",i="activity_scores"},946582:function(e,t,n){n.d(t,{b:()=>E});var r=n(552676),o=n(757105),i=n(739792),a=n(481445),s=n(824869),l=n(69831),c=n(269075),u=n(434519),d=n(381636),f=function(e){var t=e.property,n=e.number,o=e.red,i=void 0!==o&&o,a=10*parseFloat(n);return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,r.jsx)(d.Z.BodyXs,{children:t}),(0,r.jsx)(d.Z.LabelXxs,{weight:"bold",color:i?"text-red-500":"text-green-700",children:n})]}),(0,r.jsx)("div",{className:"bg-tertiary h-1 w-full rounded",children:(0,r.jsx)("div",{className:"h-full rounded ".concat(i?"bg-red-500":"bg-green-700"),style:{width:"".concat(a,"%")}})})]})},m=function(){var e="settings.community_ai.marketing_modal";return(0,r.jsxs)("div",{className:"border-primary rounded border p-5",children:[(0,r.jsx)("div",{className:"mb-1",children:(0,r.jsx)(d.Z.LabelLg,{weight:"bold",color:"text-default",children:(0,i.t)("".concat(e,".activity_score.title"))})}),(0,r.jsx)(d.Z.BodySm,{color:"text-default",children:(0,i.t)("".concat(e,".activity_score.description"))}),(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[(0,r.jsx)(f,{property:(0,i.t)("".concat(e,".params.presence")),number:"9.5"}),(0,r.jsx)(f,{property:(0,i.t)("".concat(e,".params.contribution")),number:"5.0",red:!0}),(0,r.jsx)(f,{property:(0,i.t)("".concat(e,".params.participation")),number:"8.3"}),(0,r.jsx)(f,{property:(0,i.t)("".concat(e,".params.connection")),number:"8.5"})]})]})},p=n(957363),b=function(e){var t=e.localeItem;return(0,r.jsx)("span",{className:"bg-primary rounded-full px-3 py-1",children:(0,r.jsx)(d.Z.BodyXs,{children:(0,i.t)(["settings.community_ai.marketing_modal","copilot_items",t])})})},h=n(168204),v=function(){var e="settings.community_ai.marketing_modal";return(0,r.jsxs)("div",{className:"border-primary rounded border p-5 pb-0",children:[(0,r.jsx)("div",{className:"mb-1",children:(0,r.jsx)(d.Z.LabelLg,{weight:"bold",color:"text-default",children:(0,i.t)("".concat(e,".copilot.title"))})}),(0,r.jsx)(d.Z.BodySm,{color:"text-default",children:(0,i.t)("".concat(e,".copilot.description"))}),(0,r.jsxs)("div",{className:"relative mt-4 grid grid-cols-2 gap-1 p-4",children:[(0,r.jsx)("div",{className:"absolute inset-0 z-[-1] rounded-t-lg bg-gradient-to-r from-indigo-600 via-purple-600 to-indigo-600 opacity-5"}),(0,r.jsxs)("div",{className:"flex flex-row",children:[(0,r.jsx)(p.JO,{type:"16-artificial-intelligence",className:"text-blue-100"}),(0,r.jsx)(d.Z.LabelXs,{weight:"semibold",color:h.pC,children:(0,i.t)("".concat(e,".ask_ai_to"))})]}),(0,r.jsx)("div",{className:"col-span-2 flex justify-around",children:["give_me_ideas","translate","generate_a_paragraph"].map(function(e){return(0,r.jsx)(b,{localeItem:e},e)})}),(0,r.jsx)("div",{className:"col-span-2 mt-2 flex justify-around",children:["improve_writing","summarize","adjust_spelling"].map(function(e){return(0,r.jsx)(b,{localeItem:e},e)})})]})]})},y=n(900795),g=function(e){var t=e.localeItem;return(0,r.jsxs)("li",{className:"mb-4 flex items-start justify-start last:mb-0",children:[(0,r.jsx)("div",{className:"mt-1 flex size-5 items-center justify-center",children:(0,r.jsx)(p.JO,{size:14,type:"14-magic-ai"})}),(0,r.jsx)("span",{className:"ml-3 text-blue-100",children:(0,r.jsx)(d.Z.BodySm,{color:"text-default",children:(0,r.jsx)(y.w,{content:(0,i.t)(["settings.community_ai.marketing_modal","marketing_items",t]),as:"span"})})})]})},x=function(e){var t=e.feature;return(0,r.jsx)(u.u_.Body,{children:(0,r.jsx)("div",{className:"flex size-full pt-2",children:(0,r.jsxs)("div",{className:"max-w-xl",children:[t===h.Kj&&(0,r.jsx)(v,{}),t===h.Rm&&(0,r.jsx)(m,{}),(0,r.jsxs)("div",{className:"bg-tertiary mt-6 rounded p-4 pt-2",children:[(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)(d.Z.LabelXxs,{color:"text-default",children:(0,i.t)("settings.community_ai.marketing_modal.plus")})}),t===h.Kj&&(0,r.jsx)(g,{localeItem:"activity_scores"}),t===h.Rm&&(0,r.jsx)(g,{localeItem:"copilot"}),(0,r.jsx)(g,{localeItem:"transcriptions"})]})]})})})},_=n(903225),j=n(547144),w=n(413847),O=n(779869),S=n(39905);function P(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function C(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){P(i,r,o,a,s,"next",e)}function s(e){P(i,r,o,a,s,"throw",e)}a(void 0)})}}function k(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var I=function(e){var t=e.plan,n=e.handleClose,o=e.onSuccess,a=e.source,s=(0,O.w)(),l=(0,_.k6)(),c=(0,w.$2)(),f=function(){return C(function(){return k(this,function(e){switch(e.label){case 0:return l.push(j.Lo.settings.community_ai),o&&o(),[4,n()];case 1:return e.sent(),[2]}})})()};return(0,r.jsxs)(u.u_.Footer,{children:[(0,r.jsx)("div",{children:(0,r.jsx)(S.z,{onClick:function(){return C(function(){return k(this,function(e){switch(e.label){case 0:if(!c)return[3,2];return l.push(j.Lo.settings.community_ai),[4,n()];case 1:return e.sent(),[3,4];case 2:return[4,s.show({planId:t.id,onSuccess:f,source:a,successButtonLabel:(0,i.t)("settings.community_ai.marketing_modal.go_to_community_ai"),showPlanDetails:!0})];case 3:e.sent(),e.label=4;case 4:return[2]}})})()},large:!0,full:!0,variant:"circle",children:(0,i.t)("settings.community_ai.marketing_modal.submit")})}),!c&&(0,r.jsx)("div",{className:"my-3 text-center",children:(0,r.jsx)(d.Z.BodySm,{color:"text-default",children:(0,r.jsx)(y.w,{content:(0,i.t)("settings.community_ai.marketing_modal.by_proceeding",{plan_name:t.display_name,price:t.monthly_base_amount_with_interval}),as:"span"})})})]})},N=function(e){var t=e.handleClose;return(0,r.jsxs)(u.u_.Header,{children:[(0,r.jsxs)(u.u_.Title,{size:"md",className:"w-full text-center",children:[(0,r.jsx)("div",{className:"my-2 inline-block w-auto",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)(d.Z.TitleLg,{children:[(0,i.t)("settings.community_ai.marketing_modal.title.unlock")," ",(0,r.jsx)("span",{className:h.pC,children:(0,i.t)("settings.community_ai.marketing_modal.title.community_ai")})]}),(0,r.jsx)(p.JO,{type:"16-artificial-intelligence",className:"absolute -right-5 -top-1 text-blue-100"})]})}),(0,r.jsx)(d.Z.BodyMd,{color:"text-default",children:(0,i.t)("settings.community_ai.marketing_modal.subtitle")})]}),(0,r.jsx)(u.u_.HeaderActions,{className:"absolute right-0 top-0 mr-6 mt-6",children:(0,r.jsx)(u.u_.CloseButton,{onClick:t})})]})};function A(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var M=function(e){var t=e.afterClose,n=e.feature,d=void 0===n?h.Rm:n,f=e.source,m=e.onSuccess,p=(0,s.E)().changePlanModalParams,b=(0,o.dd)(),v=p(a.o),y=v.planTier,g=v.planId,_=(0,c.R)({planTier:y,planId:String(g)||""}),j=_.plan,w=_.isPlanLoading,O=function(){var e;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return t&&t(),[4,b.hide()];case 1:return e.sent(),b.remove(),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){A(i,r,o,a,s,"next",e)}function s(e){A(i,r,o,a,s,"throw",e)}a(void 0)})})()};return(0,r.jsxs)(u.u_,{title:"".concat((0,i.t)("settings.community_ai.marketing_modal.title.unlock")," ").concat((0,i.t)("settings.community_ai.marketing_modal.title.community_ai")),isOpen:b.visible,onClose:O,children:[(0,r.jsx)(u.u_.Overlay,{}),(0,r.jsx)(u.u_.Content,{size:"md",children:w?(0,r.jsx)("div",{className:"my-28",children:(0,r.jsx)(l.u,{})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N,{handleClose:O}),(0,r.jsx)(x,{feature:d}),(0,r.jsx)(I,{handleClose:O,plan:j,source:f,onSuccess:m})]})})]})},T=o.gk.create(function(e){var t=e.afterClose,n=e.feature,o=void 0===n?h.Rm:n,i=e.source,a=e.onSuccess;return(0,r.jsx)(M,{afterClose:t,feature:o,source:i,onSuccess:a})}),E=function(){return(0,o.dd)(T)}},481445:function(e,t,n){n.d(t,{o:()=>r});var r=n(906082).Gb.business},240761:function(e,t,n){n.d(t,{n:()=>i});var r=n(552676),o=n(701168),i=function(e){var t,n,i=e.question,a=e.onClick,s=e.className,l=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["question","onClick","className"]);return(0,r.jsx)("button",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({type:"button",onClick:a,className:(0,o.A)("focus-visible:!outline-secondary transition-colors duration-200 focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2 disabled:cursor-not-allowed","border-primary border","text-secondary","hover:bg-tertiary","disabled:border-gray-300 disabled:text-gray-400 disabled:opacity-50 disabled:hover:bg-transparent","whitespace-normal","rounded-[1.25rem]","px-3.5 py-2","text-left","text-sm font-medium leading-5","dark:text-dark dark:disabled:border-gray-600 dark:disabled:text-gray-500",s)},l),n=n={children:i},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))}},982847:function(e,t,n){n.d(t,{F:()=>s});var r=n(275271),o=n(131906),i=n(93199),a=n(698173),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=void 0===t?"":t,s=e.disabled,l=(0,o.useQuery)(["community-inbox","chat-bot","profiles",n],function(){return(0,i.UT)(a.a.communityInbox.botSearch({params:{name:n}}))},{enabled:!(void 0!==s&&s),staleTime:3e5*(""===n),cacheTime:6e5}),c=l.data,u=l.isLoading;return{botProfiles:(0,r.useMemo)(function(){return(null==c?void 0:c.records)||[]},[null==c?void 0:c.records]),isBotsLoading:u}}},281772:function(e,t,n){n.d(t,{O:()=>a});var r=n(131906),o=n(93199),i=n(698173),a=function(){return{createChat:(0,r.useMutation)(function(e){return(0,o.Cu)(i.a.communityInbox.create(),{community_bot_profile_id:e.id,body:e.body||null})},{onError:function(e){console.error("Error while creating chat",e)}}).mutateAsync}}},710749:function(e,t,n){n.d(t,{Or:()=>s,aO:()=>a,vO:()=>l});var r=n(275271),o=n(861853);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var a={FIRST_LOAD:"FIRST_LOAD",PAGINATION:"PAGINATION",NEW_MESSAGE:"NEW_MESSAGE"},s="scrollableMessagesDiv",l=function(){var e,t=(e=(0,r.useState)(null),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return i(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=t[0],l=t[1],c=(0,o.Dk)(),u=c.scrollAction,d=c.setScrollAction,f=(0,r.useRef)(null),m=(0,r.useRef)(0),p=(0,r.useRef)(0),b=(0,r.useCallback)(function(){var e=document.getElementById(s);e&&(m.current=e.scrollHeight,p.current=e.scrollTop)},[]),h=(0,r.useCallback)(function(){var e=document.getElementById(s);if(e){var t=m.current,r=p.current;if(t){var o=e.scrollHeight-t;e.scrollTop=r+o}else if(n){var i,a=null==(i=n.id)?void 0:i.toString(),l=a?document.getElementById(a):null;null==l||l.scrollIntoView()}}},[n]),v=(0,r.useCallback)(function(){var e=document.getElementById(s);e&&(f.current=setTimeout(function(){e.scrollTop=e.scrollHeight},500))},[]),y=(0,r.useCallback)(function(){var e=document.getElementById(s);e&&(e.scrollTop=e.scrollHeight)},[]),g=(0,r.useCallback)(function(){switch(f.current&&u===a.PAGINATION&&clearTimeout(f.current),u){case a.PAGINATION:h();break;case a.FIRST_LOAD:v();break;case a.NEW_MESSAGE:y()}},[u,h,v,y]);return(0,r.useEffect)(function(){return function(){f.current&&clearTimeout(f.current)}},[]),{setFirstMessage:l,setScrollAction:d,preparePagination:b,adjustScroller:g}}},535471:function(e,t,n){n.d(t,{D:()=>i});var r=n(861853),o=n(982847),i=function(){var e=(0,o.F)({name:""}).botProfiles,t=(0,r.Dk)().memberChats;return(null==e?void 0:e.length)>0||(null==t?void 0:t.length)>0}},786976:function(e,t,n){n.d(t,{F8:()=>a,c8:()=>s,g:()=>l});var r=n(131906),o=n(93199),i=n(547144),a="gamification/settings",s=function(){return(0,r.useQuery)({queryKey:[a],queryFn:function(){return(0,o.UT)(i.av.gamification.settings())}})},l=function(e){return(0,r.useMutation)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({mutationFn:function(e){return(0,o.aU)(i.av.gamification.settings(),e)}},e))}},456918:function(e,t,n){n.d(t,{z:()=>l});var r=n(552676),o=n(739792),i=n(413847),a=n(935565),s=n(381636);function l(e){var t=e.memberId,n=e.shortDisabledLabel,l=e.shouldHideIfNoScore,c=(0,a.wW)(),u=c.data,d=c.isLoading,f=(0,i.m3)();if(d)return null;if(f){var m={activityScore:{label:void 0!==n&&n?(0,o.t)("activity_score.view"):(0,o.t)("activity_score.view_score"),activity:"disabled"}};return(0,r.jsx)("div",{children:(0,r.jsx)(a.uy,{activityScore:m.activityScore})})}var p=null==u?void 0:u.get(t);return void 0!==l&&l&&!p?null:p?(0,r.jsx)(a.Yf,{scoreDetail:p}):(0,r.jsx)(s.Z.LabelSm,{color:"text-default",children:(0,o.t)("n/a")})}},741331:function(e,t,n){n.d(t,{Q:()=>b});var r=n(552676),o=n(739792),i=n(381636),a=n(619803),s=n.n(a),l=n(900795),c=function(e){var t=e.reported_reason_type,n=e.profanity_filter_matches,a=e.reported_reason_body;return t&&n||a?(0,r.jsxs)("div",{className:s()("bg-tertiary ml-12 flex flex-col gap-1.5 rounded-lg px-4 py-3"),children:[t&&n&&(0,r.jsx)(i.Z.LabelSm,{children:(0,r.jsx)(l.w,{content:(0,o.t)(["settings.moderation.review_flagged_content_modal","report_reasons",t],{matches:n}),as:"span"})}),a&&(0,r.jsx)(i.Z.LabelSm,{as:"p","data-testid":"report-reason-body",children:a})]}):null},u=n(664657),d=n(957363),f=n(789745),m="settings.moderation.review_flagged_content_modal",p=function(e){var t=e.reporter,n=e.reported_at,a=e.reported_reason_type,s=e.profanity_filter_matches,l=[null==t?void 0:t.first_name,null==t?void 0:t.last_name].filter(function(e){return e}).join(" ");return t?(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(u.W,{name:l,src:t.avatar_url,size:"8"}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(i.Z.LabelSm,{weight:"semibold",children:l}),(0,r.jsx)(i.Z.LabelSm,{color:"text-dark",children:(0,o.t)([m,"reason_labels.reported_for"])}),(0,r.jsx)(i.Z.LabelSm,{color:"text-dark",weight:"semibold","data-testid":"report-reason-type",children:(0,o.t)([m,"report_reasons",a])})]}),(0,r.jsx)(i.Z.LabelXs,{color:"text-dark",children:(0,f.p)(n)})]})]}):(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"flex size-8 items-center justify-center rounded-full bg-black",children:(0,r.jsx)(d.JO,{type:"lightning",size:16,className:"text-white"})}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(i.Z.LabelSm,{weight:"semibold","data-testid":"report-reason-type",children:(0,o.t)([m,"automatically_flagged"])}),s?(0,r.jsx)(i.Z.LabelSm,{color:"text-dark",children:(0,o.t)([m,"reason_labels.profanity_filter"])}):(0,r.jsx)(i.Z.LabelSm,{color:"text-dark",children:(0,o.t)([m,"reason_labels.for_approval"])})]}),(0,r.jsx)(i.Z.LabelXs,{color:"text-dark",children:(0,f.p)(n)})]})]})},b=function(e){var t=e.reports,n=void 0===t?[]:t;return(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-8 py-6",children:[n.map(function(e){var t=e.id,n=e.reported_reason_type,o=void 0===n?"":n,i=e.reported_reason_body,a=e.reported_at,s=e.reporter,l=e.profanity_filter_matches,u=void 0===l?"":l;return(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)(p,{reporter:s,reported_at:void 0===a?"":a,reported_reason_type:o,profanity_filter_matches:u}),(0,r.jsx)(c,{reported_reason_type:o,profanity_filter_matches:u,reported_reason_body:i})]},t)}),0===n.length&&(0,r.jsx)(i.Z.LabelSm,{color:"text-lightest",children:(0,o.t)(["settings.moderation.review_flagged_content_modal","empty"])})]})}},818285:function(e,t,n){n.d(t,{z:()=>s});var r=n(552676),o=n(739792),i=n(381636),a="settings.moderation.review_flagged_content_modal.visibility_info",s=function(e){var t=e.content;if(!(null==t?void 0:t.flagged_contentable))return null;var n=t.flagged_contentable,s=n.flagged_for_approval_at,l=n.removed_at,c=s||l?(0,o.t)([a,"hidden_until_approved"]):(0,o.t)([a,"visible_to_all_members"]);return(0,r.jsx)("div",{className:"flex items-center gap-4 px-8 py-0",children:(0,r.jsx)(i.Z.LabelSm,{children:c})})}},789745:function(e,t,n){n.d(t,{p:()=>o});var r=n(467610),o=function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,r.Z)(new Date(e),new Date,{addSuffix:t})}},998716:function(e,t,n){n.d(t,{B:()=>a});var r=n(552676),o=n(963549),i=n(381636),a=function(e){var t=e.showModal,n=e.onClose,a=e.onConfirm,s=e.title,l=e.confirmText,c=e.description,u=e.isLoading;return(0,r.jsx)(o.c,{isOpen:t,onClose:n,confirmVariant:"circle",size:"md",onConfirm:a,title:s,confirmText:l,disabled:void 0!==u&&u,children:(0,r.jsx)(i.Z.LabelMd,{children:c})})}},22039:function(e,t,n){n.d(t,{K:()=>z});var r=n(552676),o=n(275271),i=n(739792),a=n(269075),s=n(906082),l=n(757105),c=n(131906),u=n(93199),d=n(547144);function f(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var m=n(434519),p=n(39905),b=n(381636),h="settings.billing.plans.trial_opt_in_modal",v=function(e){var t=e.onClose;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(m.u_.Header,{children:[(0,r.jsx)(m.u_.Title,{children:(0,i.t)("".concat(h,".blocked_downgrade_scheduled.title"))}),(0,r.jsx)(m.u_.HeaderActions,{children:(0,r.jsx)(m.u_.CloseButton,{onClick:t})})]}),(0,r.jsx)(m.u_.Body,{children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)(b.Z.BodyMd,{children:(0,i.t)("".concat(h,".blocked_downgrade_scheduled.description"))}),(0,r.jsx)(b.Z.BodyMd,{color:"text-light",children:(0,i.t)("".concat(h,".blocked_downgrade_scheduled.explanation"))})]})}),(0,r.jsx)(m.u_.Footer,{children:(0,r.jsx)("div",{className:"flex flex-row justify-end",children:(0,r.jsx)(p.z,{variant:"primary",onClick:t,children:(0,i.t)("".concat(h,".blocked_downgrade_scheduled.button"))})})})]})},y=n(957363),g=function(e){var t=e.errorMessage,n=e.onClose;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.u_.Body,{children:(0,r.jsxs)("div",{className:"mx-auto mt-16 max-w-sm text-center",children:[(0,r.jsx)(y.JO,{type:"68-error-grey",size:68,className:"mb-10 !w-14"}),(0,r.jsx)(b.Z.TitleLg,{color:"text-darkest",children:(0,i.t)("".concat(h,".error.title"))}),(0,r.jsx)("div",{className:"mt-3",children:(0,r.jsx)(b.Z.BodyMd,{color:"text-subtle",weight:"normal",size:"text-base",children:t||(0,i.t)("".concat(h,".error.subtitle"))})})]})}),(0,r.jsx)(m.u_.Footer,{className:"mt-5",children:(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(p.z,{variant:"circle",large:!0,full:!0,onClick:n,children:(0,i.t)("".concat(h,".error.close_button"))})})})]})},x=function(e){var t=e.iconType,n=e.title,o=e.description;return(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("div",{className:"mt-0.5 shrink-0",children:(0,r.jsx)("div",{className:"flex size-4 items-center justify-center",children:(0,r.jsx)(y.JO,{type:t,size:16,className:"text-blue-600",useWithFillCurrentColor:!0})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(b.Z.LabelMd,{weight:"semibold",children:n}),(0,r.jsx)(b.Z.BodySm,{color:"text-subtle",children:o})]})]})},_=n(664470),j=function(e){var t=e.plan,n=e.isPlanLoading,o=e.className,a=n||!(null==t?void 0:t.display_base_monthly_amount),s=null==t?void 0:t.display_name,l=a?(0,r.jsx)(_.X2,{md:!0,long:!0}):(0,i.t)("".concat(h,".plan_card.trial_period_dynamic"),{price:t.display_base_monthly_amount});return(0,r.jsxs)("div",{className:"bg-primary border-primary rounded-xl border p-4 ".concat(void 0===o?"":o),children:[(0,r.jsxs)("div",{className:"mb-1 flex items-center justify-between",children:[(0,r.jsx)("div",{className:"text-white",children:(0,r.jsx)(b.Z.LabelLg,{weight:"semibold",children:n||!s?(0,r.jsx)(_.X2,{md:!0,long:!0}):s})}),(0,r.jsx)("div",{className:"flex flex-row items-center gap-1 align-middle",children:(0,r.jsx)("div",{className:"text-white",children:(0,r.jsx)(b.Z.LabelMd,{weight:"bold",children:n?(0,r.jsx)(_.X2,{md:!0,short:!0}):(0,i.t)("".concat(h,".plan_card.price"))})})})]}),(0,r.jsx)("div",{className:"text-white/70",children:(0,r.jsx)(b.Z.LabelXs,{children:l})})]})},w=[{key:"community_ai",iconType:"16-thunder"},{key:"workflows_apis",iconType:"sw-thunder"},{key:"custom_fields",iconType:"16-character-square"}],O=function(e){var t=e.onConfirm,n=e.plan,o=e.isPlanLoading,a="".concat(h,".left_pane.features");return(0,r.jsxs)("div",{className:"flex h-full flex-col pb-6 lg:pb-0",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)(b.Z.BodyMd,{color:"text-subtle",children:(0,i.t)("".concat(h,".left_pane.description"))})}),(0,r.jsx)("div",{className:"space-y-4",children:w.map(function(e){return(0,r.jsx)(x,{iconType:e.iconType,title:(0,i.t)("".concat(a,".").concat(e.key,".title")),description:(0,i.t)("".concat(a,".").concat(e.key,".description"))},e.key)})})]}),(0,r.jsxs)("div",{className:"mt-auto",children:[(0,r.jsx)("div",{className:"mb-4 lg:hidden",children:(0,r.jsx)(j,{plan:n,isPlanLoading:o})}),(0,r.jsx)(p.z,{variant:"marketing-gradient",large:!0,onClick:t,className:"w-full",children:(0,i.t)("".concat(h,".start_trial"))})]})]})},S=n(69831),P=function(){return(0,r.jsx)(m.u_.Body,{children:(0,r.jsx)("div",{className:"my-28",children:(0,r.jsx)(S.u,{title:(0,i.t)("".concat(h,".loading.title")),subtitle:(0,i.t)("".concat(h,".loading.subtitle"))})})})};let C=n.p+"static/images/features/profile-fields/en/value-prop_1x-98e7fafaa426df7e.png",k=n.p+"static/images/features/profile-fields/en/value-prop_2x-f1ddd09c4371adc1.png";var I=function(e){var t=e.plan,n=e.isPlanLoading,o="".concat(C," 1x, ").concat(k," 2x");return(0,r.jsxs)("div",{className:"hidden flex-col lg:flex",children:[(0,r.jsx)("img",{src:C,srcSet:o,alt:(0,i.t)("".concat(h,".image_alt")),loading:"eager",className:"size-full rounded-tr-lg object-cover"}),(0,r.jsx)(j,{plan:t,isPlanLoading:n,className:"rounded-t-none"})]})},N=function(e){var t=e.planName,n=e.onClose,o=e.currentPlan,a=e.trialEndDate;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.u_.Body,{className:"px-12 py-8",children:(0,r.jsxs)("div",{className:"mx-auto max-w-sm text-center",children:[(0,r.jsx)("div",{className:"mb-6 flex justify-center",children:(0,r.jsx)(b.Z.TitleXxl,{children:(0,i.t)("".concat(h,".success.icon"))})}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(b.Z.TitleLg,{color:"text-darkest",children:(0,i.t)("".concat(h,".success.title"))})}),(0,r.jsx)("div",{children:(0,r.jsx)(b.Z.BodyMd,{color:"text-subtle",weight:"normal",size:"text-base",leading:"leading-relaxed",children:(0,i.t)("".concat(h,".success.subtitle"),{planName:void 0===t?"Business":t,currentPlan:void 0===o?"Professional":o,trialEndDate:a||"30 days"})})})]})}),(0,r.jsx)(m.u_.Footer,{className:"border-t-0 px-12 pb-8 pt-0",children:(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(p.z,{variant:"primary",large:!0,onClick:n,className:"min-w-[200px]",children:(0,i.t)("".concat(h,".success.button"))})})})]})};Object.freeze({DETAILS:"/details",LOADING:"/loading",SUCCESS:"/success",ERROR:"/error",BLOCKED_DOWNGRADE_SCHEDULED:"/blocked_downgrade_scheduled"});var A="details",M="loading",T="success",E="error",R="blocked_downgrade_scheduled",D=n(303189);function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function F(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var B=function(e){var t,n=e.planTier,p=void 0===n?s.Gb.business:n,b=e.onConfirm,y=e.onCancel,x=e.onSuccess,_=e.trialType,j=void 0===_?"business_thirty_day":_,w=(0,l.dd)(),S=(0,D.D)(),C=S.refetchCurrentPlan,k=S.currentPlan,L=null==k?void 0:k.is_community_hub_downgrade_scheduled,B=U((0,o.useState)(L?R:A),2),q=B[0],z=B[1],Z=U((0,o.useState)(),2),V=Z[0],H=Z[1],W=(0,a.R)({planTier:p}),Q=W.plan,G=W.isPlanLoading,$=null==Q?void 0:Q.display_name,K=(t={onSuccess:function(){C(),z(T),null==b||b()},onError:function(e){z(E),H(e.message||(0,i.t)("".concat(h,".error.subtitle")))}},(0,c.useMutation)(function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){return[2,(0,u.Cu)(d.av.planTrials.create(),e)]})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){f(i,r,o,a,s,"next",e)}function s(e){f(i,r,o,a,s,"throw",e)}a(void 0)})})()},t)),J=function(){null==y||y(),w.hide(),w.remove()},X=function(){null==x||x(),w.hide(),w.remove()},Y=function(){var e;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:if(L)return z(R),[2];return z(M),[4,K.mutateAsync({trial_type:j})];case 1:return e.sent(),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){F(i,r,o,a,s,"next",e)}function s(e){F(i,r,o,a,s,"throw",e)}a(void 0)})})()};return(0,r.jsxs)(m.u_,{isOpen:w.visible,onClose:J,children:[(0,r.jsx)(m.u_.Overlay,{}),(0,r.jsxs)(m.u_.Content,{size:q===A?"2xl":"md",children:[q!==T&&q!==E&&q!==M&&q!==R&&(0,r.jsxs)(m.u_.Header,{children:[(0,r.jsx)(m.u_.Title,{children:function(){switch(q){case R:return(0,i.t)("".concat(h,".blocked_downgrade_scheduled.title"));case T:return(0,i.t)("".concat(h,".success.modal_title"));case E:return(0,i.t)("".concat(h,".error.modal_title"));default:return(0,i.t)("".concat(h,".title"))}}()}),(0,r.jsx)(m.u_.HeaderActions,{children:(0,r.jsx)(m.u_.CloseButton,{onClick:J})})]}),function(){switch(q){case R:return(0,r.jsx)(v,{onClose:J});case M:return(0,r.jsx)(P,{});case T:return(0,r.jsx)(N,{planName:$,onClose:X,currentPlan:"Professional"});case E:return(0,r.jsx)(g,{errorMessage:V,onClose:J});default:return(0,r.jsx)(m.u_.Body,{className:"p-0 py-6",children:(0,r.jsxs)("div",{className:"flex h-full",children:[(0,r.jsx)("div",{className:"w-full pr-4 lg:w-1/2",children:(0,r.jsx)(O,{onConfirm:Y,plan:Q,isPlanLoading:G})}),(0,r.jsx)("div",{className:"hidden w-1/2 pl-4 lg:block",children:(0,r.jsx)(I,{plan:Q,isPlanLoading:G})})]})})}}()]})]})},q=l.gk.create(function(e){var t=e.planTier,n=e.onConfirm,o=e.onCancel,i=e.onSuccess,a=e.trialType;return(0,r.jsx)(B,{planTier:t,onConfirm:n,onCancel:o,onSuccess:i,trialType:a})}),z=function(){return(0,l.dd)(q)}},670714:function(e,t,n){n.d(t,{G7:()=>f,Iq:()=>u,MG:()=>s,N$:()=>l,ij:()=>a,lU:()=>c});var r,o=n(739792);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=10,s="all",l="draft",c="scheduled",u="published",d="settings.posts",f=Object.freeze((i(r={},s,(0,o.t)([d,"tabs","all"])),i(r,l,(0,o.t)([d,"tabs","drafts"])),i(r,c,(0,o.t)([d,"tabs","scheduled"])),r))},776810:function(e,t,n){n.d(t,{D:()=>u,T:()=>d});var r=n(131906),o=n(93199),i=n(547144),a=n(670714);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var c=["settings","posts"],u=function(e){var t,n,u=e.page,d=void 0===u?1:u,f=e.filter,m=e.sort,p=(0,r.useQuery)(((function(e){if(Array.isArray(e))return s(e)})(c)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(c)||function(e,t){if(e){if("string"==typeof e)return s(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}}(c)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([f,d,m]),function(){var e;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){return[2,(0,o.UT)(i.av.settings.posts.index({params:{filter:f,page:d,per_page:a.ij,sort:m}}))]})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){l(i,r,o,a,s,"next",e)}function s(e){l(i,r,o,a,s,"throw",e)}a(void 0)})})()},{keepPreviousData:!0}),b=p.data,h=p.isLoading,v=p.refetch;return{posts:null!=(t=null==b?void 0:b.records)?t:[],postsCount:null!=(n=null==b?void 0:b.count)?n:0,isLoadingPosts:h,refetchPosts:v}},d=function(){var e=(0,r.useQueryClient)();return{invalidatePostsApiQueries:function(){return e.invalidateQueries(c)}}}},326239:function(e,t,n){n.d(t,{AZ:()=>a,D9:()=>o.D9,FW:()=>f,G7:()=>m,PX:()=>u,Yp:()=>l,Z9:()=>o.Z9,_i:()=>d,av:()=>o.av,k_:()=>c,xg:()=>s});var r,o=n(271066);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a={LABEL:"label",FIELD_TYPE:"field_type",KEY:"key",PLACEHOLDER:"placeholder",DESCRIPTION:"description"},s={REQUIRED:"required",HIDDEN:"hidden"},l=Object.values(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){i(e,t,n[t])})}return e}({},a,s)),c="pages_attributes",u=(i(r={},o.Z9.TEXT,{}),i(r,o.Z9.SELECT,{CHOICES_ATTRIBUTES:"choices_attributes"}),i(r,o.Z9.CHECKBOX,{CHOICES_ATTRIBUTES:"choices_attributes"}),i(r,o.Z9.TEXTAREA,{}),i(r,o.Z9.LINK,{}),i(r,o.Z9.LOCATION,{}),i(r,o.Z9.NUMBER,{NUMBER_OPTIONS:"number_options_attributes"}),r),d=["twitter","facebook","instagram","linkedin"],f=[0,1,2,3,4,5],m={ACTIVE:"active",ARCHIVED:"archived"}},5404:function(e,t,n){n.d(t,{e:()=>c});var r=n(552676),o=n(739792),i=n(957363),a=n(381636),s=n(701168),l=n(775148),c=function(e){var t=e.onCollapseClick;return(0,r.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center p-6",children:[(0,r.jsx)(l.h,{name:"20-close",iconSize:20,onClick:t,variant:"secondary",ariaLabel:(0,o.t)("collapse"),className:(0,s.A)("bg-primary !border-primary absolute right-5 top-5 z-50 rounded-full border")}),(0,r.jsx)("div",{className:"animate-fade-in-slow flex h-full items-center justify-center p-6 opacity-0",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4 text-center",children:[(0,r.jsx)(i.JO,{type:"48-sun",size:48,className:"scale-[2.5]"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(a.Z.TitleMd,{children:(0,o.t)("ai_spaces_summaries.all_caught_up")}),(0,r.jsx)("div",{className:"max-w-[280px]",children:(0,r.jsx)(a.Z.BodySm,{color:"text-default dark:text-dark",children:(0,o.t)("ai_spaces_summaries.no_posts_found")})})]})]})})]})}},132002:function(e,t,n){n.d(t,{u:()=>I});var r=n(552676),o=n(275271),i=n(503594),a=n(664586),s=n(345585),l=n(739792),c=n(5404),u=n(430507),d=n(973660),f=n(421541),m=n(366162),p=n(871829),b=n(929959),h=n(663676),v=n(701168),y=n(619347),g=n(131906),x=n(93199),_=n(547144),j=n(404393);function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function O(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||S(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}}var P=function(e){var t,n,r,i,a=e.space,s=e.dateFrom,l=e.enabled,c=e.type,u=e.firstUnreadMessageId,d=e.dateRange,m=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||S(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=m[0],b=m[1],h=["post"===c?"post-space-summary":"chat-space-summary",a.id].concat(O("post"===c?[a.posts_count]:[]),[d],O(d===f.n.FROM_UNREAD&&u?[u]:[])),v=(0,g.useQueryClient)(),y=(0,g.useQuery)(h,function(){var e={};return s&&(e.date_from=s),u&&(e.first_unread_message_id=u),(0,x.UT)(_.av.spaces.aiSummaries.index({spaceId:String(a.id),params:e}))},{enabled:l,staleTime:6e5,retry:function(e,t){return(null==t?void 0:t.status)!==404&&(null==t?void 0:t.status)!==401&&(null==t?void 0:t.status)!==400}}),w=y.data,P=y.isLoading,C=y.error,k=y.refetch;return(0,o.useEffect)(function(){var e,t;(null==C||null==(t=C.body)||null==(e=t.error_details)?void 0:e.noDataToSummarize)?(0,j.Cp)(Promise.resolve(),3e3).then(function(){b(!0)}):b(!1)},[C]),{spaceSummary:w,isLoadingSpaceSummary:P,refetchSpaceSummary:k,clearSpaceSummary:function(){v.resetQueries({queryKey:h,exact:!0})},isNoDataError:p,contentCutOffMessage:(null==C||null==(r=C.body)||null==(n=r.error_details)?void 0:n.isContentCutOff)&&null!=(i=C.body.message)?i:null}};function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var I=function(e){var t,n=e.isOpen,g=e.onClose,x=e.space,_=e.dateRange,j=e.type,w=e.shouldHideRailbarDragger,O=e.firstUnreadMessageId,S=(0,o.useMemo)(function(){if(_!==f.n.FROM_UNREAD){var e=(0,i.Z)();return _===f.n.LAST_7_DAYS?(0,a.default)(e,7).toISOString():(0,s.default)(e,1).toISOString()}},[_]),C=P({space:x,dateFrom:_===f.n.FROM_UNREAD?void 0:S,enabled:n,type:j,firstUnreadMessageId:_===f.n.FROM_UNREAD?O:void 0,dateRange:_}),I=C.spaceSummary,N=C.isLoadingSpaceSummary,A=C.isNoDataError,M=C.contentCutOffMessage,T=k((0,o.useState)(!1),2),E=T[0],R=T[1],D=k((0,o.useState)(0),2),L=D[0],F=D[1],U=S?(0,d.An)(new Date(S),new Date):(0,l.t)("ai_spaces_summaries.from_unread"),B=x.name;(0,o.useEffect)(function(){F(function(e){return e+1})},[_]);var q=function(){R(!0),setTimeout(function(){R(!1),g()},p.HL)},z="#rail-bar-header",Z=k((0,o.useState)(null),2),V=Z[0],H=Z[1];if((0,o.useEffect)(function(){H(document.querySelector(z))},[z]),!V)return null;var W=(I||{}).topics,Q=void 0===W?[]:W,G=null!=(t=Q.flatMap(function(e){return e.relevant_posts}).filter(function(e){return void 0!==e}))?t:[],$=null==I?void 0:I.total_records;return(0,r.jsx)(b.x,{shouldShowRailBar:n,shouldHideRailbarDragger:void 0===w||w,children:(0,r.jsx)(y.S0.Content,{heightGap:16,children:(0,r.jsxs)("div",{className:(0,v.A)("transition-opacity duration-300",{"opacity-0":E,"opacity-100":!E}),children:[(0,r.jsx)("div",{className:"bg-ai-summary absolute inset-0 bg-cover bg-center bg-no-repeat"}),A&&!N?(0,r.jsx)(c.e,{onCollapseClick:q}):(0,r.jsx)("div",{className:"relative",children:(0,r.jsxs)(u.w,{onCollapseClick:q,children:[(0,r.jsx)(m.C,{spaceSummary:I,sourceName:B,formattedDateRange:U,isLoadingSpaceSummary:N,allSources:G,topics:Q,contentCutOffMessage:M}),"number"==typeof $&&$>0&&(0,r.jsx)(u.w.Footer,{children:(0,r.jsx)("div",{className:"animate-fade-in-slow opacity-0",style:{animationDelay:(0,p.fZ)(5,Q.length),animationFillMode:"forwards"},children:(0,r.jsx)(u.w.FooterNote,{children:(0,l.t)("ai_spaces_summaries.".concat("chat"===j?"messages":"posts","_summarized"),{count:$,formatted_count:(0,h.HA)($)})})})})]})},L)]})})})}},366162:function(e,t,n){n.d(t,{C:()=>f});var r=n(552676),o=n(739792),i=n(871829),a=n(430507),s=n(533609),l=n(432050),c=n(381636),u=function(e){var t=e.formattedDateRange,n=e.sourceName;return(0,r.jsxs)("div",{className:"text-tertiary animate-fade-in-slow mb-2 text-sm opacity-0",style:{animationDelay:(0,i.fZ)(0),animationFillMode:"forwards"},children:[t," ",(0,o.t)("ai_spaces_summaries.bullet")," ",(0,o.t)("ai_spaces_summaries.summary_of"),(0,r.jsx)("div",{className:"animate-fade-in-slow opacity-0",style:{animationDelay:(0,i.fZ)(1),animationFillMode:"forwards"},children:(0,r.jsx)(c.Z.TitleMd,{children:n})})]})},d=function(e){var t=e.topics;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-fade-in-slow mb-2 opacity-0",style:{animationDelay:(0,i.fZ)(3),animationFillMode:"forwards"},children:(0,r.jsx)(c.Z.BodySm,{weight:"medium",as:"strong",children:(0,o.t)("ai_spaces_summaries.takeaways")})}),(0,r.jsx)("ul",{className:"space-y-2",children:t.map(function(e,t){return(0,r.jsx)("li",{className:"animate-fade-in-slow flex items-baseline opacity-0",style:{animationDelay:(0,i.fZ)(t+4),animationFillMode:"forwards"},children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"pt-1",children:(0,r.jsx)(c.Z.BodySm,{weight:"bold",as:"strong",children:e.topic_name})}),(0,r.jsx)(a.w.TextWithUserLinks,{text:e.summary,relevantPosts:e.relevant_posts}),e.summary_subcategories_by_author&&e.summary_subcategories_by_author.length>0&&(0,r.jsx)("ul",{className:"space-y-1",children:e.summary_subcategories_by_author.map(function(n){return(0,r.jsxs)("li",{className:"animate-fade-in-slow flex items-baseline pl-2 opacity-0",style:{animationDelay:(0,i.fZ)(t+4),animationFillMode:"forwards"},children:[(0,r.jsx)("span",{className:"mr-2",children:(0,r.jsx)(c.Z.BodySm,{as:"span",children:(0,o.t)("ai_spaces_summaries.bullet")})}),(0,r.jsx)(a.w.TextWithUserLinks,{text:n})]},"".concat(e.topic_name,"-").concat(n))})})]})},e.topic_name)})})]})},f=function(e){var t=e.spaceSummary,n=e.sourceName,c=e.formattedDateRange,f=e.isLoadingSpaceSummary,m=e.allSources,p=e.topics,b=e.contentCutOffMessage,h=e.events;return(0,r.jsxs)(a.w.Content,{children:[(0,r.jsx)(a.w.Header,{animate:f,isHidden:!f&&(!!t||!!b),children:(0,o.t)("ai_spaces_summaries.generating")}),b&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{formattedDateRange:c,sourceName:n}),(0,r.jsx)(l.b,{type:"alert",description:b,className:"text-dark !rounded-2xl !border-2 !border-red-200 bg-red-50 !py-2 !pl-4 !pr-3 text-justify dark:!border-red-800 dark:bg-red-900/20",showIcon:!1})]}),t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{formattedDateRange:c,sourceName:n}),(0,r.jsx)("div",{className:"animate-fade-in-slow opacity-0",style:{animationDelay:(0,i.fZ)(2),animationFillMode:"forwards"},children:(0,r.jsx)(a.w.TextWithUserLinks,{text:t.overview||""})}),(0,r.jsx)("div",{className:"mt-2",children:p.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d,{topics:p}),m.length>0&&(0,r.jsx)("div",{className:"animate-fade-in-slow mt-4 opacity-0",style:{animationDelay:(0,i.fZ)(4,p.length),animationFillMode:"forwards"},children:(0,r.jsx)(s.F,{sources:m})})]})}),h&&(0,r.jsx)("div",{className:"animate-fade-in-slow opacity-0",style:{animationDelay:(0,i.fZ)(5,p.length),animationFillMode:"forwards"},children:(0,r.jsx)(a.w.Section,{title:(0,o.t)("ai_spaces_summaries.events"),text:h})})]})]})}},871829:function(e,t,n){n.d(t,{HL:()=>r,fZ:()=>o});var r=200,o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;switch(e){case 0:return"0ms";case 1:return"300ms";case 2:return"600ms";case 3:return"900ms";case 4:return"".concat(1200+(t+1)*300,"ms");case 5:return"".concat(1200+(t+2)*300,"ms");default:return"".concat(1200+(e-4)*300,"ms")}}},795004:function(e,t,n){n.d(t,{V:()=>D});var r=n(552676),o=n(275271),i=n(932699),a=n(25593),s=n(903225),l=n(739792),c=n(407383),u=n(786518),d=n(96533),f=n(403697),m=n(547144),p=n(905326),b=n(415307),h=n(381636),v=n(441342),y=n(963549),g=n(716089),x=n(680132),_=n(775148),j=n(943544),w=function(e){var t=e.getProfileActionItems,n=e.participantList,o=e.isViewOnlyMasquerading,i=(0,d.r)(),a=(0,v.wh)().currentCommunityMember;return(0,r.jsx)(r.Fragment,{children:n.map(function(e){return(0,r.jsxs)("button",{type:"button",className:"hover:bg-tertiary group flex w-full cursor-pointer justify-between text-darkest -mx-2 flex-row items-center rounded-md p-2 text-sm",onClick:function(){(null==e?void 0:e.user_public_uid)&&i.show({memberPublicId:e.user_public_uid})},children:[(0,r.jsxs)("div",{className:"text-dark flex w-[90%] items-center text-left",children:[(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)(g.g,{name:null==e?void 0:e.name,src:null==e?void 0:e.avatar_url,status:null==e?void 0:e.status,size:"8"})}),(0,r.jsx)("div",{className:"truncate font-medium",children:(null==a?void 0:a.id)===e.community_member_id?(0,l.t)("messaging.you"):null==e?void 0:e.name}),(null==e?void 0:e.community_admin)?(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)(x.I,{label:(0,l.t)("admin"),isAdmin:!0})}):(null==e?void 0:e.moderator)&&(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)(x.I,{label:(0,l.t)("moderator")})})]}),(0,r.jsx)("button",{type:"button",onClick:function(e){e.stopPropagation()},children:!o&&(0,r.jsx)(j.Lt,{direction:"bottom-start",menuButtonEl:"div",className:"group-hover:block lg:hidden",menuItemsClassName:"!p-2 !w-60",button:(0,r.jsx)(j.Lt.MenuButton,{id:"action-block",children:(0,r.jsx)(_.h,{name:"20-menu-dots-horizontal",iconSize:20,ariaLabel:(0,l.t)("chat_space.view_member_actions")})}),options:t(e)})})]},null==e?void 0:e.id)})})},O=function(){var e=(0,v.wh)().currentCommunityMember;return{shouldShowRemoveOption:function(t){return(null==e?void 0:e.id)!==t.community_member_id&&(null==e?void 0:e.is_admin)}}},S=n(131906),P=n(93199),C=n(60878);function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function I(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var N=function(e){var t,n=e.refetchSpaceMembers,r=e.spaceId,i=e.setIsConfirmationModalOpen,a=(t=(0,o.useState)(null),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return k(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=a[0],c=a[1],u=(0,C.pm)(),d=(0,S.useMutation)(function(){var e;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return[4,(0,P.pC)(m.av.spaceMembers.leaveSpace({spaceId:r,memberId:null==s?void 0:s.community_member_id}))];case 1:return e.sent(),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){I(i,r,o,a,s,"next",e)}function s(e){I(i,r,o,a,s,"throw",e)}a(void 0)})})()},{onError:function(e){u.error(e.message)},onSuccess:function(){u.success((0,l.t)("members_directory.community_members.actions.space.successfully_removed")),n()},onSettled:function(){i(!1)}});return{leaveSpaceMutation:d.mutate,isLeaving:d.isLoading,memberToDelete:s,setMemberToDelete:c}},A=n(271561),M=n(273511);function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var D=function(e){var t,n=e.spaceMembers,g=e.space,x=e.refetchSpaceMembers,_=e.hasMoreSpaceMembers,j=e.fetchNextPage,S=(0,s.k6)(),P=(0,p.p)().findOrCreateChatRoom,C=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return T(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),k=C[0],I=C[1],D=(0,d.r)(),L=(0,v.wh)().isViewOnlyMasquerading,F=O().shouldShowRemoveOption,U=(0,M.S)().shouldShowMessageOption,B=(0,b.q)().canBlockMemberDm,q=(0,A.U)({onSuccess:function(){x()}}),z=q.blockMember,Z=q.isBlocking,V=q.memberToBlock,H=q.toggleBlockDmsModal,W=q.handleUnblockMember,Q=q.isBlockDmsModalOpen,G=q.setIsBlockDmsModalOpen,$=N({refetchSpaceMembers:x,spaceId:g.id,setIsConfirmationModalOpen:I}),K=$.leaveSpaceMutation,J=$.isLeaving,X=$.memberToDelete,Y=$.setMemberToDelete,ee=function(e){var t=e.is_blocked_by_current_community_member,n={iconClassName:"text-feedback-error",color:"text-feedback-error"},r=[{value:"profile",icon:"20-eye-open",iconSize:20,className:"!py-2.5 !px-3",label:(0,l.t)("view_profile"),onClick:function(){return D.show({memberPublicId:null==e?void 0:e.user_public_uid})}}];return U(e)&&r.push({value:"message",icon:"20-dm-message",className:"!py-2.5 !px-3",iconSize:20,label:(0,l.t)("messaging.send_direct_message"),onClick:L?i.noop:function(){var t;return(t=function(){var t;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(n){switch(n.label){case 0:return[4,P({kind:f.g8,community_member_ids:[null==e?void 0:e.community_member_id]})];case 1:return(t=n.sent())&&S.push((0,m.co)({url:(0,m.so)({uuid:t})})),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){E(i,r,o,a,s,"next",e)}function s(e){E(i,r,o,a,s,"throw",e)}a(void 0)})})()}}),B(e)&&r.push(R({value:"block-dm",icon:t?"20-circle-check":"20-block-dms",className:"!py-2.5 !px-3",iconSize:20,label:(0,l.t)(t?"messaging.unblock_direct_messages":"messaging.block_direct_messages"),onClick:function(){return t?W(e):H(e)}},t?{}:n)),F(e)&&r.push(R({value:"remove",icon:"20-close",iconSize:20,className:"!py-2.5 !px-3",label:(0,l.t)("remove"),onClick:function(){Y(e),I(!0)}},n)),r},et=(0,c.bb)(n),en=et.onlineParticipants,er=et.offlineParticipants,eo=(0,o.useCallback)(function(){V&&z({memberId:V.community_member_id})},[V,z]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{id:"scrollableDiv",className:"p-0 md:pb-4",style:{height:"100%",overflow:"auto"},children:(0,r.jsxs)(a.Z,{scrollThreshold:.8,next:j,hasMore:void 0!==_&&_,dataLength:n.length,className:"p-0 px-6 pb-12",scrollableTarget:"scrollableDiv",loader:(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(h.Z.LabelXxs,{children:(0,l.t)("toggle_with_loader.loading")})}),children:[en.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-default mb-2",children:(0,r.jsx)(h.Z.LabelXxs,{weight:"bold",color:"text-default",children:(0,l.t)("chat_space.online")})}),(0,r.jsx)(w,{participantList:en,isViewOnlyMasquerading:L,getProfileActionItems:ee})]}),er.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-default my-2",children:(0,r.jsx)(h.Z.LabelXxs,{weight:"bold",color:"text-default",children:(0,l.t)("chat_space.offline")})}),(0,r.jsx)(w,{participantList:er,isViewOnlyMasquerading:L,getProfileActionItems:ee})]})]})}),(0,r.jsx)(y.c,{isOpen:k,title:(0,l.t)("remove"),onClose:function(){return I(!1)},onCancel:function(){return I(!1)},onConfirm:K,confirmText:J?(0,l.t)("removing"):(0,l.t)("remove"),disabled:J,confirmVariant:"danger",children:(0,l.t)("members_directory.community_members.actions.space.confirm_remove",{community_member:null==X?void 0:X.name,space:g.name})}),(0,r.jsx)(u._,{showModal:Q,onClose:function(){return G(!1)},onConfirm:eo,memberName:(null==V?void 0:V.name)||"",isLoading:Z})]})}},271561:function(e,t,n){n.d(t,{U:()=>p});var r=n(275271),o=n(131906),i=n(93199),a=n(547144),s=n(60878),l=n(739792);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){u(i,r,o,a,s,"next",e)}function s(e){u(i,r,o,a,s,"throw",e)}a(void 0)})}}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onSuccess,n=e.memberName,c=f((0,r.useState)(null),2),u=c[0],p=c[1],b=f((0,r.useState)(!1),2),h=b[0],v=b[1],y=(0,s.pm)(),g=(0,o.useMutation)(function(e){var t=e.memberId;return d(function(){return m(this,function(e){switch(e.label){case 0:return[4,(0,i.Cu)(a.av.blockedMembers.create({params:{blocked_member_id:t}}))];case 1:return e.sent(),[2]}})})()},{onError:function(e){y.error(e.message)},onSuccess:function(){y.success((0,l.t)("messaging.block_direct_messages_modal.success",{name:(null==u?void 0:u.name)||n})),v(!1),null==t||t()}}),x=g.mutate,_=g.isLoading,j=(0,o.useMutation)(function(e){var t=e.memberId;return d(function(){return m(this,function(e){switch(e.label){case 0:return[4,(0,i.pC)(a.av.blockedMembers.destroy({id:t}))];case 1:return e.sent(),[2]}})})()},{onError:function(e){y.error(e.message)},onSuccess:function(e,r){var o=r.name;y.success((0,l.t)("messaging.unblock_direct_messages_success",{name:o||n})),null==t||t()}}),w=j.mutate,O=j.isLoading,S=(0,r.useCallback)(function(e){p(e),v(!0)},[p,v]),P=(0,r.useCallback)(function(){u&&x({memberId:u.community_member_id})},[u,x]),C=(0,r.useCallback)(function(e){O||w({memberId:null==e?void 0:e.community_member_id,name:null==e?void 0:e.name})},[O,w]);return{blockMember:x,isBlocking:_,memberToBlock:u,setMemberToBlock:p,unBlockMember:w,isUnblocking:O,toggleBlockDmsModal:S,handleBlockMember:P,handleUnblockMember:C,isBlockDmsModalOpen:h,setIsBlockDmsModalOpen:v}}},418409:function(e,t,n){n.d(t,{G:()=>g});var r=n(552676),o=n(739792),i=n(434519),a=n(757105),s=n(411944),l=n(770434),c=n(121804),u=n(39905),d=n(767900),f=n(381636),m=function(e){var t=e.createEmbed,n=e.onClose;return(0,r.jsx)(d.l,{onSubmit:function(e){t(e.url),n()},validationSchema:(0,c.o)(),children:(0,r.jsxs)("div",{className:"mx-8 flex h-full flex-col items-center rounded-md",role:"tabpanel",children:[(0,r.jsx)(d.l.Item,{name:"url",fullWidth:!0,hideBorder:!0,hideLabel:!0,hideDescription:!0,className:"!pt-0",placeholder:(0,o.t)("courses.edit.lesson.embed_placeholder"),children:(0,r.jsx)(d.l.Input,{})}),(0,r.jsxs)("div",{className:"mt-12 text-center",children:[(0,r.jsx)(u.z,{type:"submit",variant:"primary",children:(0,o.t)("courses.edit.lesson.embed_media")}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)(f.Z.LabelSm,{weight:"semibold",children:[(0,o.t)("courses.edit.lesson.embed_description")," ",(0,r.jsx)("span",{className:"border-primary inline-flex border-b border-dotted",children:(0,r.jsx)(l.Y,{placement:"bottom-end",content:(0,o.t)("courses.edit.lesson.embed_providers_list"),className:"inline-flex",children:(0,o.t)("courses.edit.lesson.embed_description_more")})})]})})]})]})})},p=n(957363),b=function(e){var t,n,i=e.getRootProps,a=e.openFilePicker;return(0,r.jsxs)("div",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:"border-primary mx-8 my-6 flex flex-col items-center justify-center rounded-md border border-dotted py-6",role:"tabpanel"},i()),n=n={children:[(0,r.jsx)(p.JO,{size:42,className:"h-[42px] !w-[42px]",type:"new-file-plus"}),(0,r.jsx)("div",{className:"text-dark mb-1 mt-5",children:(0,r.jsx)(f.Z.LabelSm,{weight:"semibold",children:(0,o.t)("courses.edit.lesson.drop_here")})}),(0,r.jsx)("div",{className:"text-default mb-6",children:(0,r.jsx)(f.Z.LabelSm,{children:(0,o.t)("courses.edit.lesson.drop_placeholder")})}),(0,r.jsx)(u.z,{type:"button",onClick:a,variant:"primary",children:(0,o.t)("courses.edit.lesson.choose_a_file")})]},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},h={upload:(0,o.t)("courses.edit.lesson.upload"),embed:(0,o.t)("courses.edit.lesson.embed")},v=function(e){var t=e.createEmbed,n=e.openFilePicker,o=e.getRootProps,l=(0,a.dd)(),c=l.remove;return(0,r.jsxs)(i.u_,{isOpen:l.visible,onClose:l.remove,children:[(0,r.jsx)(i.u_.Overlay,{}),(0,r.jsx)(i.u_.Content,{size:"lg",className:"h-64 py-3",children:(0,r.jsxs)(s.O.Group,{className:"mt-3 overflow-hidden md:mt-0",children:[(0,r.jsxs)(s.O.List,{className:"border-b px-8",children:[(0,r.jsx)(s.O,{className:"!text-sm md:!text-base",children:h.upload}),(0,r.jsx)(s.O,{className:"!text-sm md:!text-base",children:h.embed})]}),(0,r.jsxs)(s.O.Panels,{children:[(0,r.jsx)(s.O.Panel,{children:(0,r.jsx)(b,{getRootProps:o,openFilePicker:n})}),(0,r.jsx)(s.O.Panel,{className:"py-[52px]",children:(0,r.jsx)(m,{onClose:c,createEmbed:t})})]})]})})]})},y=a.gk.create(function(e){return(0,r.jsx)(v,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),g=function(){return(0,a.dd)(y)}},129832:function(e,t,n){n.d(t,{S:()=>f});var r=n(275271),o=n(934990),i=n(504615),a=n(932699),s=n(623428),l=n(418409);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var f=function(e){var t=e.onUploadStarted,n=void 0===t?a.noop:t,c=e.onUploadComplete,f=void 0===c?a.noop:c,m=e.onUploadFailed,p=void 0===m?a.noop:m,b=e.allowedFileTypes,h=void 0===b?void 0:b,v=d((0,r.useState)(!1),2),y=v[0],g=v[1],x=d((0,r.useState)(!1),2),_=x[0],j=x[1],w=d((0,r.useState)(0),2),O=w[0],S=w[1],P=d((0,r.useState)(!1),2),C=P[0],k=P[1],I=(0,l.G)(),N=(0,r.useRef)(""),A=(0,r.useMemo)(function(){return new i.Z({restrictions:{maxNumberOfFiles:1,allowedFileTypes:h},autoProceed:!1}).use(o.Z,{limit:10,endpoint:"/",getChunkSize:function(e){return Math.max(0x1900000,Math.ceil(e.size/500))},shouldUseMultipart:!0}).on("file-added",function(e){var t;return(t=function(){var t;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(n){switch(n.label){case 0:if(N.current===e.id)return[2];N.current=e.id,I.hide(),g(!0),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,(0,s.L)(e.data)];case 2:return t=n.sent(),A.setState(t),A.setState({retries:2}),A.setFileMeta(e.id,{key:t.key}),A.upload(),[3,5];case 3:return console.error(n.sent()),g(!1),p(),[3,5];case 4:return N.current="",[7];case 5:return[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){u(i,r,o,a,s,"next",e)}function s(e){u(i,r,o,a,s,"throw",e)}a(void 0)})})()}).on("upload",function(){g(!1),j(!0),n()}).on("upload-progress",function(e,t){var n=0;0!==t.bytesUploaded&&(n=t.bytesUploaded/t.bytesTotal),S(100*n)}).on("upload-success",function(e){var t=A.getState(),n=t.checksum,r=t.id,o=t.created_at,i=t.attachable_sgid,a=t.service_name,s=t.signed_id,l=t.key;f({attachable_sgid:i,byte_size:e.size,checksum:n,content_type:e.type,created_at:o,filename:e.name,id:r,service_name:a,signed_id:s,key:l}),j(!1)}).on("error",function(){g(!1),j(!1);var e=A.getState().retries;if(0===e)return void p();k(!0),setTimeout(function(){A.setState({retries:e-1}),k(!1),A.retryAll()},5e3)}).on("cancel-all",function(){j(!1),g(!1)})},[]);return{uppy:A,isUploading:_,isRetrying:C,progress:O,isProcessingChecksum:y}}},558808:function(e,t,n){n.d(t,{z:()=>d});var r=n(131906),o=n(903225),i=n(739792),a=n(93199),s=n(547144),l=n(441342),c=n(818580),u=n(60878),d=function(e){var t=e.forEdition,n=void 0!==t&&t,d=(0,o.UO)(),f=d.lessonId,m=d.sectionId,p=(0,r.useQueryClient)(),b=(0,l.L2)().data,h=(0,u.pm)(),v=(0,r.useQuery)({queryKey:["lesson",f,null==b?void 0:b.id,m],queryFn:function(){return(0,a.UT)(s.av.courses.getLesson({courseId:b.id,lessonId:f,sectionId:m,params:{for_edition:n}}))},enabled:!!f&&!!b&&!!m,refetchOnWindowFocus:!1,retry:0,onError:function(e){(null==e?void 0:e.status)===401&&(window.location.href="/")}}),y=v.data,g=v.isLoading,x=v.remove,_=(0,r.useMutation)(function(e){return(0,a.aU)(s.av.courses.updateLesson({courseId:b.id,lessonId:f,sectionId:m}),{course_lesson:e})},{onSuccess:function(){x(),p.removeQueries({queryKey:(0,c.hE)(f)}),h.success(i.ZP.t("courses.edit.lesson.changes_saved"))},onError:function(e){h.error(e.errorDetails)}}),j=_.mutate,w=_.isLoading,O=(0,r.useMutation)(function(e){var t=e.spaceId,n=e.sectionId,r=e.lessonId;return(0,a.Cu)(s.av.courses.duplicateLesson({courseId:t,sectionId:n,lessonId:r}))},{onError:function(){return h.error(i.ZP.t("courses.edit.lesson.duplication_error"))}}).mutateAsync;return{currentLesson:y,isLoading:g,updateLesson:j,isUpdatingLesson:w,updateFilesOrder:(0,r.useMutation)(function(e){var t=e.filesOrder;return(0,a.aU)(s.av.courses.updateLesson({courseId:b.id,lessonId:f,sectionId:m}),{course_lesson:{files_order:t}})}).mutate,duplicateLesson:O}}},324512:function(e,t,n){n.d(t,{d:()=>i});var r=n(739792),o=n(441342),i=function(){var e=(0,o.L2)().data,t=(null==e?void 0:e.lesson_label)||"lesson",n=(null==e?void 0:e.section_label)||"section";return{lessonLabel:t,sectionLabel:n,translatedLabels:{lesson:{singular:(0,r.t)("courses.labels.".concat(t,".singular")),plural:(0,r.t)("courses.labels.".concat(t,".plural"))},section:{singular:(0,r.t)("courses.labels.".concat(n,".singular")),plural:(0,r.t)("courses.labels.".concat(n,".plural"))}}}}},205061:function(e,t,n){n.d(t,{l:()=>W});var r=n(552676),o=n(275271),i=n(619803),a=n.n(i),s=n(932699),l=n(708960),c=n(227053),u=n(654252),d=n(757105),f=n(441342),m=n(257210),p=n(434519),b=function(e){var t=e.post,n=e.spaceId,o=e.startingImageIndex,i=(0,d.dd)(),a=[[null==t?void 0:t.id]];return(0,r.jsx)(f.mE,{spaceId:n,children:(0,r.jsx)(m._x,{perPagePostIds:a,children:(0,r.jsx)(f.DW,{post:t,usedIn:"mobile-full-carousel-modal",children:(0,r.jsxs)(p.u_,{isOpen:i.visible,onClose:i.remove,contentPortalId:"mobile-full-carousel-modal-portal",children:[(0,r.jsx)(p.u_.Overlay,{}),(0,r.jsx)(p.u_.Content,{size:"full",className:"h-full",children:(0,r.jsx)(W,{startingImageIndex:o})})]})})})})},h=d.gk.create(function(e){return(0,r.jsx)(b,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),v=n(739792),y=n(957363),g=n(851945),x=function(e){var t=e.image,n=e.canDownload,o=(0,d.dd)();return(0,r.jsxs)("div",{className:"flex justify-end gap-2 pr-2 pt-2",children:[n&&(0,r.jsx)("a",{href:t.original_url,download:!0,"aria-label":(0,v.t)("download"),className:"text-dark hover:text-dark focus:text-dark",children:(0,r.jsx)(y.JO,{type:"16-download",size:16,useWithFillCurrentColor:!0})}),(0,r.jsx)(g.o,{onClick:o.remove})]})},_=n(117617),j=n(701168),w=n(381636),O=function(e){var t=e.positionClassName;return(0,r.jsx)("div",{className:(0,j.A)("bg-secondary relative flex shrink-0 grow-0 basis-full items-center justify-center",t),children:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center p-6 text-center",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(y.JO,{type:"16-trash-bin-2",size:20})}),(0,r.jsx)(w.Z.BodySm,{color:"light",children:(0,v.t)("image_space.file_not_found")})]})})},S=function(e){var t,n=e.image,o=(0,f.Zh)().record,i=(0,_.en)();return(0,r.jsx)("div",{className:a()("absolute right-4 top-4 z-[2] flex",{"hidden group-hover:flex":i}),children:(null==o||null==(t=o.gallery)?void 0:t.downloadable_images)&&(0,r.jsx)("a",{href:n.original_url,download:!0,"aria-label":(0,v.t)("download"),className:"flex size-8 justify-center rounded-full bg-black p-1 text-white transition-transform hover:text-white focus:text-white",children:(0,r.jsx)(y.JO,{type:"16-download",size:16,useWithFillCurrentColor:!0})})})};function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var k=function(e){var t=e.image,n=e.positionClassName,i=e.containerWidth,a=e.currentImageIndex,s=e.index,l=e.usedIn,c=e.shouldAnimate,u=e.zoomLevel,d=e.zoomPosition,f=C((0,o.useState)(),2),m=f[0],p=f[1],b=C((0,o.useState)("lazy"),2),h=b[0],v=b[1];return!m&&a+1>=s&&(p(t.url),s>1&&v("eager")),m&&m!==t.url&&p(t.url),(0,r.jsxs)("div",{className:(0,j.A)("relative flex size-full shrink-0 grow-0 basis-full items-center justify-center",{"transition-transform duration-300":c,"z-[1]":a===s}),style:{transform:i?"translateX(-".concat(i*a,"px)"):void 0},children:["full-post-modal"===l&&a===s&&(0,r.jsx)(S,{image:t}),"mobile-full-carousel-modal"!==l&&(0,r.jsx)("div",{className:"carousel-image absolute inset-0 scale-110 bg-cover bg-center blur-lg",style:{backgroundImage:m&&'url("'.concat(m,'")')}}),(0,r.jsx)("img",{className:(0,j.A)("carousel-image relative select-none",{"transition-transform":u},n),draggable:!1,loading:h,alt:"",src:m,style:{transform:u&&u>1?"translate(".concat(d[0],"px, ").concat(d[1],"px) scale(").concat(u,")"):void 0}})]})},I=n(775148),N=function(e){var t=e.direction,n=e.onClick;return(0,r.jsx)(I.h,{name:"20-chevron-".concat("prev"===t?"left":"right"),iconSize:20,onClick:n,iconClassName:"!text-gray-600",className:a()("absolute top-1/2 z-[2] hidden -translate-y-1/2 rounded-full border border-gray-300 bg-white hover:!bg-[#F7F9FA] focus:!bg-[#F7F9FA] sm:group-hover:flex",{"left-4":"prev"===t,"right-4":"next"===t}),ariaLabel:"prev"===t?(0,v.t)("previous"):(0,v.t)("next")})},A=function(e,t){var n;return e&&t&&(n=e>t?"w-full":e<t?"h-full":"h-full w-full"),n};function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var E=16/9,R=function(e,t,n){var r,i=T((0,o.useState)(),2),a=i[0],s=i[1],l=T((0,o.useState)(),2),c=l[0],u=l[1],d=T((0,o.useState)(),2),f=d[0],m=d[1];return(0,o.useEffect)(function(){if(e&&t.current){var r=t.current,o=r.clientWidth,i=r.clientHeight,a=e>E?E:e,l=o/a;"full-post-modal"===n?(s("100%"),m(o/i)):l>678?(s(678),m(o/678)):(s(l),m(a)),u(o)}},[t,e,n,null==(r=t.current)?void 0:r.clientWidth]),{containerCalculatedHeight:a,containerWidth:c,containerRatio:f}},D=function(e){var t=e.images,n=e.currentImageIndex,i=e.onPrevImage,a=e.onNextImage,s=e.usedIn,l=e.shouldAnimate,c=e.zoomLevel,u=e.zoomPosition,d=e.shouldHaveRoundedBottomCorners,f=(0,o.useRef)(null),m=t.length>0?t[0].width/t[0].height:1,p=R(m,f,s),b=p.containerRatio,h=p.containerCalculatedHeight,v=p.containerWidth,y=A(m,b);return(0,r.jsxs)("div",{className:(0,j.A)("group relative flex items-center overflow-hidden",{"lg:h-full":"full-post-modal"===s,"md:rounded-b-lg":void 0!==d&&d}),style:{height:"full-post-modal"!==s?h:void 0},ref:f,children:[t.length>0?t.map(function(e,t){return(0,r.jsx)(k,{image:e,currentImageIndex:n,index:t,positionClassName:y,containerWidth:v,usedIn:s,shouldAnimate:l,zoomLevel:c,zoomPosition:u},e.id)}):(0,r.jsx)(O,{positionClassName:y}),t.length>0&&n>0&&(0,r.jsx)(N,{onClick:i,direction:"prev"}),t.length>0&&n<t.length-1&&(0,r.jsx)(N,{onClick:a,direction:"next"})]})},L=function(e){var t=e.images,n=e.currentImageIndex,o=e.setCurrentImageIndex,i=e.usedIn,s=(0,_.en)(),l=(0,c.m)().isPostBodyEmpty;return t.length<2?"mobile-full-carousel-modal"===i?(0,r.jsx)("div",{className:"!pt-0 pb-12"}):null:(0,r.jsx)("div",{className:a()("z-[2] w-full justify-center pt-5",{"absolute bottom-4 left-1/2 flex w-auto -translate-x-1/2 !pt-0":s,"pb-5":!s&&("full-post-modal"===i||l),"!pt-0 pb-12":"mobile-full-carousel-modal"===i}),children:(0,r.jsx)("div",{className:a()("bg-primary flex justify-center gap-1 rounded-xl p-0",{"!bg-white !p-2":s}),children:t.map(function(e,i){return(0,r.jsx)("button",{type:"button","aria-label":(0,v.t)("image_space.carousel.indicator_button",{image_index:i+1,total_images:t.length}),onClick:function(){return o(i)},className:a()("border-3 size-1.5 rounded-full",{"border-dark":!s&&i!==n,"border-gray-300":s&&i!==n,"border-darkest":!s&&i===n,"border-gray-900":s&&i===n})},e.id)})})})};function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function U(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var q=function(e){var t,n;return"clientX"in e&&"clientY"in e?(t=e.clientX,n=e.clientY):"touches"in e&&e.touches.length>0&&(t=e.touches[0].clientX,n=e.touches[0].clientY),[t,n]},z=function(e,t,n){if(void 0===t||1===t||!U(e.target,HTMLImageElement))return n;var r=e.target,o=r.parentNode;if(!U(o,HTMLDivElement))return n;var i=o.getBoundingClientRect(),a=r.getBoundingClientRect(),s=i.left+i.width/2,l=i.top+i.height/2,c=B(q(e),2),u=c[0],d=c[1];if(void 0===u||void 0===d)return n;var f=(s-u)*(t-1),m=(l-d)*(t-1),p=f-n[0],b=m-n[1];return(a.left+p>i.left||a.right+p<i.right)&&(f=n[0]),(a.top+b>i.top||a.bottom+b<i.bottom)&&(m=n[1]),[f,m]},Z=function(e){var t=B((0,o.useState)(e?1:void 0),2),n=t[0],r=t[1],i=B((0,o.useState)([0,0]),2),a=i[0],l=i[1],c=(0,o.useMemo)(function(){return(0,s.throttle)(function(e){l(function(t){return z(e,n,t)})},50)},[n,l]);return{zoomLevel:n,resetZoom:function(){l([0,0]),r(1)},cycleZoom:function(){r(function(e){return 1===e?2:2===e?3:1})},zoomPosition:a,setZoomPosition:l,onMouseMove:(0,o.useCallback)(function(e){e.persist(),c(e)},[c])}};function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var W=function(e){var t,n,i,m,p=e.onPostChange,b=void 0===p?s.noop:p,v=e.onPostDestroy,y=void 0===v?s.noop:v,g=e.startingImageIndex,j=void 0===g?0:g,w=e.className,O=(0,f.Zh)(),S=O.record,P=O.usedIn,C="full-post-modal"===P,k="mobile-full-carousel-modal"===P,I="full-post-modal"!==P&&"mobile-full-carousel-modal"!==P,N=(0,c.m)().isPostBodyEmpty,A=I&&(null==S?void 0:S.is_liking_disabled)&&(null==S?void 0:S.is_comments_disabled)&&N,M=H((0,o.useState)(j),2),T=M[0],E=M[1],R=Z(C),F=R.zoomLevel,U=R.onMouseMove,B=R.resetZoom,q=R.cycleZoom,z=R.zoomPosition,V=H((0,o.useState)(0===j),2),W=V[0],Q=V[1],G=(0,f.L2)().data,$=(0,u.F)(),K=(0,d.dd)(h),J=(0,_.WJ)(),X=!(0,_.WJ)(),Y=C||k,ee=(0,c.m)(),et=ee.isSharedPostView,en=ee.isSharedPostWithTeaserLayout,er=null==S||null==(i=S.gallery)?void 0:i.images,eo=en&&er?er.slice(0,1):er,ei=function(){C&&B(),Q(!0),E(function(e){return Math.min(e+1,eo?eo.length-1:e+1)})},ea=function(){C&&B(),Q(!0),E(function(e){return Math.max(e-1,0)})},es=(0,l.QS)({onSwipedRight:F&&F>1?void 0:ea,onSwipedLeft:F&&F>1?void 0:ei,onTap:function(e){e.event.target.classList.contains("carousel-image")&&!en&&(C?q():X?K.show({post:S,spaceId:null==G?void 0:G.id,startingImageIndex:T}):J&&$.show({post:S,spaceId:null==G?void 0:G.id,onPostChange:b,onPostDestroy:y,isSharedPostView:et,startingImageIndex:T}))},trackMouse:!0});return S&&eo?(0,r.jsxs)("div",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:a()("group relative w-full cursor-pointer px-0 pt-5",{"!py-0 lg:h-full":C,"flex h-full flex-col justify-between !py-0":k,"!cursor-zoom-in":C,"!pt-0":!N,"mb-5":!N&&!Y},void 0===w?"":w),onMouseMove:C?U:void 0,onTouchMove:C?U:void 0},es),n=n={children:[k&&(0,r.jsx)(x,{canDownload:null==S||null==(m=S.gallery)?void 0:m.downloadable_images,image:eo[T]}),(0,r.jsx)(D,{images:eo,currentImageIndex:T,onPrevImage:ea,onNextImage:ei,usedIn:P,shouldAnimate:W,zoomLevel:F,zoomPosition:z,shouldHaveRoundedBottomCorners:A}),(0,r.jsx)(L,{images:eo,currentImageIndex:T,setCurrentImageIndex:function(e){C&&B(),E(e)},usedIn:P})]},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t)):null}},654252:function(e,t,n){n.d(t,{F:()=>w});var r=n(552676),o=n(275271),i=n(619803),a=n.n(i),s=n(131906),l=n(307992),c=n(1892),u=n(757105),d=n(441342),f=n(257210),m=n(434519),p=n(205061),b=n(739792),h=n(324921),v=n(851945),y=n(381636),g=function(e){var t=e.onPostChange,n=e.onPostDestroy,o=e.autofocusReplyForm,i=e.scrollableTarget,a=(0,u.dd)(),c=(0,d.Zh)().record,f=(0,s.useQueryClient)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"border-primary flex justify-between border-y p-6 pb-5 sm:border-t-0",children:[(0,r.jsx)(y.Z.TitleSm,{weight:"semibold",children:(0,b.t)("image_space.grid_view.post_details")}),(0,r.jsx)(v.o,{onClick:function(){f.invalidateQueries([l.b,c.id]),a.remove()}})]}),(0,r.jsx)(h.D,{defaultShowComment:!0,autofocusReplyForm:o,onPostChange:t,onPostDestroy:function(e){a.remove(),n(e)},hideShareLink:!0,hidePinnedToTopIcon:!0,hideBookmarkButton:!0,tagsLimit:1,tagsShowMoreLabelVariant:"numbers",metaInfoWrapperClassName:"!pr-0",scrollableTarget:i})]})},x=function(e){var t=e.onPostChange,n=e.onPostDestroy,i=e.startingImageIndex,a=e.autofocusReplyForm,s=(0,o.useRef)(null);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex max-h-full w-full flex-col overflow-auto lg:h-full lg:w-3/5 xl:w-2/3",children:(0,r.jsx)(p.l,{startingImageIndex:i})}),(0,r.jsx)("div",{className:"border-primary flex w-full flex-col lg:h-full lg:w-2/5 lg:overflow-scroll lg:border-l xl:w-1/3",ref:s,children:(0,r.jsx)(g,{onPostChange:t,onPostDestroy:n,autofocusReplyForm:a,scrollableTarget:s})})]})},_=function(e){var t=e.post,n=e.spaceId,i=e.onPostChange,p=e.onPostDestroy,b=e.startingImageIndex,h=e.autofocusReplyForm,v=e.isSharedPostView,y=(0,u.dd)(),g=(0,o.useRef)(null),_=(0,c.t)({spaceId:null==t?void 0:t.space_id,spaceSlug:null==t?void 0:t.space_slug,postSlug:null==t?void 0:t.slug}),j=_.post,w=_.onPostChange,O=(0,s.useQueryClient)(),S=[[null==t?void 0:t.id]];return(0,r.jsx)(d.mE,{spaceId:n,children:(0,r.jsx)(f._x,{perPagePostIds:S,isSharedPostView:void 0!==v&&v,children:(0,r.jsx)(d.DW,{post:j||t,usedIn:"full-post-modal",children:(0,r.jsxs)(m.u_,{initialFocus:g,isOpen:y.visible,onClose:function(){O.invalidateQueries([l.b,null==t?void 0:t.id]),y.remove()},contentPortalId:"full-post-modal-portal",children:[(0,r.jsx)(m.u_.Overlay,{}),(0,r.jsxs)(m.u_.Content,{size:"full",className:a()("flex !flex-row flex-wrap content-start sm:!max-h-[836px] sm:!max-w-[1256px]"),children:[(0,r.jsx)("div",{ref:g,tabIndex:-1}),(0,r.jsx)(x,{onPostChange:function(e,t){i(e),w(e,t)},onPostDestroy:p,startingImageIndex:b,autofocusReplyForm:void 0!==h&&h})]})]})})})})},j=u.gk.create(function(e){return(0,r.jsx)(_,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),w=function(){return(0,u.dd)(j)}},366249:function(e,t,n){n.d(t,{Jl:()=>a,NU:()=>s,X2:()=>l});var r=n(131906),o=n(93199),i=n(547144),a="topics",s="courseTopics",l=function(e){var t=e.isCourseDirectory,n=e.spaceId,l=(0,r.useQuery)(t?[s]:[a,n],function(){return t?(0,o.UT)(i.av.courseTopics.index()):(0,o.UT)(i.av.topics.spaceTopics({spaceId:n}))},{enabled:t||!!n}),c=l.data,u=l.isLoading;return{topics:(null==c?void 0:c.records)||[],isLoading:u}}},151433:function(e,t,n){n.d(t,{$:()=>r});var r=function(e){var t=e.shouldShowLockIconForNonMembers,n=e.isPrivate,r=e.isAdmin;return!(void 0!==r&&r)&&n&&t}},936877:function(e,t,n){n.d(t,{H:()=>u});var r=n(552676),o=n(275271),i=n(227851),a=n(441342),s=n(65631),l=n(767900),c=n(751169),u=function(e){var t=e.formItemName,n=e.formItemTranslationRoot,u=e.formItemRules,d=e.formItemTooltipText,f=e.formItemClassName,m=e.disabled,p=e.markDefaultCurrencyDirty,b=void 0!==p&&p,h=e.dataTestId,v=(0,i.Gc)(),y=v.watch,g=v.setValue,x=y(t),_=(0,a.wh)(),j=_.data,w=_.isLoading,O=null==j?void 0:j.current_community_settings,S=(0,s.K)(),P=S.data,C=S.isLoading;if((0,o.useEffect)(function(){if(!x){var e=(P||[]).find(function(e){return e.is_default});e&&(b?g(t,"".concat(e.id),{shouldDirty:!0}):g(t,"".concat(e.id)))}},[t,g,P,x]),w||C||!P)return(0,r.jsx)(c.a,{});if(!(null==O?void 0:O.currencies_enabled))return null;var k=P.map(function(e){return{label:e.code.toUpperCase(),value:"".concat(e.id)}});return(0,r.jsx)(l.l.Item,{className:f,fullWidth:!1,hideBorder:!0,hideDescription:!0,hidePlaceholder:!0,name:t,rules:u,translationRoot:n,tooltipText:d,children:(0,r.jsx)(l.l.SelectNative,{name:t,options:k,disabled:m,"data-testid":h})})}},623428:function(e,t,n){n.d(t,{L:()=>c});var r=n(934847),o=n.n(r),i=n(547144);function a(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)})}}function l(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var c=function(e){return s(function(){var t,n;return l(this,function(r){switch(r.label){case 0:return[4,u(e)];case 1:return t=r.sent(),n=document.querySelector("meta[name=csrf-token]").content,[4,fetch((0,i.hq)(),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":n},body:JSON.stringify({blob:{filename:e.name,content_type:e.type,byte_size:e.size,checksum:t}})})];case 2:return[4,r.sent().json()];case 3:return[2,r.sent()]}})})()},u=function(e){return s(function(){return l(this,function(t){return[2,new Promise(function(t,n){var r=Math.ceil(e.size/2097152),i=0,a=new(o()).ArrayBuffer,s=new FileReader,l=function(){if(i<r||0===i&&0===r){var t=2097152*i,n=Math.min(t+2097152,e.size),o=(File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice).call(e,t,n);return s.readAsArrayBuffer(o),i++,!0}return!1};s.addEventListener("load",function(e){a.append(e.target.result),l()||t(btoa(a.end(!0)))}),s.addEventListener("error",function(){return n("Error reading ".concat(e.name))}),l()})]})})()}},260622:function(e,t,n){n.d(t,{T:()=>i});var r=n(552676),o=n(441342),i=function(e){var t=e.children;return(0,o.wh)().isViewOnlyMasquerading?(0,r.jsx)("div",{className:"!cursor-not-allowed",children:(0,r.jsx)("div",{className:"!pointer-events-none",children:t})}):(0,r.jsx)(r.Fragment,{children:t})}},601757:function(e,t,n){n.d(t,{r:()=>b});var r=n(552676),o=n(497202),i=n(131906),a=n(903225),s=n(739792),l=n(251630),c=n(957363),u=n(431089),d=n(57851),f=n(552382),m=n(757105),p=n(390431),b=m.gk.create(function(e){var t=e.templateKey,n=(0,o.dd)(),m=(0,a.k6)(),b=(0,l.WX)(),h=(0,i.useQuery)(["workflow-templates","ai_workflows"],function(){return b.templates({params:{category:"ai_workflows",v2_2_enabled:!0}})}),v=h.data,y=h.isLoading;return(0,r.jsx)(p.o,{isOpen:n.visible,onClose:n.hide,title:(0,s.t)("workflows_v2.momentum_modal.".concat(t,".title")),description:(0,s.t)("workflows_v2.momentum_modal.".concat(t,".description")),isLoading:y,"data-testid":"reported-post-momentum-modal",children:(0,r.jsx)(d.X,{title:(0,s.t)("workflows_v2.momentum_modal.".concat(t,".notice.title")),description:(0,s.t)("workflows_v2.momentum_modal.".concat(t,".notice.description")),children:(0,r.jsx)(u.K,{iconEl:(0,r.jsx)(c.JO,{type:"20-zap",size:20}),onClick:function(){var e,r,o=null==v||null==(r=v.records)||null==(e=r.find(function(e){return(null==e?void 0:e.key)===t}))?void 0:e.id;o?m.push(f.o.preview({workflowId:o})):m.push(f.o.new()),n.hide()},disabled:y,"data-testid":"create-moderation-workflow-button",children:(0,s.t)("workflows_v2.momentum_modal.".concat(t,".notice.button"))})})})})},540539:function(e,t,n){n.d(t,{D:()=>c,d:()=>l});var r=n(552676),o=n(275271);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=(0,o.createContext)({});s.displayName="CurrentLessonContext";var l=function(e){var t=e.children,n=a((0,o.useState)(!0),2),i=n[0],l=n[1],c=a((0,o.useState)({}),2),u=c[0],d=c[1];return(0,r.jsx)(s.Provider,{value:{isSubmitEnabled:i,setIsSubmitEnabled:l,currentLesson:u,setCurrentLesson:d},children:t})},c=function(){var e=(0,o.useContext)(s);if(!e)throw Error("useCurrentLessonContext must be used within a CurrentLessonContextProvider");return e}},276012:function(e,t,n){n.d(t,{hg:()=>U,Vu:()=>B});var r=n(552676),o=n(275271),i=n(932699),a=n(757105),s=n(131906),l=n(309757),c=n(93199),u=n(547144),d=n(144102),f=n(548298),m=n(434519),p=n(739792),b=n(957363),h=n(381636),v=function(){return(0,r.jsx)("div",{className:"bg-primary m-auto text-center",children:(0,r.jsxs)("div",{className:"m-auto flex h-32 max-w-md flex-col items-center justify-center gap-4 p-8","data-testid":"empty-search",children:[(0,r.jsx)(b.JO,{type:"32-search-v2",className:"text-default !h-8 !w-8",size:32}),(0,r.jsx)("div",{className:"flex flex-col gap-2",children:(0,r.jsx)(h.Z.BodySm,{color:"text-default",children:(0,p.t)("view_only_masquerading.empty_search_placeholder")})})]})})},y=n(346681),g=function(e){var t=e.setCategory,n=e.setQuery;return(0,r.jsxs)("div",{className:"mx-auto flex h-32 flex-col items-center justify-center pb-8 pt-6 leading-tight",children:[(0,r.jsx)("div",{className:"pb-2",children:(0,r.jsx)(h.Z.TitleSm,{weight:"semibold",children:(0,p.t)("view_only_masquerading.no_results")})}),(0,r.jsx)("div",{children:(0,r.jsx)(h.Z.BodySm,{color:"text-default",children:(0,p.t)("view_only_masquerading.try_a_different_term")})}),(0,r.jsx)("div",{className:"pt-2",children:(0,r.jsx)("button",{type:"button",onClick:function(){"function"==typeof t&&t(""),n("")},children:(0,r.jsx)(y.Di,{color:"text-circle",weight:"semibold",children:(0,p.t)("view_only_masquerading.back")})})})]})},x=function(e){var t=e.isLoading,n=e.query,o=e.setQuery;return(0,r.jsx)("div",{className:"bg-primary sticky top-0 isolate z-10 flex items-center justify-between p-4 md:static md:top-auto md:p-0",children:(0,r.jsx)("div",{className:"mr-0 flex w-full items-center md:p-5",children:(0,r.jsxs)("div",{className:"bg-secondary sm:bg-primary border-secondary flex w-full items-center gap-3 rounded-md border px-2 py-1 sm:rounded-md sm:px-2 sm:py-1",children:[(0,r.jsx)("div",{className:"flex",children:t?(0,r.jsx)(b.JO,{type:"loader",className:"text-default",size:20,useWithFillCurrentColor:!0}):(0,r.jsx)(b.JO,{type:"16-search",className:"text-default",size:16,useWithFillCurrentColor:!0})}),(0,r.jsx)("input",{className:"text-dark sm:bg-primary placeholder:text-light h-6 w-full rounded bg-transparent text-sm outline-none placeholder:opacity-100 sm:rounded-none",placeholder:(0,p.t)("view_only_masquerading.input_placeholder"),"aria-autocomplete":"list",value:n,onChange:function(e){return o(e.target.value)}}),(0,r.jsx)("button",{type:"submit",className:"text-default flex pt-1",onClick:function(){return o("")},children:!!n&&(0,r.jsx)(b.JO,{type:"20-close-md",useWithFillCurrentColor:!0})})]})})})},_=n(664657),j=n(208807),w=function(e){var t,n=e.id,o=e.type,i=e.name,a=e.avatarUrl,s=e.onClick;return"CommunityMember"==o?t=(0,r.jsx)(_.W,{src:a,name:i,size:"5"}):"Paywall"==o?t=(0,r.jsx)(b.JO,{type:"credit-card",className:"text-default shrink-0",size:16}):"InvitationLink"==o&&(t=(0,r.jsx)(b.JO,{type:"16-link",className:"text-default shrink-0",size:16})),(0,r.jsx)("li",{children:(0,r.jsx)("button",{tabIndex:0,type:"button",className:"text-dark bg-primary hover:bg-secondary focus:bg-secondary flex w-full cursor-pointer items-center justify-between gap-4 px-5 py-2.5 transition-colors",onClick:function(){return s(n,o)},children:(0,r.jsxs)("div",{className:"truncate-one-line flex items-center gap-3",children:[t,(0,r.jsx)(j.T1,{children:i})]})})})};function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var P=function(){var e=(0,a.dd)(),t=(0,o.useRef)(null),n=(0,o.useRef)(null);(0,l.Z)(t,function(){e.remove()});var i=S((0,o.useState)(""),2),p=i[0],b=i[1],h=S((0,o.useState)([]),2),y=h[0],_=h[1],j=S((0,o.useState)(!1),2),O=j[0],P=j[1],C=(0,f.c)(p,500),k=(0,s.useQuery)({queryKey:["masquerading/entities",C],queryFn:function(){return(0,c.UT)(u.av.masquerading.entities.index({query:C,members_only:!0}))},refetchOnWindowFocus:!1,enabled:!!C,staleTime:3e5}),I=k.data,N=k.isLoading;(0,o.useEffect)(function(){C||(P(!1),_([]))},[C]),(0,o.useEffect)(function(){if(I){var e=I.records,t=I.category,n=I.query;t||n?(P(0===e.length),_(e)):(P(!1),_([]))}},[I]);var A=function(e,t){return(0,d.g)({entityId:e,entityType:t,mode:"edit"}).then(function(e){return window.open(e.masquerade_url,"_self")}).catch(function(e){console.error(e)})};return(0,r.jsx)(m.u_,{isOpen:e.visible,onClose:e.remove,children:(0,r.jsx)(m.u_.Content,{position:"top",className:"border-primary w-full rounded-[0px] sm:rounded-lg sm:border md:!mt-[3.25rem] md:w-[335px]",size:"xl",children:(0,r.jsxs)("div",{ref:t,children:[(0,r.jsx)(x,{isLoading:N,query:p,setQuery:b}),y.length>0?(0,r.jsx)("div",{className:"overflow-y-auto md:max-h-96",ref:n,children:(0,r.jsx)("ul",{className:"list-none",children:y.map(function(e){return(0,r.jsx)(w,{id:e.id,type:e.type,name:e.name,avatarUrl:e.avatar_url,onClick:A},"".concat(e.type,"-").concat(e.id))})})}):O?(0,r.jsx)(g,{setQuery:b}):(0,r.jsx)(v,{})]})})})},C=n(638369),k=function(e){var t=e.category,n=e.setCategory;return(0,r.jsx)("button",{tabIndex:0,type:"button",className:"text-dark bg-primary hover:bg-secondary focus:bg-secondary flex w-full cursor-pointer items-center justify-between gap-4 px-5 py-2.5 transition-colors",onClick:function(){return n("")},children:(0,r.jsxs)("div",{className:"flex items-center gap-3 text-gray-500",children:[(0,r.jsx)(b.JO,{type:"chevron-left",className:"text-default",size:16}),(0,r.jsx)(C.c,{color:"text-gray-500",children:(0,p.t)("view_only_masquerading.categories.".concat(t))})]})})},I=function(e){var t=e.name,n=e.icon,o=e.onClick;return(0,r.jsx)("li",{children:(0,r.jsxs)("button",{tabIndex:0,type:"button",className:"text-dark bg-primary hover:bg-secondary focus:bg-secondary flex w-full cursor-pointer items-center justify-between gap-4 px-5 py-2.5 transition-colors",onClick:o,children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(b.JO,{type:n,className:"text-default",size:16}),(0,r.jsx)(j.T1,{children:t})]}),(0,r.jsx)(b.JO,{type:"16-chevron-right",className:"text-default",size:16})]})})},N=function(e){var t=e.setCategory;return(0,r.jsx)("div",{className:"mb-2 overflow-y-auto md:max-h-96",children:(0,r.jsxs)("ul",{className:"list-none",children:[(0,r.jsx)(I,{name:(0,p.t)("view_only_masquerading.categories.members"),icon:"16-account",onClick:function(){return t("members")}}),(0,r.jsx)(I,{name:(0,p.t)("view_only_masquerading.categories.paywalls"),icon:"credit-card",onClick:function(){return t("paywalls")}}),(0,r.jsx)(I,{name:(0,p.t)("view_only_masquerading.categories.links"),icon:"16-link",onClick:function(){return t("links")}}),(0,r.jsx)(I,{name:(0,p.t)("view_only_masquerading.categories.access_groups"),icon:"16-lock",onClick:function(){return t("access_groups")}})]})})};function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var T=function(){var e=(0,a.dd)(),t=(0,o.useRef)(null),n=(0,o.useRef)(null);(0,l.Z)(t,function(){e.remove()});var i=M((0,o.useState)(""),2),p=i[0],b=i[1],h=M((0,o.useState)(""),2),v=h[0],y=h[1],_=M((0,o.useState)(""),2),j=_[0],O=_[1],S=M((0,o.useState)(""),2),P=S[0],C=S[1],I=M((0,o.useState)([]),2),A=I[0],T=I[1],E=M((0,o.useState)(!1),2),R=E[0],D=E[1],L=(0,f.c)(v,500),F=(0,s.useQuery)({category:p,queryKey:["masquerading/entities",L,p],queryFn:function(){return(0,c.UT)(u.av.masquerading.entities.index({query:L,category:p}))},refetchOnWindowFocus:!1,enabled:!!(L||p),staleTime:3e5}),U=F.data,B=F.isLoading;(0,o.useEffect)(function(){L||p||(D(!1),T([]))},[L,p]),(0,o.useEffect)(function(){if(U){var e=U.records,t=U.category,n=U.query;O(t),C(n),t||n?(D(0===e.length),T(e)):(D(!1),T([]))}},[U]);var q=function(e,t){return(0,d.g)({entityId:e,entityType:t}).then(function(e){return window.open(e.masquerade_url,"_self")}).catch(function(e){console.error(e)})};return(0,r.jsx)(m.u_,{isOpen:e.visible,onClose:e.remove,children:(0,r.jsx)(m.u_.Content,{position:"top",className:"border-primary w-full rounded-[0px] sm:rounded-lg sm:border md:!mt-[3.25rem] md:w-[335px]",size:"xl",children:(0,r.jsxs)("div",{ref:t,children:[(0,r.jsx)(x,{isLoading:B,query:v,setQuery:y}),A.length>0?(0,r.jsxs)("div",{className:"mb-2 overflow-y-auto md:max-h-96",ref:n,children:[j&&!P&&(0,r.jsx)(k,{category:j,setCategory:b}),(0,r.jsx)("ul",{className:"list-none",children:A.map(function(e){return(0,r.jsx)(w,{id:e.id,type:e.type,name:e.name,avatarUrl:e.avatar_url,onClick:q},"".concat(e.type,"-").concat(e.id))})})]}):R?(0,r.jsx)(g,{setCategory:b,setQuery:y}):(0,r.jsx)(N,{setCategory:b})]})})})},E=a.gk.create(function(){return(0,r.jsx)(P,{})}),R=a.gk.create(function(){return(0,r.jsx)(T,{})});function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var L={isBannerVisible:!1,showBanner:i.noop,hideBanner:i.noop,openViewMasqueradingSearch:i.noop,openEditMasqueradingSearch:i.noop},F=(0,o.createContext)(L);F.displayName="MasqueradeContext";var U=function(e){var t,n=e.children,i=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return D(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=i[0],l=i[1],c=(0,a.dd)(R),u=(0,a.dd)(E);return(0,r.jsx)(F.Provider,{value:{isBannerVisible:s,showBanner:function(){l(!0),c.show()},hideBanner:function(){return l(!1)},openViewMasqueradingSearch:function(){c.show()},openEditMasqueradingSearch:function(){u.show()}},children:n})},B=function(){var e=(0,o.useContext)(F);if(!e)throw Error("useMasqueradeContext must be used within a MasqueradeContextProvider");return e}},218059:function(e,t,n){n.d(t,{Rl:()=>f,Wj:()=>p,h4:()=>m});var r=n(552676),o=n(275271);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}var l=function(e,t){var n=t.type,r=t.payload;switch(n){case"SET_SPACE_NOTIFICATIONS":return r;case"UPDATE_SPACE_NOTIFICATIONS":var o,i,s=e.spaces,l=s.findIndex(function(e){return e.id===r.space.id});if(l>-1)return o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),i=i={spaces:a(s.slice(0,l)).concat([r.space],a(s.slice(l+1)))},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(i)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(i,e))}),o;return e;default:throw Error("Unhandled action type: ".concat(n))}},c=(0,o.createContext)(null);c.displayName="SpaceNotificationsStateContext";var u=(0,o.createContext)(null);u.displayName="SpaceNotificationsDispatchContext";var d={spaces:[]},f=function(e){var t,n=e.children,i=(t=(0,o.useReducer)(l,d),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||s(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],f=i[1];return(0,r.jsx)(c.Provider,{value:a,children:(0,r.jsx)(u.Provider,{value:f,children:n})})},m=function(){var e=(0,o.useContext)(c);if(void 0===e)throw Error("useSpaceNotificationsState must be used within a SpaceNotificationsProvider");return e},p=function(){var e=(0,o.useContext)(u);if(void 0===e)throw Error("useSpaceNotificationsDispatch must be used within a SpaceNotificationsProvider");return e}},117679:function(e,t,n){n.d(t,{I:()=>i});var r=n(131906),o=n(547144),i=function(e){var t,n,i,a=e.spaceId,s=e.enabled,l=o.av.spaces.activeMembersCount({id:a}),c=(0,r.useQuery)({queryKey:[l],enabled:!!a&&(void 0===s||s)});return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},c),n=n={count:(null==(i=c.data)?void 0:i.members_count)||0},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}},810958:function(e,t,n){n.d(t,{BU:()=>l,G5:()=>s,GL:()=>a,ND:()=>i,el:()=>c});var r=n(376518),o=function(e){var t=[],n=Math.random().toString(36).slice(2);return{contentWithoutAttachments:e.replace(/data-trix-attachment="([^"]*)"/g,function(e,r){var o=t.push(r)-1;return'data-trix-attachment="__TRIX_'.concat(n,"_").concat(o,'__"')}),attachments:t,uniqueId:n}},i=function(e){if(!e)return e;var t,n=o(e),i=n.contentWithoutAttachments,a=n.attachments,s=n.uniqueId;return t=(0,r.Z)(i,{defaultProtocol:"https",target:{url:"_blank"},ignoreTags:["a","style","script","img","iframe","action-text-attachment","video","audio"],validate:{url:function(e){return/^[^A-Z]/.test(e)}}}),t.replace(RegExp('data-trix-attachment="__TRIX_'.concat(s,'_(\\d+)__"'),"g"),function(e,t){return'data-trix-attachment="'.concat(a[Number(t)],'"')})},a=function(e){e.querySelectorAll("video").forEach(function(e){e.setAttribute("controlsList","nodownload")})},s=function(e){var t=e.containerElement,n=e.shouldIncludeInternalLinks,r=void 0!==n&&n;t.querySelectorAll("a").forEach(function(e){"A"===e.tagName&&!e.isContentEditable&&(r||e.host!==window.location.host)&&(e.setAttribute("target","_blank"),e.setAttribute("rel","noreferrer"))})},l=function(e){e.querySelectorAll("[data-background-image]").forEach(function(e){var t=e.getAttribute("data-background-image")||"",n=document.createElement("img");n.src=t,e.setAttribute("style",'background-image: url("'.concat(t,'")')),n.onload=function(){var t=e.parentElement;t&&(t.classList.add("show"),t.classList.remove("hide"))}})};function c(e){e.querySelectorAll("[data-target~='downloadAttachment']").forEach(function(e){e.addEventListener("click",function(e){var t,n;if(t=e.currentTarget,null!=(n=HTMLElement)&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](t):t instanceof n){e.preventDefault(),e.stopPropagation();var r,o,i,a,s,l,c,u=e.currentTarget.dataset;u.url&&u.fileName&&u.logUrl&&(o=(r={url:u.url,fileName:u.fileName,logUrl:u.logUrl}).url,i=r.fileName,a=r.logUrl,s=o,l=i,(c=document.createElement("a")).href=s,c.download=l,c.setAttribute("download",l),c.click(),fetch(a,{method:"POST"}))}})})}},400810:function(e,t,n){n.d(t,{B:()=>r,K:()=>o});var r=function(e){var t=e.type;return!t||"CommunityMember"===t},o=function(e){return"CommunityLead"===e.type}},595971:function(e,t,n){n.d(t,{H:()=>r});var r=function(e){if(!e)return"";var t=e.replace(/data:\S+,/,"");try{for(var n=atob(t),r=new Uint8Array(n.length),o=0;o<n.length;o++)r[o]=n.charCodeAt(o);return new TextDecoder("utf-8").decode(r)}catch(e){return console.error("Failed to decode base64 data:",e),""}}},282859:function(e,t,n){n.d(t,{G6:()=>l,OP:()=>f,n2:()=>u,qx:()=>c,s2:()=>a,vF:()=>d});var r=n(215989),o=n.n(r),i=n(72622),a=function(){return window.MOBILE_DEVICE},s=function(){return{name:o().name,version:o().version,os:o().os,description:o().description,product:o().product,layout:o().layout,manufacturer:o().manufacturer,ua:o().ua}},l=function(){return"Safari"===s().name},c=function(){return"iPhone"===s().product},u=function(e){if(!e)return!1;var t=e.ctrlKey||e.metaKey,n=e.button&&1===e.button;return t||n},d=function(){return l()&&i.isMacOs&&15>=parseFloat(i.browserVersion)},f=function(){return d()?"vh":"dvh"}},952723:function(e,t,n){n.d(t,{N:()=>i});var r=n(932699),o=n(916823),i=function(e,t){try{var n,i,a,s,l,c,u=new Date(e),d=(0,o.Ed)(),f=new Intl.DateTimeFormat(d,{day:"numeric",month:"short",timeZone:t}).formatToParts(u);s=null==(l=f.find(function(e){return"month"===e.type}))?void 0:l.value,i=null==(c=f.find(function(e){return"day"===e.type}))?void 0:c.value,a=(0,r.upperFirst)(s).replace(".","")}catch(e){(null!=(n=Error)&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](e):e instanceof n)&&console.error("dateComponents - Could not parse date: ".concat(e.message))}return{dayOfMonth:i,shortMonthString:a}}},857338:function(e,t,n){n.d(t,{H:()=>s});var r=n(27690),o=n(941053),i=n(739792),a=n(134870),s=function(e){var t=new Date(e),n=new Date,s=(0,r.Z)(),l=(0,o.Z)();return{day:t.getFullYear()===n.getFullYear()?t>s?(0,i.t)("today"):t>l?(0,i.t)("yesterday"):(0,a.w)({dateTime:t,format:"short_month_and_date"}):(0,a.w)({dateTime:t,format:"short_date"}),time:(0,a.w)({dateTime:t,format:"short_time"})}}},624589:function(e,t,n){n.d(t,{k:()=>i});var r=n(271066),o=n(916823),i=function(e,t){var n=t.format,i=t.decimal,a=void 0===i?0:i,s=t.position,l=t.text;if(n===r.av.UNFORMATTED)return e.toString();var c=(0,o.Ed)(),u=e.toLocaleString(c,{minimumFractionDigits:a,maximumFractionDigits:a});return n===r.av.PERCENT&&(u+="%"),n===r.av.CUSTOM&&l&&(u="left"===s?"".concat(l," ").concat(u):"".concat(u," ").concat(l)),u}},590996:function(e,t,n){n.d(t,{s:()=>r});var r=(0,n(325752).partial)({base:2,standard:"jedec"})},18317:function(e,t,n){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}n.d(t,{q:()=>c,y:()=>l});var a="OvDGLovptOPNSO5JjplEIssLF1x8Yxc3",s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new URL("".concat("https://api.giphy.com/v1/gifs","/").concat(e)),o=!0,i=!1,a=void 0;try{for(var s,l=Object.entries(t)[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c,u=(c=s.value,function(e){if(Array.isArray(e))return e}(c)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(c,2)||function(e,t){if(e){if("string"==typeof e)return r(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}}(c,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=u[0],f=u[1];n.searchParams.set(d,f)}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}return n.toString()},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch(s("search",i(o({},t),{q:e,api_key:a}))).then(function(e){return e.json()})},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return fetch(s("trending",i(o({},e),{api_key:a}))).then(function(e){return e.json()})}},767379:function(e,t,n){n.d(t,{C:()=>r});var r=function(e){return"triggerFormSubmit"in e}},767132:function(e,t,n){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{E9:()=>a,Ig:()=>c,ON:()=>s,kK:()=>l,ug:()=>i});var o=/^```html\s*([\s\S]*?)\s*```$/gm,i=function(e){return o.test(e)};function a(e){return e.replace(o,"$1").trim().replace(/<\/?\s*br\s*>/gi,function(e){return e.startsWith("</")?"":"<br />"}).replace(/<\s*br\s*\/?\s*>/gi,"<br />")}var s=function(e){return"```html\n".concat(e,"\n```")},l=function(e){return e.nodeType===Node.ELEMENT_NODE},c=function(e){var t=document.createElement("div");t.innerHTML=e;var n=[],o=function(e){if(e.nodeType===Node.TEXT_NODE){var t=(e.textContent||"").match(/\S+\s*/g)||[];n.push.apply(n,function(e){if(Array.isArray(e))return r(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return r(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}else if(l(e)){n.push((null==(i=e.outerHTML.match(/^<[^>]+>/))?void 0:i[0])||""),e.childNodes.forEach(o);var i,a=e.tagName.toLowerCase();n.push("</".concat(a,">"))}};return t.childNodes.forEach(o),n}},131510:function(e,t,n){n.d(t,{U:()=>r});var r=function(){var e=window.location.pathname;return/^\/c\/[^/]+\/[^/]+\/?$/.test(e)}},437588:function(e,t,n){n.d(t,{$e:()=>y,B8:()=>p,Bk:()=>a,Gi:()=>g,H0:()=>o,HN:()=>x,Hq:()=>T,If:()=>w,L6:()=>I,LV:()=>r,MA:()=>h,SS:()=>f,UT:()=>b,VM:()=>s,Vq:()=>A,Zo:()=>_,_V:()=>k,_d:()=>i,a_:()=>N,cf:()=>P,eM:()=>S,ee:()=>v,fN:()=>m,g5:()=>R,iD:()=>l,jN:()=>E,kx:()=>j,lH:()=>C,ln:()=>d,mP:()=>M,pp:()=>D,vX:()=>O,wA:()=>c});var r=Object.freeze({INITIALIZING:"initializing",BACKSTAGE:"backstage",LIVE:"active",ENDED:"inactive",CLOSING:"closing",SCHEDULED:"scheduled"}),o=Object.freeze({CONFERENCE:"conference",STREAM:"stream",EVENT:"event"}),i=Object.freeze({OPEN:"open",SECRET:"secret",PUBLIC_STREAM:"public_stream"}),a=Object.freeze({SPEAKER:"speaker_view",SPEAKER_VARIANT:"speaker_variant_view",GRID:"grid_view"}),s=Object.freeze({HOST:"host",HLS_SPECTATOR:"hlsspectator",MODERATOR:"moderator"}),l=Object.freeze({HOST:"host",MODERATOR:"moderator",COHOST:"cohost",PARTICIPANT:"participant"}),c={JOINING:"joining",ACTIVE:"active",INACTIVE:"inactive"},u=Object.freeze({HMS:"hms",LIVEKIT:"livekit"}),d=1,f=function(e){return(null==e?void 0:e.status)===r.BACKSTAGE},m=function(e){return(null==e?void 0:e.status)===r.LIVE},p=function(e){return(null==e?void 0:e.status)===r.CLOSING},b=function(e){return(null==e?void 0:e.status)===r.ENDED},h=function(e){return(null==e?void 0:e.status)===r.SCHEDULED},v=function(e){return(null==e?void 0:e.room_type)===o.STREAM},y=function(e){return(null==e?void 0:e.room_type)===o.CONFERENCE},g=function(e){return!!(null==e?void 0:e.recording_enabled)},x=function(e){return!!(null==e?void 0:e.can_manage)},_=function(e){return!!(null==e?void 0:e.can_host)},j=function(e){return!!(null==e?void 0:e.host_capacity_reached)},w=function(e){return!!(null==e?void 0:e.spectator_capacity_reached)},O=function(e){return(null==e?void 0:e.room_type)||o.STREAM},S=function(e){return!(null==e?void 0:e.view_type)||(null==e?void 0:e.view_type)===a.SPEAKER||(null==e?void 0:e.view_type)===a.SPEAKER_VARIANT},P=function(e){return(null==e?void 0:e.view_type)===a.SPEAKER_VARIANT},C=function(e){return(null==e?void 0:e.view_type)===a.GRID},k=function(e){return(null==e?void 0:e.access_type)===i.SECRET},I=function(e){return(null==e?void 0:e.access_type)===i.PUBLIC_STREAM},N=function(e){return(null==e?void 0:e.status)===c.INACTIVE},A=function(e){return(null==e?void 0:e.role)===s.HLS_SPECTATOR},M=function(e){return(null==e?void 0:e.room_provider)===u.LIVEKIT},T=function(e){return I(e)&&x(e)},E=function(e){return null==e?void 0:e.limit_url_sharing},R=function(e){return!!(null==e?void 0:e.hide_participants_list)&&!x(e)&&!(null==e?void 0:e.can_moderate)},D=function(e){var t=null==e?void 0:e.metadata;if(!t)return null;try{var n,r,o=JSON.parse(t);return n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},o),r={role:e.roleName},r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(r)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}),n}catch(e){return console.error("Error parsing peer metadata",e),null}}},981261:function(e,t,n){n.d(t,{$q:()=>i,cT:()=>r,sR:()=>o});var r=function(e){var t,n;return(null!=(n=null==e||null==(t=e.member_tags)?void 0:t.length)?n:0)>0},o=function(e){return!!e.website_url||!!e.facebook_url||!!e.twitter_url||!!e.linkedin_url||!!e.instagram_url},i={SIGNUP:"signup",EDIT_PROFILE:"edit_profile",PROFILE_VIEW:"profile_view"}},663676:function(e,t,n){n.d(t,{HA:()=>r,Ri:()=>o,cM:()=>a,dm:()=>i});var r=function(e){return e.toLocaleString(void 0,{maximumFractionDigits:0})};function o(e){return Math.floor(e)===e?0:e.toString().split(".")[1].length||0}var i=function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=[{value:1e9,suffix:"b"},{value:1e6,suffix:"m"},{value:1e3,suffix:"k"}][Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(e>=a.value)return(e/a.value).toFixed(1).replace(/\.0$/,"")+a.suffix}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e.toString()},a=function(e,t){if(!t||""===t.trim())return i(e);var n=Math.abs(e),r=e<0,o=i(n);return r?"".concat(t,"-").concat(o):"".concat(t).concat(o)}},180932:function(e,t,n){n.d(t,{$v:()=>u,FV:()=>l,GY:()=>w,Kj:()=>y,Km:()=>a,Sy:()=>o,UU:()=>j,Vp:()=>i,Vu:()=>_,XV:()=>x,Zi:()=>g,_D:()=>v,ff:()=>s,q2:()=>p,s5:()=>b,sR:()=>m,sq:()=>f,tL:()=>c});var r=n(739792),o=function(e){return e.interval===s.year?(0,r.t)("pricing_plans.billing_cycle.annually"):(0,r.t)("pricing_plans.billing_cycle.monthly")},i=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},a=function(e){var t;return null!=(t=null==e?void 0:e.alternative_plan)&&t},s=Object.freeze({month:"month",year:"year",quarter:"quarter",biannual:"biannual"}),l=function(e){return[w.live_stream_max_host_capacity,w.live_stream_max_spectator_capacity].includes(e)},c=function(e){return e>=1e6},u={upgrade:"upgrade",current_plan:"current_plan",resume:"resume",redeem_offer:"redeem_offer",renew:"renew",change_plan:"change_plan",downgrade:"downgrade",contact_support:"contact_support"},d=function(e){return function(t){return t===e}},f=d(u.current_plan),m=d(u.upgrade);d(u.redeem_offer);var p=d(u.resume),b=d(u.renew),h=d(u.change_plan),v=d(u.downgrade),y=d(u.contact_support),g=function(e){return h(e.plan_action)&&e.interval===s.year},x=function(e){return h(e.plan_action)&&e.interval===s.month},_=function(e){return g(e)||m(e.plan_action)},j=function(e){var t=e.checkout_succeeded;return!!(void 0!==t&&t)},w=Object.freeze({sso:"sso",max_admin_count:"max_admin_count",max_space_count:"max_space_count",custom_css:"custom_css",api_access:"api_access",automated_moderation:"automated_moderation",advanced_reporting:"advanced_reporting",custom_domain:"custom_domain",max_moderator_count:"max_moderator_count",internal_custom_html:"internal_custom_html",post_admin_change:"post_admin_change",max_member_count:"max_member_count",payments_fee_percentage:"payments_fee_percentage",allow_addons:"allow_addons",email_whitelist:"email_whitelist",live_stream_max_host_capacity:"live_stream_max_host_capacity",live_stream_max_spectator_capacity:"live_stream_max_spectator_capacity",live_stream_monthly_stream_hours:"live_stream_monthly_stream_hours",live_stream_recording_hours:"live_stream_recording_hours",chat_space_members_limit:"chat_space_members_limit",profile_fields_enabled:"profile_fields_enabled",max_bulk_import_member_limit_tier_1:"max_bulk_import_member_limit_tier_1",max_bulk_import_member_limit_tier_2:"max_bulk_import_member_limit_tier_2",max_bulk_import_member_limit_on_trial:"max_bulk_import_member_limit_on_trial",live_room_participants_capacity:"live_room_participants_capacity",courses:"courses",customize_community:"customize_community",paywall_conversion_tracking_code:"paywall_conversion_tracking_code",max_dynamic_workflows_count:"max_dynamic_workflows_count",max_bulk_action_workflows_count:"max_bulk_action_workflows_count",max_scheduled_workflows_count:"max_scheduled_workflows_count",zapier_token_automatic_creation:"zapier_token_automatic_creation",affiliates:"affiliates",analytics_filters:"analytics_filters",included_storage_gigabytes:"included_storage_gigabytes"})},259459:function(e,t,n){n.d(t,{B:()=>s,H:()=>l});var r=n(932699),o=n(739792),i=n(547144);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(e){return(0,r.isString)(e)?e.replace(/(^\w+:|^)\/\//,""):e},l=function(e){var t=e.name,n=e.params,s=e.publicUid,l=e.shouldOpenInNewTab,c=e.showMemberProfileDrawer,u=t||(0,o.t)("view_user_profile_name"),d=(0,o.t)("view_user_profile",{user:u});return s?void 0!==l&&l?a({href:(0,i.zd)({public_uid:s,params:n}),target:"_blank",rel:"noreferrer"},"aria-label",d):a({onClick:function(e){e.preventDefault(),c({memberPublicId:s,params:n})},href:(0,i.zd)({public_uid:s})},"aria-label",d):a({onClick:r.noop,href:"#"},"aria-label","")}},693276:function(e,t,n){n.d(t,{S:()=>r});var r=function(e){return{body:{type:"doc",content:[{type:"paragraph",content:[{type:"text",text:e}]}]},attachments:[],localAttachments:[],localSgidToObjectMap:{}}}},326371:function(e,t,n){n.d(t,{e:()=>r});var r={list:function(){return"/settings/emails/broadcast"},edit:function(e){var t=e.broadcastId;return"/settings/emails/broadcast/".concat(t,"/edit")},visualBuilder:function(e){var t=e.broadcastId;return"/settings/emails/broadcast/".concat(t,"/visual-builder")},content:function(e){var t=e.broadcastId;return"/settings/emails/broadcast/".concat(t,"/content")},view:function(e){var t=e.broadcastId;return"/settings/emails/broadcast/".concat(t,"/view")},viewAnalytics:function(e){var t=e.broadcastId;return"/settings/emails/broadcast/".concat(t,"/view/analytics")}}},573622:function(e,t,n){n.d(t,{OT:()=>i,i4:()=>o,lu:()=>r});var r=/[(http(s)?)://(www.)?a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,15}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/,o=/^[-a-zA-Z0-9%_+.~#?&//=]+$/,i=/(^mailto:(?!.*\.\.)[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$)|(^https?:\/\/(?!.*\.\.)[-a-zA-Z0-9_]+\.[a-zA-Z0-9-.]+[^ ]*$)/},627175:function(e,t,n){n.d(t,{r:()=>o});var r=n(22319),o=function(){return(0,r.ww)().isAdminUsageContext?"circle":"primary"}},742613:function(e,t,n){n.d(t,{z:()=>a});var r=n(131906),o=n(93199),i=n(547144),a=function(e){var t=e.agentId,n=e.params,a=void 0===n?{}:n,s=["AI_AGENT_PROFILE_INFO",t,a];return{getAgentProfileInfoQuery:(0,r.useQuery)({queryKey:s,queryFn:function(){return(0,o.UT)(i.av.communityAiAgentProfile.show({agentId:t,params:a}))},retry:!1,enabled:!!t})}}},852937:function(e,t,n){n.d(t,{W:()=>en});var r=n(275271),o=n(552676),i=n(497202),a=n(739792),s=n(742613),l=n(981261),c=n(434519),u=n(851945),d=n(381636),f=n(25593),m=n(903225),p=n(532602),b=n(217123),h=n(918594),v=n(693440),y=n(941084),g=n(547144),x=n(380171),_=n(291704),j=function(e){var t=e.comment,n=e.onClose,r=e.member,i=(0,b.default)(new Date(t.created_at),"MMM dd");return(0,o.jsxs)(h.rU,{to:(0,g.LM)({slug:t.post_slug,spaceSlug:t.space_slug})+"#comment_wrapper_".concat(t.id),onClick:n,className:"flex w-full min-w-0 items-start space-x-3 overflow-hidden py-5 first:pt-0",children:[(0,o.jsx)("div",{className:"mt-1",children:(0,o.jsx)(p.s,{isFullRounded:!0,name:r.name,src:r.avatar_url,size:"10"})}),(0,o.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,o.jsxs)("div",{className:"flex w-full min-w-0 items-center justify-between space-x-2",children:[(0,o.jsxs)("div",{className:"text-default w-full min-w-0 flex-1 truncate text-sm",children:[(0,a.t)("profile_drawer.comments.commented_on")," ",(0,o.jsx)("span",{className:"text-dark dark:text-darkest font-medium",children:t.post_name||t.post_truncated_content})]}),(0,o.jsx)("div",{children:(0,o.jsx)(x.T,{interactive:!1,content:(0,y.s4)(t.created_at),children:(0,o.jsx)("span",{className:"text-default text-sm",children:i})})})]}),"tiptap"===t.editor?(0,o.jsx)(v.G,{tiptapBody:t.tiptap_body},t.updated_at):(0,o.jsx)(_.P,{content:t.body_trix_content})]})]})},w=n(917335),O=n(137385),S=n(259092),P=n(240761),C=n(281772),k=n(720624),I=n(693276),N=n(932699),A=(0,r.createContext)({agent:null,isLoading:!0,isFullPageView:!1,onClose:function(){}});A.displayName="AgentProfileContext";var M=function(){return(0,r.useContext)(A)},T=function(e){var t=e.agent,n=e.isFullPageView,r=e.isLoading,i=e.children,a=e.onClose,s=void 0===a?N.noop:a;return(0,o.jsx)(A.Provider,{value:{agent:t,isLoading:r,isFullPageView:void 0!==n&&n,onClose:s},children:i})};function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var R="agent-profile-scrollable-target",D=function(){var e,t,n,i,s,l=M(),c=l.agent,u=l.onClose,p=c.can_interact,b=(0,m.k6)(),h=(e=(0,r.useState)("about"),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return E(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=h[0],y=h[1],x=null==c||null==(t=c.profile)?void 0:t.id,_=(0,w.n)({profileId:x,enabled:"comments"===v}),N=_.fetchNextPage,A=_.hasNextPage,T=_.isLoading,D=_.error,L=_.comments,F=null!=(s=null!=(i=null==c?void 0:c.comments_count)?i:null==c||null==(n=c.profile)?void 0:n.comments_count)?s:0,U=(0,r.useMemo)(function(){var e,t,n;return{id:null!=(e=null==c?void 0:c.id)?e:0,name:null!=(t=null==c?void 0:c.name)?t:"",avatar_url:null!=(n=null==c?void 0:c.avatar_url)?n:""}},[null==c?void 0:c.id,null==c?void 0:c.name,null==c?void 0:c.avatar_url]),B=(0,C.O)().createChat,q=function(e,t){B({id:e.id,body:(0,I.S)(t)}).then(function(e){b.push((0,g.Gr)({id:e.id.toString()}))}).catch(function(e){console.error(e)})};return(0,o.jsxs)("div",{className:"bg-primary col-span-12 flex flex-col overflow-auto overflow-x-hidden p-8 md:col-span-8",children:[(0,o.jsx)("div",{className:"pb-5 pt-2",children:(0,o.jsxs)("div",{className:"flex items-center gap-2 overflow-x-auto pb-2",children:[(0,o.jsx)(S.E,{title:(0,a.t)("about"),isActive:"about"===v,onClick:function(){return y("about")}}),(0,o.jsx)(S.E,{title:(0,a.t)("comments.comments"),isActive:"comments"===v,count:F,onClick:function(){return y("comments")}})]})}),(0,o.jsx)("div",{className:"flex-1 overflow-auto",id:R,children:"about"===v?(0,o.jsx)("div",{className:"pb-8",children:(0,o.jsxs)("div",{className:"flex flex-col items-start gap-6",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,o.jsx)(d.Z.LabelSm,{weight:"semibold",color:"text-dark",children:(0,a.t)("community_bot.profiles.bio_label")}),(0,o.jsx)(d.Z.BodySm,{color:"text-default",children:c.bio})]}),(0,o.jsx)("div",{className:"flex flex-col gap-3",children:p&&c.suggested_questions&&c.suggested_questions.length>0&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(d.Z.LabelSm,{weight:"semibold",color:"text-dark",children:(0,a.t)("community_bot.profiles.suggested_questions_label")}),(0,o.jsx)("div",{className:"flex flex-wrap gap-2",children:c.suggested_questions.map(function(e){return(0,o.jsx)(P.n,{question:e,onClick:function(){return q(c.profile,e)}},e)})})]})})]})}):(0,o.jsx)("div",{className:"flex flex-col",children:T?(0,o.jsx)(k.m,{}):D?(0,o.jsx)("div",{className:"flex h-32 flex-col items-center justify-center px-2 text-center",children:(0,o.jsx)("p",{className:"text-sm text-[#dc2626]",children:(0,a.t)("community_inbox.profile.error_loading_comments")})}):L.length>0?(0,o.jsx)("div",{children:(0,o.jsx)(f.Z,{style:{overflow:"initial"},scrollThreshold:.5,next:N,hasMore:!!A,loader:(0,o.jsx)(k.m,{}),dataLength:L.length,scrollableTarget:R,className:"divide-primary space-y-2 divide-y",children:L.map(function(e){return(0,o.jsx)(j,{comment:e,member:U,onClose:function(){return null==u?void 0:u()}},e.id)})})}):(0,o.jsx)("div",{children:(0,o.jsx)(O.Z,{title:(0,a.t)("profile_drawer.comments.empty_state.title"),subtitle:(0,a.t)("profile_drawer.comments.empty_state.subtitle")})})})})]})},L=n(478188),F=n(982942),U=n(739265),B=n(701168),q=function(e){var t=e.isFullPageView;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(F.J,{isFullPageView:t}),(0,o.jsxs)("div",{className:(0,B.A)("col-span-12 flex flex-col overflow-auto px-4 pb-9 md:col-span-8 md:p-8",{"!md:pl-14 pl-4":t}),children:[(0,o.jsx)(U.y,{}),(0,o.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,o.jsx)(L.t,{}),(0,o.jsx)(L.t,{}),(0,o.jsx)(L.t,{}),(0,o.jsx)(L.t,{})]})]})]})},z=n(861853),Z=n(957363),V=n(39905),H=function(){var e=M(),t=e.isLoading,n=e.agent,r=n.can_interact,i=(0,m.k6)(),s=(0,z.Dk)().setCurrentBotProfile;return t?null:(0,o.jsxs)("div",{className:"border-primary bg-primary dark:bg-primary col-span-full flex flex-col items-center overflow-auto border-r bg-[linear-gradient(180deg,#F5ECFC_19.48%,#FFF_50%)] px-6 pb-10 pt-8 md:col-span-4 dark:bg-none",children:[(0,o.jsx)("img",{loading:"eager",src:n.avatar_url,alt:n.name,className:"size-[152px] rounded-full"}),(0,o.jsxs)("div",{className:"mt-6 flex w-full flex-col items-center gap-[28px] text-center",children:[(0,o.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,o.jsx)(d.Z.LabelLg,{weight:"semibold",color:"text-dark",children:n.name}),(0,o.jsxs)("div",{className:"bg-tertiary dark:bg-secondary-dark flex h-6 items-center justify-center gap-1.5 rounded-full px-2 py-[3px]",children:[(0,o.jsx)(Z.JO,{type:"16-ask-ai-gradient",size:16}),(0,o.jsx)("span",{className:"text-dark text-[12px] font-medium",children:(0,a.t)("community_bot.profile_tag")})]})]}),r&&(0,o.jsx)("div",{className:"w-full",children:(0,o.jsx)(V.z,{variant:"circle",onClick:function(){s(n.profile),i.push({pathname:(0,g.W9)()})},children:(0,a.t)("community_inbox.new_conversation")})})]})]})},W=function(e){var t=e.agent,n=e.isLoading,r=e.isFullPageView,i=e.onClose;return(0,o.jsx)(T,{isFullPageView:void 0!==r&&r,agent:t,isLoading:n,onClose:i,children:t?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(H,{}),(0,o.jsx)(D,{})]}):(0,o.jsx)(q,{})})},Q={page_name:l.$q.PROFILE_VIEW},G=function(e){var t=e.agentId,n=(0,i.dd)(),r=(0,s.z)({agentId:t,params:Q}).getAgentProfileInfoQuery,l=r.data,f=r.isLoading,m=function(){n.remove()};return(0,o.jsxs)(c.u_,{isOpen:n.visible,onClose:m,contentPortalId:"post-modal-portal",children:[(0,o.jsx)(c.u_.Overlay,{}),(0,o.jsxs)(c.u_.Content,{size:"2xl",className:"max-w-screen-xl",children:[(0,o.jsxs)("div",{className:"border-primary text-dark flex justify-between border-b !px-9 !py-4",children:[(0,o.jsx)(d.Z.TitleSm,{weight:"semibold",children:(0,a.t)("profile")}),(0,o.jsx)(u.o,{onClick:m})]}),(0,o.jsx)(c.u_.Body,{className:"!md:px-0 !md:pt-0 !md:overflow-hidden block grid-cols-12 !p-0 md:grid md:grid-flow-row-dense",children:(0,o.jsx)(W,{agent:l,isLoading:f,onClose:function(){return n.remove()}})})]})]})},$=n(757105),K=$.gk.create(function(e){var t=e.agentId,n=e.params;return(0,o.jsx)(G,{agentId:t,params:n})});function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var X=function(e){var t=e.name,n=e.params,r=e.agentId,o=e.shouldOpenInNewTab,i=e.showAgentProfileDrawer,s=t||(0,a.t)("view_user_profile_name"),l=(0,a.t)("view_user_profile",{user:s});return!r||void 0!==o&&o?J({onClick:N.noop,href:"#"},"aria-label",""):J({onClick:function(e){e.preventDefault(),i({agentId:r,params:n})},href:"#"},"aria-label",l)},Y=n(282859),ee=n(715731),et=n(660512),en=function(e){var t,n,o=e.name,i=e.params,a=void 0===i?{}:i,s=e.id,l=(0,$.dd)(K).show,c=(0,ee.I)(),u=(0,et.x)().isDrawer,d=(0,r.useCallback)(function(e){(0,Y.n2)(e)||c||u||(e.preventDefault(),l({agentId:s,params:a}))},[c,u,a,l]);return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},X({name:o,params:a,agentId:s,shouldOpenInNewTab:c,showAgentProfileDrawer:l})),n=n={onClick:d},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}},917335:function(e,t,n){n.d(t,{n:()=>l});var r=n(275271),o=n(932699),i=n(131906),a=n(93199),s=n(547144),l=function(e){var t,n,l=e.profileId,c=e.enabled,u=e.perPage,d=void 0===u?10:u,f=(0,i.useInfiniteQuery)(["bot-comments-infinite",l,d],function(e){var t,n=e.pageParam;return t=void 0===n?1:n,(0,a.UT)(s.av.communityBot.agents.comments({id:l,params:{page:t,per_page:d}}))},{enabled:!!l&&!!c,getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),m=(0,r.useMemo)(function(){return f.isLoading||!f.data?[]:(0,o.uniqBy)((0,o.flatten)(f.data.pages.map(function(e){return e.records})),"id")},[f.data,f.isLoading]);return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},f),n=n={comments:m},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}},899550:function(e,t,n){n.d(t,{C:()=>r});var r={PIE:"pie",BAR:"bar",TABLE:"table",CHOROPLETH:"choropleth",LINE:"line"}},415307:function(e,t,n){n.d(t,{q:()=>o});var r=n(691525),o=function(){var e=(0,r.wh)(),t=e.currentCommunitySettings,n=e.currentCommunityMember,o=null==t?void 0:t.live_pulse_block_dms_enabled;return{canBlockMemberDm:function(e){var t=(null==n?void 0:n.id)===e.community_member_id;return o&&!(t||e.admin)},isBlockDMsEnabled:o}}},977384:function(e,t,n){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(a=function(){return!!e})()}n.d(t,{K:()=>s});var s=new(function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");function t(){var e,n,i;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");return n=o(n=t),r(e=function(e,t){var n;if(t&&("object"==((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)||"function"==typeof t))return t;if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,a()?Reflect.construct(n,[],o(this).constructor):n.apply(this,i)),"toggleMessageBookmark",function(t){e.emit("onBookmarkToggle",t)}),r(e,"sendSuggestedQuestion",function(t){e.emit("sendSuggestedQuestion",t)}),e}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e),t}(n(972100).EventEmitter))},742992:function(e,t,n){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function i(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.d(t,{y:()=>a,z:()=>s});var a=function(e){var t=e.chatMessages,n=e.setChatRoomMessages,r=e.newMessage,a=r.parent_message_id,s=r.sent_at,l=r.sender,c=r.chat_thread_id,u=t.findIndex(function(e){return e.id===a});if(u>-1){var d,f,m=t[u],p=m.thread_participants_preview,b=void 0===p?[]:p,h=m.replies_count,v=(d=o({},m),f=f={replies_count:(void 0===h?0:h)+1,last_reply_at:s},Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(f)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(f)).forEach(function(e){Object.defineProperty(d,e,Object.getOwnPropertyDescriptor(f,e))}),d);m.chat_thread_id||(v.chat_thread_id=c),l&&b.length<3&&!b.some(function(e){return e.community_member_id===l.community_member_id})&&(v.thread_participants_preview=i(b).concat([o({},l)])),n(i(t.slice(0,u)).concat([v],i(t.slice(u+1))))}},s=function(e){if(!e)return!1;var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.right<=window.innerWidth&&t.bottom<=window.innerHeight}},870347:function(e,t,n){n.d(t,{N:()=>j,T:()=>O});var r=n(275271),o=n(932699),i=n(131906),a=n(903225),s=n(93199),l=n(714218),c=n(441342),u=n(547144);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function m(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function p(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return d(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var b=function(e,t,n){var r=e.chat_room_uuids,o=void 0===r?[]:r;0!==o.length&&n(t.map(function(e){return o.includes(e.uuid)?m(f({},e),{has_unread_messages:!1}):e}))},h=function(e,t,n){var r=e.chat_room_uuid,o=t.findIndex(function(e){return e.uuid===r});if(o>-1){var i=t[o];n(p(t.slice(0,o)).concat([m(f({},i),{has_unread_messages:!1})],p(t.slice(Number(o)+1))))}};function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function g(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function x(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return v(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var _=["sidebar","chat-rooms","all"],j=["messaging","chat-rooms","all"],w=["sidebar","chat-rooms","unread"],O=function(e){var t=e.openChatRoomUuid,n=e.uuids,d=(0,i.useQueryClient)(),f=((0,c.wh)().currentCommunitySettings||{}).cached_unread_chat_room_ids_enabled,m=(0,l.d)().updateAllRecords,p=(0,a.TH)().pathname.startsWith("/messages"),v=(0,r.useMemo)(function(){return n?w:p?j:_},[n,p]),O=function(e){m(e,v)},S=function(e){var t={page:e,per_page:p?20:10};return n&&(f?t.only_unread=!0:t.uuids=n),(0,s.UT)(u.av.chatRooms.index({params:t}))},P=(0,i.useInfiniteQuery)(v,function(e){var t=e.pageParam;return S(void 0===t?1:t)},{select:function(e){var t=e.pages,n=void 0===t?[]:t;return{pages:(0,o.uniqBy)((0,o.flatten)(n.map(function(e){return e.records})),"uuid"),pageParams:n.map(function(e){return e.page})}},onSuccess:function(){L(t)},getNextPageParam:function(e){return e.has_next_page?Number(e.page)+1:void 0}}),C=P.isLoading,k=P.refetch,I=P.data,N=(void 0===I?{}:I).pages,A=void 0===N?[]:N,M=P.hasNextPage,T=void 0!==M&&M,E=P.fetchNextPage,R=function(e){return A.find(function(t){return t.uuid===e})},D=function(e){(0,s.UT)(u.av.chatRooms.show({uuid:e})).then(function(e){e.chat_room&&O([e.chat_room].concat(x(A)))})},L=function(e){e&&"new"!==e&&A.find(function(e){return!!e.isOpen})&&D(e)},F=function(e){if(e.pinned_at)O(A.map(function(t){return t.uuid===e.uuid?e:t}));else{var t=[],n=[];A.forEach(function(r){r.pinned_at?t.push(r):r.uuid!==e.uuid&&n.push(r)}),O(x(t).concat([e],x(n)))}},U=function(e,t){var n=e.json_message,r=n.chat_room_uuid,o=n.sender.community_member_id,i=R(r);if(i){var a=i.isOpen;F(g(y({},i),{last_message:n,has_unread_messages:!a&&o!==t}))}else d.invalidateQueries(v)},B=function(e){var t="string"==typeof e.chat_room?JSON.parse(e.chat_room):e.chat_room;O(A.map(function(e){return e.uuid===t.uuid?g(y({},e),{chat_room_name:t.chat_room_name}):e}))},q=function(e){var t=e.chat_room_uuid;O(A.filter(function(e){return e.uuid!==t}))},z=function(e){var t=(0,o.isObject)(e.chat_room)?e.chat_room:JSON.parse(e.chat_room);O(A.map(function(e){return e.uuid===t.uuid?y({},e,t):e}))},Z=function(){d.invalidateQueries(v)},V=function(e){var t=e||{},n=t.chat_room_id,r=t.pinned_at,o={},i=[];A.forEach(function(e){e.id!==n?i.push(e):o=g(y({},e),{pinned_at:r})}),O([o].concat(x(i)))},H=function(e){var t=(e||{}).chat_room_id;O(x(A.map(function(e){return e.id===t?g(y({},e),{pinned_at:null}):e}))),k()};return{chatRooms:A,setChatRooms:O,fetchChatRoomForUuid:R,onEventReceive:function(e,t){switch(e.event){case"newMessage":U(e,t);break;case"chatRoomRead":h(e,A,O);break;case"chatMarkAllAsRead":b(e,A,O);break;case"chatRoomCreated":Z();break;case"chatRoomUpdated":B(e);break;case"chatRoomDeleted":case"chatRoomParticipantDestroy":q(e);break;case"chatRoomParticipantsUpdated":z(e);break;case"chatRoomPinned":V(e);break;case"chatRoomUnPinned":H(e)}},chatRoomsHasNextPage:T,hasNextPage:T,fetchNextPage:E,fetchUserChatRooms:k,isLoading:C}}},861853:function(e,t,n){n.d(t,{AP:()=>x,CD:()=>g,Dk:()=>y,Dq:()=>d,G9:()=>w,Iv:()=>f,Kv:()=>p,Rv:()=>j,XT:()=>_,f4:()=>O,iX:()=>b,nC:()=>v,qN:()=>h,yf:()=>m});var r=n(275271),o=n(239295),i=n(72220),a=n(604775),s=function(e){return e.threads},l=function(e){return e.ui},c=function(e){return e.inbox},u=function(e){return e.unread},d=function(e){return Array.from(e.chatRoomMap.values()).reverse()},f=function(e){return e.messageActions},m=function(e){return e.actions},p=function(e){return function(t){return t.chatRoomMap.get(e)}},b=function(e){return e.messageActions.sendRichTextMessage},h=function(){return(0,i.a)(s)},v=function(){return(0,i.a)(l)},y=function(){return(0,i.a)(c)},g=function(){return(0,i.a)(u)},x=function(){var e=(0,o.q)().chatRoomUuid,t=(0,i.a)(function(t){var n;return null==(n=t.chatRoomStateMap.get(e))?void 0:n.uiState});return null!=t?t:a.FN},_=function(){var e=(0,o.q)().chatRoomUuid;return{chatRoomMessages:(0,i.a)(function(t){var n;return null==(n=t.chatRoomStateMap.get(e))?void 0:n.chatRoomMessages})}},j=function(){var e=(0,o.q)().chatRoomUuid;return(0,i.a)(p(e))},w=function(){var e=(0,i.a)().messageActions,t=(0,o.q)(),n=t.chatRoomUuid,a=t.isMessaging;return(0,r.useMemo)(function(){return{setChatRoomMessages:function(t){return e.setChatRoomMessages(n,t)},fetchChatMessages:function(t){return e.fetchChatMessages(n,a,t)},setIsLoading:function(t){return e.setIsLoading(n,t)},setIsInitialPageLoaded:function(t){return e.setIsInitialPageLoaded(n,t)},setHasNextPage:function(t){return e.setHasNextPage(n,t)},setHasPrevPage:function(t){return e.setHasPrevPage(n,t)},setScrollInfo:function(t){return e.setScrollInfo(n,t)},setFirstMessageId:function(t){return e.setFirstMessageId(n,t)},setLastMessageId:function(t){return e.setLastMessageId(n,t)},setTopMessageId:function(t){return e.setTopMessageId(n,t)},setActiveMessageId:function(t){return e.setActiveMessageId(n,t)},appendLastMessage:function(t){return e.appendLastMessage(n,t)},deleteMessage:function(t){return e.deleteMessage(n,t)},updateMessage:function(t){return e.updateMessage(n,t)}}},[e,n,a])},O=function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},x(),_(),w(),{chatRooms:(0,i.a)(d)})}},604775:function(e,t,n){n.d(t,{FN:()=>r,SZ:()=>a,le:()=>o,p_:()=>i});var r={isLoading:!1,hasNextPage:!1,hasPrevPage:!1,scrollInfo:{},firstMessageId:null,lastMessageId:null,topMessageId:null,isInitialPageLoaded:!1,activeMessageId:null},o={uiState:r,chatRoomMessages:[]},i=60,a=40},72220:function(e,t,n){n.d(t,{a:()=>W});var r=n(320075),o=n(798104),i=n(433251),a=n(93199),s=n(547144),l=n(604775);function c(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)})}}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function f(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function m(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var p=function(e,t){return{actions:{createNewChatRoom:function(t){return e(function(e){e.chatRoomStateMap.set(t,f(d({},l.le),{uiState:d({},l.FN)}))}),l.FN},fetchChatRoom:function(n){return u(function(){var r,o,i,c,u;return m(this,function(m){switch(m.label){case 0:o=(null==(r=t().chatRoomStateMap.get(n)||l.le)?void 0:r.uiState)||l.FN,i=f(d({},r),{uiState:f(d({},o),{isLoading:!0})}),e(function(e){e.chatRoomStateMap.set(n,i)}),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,(0,a.UT)(s.av.chatRooms.show({uuid:n}))];case 2:return(c=m.sent()).chat_room&&e(function(e){var t=c.chat_room;e.chatRoomMap.set(n,t);var r=e.chatRoomStateMap.get(n);r&&(r.uiState.isLoading=!1)}),[3,4];case 3:return u=m.sent(),e(function(e){var t=e.chatRoomStateMap.get(n);t&&(t.uiState.isLoading=!1)}),console.error(u),[3,4];case 4:return[2]}})})()},ensureChatRoomParticipant:function(e){return u(function(){var n;return m(this,function(r){switch(r.label){case 0:if(null==(n=t().chatRoomMap.get(e))?void 0:n.current_participant)return[3,2];return[4,t().actions.fetchChatRoom(e)];case 1:r.sent(),r.label=2;case 2:return[2]}})})()},updateChatRoom:function(n){return e(function(e){var r=t().chatRoomMap.get(n.uuid);r&&e.chatRoomMap.set(n.uuid,d({},r,n))})},appendChatRoom:function(t){return e(function(e){e.chatRoomMap.delete(t.uuid),e.chatRoomMap.set(t.uuid,t)})},removeChatRoom:function(t){return e(function(e){e.chatRoomMap.delete(t)})},markChatRoomAsRead:function(t){return e(function(e){var n=e.chatRoomMap.get(t);n&&(n.has_unread_messages=!1)})}}}},b=n(315346),h=n(932699);function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function y(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return v(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var g=new Map,x=function(e,t){var n=y(e);n.length>l.p_&&(n=n.slice(-l.SZ));var r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)!function(){var e=a.value.message,t=(0,h.last)(n);if((null==t?void 0:t.id)!=e.id&&!(0,b.wJ)(t,e)){var r=n.findIndex(function(t){return t.creation_uuid===e.creation_uuid});r>-1?n[r]=e:n.push(e)}}()}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n},_=function(e,t,n){if(g){var r=g.get(e);if(r&&0!==r.messages.length){var o=y(r.messages);r.messages=[],r.timeoutId=null;try{var i=n().chatRoomStateMap.get(e);if(!i)return;var a=i.uiState,s=!!(null==a?void 0:a.isInitialPageLoaded),c=!!(null==a?void 0:a.hasNextPage);if(!s||c)return;t(function(t){var n,r=t.chatRoomStateMap.get(e);if(r){var i=x(null!=(n=null==r?void 0:r.chatRoomMessages)?n:[],o);i.length>l.p_&&(r.uiState.firstMessageId=i[0].id,r.uiState.hasPrevPage=!0),r.chatRoomMessages=i}})}catch(e){console.error("Error processing batched messages:",e)}}}};function j(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var O=n(936353);function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function P(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function C(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return S(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var k=function(e,t){return{messageActions:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},{setChatRoomMessages:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.chatRoomMessages=n)})},appendLastMessage:function(n,r){g.has(n)||g.set(n,{messages:[],timeoutId:null});var o=g.get(n);o&&(o.messages.push({message:r}),r.id<0?(_(n,e,t),o.timeoutId=null):o.timeoutId||(o.timeoutId=setTimeout(function(){_(n,e,t)},200)))},updateMessage:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);if(r){var o=r.chatRoomMessages.findIndex(function(e){return e.id===n.id});o>-1&&(r.chatRoomMessages[o]=w({},r.chatRoomMessages[o],n))}})},deleteMessage:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.chatRoomMessages=r.chatRoomMessages.filter(function(e){return e.id!==n}))})},clearSpotlightedMessages:function(t){return e(function(e){var n=e.chatRoomStateMap.get(t);n&&(n.chatRoomMessages=n.chatRoomMessages.map(function(e){var t,n;return t=w({},e),n=n={spotlighted:!1},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}))})},sendRichTextMessage:function(e,n){var r;return(r=function(){var r,o,i,l,c,u,d,f,m,p,h;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(v){switch(v.label){case 0:return r=n.richTextBody,o=n.localAttachments,i=n.localSgidToObjectMap,l=n.parentMessageId,c=n.unfurlUrls,[4,t().actions.ensureChatRoomParticipant(e)];case 1:if(v.sent(),f=null==(d=null==(u=t().chatRoomMap.get(e))?void 0:u.current_participant)?void 0:d.id,!u||!d||!f)return[2];return m={chat_room_participant_id:f,rich_text_body:r},l&&(m.parent_message_id=l),c&&(m.unfurl_urls=c),[4,(0,a.Cu)(s.av.chatRoomMessages.create({uuid:e}),{chat_room_message:m})];case 2:if(p=v.sent(),!(h=(0,b.yf)({chatRoom:u,richTextBody:r,localAttachments:o,localSgidToObjectMap:i,unfurlUrls:c,parentMessageId:l,creationUuid:p.creation_uuid,sentAt:p.sent_at})))return[2];return l?t().threads.appendLastMessage(h):t().messageActions.appendLastMessage(e,h),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function a(e){j(i,n,o,a,s,"next",e)}function s(e){j(i,n,o,a,s,"throw",e)}a(void 0)})})()}},{fetchChatMessages:function(n){var r,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,c=i.id,u=void 0===c?null:c,d=i.previousPerPage,f=void 0===d?20:d,m=i.nextPerPage,p=void 0===m?0:m,b=i.isInitialPage,v=void 0!==b&&b,y=i.parentMessageId;return(r=function(){var r,i,c,d,m,b,g,x,_;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(j){switch(j.label){case 0:if(r=(0,O.nc)(o,n),d=(c=(null==(i=t().chatRoomStateMap.get(n))?void 0:i.uiState)||{}).isLoading,m=c.hasNextPage,b=c.hasPrevPage,(g=0===f)&&d)return[2];return e(function(e){var t=e.chatRoomStateMap.get(n);t&&(t.uiState.isLoading=!0)}),x={previous_per_page:f,next_per_page:p},u&&(x.id=u),y&&(x.parent_message_id=y),[4,(0,a.UT)(s.av.chatRoomMessages.index({uuid:n,params:x}))];case 1:return _=j.sent(),e(function(e){var t=e.chatRoomStateMap.get(n);if(t)if(v)t.chatRoomMessages=_.records,t.uiState.scrollInfo=(0,O.kL)({event:"chatRoomLoad",scrollerId:r}),t.uiState.hasNextPage=_.has_next_page,t.uiState.hasPrevPage=_.has_previous_page,t.uiState.firstMessageId=_.first_id,t.uiState.lastMessageId=_.last_id,t.uiState.isInitialPageLoaded=!0;else{g?(t.uiState.scrollInfo=(0,O.kL)({event:"nextPaginatedMessageLoad",scrollerId:r}),t.uiState.lastMessageId=_.last_id):(t.uiState.scrollInfo=(0,O.kL)({event:"paginatedMessageLoad",scrollerId:r}),t.uiState.firstMessageId=_.first_id);var o=C(t.chatRoomMessages);if(o.length>l.p_)if(g)o=o.slice(-l.SZ),t.uiState.firstMessageId=o[0].id,t.uiState.hasPrevPage=!0;else{var i=_.records[_.records.length-1];t.uiState.topMessageId=i.id,o=o.slice(0,l.SZ),t.uiState.lastMessageId=o[o.length-1].id,t.uiState.hasNextPage=!0}else t.uiState.topMessageId=null;t.chatRoomMessages=g?(0,h.uniqBy)(C(o).concat(C(_.records)),"id"):(0,h.uniqBy)(C(_.records).concat(C(o)),"id"),m&&(t.uiState.hasNextPage=_.has_next_page),b&&(t.uiState.hasPrevPage=_.has_previous_page)}}),e(function(e){var t=e.chatRoomStateMap.get(n);t&&(t.uiState.isLoading=!1)}),[2,_]}})},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function a(e){P(i,n,o,a,s,"next",e)}function s(e){P(i,n,o,a,s,"throw",e)}a(void 0)})})()}},{setIsLoading:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.isLoading=n)})},setIsInitialPageLoaded:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.isInitialPageLoaded=n)})},setHasNextPage:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.hasNextPage=n)})},setHasPrevPage:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.hasPrevPage=n)})},setScrollInfo:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.scrollInfo=n)})},setFirstMessageId:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.firstMessageId=n)})},setLastMessageId:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.lastMessageId=n)})},setTopMessageId:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.topMessageId=n)})},setActiveMessageId:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.activeMessageId=n)})}})}},I=function(){return{chatRoomMap:new Map,chatRoomStateMap:new Map}},N=n(710749),A=n(536394);function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function T(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function E(e){return function(e){if(Array.isArray(e))return M(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return M(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var R=function(e,t){return{inbox:{currentChatId:null,setCurrentChatId:function(t){return e(function(e){e.inbox.currentChatId=t})},memberChats:[],adminChats:[],previewChat:null,totalUnreadChatsCount:0,totalUnreadPausedAiChatsCount:0,isTotalUnreadPausedAiChatsCountLoaded:!1,setChats:function(t,n){var r="member"===n?"memberChats":"adminChats";e(function(e){e.inbox[r]=t})},appendChats:function(n,r){var o="member"===r?"memberChats":"adminChats";e(function(e){e.inbox[o]=(0,h.uniq)(E(t().inbox[o]).concat(E(n)))})},setPreviewChat:function(t){e(function(e){e.inbox.previewChat=t})},fetchChat:function(n,r){var o;return(o=function(){var o,i;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(a){switch(a.label){case 0:return[4,A.MW.fetchChat({id:n})];case 1:return o=a.sent(),i="member"===r?"memberChats":"adminChats",t().inbox[i].find(function(e){return e.id===o.id})?e(function(e){e.inbox.updateChat(o,r)}):e(function(e){e.inbox.appendChat(o,r)}),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var i=o.apply(e,t);function a(e){T(i,n,r,a,s,"next",e)}function s(e){T(i,n,r,a,s,"throw",e)}a(void 0)})})()},appendChat:function(n,r){var o="member"===r?"memberChats":"adminChats";t().inbox[o].some(function(e){return e.id===n.id})||e(function(e){e.inbox[o]=[n].concat(E(e.inbox[o]))})},updateChat:function(n,r){var o="member"===r?"memberChats":"adminChats",i=t().inbox[o].findIndex(function(e){return e.id===n.id});-1!==i?e(function(e){e.inbox[o][i]=n}):t().inbox.appendChat(n,r)},destroyChat:function(t,n){var r="member"===n?"memberChats":"adminChats";e(function(e){e.inbox[r]=e.inbox[r].filter(function(e){return e.id!==t})})},adminMarkAsRead:function(t){A.MW.adminMarkAsRead({id:t}).then(function(){e(function(e){var n=e.inbox.adminChats.findIndex(function(e){return e.id===t});-1!==n&&(e.inbox.adminChats[n].has_unread_messages_for_admin=!1,e.inbox.adminChats[n].ai_snoozed&&(e.inbox.totalUnreadPausedAiChatsCount=e.inbox.totalUnreadPausedAiChatsCount-1))})}).catch(function(e){console.error(e)})},memberMarkAsRead:function(t){A.MW.memberMarkAsRead({id:t}).then(function(){e(function(e){var n=e.inbox.memberChats.findIndex(function(e){return e.id===t});-1!==n&&(e.inbox.memberChats[n].has_unread_messages_for_member=!1,e.inbox.totalUnreadChatsCount=e.inbox.totalUnreadChatsCount-1)})}).catch(function(e){console.error(e)})},messages:[],setMessages:function(t){return e(function(e){e.inbox.messages=t})},appendMessage:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"member";if(n.community_inbox_chat_id!==Number(t().inbox.currentChatId))return void e(function(e){var t=e.inbox["member"===r?"memberChats":"adminChats"].findIndex(function(e){return e.id===n.community_inbox_chat_id});-1!==t&&("member"===r?(e.inbox.memberChats[t].has_unread_messages_for_member=!0,e.inbox.totalUnreadChatsCount=e.inbox.memberChats.filter(function(e){return e.has_unread_messages_for_member}).length):(e.inbox.adminChats[t].has_unread_messages_for_admin=!0,e.inbox.totalUnreadPausedAiChatsCount=e.inbox.adminChats.filter(function(e){return e.has_unread_messages_for_admin&&e.ai_snoozed}).length))});t().inbox.messages.some(function(e){return e.id===n.id})||e(function(e){e.inbox.messages=E(e.inbox.messages).concat([n])})},updateMessage:function(n){n.community_inbox_chat_id===Number(t().inbox.currentChatId)&&e(function(e){var t=e.inbox.messages.findIndex(function(e){return e.id===n.id});-1!==t&&(e.inbox.messages[t]=n)})},destroyMessage:function(t){e(function(e){e.inbox.messages=e.inbox.messages.filter(function(e){return e.id!==t})})},resetMessages:function(){return e(function(e){e.inbox.messages=[]})},scrollAction:N.aO.FIRST_LOAD,setScrollAction:function(t){e(function(e){e.inbox.scrollAction=t})},currentBotProfile:null,setCurrentBotProfile:function(t){e(function(e){e.inbox.currentBotProfile=t})},fetchTotalUnreadChatsCount:function(){return A.MW.unreadMemberChatsCount().then(function(t){var n=t.unread_chats_count;e(function(e){e.inbox.totalUnreadChatsCount=n})}).catch(function(e){console.error(e)})},fetchPausedAiUnreadChatsCount:function(){return A.MW.unreadAdminPausedAiChatsCount().then(function(t){var n=t.unread_chats_count;e(function(e){e.inbox.totalUnreadPausedAiChatsCount=n,e.inbox.isTotalUnreadPausedAiChatsCountLoaded=!0})}).catch(function(e){console.error(e)})},setIsProcessing:function(t,n){e(function(e){var r=e.inbox["member"===n?"memberChats":"adminChats"].find(function(t){return t.id===e.inbox.currentChatId});r&&(r.is_processing=t)})},setPreviewChatProcessing:function(t){e(function(e){var n=e.inbox.previewChat;n&&(n.is_processing=t)})}}}};function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function F(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function U(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return D(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var B={chatMessages:[],isLoading:!1,hasNextPage:!1,hasPrevPage:!1,scrollInfo:{},firstMessageId:null,lastMessageId:null,totalMessagesCount:0,metaData:{}},q=function(e){return{threads:F(L({},B),{setChatMessages:function(t){return e(function(e){e.threads.chatMessages=t})},setIsLoading:function(t){return e(function(e){e.threads.isLoading=t})},setHasNextPage:function(t){return e(function(e){e.threads.hasNextPage=t})},setHasPrevPage:function(t){return e(function(e){e.threads.hasPrevPage=t})},setScrollInfo:function(t){return e(function(e){e.threads.scrollInfo=t})},setFirstMessageId:function(t){return e(function(e){e.threads.firstMessageId=t})},setLastMessageId:function(t){return e(function(e){e.threads.lastMessageId=t})},setTotalMessagesCount:function(t){return e(function(e){e.threads.totalMessagesCount=t})},setMetaData:function(t){return e(function(e){e.threads.metaData=t})},clearSpotlightedMessages:function(){return e(function(e){e.threads.chatMessages=e.threads.chatMessages.map(function(e){return F(L({},e),{spotlighted:!1})})})},appendLastMessage:function(t){return e(function(e){var n=e.threads.chatMessages,r=n.findIndex(function(e){return e.creation_uuid===t.creation_uuid});if(r>-1){if(t.id>0){var o=U(n);o[r]=t,e.threads.chatMessages=o}}else e.threads.chatMessages=U(n).concat([t])})}})}},z=function(e){return{ui:{liveChatRoomUuid:null,setLiveChatRoomUuid:function(t){return e(function(e){e.ui.liveChatRoomUuid=t})},dmSelectedTabIndex:0,setDmSelectedTabIndex:function(t){return e(function(e){e.ui.dmSelectedTabIndex=t})}}}},Z=function(e){return{unread:{unreadChatRoomUuids:{},setUnreadChatRoomUuids:function(t,n){return e(function(e){e.unread.unreadChatRoomUuids[t]=n})},appendUnreadChatRoomUuids:function(t,n){return e(function(e){e.unread.unreadChatRoomUuids[t]||(e.unread.unreadChatRoomUuids[t]=[]),e.unread.unreadChatRoomUuids[t].push(n)})}}}};function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function H(e){return function(e){if(Array.isArray(e))return V(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return V(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(0,r.MD)();var W=(0,o.Ue)()((0,i.n)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},I.apply(void 0,H(t)),p.apply(void 0,H(t)),k.apply(void 0,H(t)),q.apply(void 0,H(t)),Z.apply(void 0,H(t)),z.apply(void 0,H(t)),R.apply(void 0,H(t)))}))},716533:function(e,t,n){n.d(t,{B:()=>l});var r=n(275271),o=n(93199),i=n(547144),a=n(977384);function s(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var l=function(e,t){var n=(0,r.useRef)(e);n.current=e;var l=(0,r.useCallback)(function(e){var r;return(r=function(){var r,a,s;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(l){switch(l.label){case 0:var c,u;if(!(a=(r=n.current).find(function(t){return t.id===e})))return[2];if(!(null==a?void 0:a.bookmark_id))return[3,1];return c=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},a),u=u={bookmark_id:null},Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(u)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(u)).forEach(function(e){Object.defineProperty(c,e,Object.getOwnPropertyDescriptor(u,e))}),s=c,[3,3];case 1:return[4,(0,o.UT)(i.av.chatRoomMessages.show({uuid:a.chat_room_uuid,id:a.id}))];case 2:s=l.sent(),l.label=3;case 3:if(!s)return[2];return t(r.map(function(e){return e.id===a.id?s:e})),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function a(e){s(i,n,o,a,l,"next",e)}function l(e){s(i,n,o,a,l,"throw",e)}a(void 0)})})()},[t]);return(0,r.useEffect)(function(){var e=function(e){l(e)};return a.K.on("onBookmarkToggle",e),function(){a.K.off("onBookmarkToggle",e)}},[l]),l}},772309:function(e,t,n){n.d(t,{L:()=>l});var r=n(275271),o=n(932699),i=n(403697),a=n(739792),s=n(441342),l=function(e,t,n){var l=(0,s.wh)().currentCommunitySettings,c=e.current_participant,u=e.chat_room_kind===i.g8,d=(0,o.isEmpty)(c)||(null==c?void 0:c.can_send_message_in_room),f=!(0,o.isEmpty)(c)&&!(null==c?void 0:c.deleted_at),m=(null==c?void 0:c.is_flagged)&&(null==l?void 0:l.live_pulse_block_flagged_member_messages_enabled),p=u?d:f&&!m,b=t.find(function(e){return e.id!==(null==c?void 0:c.id)}),h=(0,r.useMemo)(function(){return u&&(null==b?void 0:b.is_blocked_by_current_community_member)},[u,b]),v=(0,r.useMemo)(function(){return u&&(null==b?void 0:b.has_blocked_current_community_member)},[u,c]);return{canSendMessage:p,canParticipantsMessage:d,getBottomBannerMessage:function(){return d?(0,a.t)("community_member.join_space_to_message"):v?(0,a.t)("community_member.not_receiving_messages"):h?(0,a.t)("community_member.blocked_direct_messaging"):n&&m?(0,a.t)("community_member.flagged_user_messaging_disabled_course_space"):m?(0,a.t)("community_member.flagged_user_messaging_disabled"):(0,a.t)("community_member.messaging_disabled")}}}},579528:function(e,t,n){n.d(t,{Q:()=>s});var r=n(660512),o=n(861853),i=n(936353);function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var s=function(){var e=(0,o.f4)(),t=e.chatRoomMessages,n=void 0===t?[]:t,s=e.setChatRoomMessages,l=e.setScrollInfo,c=(0,i.Op)().calculateScrollInfo,u=(0,r.x)(),d=u.parentMessage,f=u.updateParentMessage,m=function(e){var t,r,o=e.communityMemberId,i=e.emoji,u=e.reactionableId,m=structuredClone(n),p=m.findIndex(function(e){return e.id===u});if(-1!==p){var b=m[p],h=b.reactions.findIndex(function(e){return e.emoji===i});if(!(-1!==h&&(null==(r=b.reactions[h])||null==(t=r.community_member_ids)?void 0:t.includes(o)))&&(-1!==h?(b.reactions[h].community_member_ids.push(o),b.reactions[h].count+=1):b.reactions.push({emoji:i,community_member_ids:[o],count:1}),l(c({event:"reaction"})),s(m),(null==d?void 0:d.id)===u)){var v=m.find(function(e){return e.id===d.id});v&&f(a({},v))}}},p=function(e){var t,r,o=e.communityMemberId,i=e.emoji,u=e.reactionableId,m=structuredClone(n),p=m.findIndex(function(e){return e.id===u});if(-1!==p){var b=m[p],h=b.reactions.findIndex(function(e){return e.emoji===i});if(-1!==h&&(null==(r=b.reactions[h])||null==(t=r.community_member_ids)?void 0:t.includes(o))&&(1===b.reactions[h].count?b.reactions.splice(h,1):(b.reactions[h].community_member_ids=b.reactions[h].community_member_ids.filter(function(e){return e!==o}),b.reactions[h].count-=1),l(c({event:"reaction"})),s(m),(null==d?void 0:d.id)===u)){var v=m.find(function(e){return e.id===d.id});v&&f(a({},v))}}},b=function(e){if("ChatRoomMessage"===e.json_message.reactionable_type){var t=e.json_message,n={communityMemberId:t.community_member_id,emoji:t.emoji,reactionableId:t.reactionable_id};"createReaction"===e.event?m(n):"destroyReaction"===e.event&&p(n)}};return{createReactionFromMessage:m,removeReactionFromMessage:p,handleReactionFromWebsocket:b,onReactionWebsocketEvent:function(e){switch(e.event){case"createReaction":case"destroyReaction":b(e)}}}}},202952:function(e,t,n){n.d(t,{u:()=>g});var r=n(275271),o=n(707999),i=n(691525),a=n(861853),s=n(660512),l=n(742992),c=n(495834),u=n(936353),d=n(72220),f=n(239295);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function b(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)})}}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function v(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function y(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var g=function(){var e,t=(0,a.G9)(),n=t.setChatRoomMessages,p=t.setScrollInfo,g=t.appendLastMessage,x=t.deleteMessage,_=t.updateMessage,j=t.fetchChatMessages,w=(0,f.q)().chatRoomUuid,O=(0,i.wh)().isViewOnlyMasquerading,S=(0,a.Rv)(),P=(0,d.a)(a.yf).createNewChatRoom;(0,r.useEffect)(function(){S||P(w)},[S,w,P]);var C=(0,a.AP)(),k=C.scrollInfo,I=C.topMessageId,N=C.hasNextPage,A=(S||{}).current_participant,M=(e=(0,r.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return m(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),T=M[0],E=M[1],R=(0,s.x)(),D=R.parentMessage,L=R.updateParentMessage,F=(0,c.w)().markChatRoomAsRead,U=(0,u.Op)(),B=U.calculateScrollInfo,q=U.getScrollingElement,z=U.targetDocument,Z=function(e){return b(function(){return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,j(e)];case 1:return t.sent().has_next_page||T||O||null==S||!S.uuid||F({uuid:null==S?void 0:S.uuid}),[3,3];case 2:return console.error(t.sent()),[3,3];case 3:return[2]}})})()},V=function(e){var t=e.id,n=e.parent_message;n?_(n):x(t)},H=function(e){p(B({event:"messageUpdated"}));var t=e.json_message;_(t),t.id===(null==D?void 0:D.id)&&L(t)},W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=e.json_message;if(!r.parent_message_id){var i=(0,o.OG)(r,A);if(p(B({event:i?"messageSent":"messageReceived"})),N&&!i)return;g(r);return}p(B({event:"parentMessageUpdated"})),(0,l.y)({chatMessages:t,setChatRoomMessages:n,newMessage:r}),D&&r.parent_message_id===D.id&&!D.chat_thread_id&&L(v(h({},D),{chat_thread_id:r.chat_thread_id}))};return{fetchChatMessages:Z,fetchChatMessagesFirstPage:function(e){return b(function(){var t;return y(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t={isInitialPage:!0},e&&(t=v(h({},t),{id:e,previousPerPage:20,nextPerPage:20})),[4,Z(t)];case 1:return n.sent(),[3,3];case 2:return console.error(n.sent()),[3,3];case 3:return[2]}})})()},adjustScroller:function(){var e=q();if(e){var t=z.getElementById("unread-message-breakpoint");if(k)switch(k.action){case"scrollToBottom":e.scrollTop=e.scrollHeight;break;case"adjustTop":if(I){var n=z.getElementById(I.toString());null==n||n.scrollIntoView()}else{var r,o,i=null!=(r=k.scrollHeightValue)?r:0,a=null!=(o=k.scrollTopValue)?o:0;e.scrollTop=e.scrollHeight-(i-a)}break;case"scrollToUnreadMessageIndicator":t?t.scrollIntoView({block:"center"}):e.scrollTop=e.scrollHeight}}},onEventReceive:function(e,t){switch(e.event){case"newMessage":W(e,t);break;case"deletedMessage":V(e);break;case"updatedMessage":H(e)}},setUnreadMessageFlow:E}}},944428:function(e,t,n){n.d(t,{U:()=>c,u:()=>u});var r=n(275271),o=n(932699),i=n(131906),a=n(93199),s=n(547144),l=n(652478),c=100,u=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shouldDisableCache:!1,per_page:c},u=["chat-participants",e],d=n.shouldDisableCache,f=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(n,["shouldDisableCache"]),m=(0,r.useCallback)(function(){var e=l.E.getQueryData(u),t=(0,o.flatten)(((null==e?void 0:e.pages)||[]).map(function(e){return e.records}));return(0,o.uniqBy)(t,"id")},[u]),p=(0,i.useInfiniteQuery)(u,function(t){var n,r=t.pageParam;return n=void 0===r?1:r,(0,a.UT)(s.av.chatRoomParticipants.index({uuid:e,params:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({page:n},f)}))},{select:function(e){return{pages:e.pages,pageParams:e.pageParams,participants:(0,o.uniqBy)((0,o.flatten)((e.pages||[]).map(function(e){return e.records})),"id"),totalCount:e.pages[0].count}},enabled:((null==(t=m())?void 0:t.length)===0||d)&&!!e,getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),b=p.data,h=p.isLoading,v=p.refetch,y=p.hasNextPage,g=p.fetchNextPage,x=(b||{}).totalCount;return{chatParticipants:(0,r.useMemo)(function(){return m()},[null==b?void 0:b.pages]),isLoading:h,refetchChatParticipants:e?v:o.noop,hasNextPage:y,totalCount:void 0===x?0:x,fetchNextPage:g}}},905326:function(e,t,n){n.d(t,{p:()=>m});var r=n(903225),o=n(739792),i=n(93199),a=n(852770),s=n(547144),l=n(60878);function c(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)})}}function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function f(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var m=function(){var e=(0,r.k6)(),t=(0,l.pm)();return{findChatRoom:function(n){return u(function(){var r,l,c,u,m,p;return f(this,function(f){switch(f.label){case 0:l=void 0!==(r=n.shouldNavigate)&&r,c=d(n,["shouldNavigate"]),f.label=1;case 1:return f.trys.push([1,3,,4]),u=c.community_member_ids,[4,(0,i.UT)(s.av.chatRooms.fetch({params:{community_member_ids:u}}))];case 2:return m=f.sent().uuid,l&&e.push((0,s.so)({uuid:m})),[2,m];case 3:return p=f.sent(),t.error((0,o.t)("something_went_wrong")),(0,a.dD)(p),[3,4];case 4:return[2]}})})()},findOrCreateChatRoom:function(n){return u(function(){var r,o,l,c,u,m,p,b;return f(this,function(f){switch(f.label){case 0:o=void 0!==(r=n.shouldNavigate)&&r,l=d(n,["shouldNavigate"]),f.label=1;case 1:return f.trys.push([1,3,,4]),c={chat_room:l},[4,(0,i.Cu)(s.av.chatRooms.create(),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},c))];case 2:return m=(u=f.sent()).chat_room.uuid,o&&e.push((0,s.so)({uuid:u.chat_room.uuid})),[2,m];case 3:return p=f.sent(),t.error((null==(b=p.errorDetails)?void 0:b.message)||p.message),(0,a.dD)(p),[3,4];case 4:return[2]}})})()}}}},239295:function(e,t,n){n.d(t,{A:()=>a,q:()=>s});var r=n(552676),o=n(275271),i=(0,o.createContext)({chatRoomUuid:"main",isMessaging:!1});i.displayName="ChatRoomContext";var a=function(e){var t=e.chatRoomUuid,n=e.isMessaging,o=e.children;return(0,r.jsx)(i.Provider,{value:{chatRoomUuid:t,isMessaging:void 0!==n&&n},children:o})},s=function(){return(0,o.useContext)(i)}},26674:function(e,t,n){n.d(t,{N:()=>s});var r=n(861853),o=n(660512);function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var s=function(){var e=(0,o.x)(),t=e.parentMessage,n=e.updateParentMessage,s=(0,r.qN)(),l=s.chatMessages,c=s.setChatMessages,u=s.scrollInfo,d=s.setScrollInfo,f=function(e,t,n){var r=t.communityMemberId,o=t.emoji,i=e.reactions.findIndex(function(e){return e.emoji===o});if(-1===i){n&&e.reactions.push({emoji:o,community_member_ids:[r],count:1});return}var a=e.reactions[i],s=a.community_member_ids.includes(r);(!n||!s)&&(n||s)&&(n?(a.community_member_ids.push(r),a.count+=1):1===a.count?e.reactions.splice(i,1):(a.community_member_ids=a.community_member_ids.filter(function(e){return e!==r}),a.count-=1))},m=function(e){var r=e.communityMemberId,o=e.emoji,s=e.reactionableId;if((null==t?void 0:t.id)===s){var m=structuredClone(t);f(m,{communityMemberId:r,emoji:o},!0),n(m);return}var p=structuredClone(l),b=p.findIndex(function(e){return e.id===s});-1!==b&&(f(p[b],{communityMemberId:r,emoji:o},!0),d(a(i({},u),{action:"noScroll"})),c(p))},p=function(e){var r=e.communityMemberId,o=e.emoji,s=e.reactionableId;if((null==t?void 0:t.id)===s){var m=structuredClone(t);f(m,{communityMemberId:r,emoji:o},!1),n(m);return}var p=structuredClone(l),b=p.findIndex(function(e){return e.id===s});-1!==b&&(f(p[b],{communityMemberId:r,emoji:o},!1),d(a(i({},u),{action:"noScroll"})),c(p))};return{createReactionFromThread:m,removeReactionFromThread:p,handleReactionFromWebsocket:function(e){if("ChatRoomMessage"===e.json_message.reactionable_type){var t=e.json_message,n={communityMemberId:t.community_member_id,emoji:t.emoji,reactionableId:t.reactionable_id};"createReaction"===e.event?m(n):"destroyReaction"===e.event&&p(n)}}}}},701800:function(e,t,n){n.d(t,{C:()=>O,_:()=>S});var r=n(552676),o=n(275271),i=n(131906),a=n(903225),s=n(739792),l=n(93199),c=n(852770),u=n(547144),d=n(60878),f=n(403697),m=n(499385),p=n(139964);function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var h=function(){var e=(0,o.useRef)(null);return(0,o.useEffect)(function(){return clearTimeout(e.current)},[]),{debouncedFunction:(0,o.useCallback)(function(t,n){for(var r=arguments.length,o=Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];clearTimeout(e.current),e.current=setTimeout(function(){t.apply(void 0,function(e){if(Array.isArray(e))return b(e)}(o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return b(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}}(o)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())},n)},[])}},v=n(861853),y=n(72220),g=n(495834);function x(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function _(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){x(i,r,o,a,s,"next",e)}function s(e){x(i,r,o,a,s,"throw",e)}a(void 0)})}}function j(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var w=(0,o.createContext)({chatRooms:[]});w.displayName="ChatRoomsContext";var O=function(e){var t=e.children,n=(0,y.a)(v.Dq),b=(0,y.a)(v.yf),x=b.fetchChatRoom,O=b.updateChatRoom,S=b.appendChatRoom,P=b.removeChatRoom,C=b.markChatRoomAsRead,k=(0,p.j)().addDirectMessageParticipantNameInTitle,I=(0,g.w)().markChatRoomAsRead,N=(0,a.k6)(),A=(0,d.pm)(),M=(0,i.useQueryClient)(),T=h().debouncedFunction,E=(0,o.useCallback)(function(e){return n.find(function(t){return t.uuid===e})},[n]),R=(0,o.useCallback)(function(e,t){var n=e.json_message,r=n.chat_room_uuid;!n.parent_message_id&&(E(r)?t&&T(I,2e3,{uuid:r}):x(r))},[T,x,E]),D=(0,o.useCallback)(function(e){C(e.chat_room_uuid)},[C]),L=(0,o.useCallback)(function(e){S((e||{}).chat_room)},[S]),F=(0,o.useCallback)(function(e){O((e||{}).chat_room)},[O]),U=(0,o.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};O(e.chat_room)},[O]),B=(0,o.useCallback)(function(e){var t,n="object"==((t=e.chat_room)&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t)?e.chat_room:JSON.parse(e.chat_room);O(n),M.invalidateQueries({queryKey:[(0,m.S)(n.uuid)]})},[M,O]),q=(0,o.useCallback)(function(e){P(e.chat_room_uuid),N.push((0,u.yg)())},[N,P]),z=(0,o.useCallback)(function(e,t){switch(e.event){case"newMessage":R(e,t);break;case"chatRoomRead":D(e);break;case"chatRoomCreated":L(e);break;case"chatRoomUpdated":F(e);break;case"chatRoomParticipantsUpdated":B(e);break;case"chatRoomParticipantDestroy":case"chatRoomDeleted":q(e)}},[L,q,B,D,F,R]),Z=(0,o.useCallback)(function(e){switch(e.event){case"chatRoomRead":D(e);break;case"chatRoomUpdated":U(e);break;case"chatRoomParticipantsUpdated":B(e);break;case"chatRoomParticipantDestroy":q(e)}},[U,q,B,D]),V=(0,o.useCallback)(function(e){var t,n,r=E(e);r&&k(r.chat_room_kind===f.g8?null==(n=r.other_participants_preview)||null==(t=n[0])?void 0:t.name:r.chat_room_name)},[k]),H=(0,o.useCallback)(function(e){var t=e.chatRoomUuid,n=e.rich_text_body,r=e.messageId,o=e.unfurl_urls;return _(function(){var e,i;return j(this,function(a){switch(a.label){case 0:e={rich_text_body:n},o&&(e.unfurl_urls=o),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,(0,l.gN)(u.av.chatRoomMessages.update({uuid:t,id:r}),{chat_room_message:e})];case 2:return a.sent(),[3,4];case 3:return i=a.sent(),A.error((0,s.t)("something_went_wrong")),(0,c.dD)(i),[3,4];case 4:return[2]}})})()},[A]),W=(0,o.useCallback)(function(e){var t=e.chatRoomUuid,n=e.messageId;return _(function(){var e;return j(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,l.pC)(u.av.chatRoomMessages.delete({uuid:t,id:n}))];case 1:return r.sent(),[3,3];case 2:return e=r.sent(),A.error((0,s.t)("something_went_wrong")),(0,c.dD)(e),[3,3];case 3:return[2]}})})()},[A]),Q=(0,o.useMemo)(function(){return{fetchChatRoomForUuid:E,onEventReceive:z,onEmbedEventReceive:Z,updateTitleBar:V,updateRichTextMessage:H,deleteRichTextMessage:W}},[W,E,Z,z,H,V]);return(0,r.jsx)(w.Provider,{value:Q,children:t})},S=function(){return(0,o.useContext)(w)}},495834:function(e,t,n){n.d(t,{w:()=>s});var r=n(932699),o=n(131906),i=n(93199),a=n(547144),s=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onSuccess;return{markChatRoomAsRead:(0,o.useMutation)(function(e){var t=e.uuid;return(0,i.gN)(a.av.chatRooms.markAsRead({uuid:t}))},{onSuccess:function(){(0,r.isFunction)(e)&&e()},onError:function(e){console.error(e.message)}}).mutateAsync}}},660512:function(e,t,n){n.d(t,{G:()=>eN,x:()=>eA});var r=n(552676),o=n(275271),i=n(903225),a=n(421541),s=n(707999),l=n(932699),c=n(739792),u=n(605603),d=n(117617),f=n(548298),m=n(571807),p=n(441342),b=n(701168),h=n(233516),v=n(775148),y=n(751169),g=n(619347),x=n(957363),_=n(381636),j=function(e){var t=e.name;return(0,r.jsxs)("div",{className:"flex h-full flex-col items-center justify-center gap-2",children:[(0,r.jsx)(x.JO,{type:"20-search-v3",size:24,className:"text-disabled !w-6"}),(0,r.jsxs)("div",{className:"w-48 text-center",children:[(0,r.jsx)("div",{className:"mr-1",children:(0,r.jsx)(_.Z.LabelSm,{color:"text-default",children:(0,c.t)("chat_space.search_messages.empty_state")})}),(0,r.jsx)(_.Z.LabelSm,{color:"text-default",children:t||""})]})]})},w=n(25593),O=n(720624),S=n(635556),P=n(378252),C=n(664657),k=n(857338),I=function(e){var t=e.message,n=e.activeMessageId,o=e.setActiveMessageId,i=t.sender,a=t.sent_at,s=(0,k.H)(a),l=s.day,u=s.time,f=(0,P.O1)().redirectToMessage,m=eA(),p=m.toggleShowEmbeddedRailBar,h=m.shouldShowEmbeddedRailBar,v=m.closeThreadsRailbar,y=(0,d.BT)(),g="Today"===l;return(0,r.jsxs)("button",{type:"button",className:(0,b.A)("bg-primary hover:border-light w-full cursor-pointer rounded-xl border px-4 py-3 text-left",n===t.id?"border-light":"border-primary"),onClick:function(){h&&p(),y&&v(),o(t.id),f(t)},children:[(0,r.jsx)("div",{className:"mb-px flex items-center gap-1.5",children:(0,r.jsxs)("div",{className:"mb-1 flex items-center gap-1",children:[(0,r.jsx)("div",{className:"mr-1 self-start",children:(0,r.jsx)(C.W,{src:i.avatar_url,name:i.name,size:"6",hasBorder:!0})}),(0,r.jsx)("div",{className:(0,b.A)("text-darkest truncate text-left text-sm font-semibold"),children:(null==i?void 0:i.name)||""}),(0,r.jsx)("div",{className:"text-timestamp mx-0.5 inline min-w-fit text-sm font-medium",children:(0,c.t)("separator_dot")}),(0,r.jsx)("div",{className:"text-light inline min-w-fit text-sm font-normal",children:g?u:l})]})}),(0,r.jsx)(S.z,{message:t,shouldShowPreviewBlocks:!1})]},t.id)};function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var A=function(e){var t,n=e.messages,i=e.fetchNextPage,a=e.hasNextPage,s=(t=(0,o.useState)(null),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return N(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=s[0],u=s[1];return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsxs)(_.Z.LabelXs,{color:"text-dark",weight:"medium",children:[n.length," ",(0,c.t)("chat_space.search_messages.results")]})}),(0,r.jsx)(w.Z,{style:{overflow:"initial",height:"100%"},scrollThreshold:.8,next:i,hasMore:a,loader:(0,r.jsx)(O.m,{}),scrollableTarget:"scrollableMessageSearch",dataLength:(null==n?void 0:n.length)||0,className:"pb-6",children:(0,r.jsx)("div",{className:"space-y-2",children:n.map(function(e){return(0,r.jsx)(I,{message:e,activeMessageId:l,setActiveMessageId:u},e.id)})})})]})},M=n(131906),T=n(93199),E=n(547144),R=function(e){var t,n=e.debouncedValue,r=e.isDmsPage,o=e.currentSpace,a=(0,i.UO)().uuid,s=r?a:null==o?void 0:o.chat_room_uuid,c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return(0,T.UT)(E.av.search.chatRoomMessages.index({params:{page:e,query:n},chat_room_uuid:null!=s?s:""}))},u=(0,M.useInfiniteQuery)(["chat-room-message-search",n,s],function(e){var t=e.pageParam;return c(void 0===t?1:t)},{enabled:!!n,getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},select:function(e){var t=e.pages,n=void 0===t?[]:t;return{pages:(0,l.flatten)(n.map(function(e){return e.records})),pageParams:n.map(function(e){return e.page}),pagesList:n}}}),d=u.data,f=u.fetchNextPage,m=u.hasNextPage,p=u.isLoading;return{messages:null!=(t=null==d?void 0:d.pages)?t:[],fetchNextPage:f,hasNextPage:m,isLoading:p}};function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var L=function(){var e,t=(0,p.L2)().data,n=eA(),i=n.isDmsPage,a=n.closeThreadsRailbar,s=(0,d.BT)(),x=t?t.name:"DMs",_=(e=(0,o.useState)(""),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return D(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),w=_[0],O=_[1],S=(0,h.T)(),P=S.ref,C=S.height,k=(0,f.c)(w,300),I=R({debouncedValue:k,isDmsPage:i,currentSpace:t}),N=I.messages,M=I.isLoading,T=I.fetchNextPage,E=I.hasNextPage,L=!!k;return(0,r.jsxs)(m.x,{children:[(0,r.jsx)("div",{ref:P,children:(0,r.jsxs)(g.S0.Header,{className:(0,b.A)(s?"!px-4":"!px-2",{"h-[56px]":i}),children:[s&&(0,r.jsx)(v.h,{name:"16-arrow-left",onClick:a,className:"flex-none",ariaLabel:(0,c.t)("close")}),(0,r.jsx)(u.M,{onChange:O,searchValue:w,onKeyPress:l.noop,onClickCancel:function(){return O("")},placeholder:(0,c.t)("chat_space.search_messages.placeholder",{spaceName:(0,l.toLower)(x)}),className:(0,b.A)("!bg-primary !border-dark !hover:border-secondary-dark rounded-full",{"!h-9":!i})})]})}),(0,r.jsx)(g.S0.Content,{noPadding:!0,heightGap:C,className:"bg-secondary-dark",id:"scrollableMessageSearch",children:L?M?(0,r.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,r.jsx)(y.a,{})}):(0,r.jsx)(A,{messages:N,fetchNextPage:T,hasNextPage:!!E}):(0,r.jsx)(j,{name:x})})]})},F=n(792771),U=n(403697),B=n(981261),q=n(944428),z=n(208054),Z=n(253035),V=n(786518),H=n(96533),W=n(415307),Q=n(905326),G=n(380171),$=n(716089),K=n(680132),J=n(943544),X=function(e){var t=e.currentParticipant,n=e.getProfileActionItems,o=e.participantList,i=e.showMemberProfile;return(0,r.jsx)(r.Fragment,{children:o.map(function(e){var o=t.id===e.id,a=n(e);return(0,r.jsx)(G.T,{content:(0,c.t)("messaging.member_disabled_messaging"),disabled:!1!==e.messaging_enabled,children:(0,r.jsxs)("button",{type:"button",className:"hover:bg-tertiary messaging-rail__content--member focus-visible:bg-tertiary group w-full","aria-label":(0,c.t)("messaging.open_member_profile_button_aria_label",{name:e.name}),onClick:function(){return i(e.user_public_uid||"")},children:[(0,r.jsxs)("div",{className:(0,b.A)("text-dark flex w-[90%] items-center text-left",{"opacity-50":!1===e.messaging_enabled}),children:[(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)($.g,{name:e.name,src:e.avatar_url,status:e.status,size:"8"})}),(0,r.jsx)("div",{className:"truncate font-medium",children:o?(0,c.t)("messaging.you"):e.name}),e.admin&&(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)(K.I,{label:(0,c.t)("moderator")})})]}),t.id!==e.id&&t.admin&&(0,r.jsx)("button",{type:"button",onClick:function(e){e.stopPropagation()},children:(0,r.jsx)(J.Lt,{direction:"bottom-start",menuButtonEl:"div",menuItemsClassName:"!p-2 !w-60",button:(0,r.jsx)(J.Lt.MenuButton,{id:"action-block",children:(0,r.jsx)(v.h,{name:"20-menu-dots-horizontal",iconSize:20,ariaLabel:(0,c.t)("options_dropdown")})}),options:a})})]})},e.id)})})},Y=n(407383),ee=n(251630),et=n(60878),en=function(e){var t=e.refetchChatParticipants,n=e.refetchChatRoom,r=e.uuid,o=(0,et.pm)();return{handleMakeAdmin:(0,M.useMutation)(function(e){var t=e.participantId,n=e.status;return ee.M.update({uuid:r,id:t,admin:n})},{onSuccess:function(e){var r=e.chat_room_participant,i=r.name,a=r.roles.admin,s=i||(0,c.t)("messaging.member");t(),n(),o.success(a?(0,c.t)("messaging.member_made_admin",{name:s}):(0,c.t)("messaging.member_removed_as_admin",{name:s}),{duration:"short",shouldUseProgress:!1})},onError:function(){o.error((0,c.t)("request_failure_message"))}}).mutateAsync,removeParticipant:(0,M.useMutation)(function(e){var t=e.participantId;return ee.M.destroy({uuid:r,id:t})},{onSuccess:function(e){var r=e.message;t(),n(),o.success(r)},onError:function(){o.error((0,c.t)("request_failure_message"))}}).mutateAsync}},er=n(271561),eo=n(273511),ei=n(691525);function ea(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function es(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function el(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var ec=function(e){var t,n=e.chatRoom,a=e.refetchChatRoom,s=(0,H.r)(),l=n.uuid,u=n.current_participant,d=(0,W.q)().canBlockMemberDm,f=(0,eo.S)().shouldShowMessageOption,m=(0,ei.wh)().isViewOnlyMasquerading,p=(0,Q.p)().findOrCreateChatRoom,b=(0,i.k6)(),h=(0,q.u)(l),v=h.chatParticipants,g=h.refetchChatParticipants,x=h.totalCount,j=h.hasNextPage,O=h.fetchNextPage,S=function(e){if(Array.isArray(e))return ea(e)}(t=(0,Y.F2)(void 0===v?[]:v))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return ea(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ea(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),P=en({refetchChatParticipants:g,refetchChatRoom:a,uuid:l}),C=P.handleMakeAdmin,k=P.removeParticipant,I=(0,o.useCallback)(function(e){e&&s.show({memberPublicId:e})},[s]),N=(0,er.U)({onSuccess:function(){g()}}),A=N.isBlocking,M=N.memberToBlock,T=N.toggleBlockDmsModal,R=N.handleBlockMember,D=N.handleUnblockMember,L=N.isBlockDmsModalOpen,F=N.setIsBlockDmsModalOpen,B="!py-2.5 !px-3",z={iconClassName:"text-feedback-error",color:"text-feedback-error"},Z=function(e){var t;return(t=function(){var t;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(n){switch(n.label){case 0:return[4,p({kind:U.g8,community_member_ids:[null==e?void 0:e.community_member_id]})];case 1:return(t=n.sent())&&b.push((0,E.co)({url:(0,E.so)({uuid:t})})),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){es(i,r,o,a,s,"next",e)}function s(e){es(i,r,o,a,s,"throw",e)}a(void 0)})})()},G=function(e){var t=e.is_blocked_by_current_community_member,n=[{value:"view-profile",icon:"20-eye-open",iconSize:20,className:B,label:(0,c.t)("view_profile"),onClick:function(){return I(e.user_public_uid||"")}},{value:e.admin?"remove-admin":"make-admin",label:e.admin?(0,c.t)("messaging.remove_admin"):(0,c.t)("messaging.make_admin"),icon:"20-moderator",iconSize:20,className:B,onClick:function(){return C({participantId:e.id,status:!e.admin})}}];return f(e)&&n.push({value:"message",icon:"20-dm-message",className:"!py-2.5 !px-3",iconSize:20,label:(0,c.t)("messaging.send_direct_message"),onClick:function(){return!m&&Z(e)}}),d({admin:e.community_admin,community_member_id:e.community_member_id})&&(t?n.push({value:"block-dm",icon:"20-circle-check",className:B,iconSize:20,label:(0,c.t)("messaging.unblock_direct_messages"),onClick:function(){return D(e)}}):n.push(el({value:"block-dm",icon:"20-block-dms",className:B,iconSize:20,label:(0,c.t)("messaging.block_direct_messages"),onClick:function(){return T(e)}},z))),n.push(el({value:"remove",label:(0,c.t)("messaging.remove"),icon:"20-close",iconSize:20,className:B,onClick:function(){return k({participantId:e.id})}},z)),n},$=(0,Y.bb)(S),K=$.onlineParticipants,J=$.offlineParticipants;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{id:"scrollableDiv",className:"messaging-rail__content h-full overflow-auto",children:(0,r.jsxs)(w.Z,{scrollThreshold:.8,next:O,hasMore:!!j,dataLength:x,className:"px-6 pb-6",scrollableTarget:"scrollableDiv",loader:(0,r.jsx)(y.a,{center:!0}),children:[K.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-default mb-2",children:(0,r.jsx)(_.Z.LabelXxs,{weight:"bold",color:"text-default",children:(0,c.t)("chat_space.online")})}),(0,r.jsx)(X,{currentParticipant:u,getProfileActionItems:G,participantList:K,showMemberProfile:I})]}),J.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-default my-2",children:(0,r.jsx)(_.Z.LabelXxs,{weight:"bold",color:"text-default",children:(0,c.t)("chat_space.offline")})}),(0,r.jsx)(X,{currentParticipant:u,getProfileActionItems:G,participantList:J,showMemberProfile:I})]})]})}),(0,r.jsx)(V._,{showModal:L,onClose:function(){return F(!1)},onConfirm:R,memberName:(null==M?void 0:M.name)||"",isLoading:A})]})},eu=function(e){var t=e.chatRoom,n=e.isDirect,o=e.refetchChatRoom,i=e.otherParticipant,a=e.member,s=e.refetchProfileInfo;return n?(0,r.jsx)(Z.N,{memberPublicId:(null==i?void 0:i.user_public_uid)||"",member:a,isFullPageProfile:!1,isRenderedOnRailBar:!0,shouldHideMessageButton:!0,shouldHideBadge:!0,shouldFixTabsOnTop:!0,refetch:function(){s(),o()}}):(0,r.jsx)(ec,{chatRoom:t,refetchChatRoom:o})},ed=n(697485),ef={page_name:B.$q.PROFILE_VIEW},em=function(e){var t=e.chatRoom,n=e.chatRoomUuid,o=e.refetchChatRoom,i=t||{},a=i.chat_room_name,s=i.chat_room_kind,l=i.chat_room_description,u=i.current_participant,d=s===U.g8,f=(0,q.u)(n),p=f.chatParticipants,b=f.isLoading,v=f.totalCount,y=(p||[]).find(function(e){return e.id!==(null==u?void 0:u.id)}),x=eA().toggleShowRailBar,_=(0,z.P$)({publicId:null==y?void 0:y.user_public_uid,params:ef}).getProfileInfoQuery,j=_.data,w=_.isLoading,O=_.refetch,S=(0,h.T)(),P=S.ref,C=S.height;return(0,r.jsxs)(m.x,{isLoading:d&&w||b,loaderVariant:d?"rail-profile":"rail-member-list",children:[(0,r.jsx)("div",{ref:P,children:(0,r.jsx)(g.S0.Header,{className:"!min-h-[56px]",children:(0,r.jsx)(ed.h,{title:d?(0,c.t)("profile"):a,memberCount:v,isDirect:d,description:l,onClose:x})})}),(0,r.jsx)(g.S0.Content,{noPadding:!0,heightGap:C,children:(0,r.jsx)(eu,{chatRoom:t,isDirect:d,otherParticipant:y,member:void 0===j?{}:j,refetchChatRoom:o,refetchProfileInfo:O})})]})},ep=n(132002),eb=function(){var e=(0,p.L2)().data,t=eA(),n=t.shouldShowRailBar,o=t.dateRange,i=t.closeSpaceSummaryRailbar,a=t.firstUnreadMessageId;return e?(0,r.jsx)(ep.u,{isOpen:n,onClose:i,space:e,dateRange:o,type:"chat",shouldHideRailbarDragger:!1,firstUnreadMessageId:a}):null},eh=n(795004),ev=function(e){var t=e.description,n=e.shouldHideMembersCount,o=e.memberCount,i=void 0===o?0:o,a=e.onClose,s=void 0===a?l.noop:a,u=(0,d.BT)();return(0,d.kK)()?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"border-primary flex items-center justify-between border-b px-6 py-4",children:[(0,r.jsx)(v.h,{name:"16-arrow-left",onClick:s,ariaLabel:(0,c.t)("chat_space.details")}),(0,r.jsx)(_.Z.TitleSm,{as:"h2",weight:"semibold",children:(0,c.t)("chat_space.details")}),!n&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"text-default mr-2",children:(0,r.jsx)(_.Z.LabelSm,{weight:"medium",children:i})}),(0,r.jsx)(x.JO,{type:"20-members",size:20,className:"text-dark",useWithFillCurrentColor:!0})]})]}),t&&(0,r.jsx)("div",{className:"text-default mt-4 max-h-[200px] overflow-y-auto whitespace-pre-line px-6 py-4",children:(0,r.jsx)(_.Z.BodySm,{children:t})})]}):(0,r.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)(_.Z.TitleSm,{as:"h2",weight:"semibold",children:(0,c.t)("chat_space.details")}),u?(0,r.jsx)("button",{type:"submit",onClick:s,children:(0,r.jsx)(x.JO,{type:"close-v2",className:"text-dark mr-1 mt-2.5 cursor-pointer",useWithFillCurrentColor:!0})}):(0,r.jsx)(r.Fragment,{children:!n&&(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"text-dark mr-2",children:(0,r.jsx)(_.Z.LabelSm,{weight:"medium",children:i})}),(0,r.jsx)(x.JO,{type:"space-chat-members",className:"mt-1"})]})})]}),t&&(0,r.jsx)("div",{className:"text-dark max-h-[200px] overflow-y-auto whitespace-pre-line",children:(0,r.jsx)(_.Z.BodySm,{children:t})})]})},ey=function(e){var t=e.space,n=(0,q.u)(t.chat_room_uuid),o=n.chatParticipants,i=n.isLoading,a=n.refetchChatParticipants,s=n.hasNextPage,l=n.fetchNextPage,c=n.totalCount,u=eA().toggleShowRailBar,d=(0,h.T)(),f=d.ref,p=d.height;return(0,r.jsxs)(m.x,{isLoading:i,loaderVariant:"rail-member-list",children:[(0,r.jsx)(g.S0.Header,{className:"mb-4 border-none !p-0 sm:!px-6 md:mb-0 md:!py-4",children:(0,r.jsx)("div",{ref:f,className:"w-full",children:(0,r.jsx)(ev,{shouldHideMembersCount:t.hide_members_count,memberCount:c,description:t.chat_room_description,onClose:u})})}),(0,r.jsx)(g.S0.Content,{heightGap:p,noPadding:!0,children:(0,r.jsx)(eh.V,{spaceMembers:o,hasMoreSpaceMembers:s,space:t,refetchSpaceMembers:a,fetchNextPage:l})})]})},eg=n(396354),ex=n(624804);function e_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ej(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ew(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return e_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e_(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var eO="PARTICIPANTS",eS="CHAT_THREADS",eP="CHAT_ROOM_MESSAGE_SEARCH",eC="CHAT_SPACE_SUMMARY",ek={chatRoom:null,closeThreadsRailbar:function(){},isCourseSpace:!1,isLiveStream:!1,isDrawer:!1,messageHighlightId:null,openThreadsRailbar:function(){},parentMessage:null,RailbarComponent:function(){return null},setMessageHighlightId:function(){},shouldShowRailBar:!1,toggleShowRailBar:function(){},type:eO,updateParentMessage:function(){},isChatSpace:!1,isDmsPage:!1,toggleChatRoomMessageSearchRailbar:function(){},isMessageSearchRailbarOpen:!1,EmbeddedRailbarComponent:function(){return null},shouldShowEmbeddedRailBar:!1,toggleShowEmbeddedRailBar:function(){},messageHashId:void 0,dateRange:a.n.LAST_7_DAYS,setDateRange:function(){},openSpaceSummaryRailbar:function(){},closeSpaceSummaryRailbar:function(){},firstUnreadMessageId:void 0},eI=(0,o.createContext)(ek);eI.displayName="RailbarContext";var eN=function(e){var t,n=e.isChatSpace,l=void 0!==n&&n,c=e.children,u=e.isLiveStream,f=e.isCourseSpace,m=e.isDrawer,p=(0,s.YQ)(),b=(0,eg.t)().message_id,h=ew((0,o.useState)(ek.type),2),v=h[0],y=h[1],g=ew((0,ex.k)(!1),3),x=g[0],_=g[1],j=g[2],w=ew((0,ex.k)(!1),3),O=w[0],S=w[1],P=w[2],C=ew((0,o.useState)(ek.parentMessage),2),k=C[0],I=C[1],N=ew((0,o.useState)(ek.chatRoom),2),A=N[0],M=N[1],T=ew((0,o.useState)(b),2),E=T[0],R=T[1],D=(0,i.TH)().pathname.startsWith("/messages"),U=(0,d.BT)(),B=v===eP,q=ew((0,o.useState)(a.n.LAST_7_DAYS),2),z=q[0],Z=q[1],V=ew((0,o.useState)(),2),H=V[0],W=V[1];(0,o.useEffect)(function(){j(!U)},[U]);var Q=(0,o.useCallback)(function(e,t){I(e),M(t),B&&b?P(!0):(P(!1),y(eS),j(!0))},[B,b]),G=(0,o.useCallback)(function(){I(null),M(null),y(eO),U&&j(!1)},[U]),$=(0,o.useCallback)(function(){y(v===eP?eO:eP),j(!0)},[v]),K=(0,o.useCallback)(function(){return l?ey:em},[l]),J=(0,o.useCallback)(function(e,t){Z(e),W(t),y(eC),j(!0)},[]),X=(0,o.useCallback)(function(){y(eO),U&&j(!1)},[U]),Y=(ej(t={},eO,K()),ej(t,eS,F.I),ej(t,eP,L),ej(t,eC,eb),t),ee=Y[v],et=Y[eS];return(0,r.jsx)(eI.Provider,{value:{chatRoom:A,closeThreadsRailbar:G,isCourseSpace:void 0!==f&&f,isLiveStream:void 0!==u&&u,isChatSpace:l,isDrawer:void 0!==m&&m,messageHighlightId:E,openThreadsRailbar:Q,parentMessage:k,RailbarComponent:ee,EmbeddedRailbarComponent:et,setMessageHighlightId:R,shouldShowRailBar:x,toggleShowRailBar:_,type:v,updateParentMessage:function(e){I(e)},isDmsPage:D,toggleChatRoomMessageSearchRailbar:$,isMessageSearchRailbarOpen:B,shouldShowEmbeddedRailBar:O&&B,toggleShowEmbeddedRailBar:S,messageHashId:p,dateRange:z,setDateRange:Z,openSpaceSummaryRailbar:J,closeSpaceSummaryRailbar:X,firstUnreadMessageId:H},children:c})},eA=function(){return(0,o.useContext)(eI)}},936353:function(e,t,n){n.d(t,{Op:()=>c,kL:()=>s,nc:()=>l});var r=n(275271),o=n(90047),i=n(447640),a=n(239295),s=function(e){var t=e.event,n=e.scrollerId,r=e.targetDocument,i=(0,o.j)().isMobileView,a=(r||document).getElementById(void 0===n?"message-scroll-view":n);if(!a)return{};var s="noScroll";switch(t){case"messageSent":s="scrollToBottom";break;case"messageReceived":var l=a.scrollTop-a.scrollHeight+a.offsetHeight,c=i()&&0===l,u=l>=-(.8*a.offsetHeight)||l>14;(c||u)&&(s="scrollToBottom");break;case"chatRoomLoad":s="scrollToUnreadMessageIndicator";break;case"paginatedMessageLoad":s="adjustTop";break;case"nextPaginatedMessageLoad":case"messageUpdated":case"messageDeleted":case"parentMessageUpdated":break;case"reaction":a.scrollTop-a.scrollHeight+a.offsetHeight>=-80&&(s="scrollToBottom")}return{action:s,scrollTopValue:a.scrollTop,scrollHeightValue:a.scrollHeight}},l=function(e,t){return e&&t?"message-scroll-view-".concat(t):"message-scroll-view"},c=function(){var e=(0,a.q)(),t=e.chatRoomUuid,n=e.isMessaging,o=(0,i.D)().frameDocument,c=l(n,t),u=o||document,d=(0,r.useCallback)(function(){return u.getElementById(c)},[u,c]),f=(0,r.useCallback)(function(e){return s({event:e.event,scrollerId:c,targetDocument:u})},[c,u]);return(0,r.useMemo)(function(){return{calculateScrollInfo:f,scrollerId:c,getScrollingElement:d,targetDocument:u}},[f,c,d,u])}},548880:function(e,t,n){n.d(t,{K:()=>s});var r=n(932699),o=n(903225),i=n(396354),a=n(660512),s=function(){var e=(0,o.k6)(),t=(0,a.x)(),n=t.openThreadsRailbar,s=t.setMessageHighlightId,l=t.messageHighlightId,c=t.shouldShowEmbeddedRailBar,u=t.closeThreadsRailbar,d=(0,i.t)().message_id;return{removeThreadIdUrlParam:function(){l&&(e.replace({search:"",hash:window.location.hash}),s(null))},openThreadsRailbarOnThreadsNotification:function(e){var t=e.messageHashId,o=e.chatRoomMessages,i=e.chatRoom;if(d){var a=o.find(function(e){return e.id===Number(t)});a&&(0,r.delay)(function(){s(Number(d)),n(a,i)},500*!c)}},closeThreadsRailbar:u}}},764208:function(e,t,n){n.d(t,{r:()=>g,x:()=>y});var r=n(552676),o=n(275271),i=n(131906),a=n(903225),s=n(93199),l=n(547144),c=n(263271),u=n(441342),d=n(60878),f=n(742992);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||h(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}}var v=(0,o.createContext)({chatThreadIds:[]});v.displayName="UnreadChatThreadsContext";var y=function(e){var t,n=e.children,m=(0,u.wh)().currentCommunityMember,h=p((0,o.useState)([]),2),y=h[0],g=h[1],x=p((0,o.useState)(!1),2),_=x[0],j=x[1],w=p((0,o.useState)(new Set),2),O=w[0],S=w[1],P=(0,d.pm)().error,C="/threads"===(0,a.TH)().pathname;(0,c.s)({channel:"Chats::CommunityMemberThreadsChannel",onMessageReceive:function(e){A(e)},community_member_id:null==m?void 0:m.id,canCreateConnection:!!(null==m?void 0:m.id)},[null==m?void 0:m.id]);var k=(0,i.useQuery)(["thread_messages","unread",null==m?void 0:m.id],function(){return(0,s.UT)(l.av.chatThreads.unreadChatThreads())},{enabled:!!(null==m||null==(t=m.policies)?void 0:t.can_access_threads_tab),onSuccess:function(e){g(e.chat_thread_ids)},onError:function(e){P(e.message)}}),I=k.isLoading,N=k.refetch,A=function(e){"chatThreadRead"===e.event?M(e.chat_thread_id):"newMessage"===e.event&&T(e.json_message)},M=function(e){y.includes(e)&&g(y.filter(function(t){return t!==Number(e)}))},T=function(e){(null==e?void 0:e.unread_flow)&&j(!0);var t,n=(null==(t=e.sender)?void 0:t.community_member_id)===(null==m?void 0:m.id),r=!e.chat_thread_id,o=(null==e?void 0:e.chat_room_parent_type)==="Live::Room",i=y.includes(e.chat_thread_id);if(!r&&!n&&!o&&!i){if(C){var a=e.chat_thread_id,s=document.getElementById(String(a));if(s&&(0,f.z)(s))return}g(function(t){return b(t).concat([e.chat_thread_id])})}};(0,o.useEffect)(function(){S(function(e){return new Set(b(e).concat(b(y)))})},[y]);var E={fetchUnreadChatThreads:N,unreadChatThreadIds:y,unreadThreadsCount:y.length,isLoading:I,onEventReceive:A,isUnreadThreadFlow:_,newBadgeIds:O,resetNewBadgeIds:function(){S(new Set)}};return(0,r.jsx)(v.Provider,{value:E,children:n})},g=function(){return(0,o.useContext)(v)}},807355:function(e,t,n){n.d(t,{g:()=>f});var r=n(932699),o=n(131906),i=n(93199),a=n(547144),s=n(944428);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function u(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function d(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return l(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var f=function(e){var t=e.uuid,n=e.ids,l=e.enabled,f=e.shouldUpdateCache,m=void 0===f||f,p=(0,o.useQueryClient)(),b=function(e){p.setQueryData(["chat-participants",t],function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pages:[]},n=d((0,r.flatten)((t.pages||[]).map(function(e){return e.records}))).concat(d(e)),o=Math.ceil(n.length/s.U);return o>t.pages.length&&(t.pages=Array.from({length:o}).fill(t.pages[o]||t.pages[t.pages.length-1])),u(c({},t),{pages:t.pages.map(function(e,t){return u(c({},e||{}),{records:n.slice(s.U*t,s.U*(t+1))})})})})},h=(0,o.useQuery)(["chatroom","missing-participants",n],function(){return(0,i.UT)(a.av.chatRoomParticipants.index({uuid:t,params:{ids:n}}))},{enabled:l,select:function(e){return e.records},onSuccess:function(e){m&&b(e)},onError:function(e){console.error("err:",e)}}),v=h.isLoading,y=h.data;return{isLoading:v,participants:void 0===y?[]:y}}},416384:function(e,t,n){n.d(t,{s:()=>i});var r=n(131906),o=n(251630),i=function(e){return(0,r.useMutation)(o.e5.createConnection,e)}},501777:function(e,t,n){n.d(t,{_:()=>i});var r=n(131906),o=n(251630),i=function(e){return(0,r.useMutation)(function(e){return o.e5.withdrawConnection(e)},e)}},818580:function(e,t,n){n.d(t,{RN:()=>u,bD:()=>s,hE:()=>c,rF:()=>l});var r=n(131906),o=n(93199),i=n(547144);function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var s=function(e){return"course-sections-".concat(e)},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.useQuery)(a({queryKey:[s(e)],queryFn:function(){return(0,o.UT)(i.av.courses.listSections({courseId:e}))}},t))},c=function(e){return"lesson-".concat(e)},u=function(e){var t=e.courseId,n=e.lessonId,s=e.sectionId,l=e.options;return(0,r.useQuery)(a({queryKey:[c(n)],queryFn:function(){return(0,o.UT)(i.av.courses.getLesson({courseId:t,lessonId:n,sectionId:s}))}},void 0===l?{}:l))}},90047:function(e,t,n){n.d(t,{j:()=>r});var r=function(){return{isMobileView:function(){return window.matchMedia("(max-width: 992px)").matches}}}},499385:function(e,t,n){n.d(t,{S:()=>c,m:()=>u});var r=n(932699),o=n(131906),i=n(93199),a=n(547144),s=n(861853),l=n(72220),c=function(e){return"embeddable-chat-room-".concat(e)},u=function(e){var t=(0,l.a)(s.yf).updateChatRoom,n=(0,s.Rv)(),u=(0,o.useQuery)({queryKey:[c(e)],queryFn:function(){return(0,i.UT)(a.av.chatRooms.show({uuid:e}))},enabled:!!e&&"new"!==e,refetchOnWindowFocus:!1,onSuccess:function(e){var n=e.chat_room;n&&t(n)}}),d=u.isLoading,f=u.refetch,m=u.data,p=(void 0===m?{}:m).chat_room;return{isLoading:d,chatRoom:p,refetchChatRoom:e?f:r.noop,onEventReceive:function(e){var r,o;if("chatRoomUpdated"===e.event){var i,a,s=e.chat_room;t((i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},s),a=a={pinned_message:s.pinned_message},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(a)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(a,e))}),i))}"updatedMessage"===e.event&&(null==n||null==(r=n.pinned_message)?void 0:r.id)===e.json_message.id&&t({uuid:null==p?void 0:p.uuid,pinned_message:e.json_message}),"deletedMessage"===e.event&&(null==n||null==(o=n.pinned_message)?void 0:o.id)===e.id&&t({uuid:null==p?void 0:p.uuid,pinned_message:null})}}}},484530:function(e,t,n){n.d(t,{j:()=>o});var r=n(441342),o=function(e){var t,n=(0,r.wh)().experimentation;return(null!=(t=null==n?void 0:n.experiments)?t:[]).some(function(t){return t.flag_name===e})}},532244:function(e,t,n){n.d(t,{f:()=>i});var r=n(685593),o=n(484530),i=function(){var e=(0,o.j)("professional_price_test"),t=(0,o.j)("business_price_test");return e||t||(0,r.np)()}},139964:function(e,t,n){n.d(t,{j:()=>s});var r=n(275271);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=/^\(\d+\)\s/,a=/| [a-z 0-9@_\-#.!]+ $/i,s=function(){var e,t=(e=(0,r.useState)(document.title.replace(i,"")),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,1)||function(e,t){if(e){if("string"==typeof e)return o(e,1);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e,1)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return{originalTitle:t,prependTitle:function(e){return document.title="".concat(e).concat(t)},resetTitleToOriginal:function(){return document.title=t},addDirectMessageParticipantNameInTitle:function(e){var n=document.title.match(i),r=t.replace(a,"".concat(e," "));n&&(r="".concat(n[0]).concat(r)),document.title=r}}}},502504:function(e,t,n){n.d(t,{t:()=>l});var r=n(739792),o=n(691525),i=n(852770),a=n(72727),s=function(e){var t=e.notification;try{return t.notification_text_structure.map(function(e){return t[e]||""}).join(" ")}catch(e){return""}},l=function(){var e=(0,o.wh)().currentCommunity,t=(0,a.L)().electronAPI,n=(null==e?void 0:e.icon_url)||"https://assets-v3.circle.so/qv2902nizkth5o752l2cugc6y09e";return{sendNotificationToDesktopApp:function(o){var a=o.title,l=o.body,c=o.metadata,u=o.type;if(null==t?void 0:t.sendNotification)try{if("notification"===u&&!c)return;t.sendNotification({title:a||(0,r.t)("desktop_app.notifications.new_notification_generic_title"),body:l||(c&&"notification_text_structure"in c?s({notification:c}):""),icon:n,metadata:c,currentCommunityData:{id:null==e?void 0:e.id,name:null==e?void 0:e.name,slug:null==e?void 0:e.slug,root_url:null==e?void 0:e.root_url,full_url:null==e?void 0:e.full_url},type:u})}catch(e){(0,i.EZ)("Failed to send notification to desktop app"),(0,i.dD)(e),console.warn("Failed to send notification to desktop app:",e)}},setDesktopAppNotificationCount:function(n){if(null==t?void 0:t.setNotificationCount)try{var r=(null==e?void 0:e.id)?Number(e.id):void 0;t.setNotificationCount(n,r)}catch(e){(0,i.EZ)("Failed to set desktop app notification count"),(0,i.dD)(e),console.warn("Failed to set desktop app notification count:",e)}},setDesktopAppUnreadMessageCount:function(n){if(null==t?void 0:t.setUnreadMessageCount)try{var r=(null==e?void 0:e.id)?Number(e.id):void 0;t.setUnreadMessageCount(n,r)}catch(e){(0,i.EZ)("Failed to set desktop app unread message count"),(0,i.dD)(e),console.warn("Failed to set desktop app unread message count:",e)}}}}},884579:function(e,t,n){n.d(t,{I:()=>i});var r=n(263271),o=n(502504),i=function(e,t){var n=(0,o.t)().sendNotificationToDesktopApp;(0,r.s)({channel:"NotificationChannel",onMessageReceive:function(e){n({type:"notification",metadata:null==e?void 0:e.data}),t(e)},community_member_id:e,canCreateConnection:!!e},[e])}},65631:function(e,t,n){n.d(t,{K:()=>l});var r=n(131906),o=n(93199),i=n(547144),a=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,o.UT)(i.av.supportedCurrencies.index(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e?{include_traded:!0}:{})))},s={includeTraded:!1},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=e.includeTraded,n=void 0!==t&&t;return(0,r.useQuery)(["paywalls-currencies",n],function(){return a(n)})}},323583:function(e,t,n){n.d(t,{P:()=>b,N:()=>p});var r=n(275271),o=n(932699),i=n(131906),a=n(93199),s=n(714218),l=n(441342),c=n(60589),u=n(698173),d=function(e){var t=e.lastPage,n=e.isCalendarView,o=e.fetchNextPage;(0,r.useEffect)(function(){n&&(null==t?void 0:t.has_next_page)&&(null==t?void 0:t.page)<11&&o()},[t,n,o])};function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{per_page:12},t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop,p=(0,i.useQueryClient)(),b=(0,s.d)(),h=b.removeRecord,v=b.findAndReplaceRecord,y=(0,l.L2)().data,g=Object.fromEntries(Object.entries(e).filter(function(e){return void 0!==(function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return f(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[1]})),x=["posts",null==y?void 0:y.id,g],_=(null==g?void 0:g.used_on)==="calendar",j=(0,i.useInfiniteQuery)({queryKey:x,queryFn:function(e){var t,n=e.pageParam;return t=void 0===n?1:n,(0,a.UT)(u.a.posts.index({spaceId:null==y?void 0:y.id,params:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({page:t},g)}))},getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},keepPreviousData:_,enabled:t&&!!(null==y?void 0:y.id)&&(0,c.BT)(y),onSuccess:n}),w=j.data,O=j.hasNextPage,S=j.isLoading,P=j.refetch,C=j.fetchNextPage,k=(0,r.useCallback)(function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.refetch,o=void 0===r||r;return(t=function(){var t,n;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:if(t=e,!o)return[3,6];r.label=1;case 1:return r.trys.push([1,3,4,5]),n=u.a.posts.show({spaceId:e.space_id,postSlug:e.slug}),[4,p.fetchQuery({queryKey:[n]})];case 2:return t=r.sent(),[3,5];case 3:return console.error(r.sent()),[3,5];case 4:return v(t,x),[7];case 5:return[3,7];case 6:v(t,x),r.label=7;case 7:return[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){m(i,r,o,a,s,"next",e)}function s(e){m(i,r,o,a,s,"throw",e)}a(void 0)})})()},[v,x]),I=(0,r.useCallback)(function(e){h(e,x)},[h]),N=[];return!S&&w&&(N=(0,o.uniqBy)((0,o.flatten)(w.pages.map(function(e){return e.records})),"id")),d({lastPage:null==w?void 0:w.pages[(null==w?void 0:w.pages.length)-1],isCalendarView:_,fetchNextPage:C}),{mapPages:function(e){return S||!w?[]:w.pages.map(e)},hasNextPage:O,refetch:P,isLoading:S,fetchNextPage:C,posts:N,onPostChange:k,onPostDestroy:I}},b=function(e){return p({only_pinned:!0,per_page:e||50,used_on:"pinned_post_sidebar"})}},1892:function(e,t,n){n.d(t,{j:()=>c,t:()=>u});var r=n(131906),o=n(93199),i=n(547144);function a(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function l(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var c="post-show",u=function(e){var t=e.spaceId,n=e.postSlug,u=e.spaceSlug,d=void 0===u?"":u,f=e.queryOptions,m=e.context,p=e.disabled,b=[c,n,t||d,void 0===m?"default":m],h=i.av.posts.show({spaceId:t,spaceSlug:d,postSlug:n}),v=(0,r.useQuery)(l(s({queryKey:b,queryFn:function(){return(0,o.UT)(h)},enabled:!(void 0!==p&&p)&&!!((t||d)&&n),staleTime:0},void 0===f?{}:f),{retry:function(e,t){return(null==t?void 0:t.status)!==404}})),y=(0,r.useQueryClient)();return l(s({},v),{post:v.data,onPostChange:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.refetch,o=void 0===r||r;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){return o?[2,v.refetch()]:[2,y.setQueryData(b,function(){return e})]})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)})})()}})}},886307:function(e,t,n){n.d(t,{Z:()=>a});var r=n(131906),o=n(93199),i=n(547144),a=function(e){var t=e.post,n=["post-summary",t.id],a=(0,r.useQueryClient)(),s=(0,r.useQuery)(n,function(){return(0,o.UT)(i.av.posts.summary({postId:String(t.id)}))},{enabled:!1,staleTime:6e5,retry:function(e,t){return(null==t?void 0:t.status)!==404}}),l=s.data,c=s.isLoading,u=s.refetch,d=function(){c&&a.cancelQueries(n),a.resetQueries({queryKey:n,exact:!0})};return{summary:l,isLoadingSummary:c,refetchSummary:u,clearSummary:d,toggleSummary:function(){l||c?d():u()}}}},177201:function(e,t,n){n.d(t,{F:()=>c});var r=n(275271),o=n(932699),i=n(131906),a=n(93199),s=n(547144);function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var c=function(e){var t,n,c=e.memberPublicId,u=e.params,d=void 0===u?{per_page:10}:u,f=(0,i.useInfiniteQuery)({queryKey:["profile-comments",c],queryFn:function(e){var t,n=e.pageParam;return t=void 0===n?1:n,(0,a.UT)(s.av.profile.comments({memberPublicId:c,params:l({page:t},d)}))},getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),m=(0,r.useMemo)(function(){return f.isLoading?[]:(0,o.uniqBy)((0,o.flatten)(f.data.pages.map(function(e){return e.records})),"id")},[f.data]);return t=l({},f),n=n={comments:m},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}},208054:function(e,t,n){n.d(t,{FC:()=>m,P$:()=>f,Wx:()=>d});var r=n(131906),o=n(739792),i=n(441342),a=n(400810),s=n(93199),l=n(547144),c=n(60878);function u(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var d="PROFILE_INFO",f=function(e){var t=e.publicId,n=e.params,f=void 0===n?{}:n,m=e.type,p=(0,c.pm)(),b=(0,r.useQueryClient)(),h=(0,i.wh)().refetch,v=[d,t,f],y=function(){return(0,s.UT)(l.av.profile.show({memberPublicId:t,params:f}))},g=(0,r.useQuery)({queryKey:v,queryFn:(0,a.B)({type:void 0===m?"CommunityMember":m})?y:function(){return(0,s.UT)(l.av.profile.leadShow({leadPublicId:t,params:f}))},retry:!1,enabled:!!t}),x=(0,r.useMutation)(function(e){return(0,s.aU)(l.av.profile.update({memberPublicId:t}),e)},{onSuccess:function(){var e;return(e=function(){var e,t,n,r,i,a;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(s){switch(s.label){case 0:return r=null==(n=null==g?void 0:g.data)?void 0:n.locale,p.success((0,o.t)("profile_saved_successfully")),[4,h()];case 1:return s.sent(),[4,b.invalidateQueries({queryKey:[d]})];case 2:return s.sent(),[4,b.fetchQuery({queryKey:v,queryFn:y})];case 3:return a=null==(i=s.sent())?void 0:i.locale,null==(t=window.webview)||null==(e=t.onProfileInfoSaved)||e.call(t),r!==a&&window.location.reload(),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){u(i,r,o,a,s,"next",e)}function s(e){u(i,r,o,a,s,"throw",e)}a(void 0)})})()},onError:function(e){p.error(e.message)}});return{getProfileInfoQuery:g,updateProfileInfoMutation:x}},m=function(e){var t=e.publicId;return(0,r.useMutation)(function(e){return(0,s.aU)(l.av.profile.update({memberPublicId:t}),e)})}},859834:function(e,t,n){n.d(t,{O:()=>c});var r=n(275271),o=n(96533),i=n(282859),a=n(259459),s=n(715731),l=n(660512),c=function(e){var t,n,c=e.name,u=e.params,d=void 0===u?{}:u,f=e.public_uid,m=(0,o.r)().show,p=(0,s.I)(),b=(0,l.x)().isDrawer,h=(0,r.useCallback)(function(e){(0,i.n2)(e)||p||b||(e.preventDefault(),m({memberPublicId:f,params:d}))},[p,b,f,d,m]);return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},(0,a.H)({name:c,params:d,publicUid:f,shouldOpenInNewTab:p,showMemberProfileDrawer:m})),n=n={onClick:h},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}},62025:function(e,t,n){n.d(t,{t:()=>d});var r=n(275271),o=n(932699),i=n(131906),a=n(93199),s=n(547144),l=n(714218);function c(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var d=function(e){var t,n,d=e.memberPublicId,f=e.params,m=void 0===f?{per_page:10}:f,p=e.enabled,b=e.onSuccess,h=void 0===b?o.noop:b,v=["profile-posts",d],y=(0,l.d)().findAndReplaceRecord,g=(0,i.useQueryClient)(),x=(0,i.useInfiniteQuery)({queryKey:v,queryFn:function(e){var t,n=e.pageParam;return t=void 0===n?1:n,(0,a.UT)(s.av.profile.posts({memberPublicId:d,params:u({page:t},m)}))},getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},enabled:void 0===p||p,onSuccess:function(e){(0,o.isFunction)(h)&&h(e)}}),_=(0,r.useMemo)(function(){var e,t;return x.isLoading?[]:(0,o.uniqBy)((0,o.flatten)(null!=(t=null==(e=x.data)?void 0:e.pages.map(function(e){return e.records}))?t:[]),"id")},[x.data,x.isLoading]);return t=u({},x),n=n={onPostChange:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return[4,g.fetchQuery({queryKey:[s.av.posts.show({spaceId:e.space_id,postSlug:e.slug})]})];case 1:return[2,y(t.sent(),v)]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)})})()},posts:_},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}},988159:function(e,t,n){n.d(t,{u:()=>c});var r=n(275271),o=n(932699),i=n(131906),a=n(93199),s=n(547144);function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var c=function(e){var t,n,c=e.memberPublicId,u=e.params,d=void 0===u?{per_page:12}:u,f=(0,i.useInfiniteQuery)({queryKey:["PROFILE_SPACES",c,d],queryFn:function(e){var t,n=e.pageParam;return t=void 0===n?1:n,(0,a.UT)(s.av.profile.spaces({memberPublicId:c,params:l({page:t},d)}))},getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),m=(0,r.useMemo)(function(){return f.isLoading?[]:(0,o.uniqBy)((0,o.flatten)(f.data.pages.map(function(e){return e.spaces})),"id")},[f.data]);return t=l({},f),n=n={spaces:m},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}},514598:function(e,t,n){n.d(t,{H:()=>b});var r=n(275271),o=n(903225),i=n(739792),a=new(n(510193)).Z({minLength:8,alphabet:"vRx5keXBhG3b0Z1nJgPiNMqsItjLuE2dOWz9DQCmScylaUfKFV7HA4pw6o8YTr"}),s=n(441342),l=n(93199),c=n(852770),u=n(78456),d=n(981261),f=n(547144),m=function(){var e=(0,o.TH)(),t=(0,o.k6)();return function(n){var r=n.sqid;t.push((0,f.Zm)({sqid:r,previousLocation:e}).index)}},p={page_name:d.$q.PROFILE_VIEW},b=function(){var e=(0,o.TH)(),t=(0,o.k6)(),n=(0,s.wh)().currentCommunityMember,d=(0,u.vb)(n),b=m(),h=(0,r.useCallback)(function(){t.push(f.du.profile(e))},[t,e]),v=(0,r.useCallback)(function(e){b({sqid:a.encode([e])})},[b]),y=(0,r.useCallback)(function(e){return(0,l.UT)(f.av.profile.show({memberPublicId:e,params:p})).then(function(e){return(null==e?void 0:e.sqid)?b({sqid:e.sqid}):(null==e?void 0:e.id)?v(e.id):void console.error((0,i.t)("show_member_profile_has_no_sqid_or_id"),{profileData:e})}).catch(function(e){console.error((0,i.t)("show_member_profile_fetch_error"),{error:e})})},[b,v]);return{showOwnProfileEdit:h,showMemberProfileEdit:(0,r.useCallback)(function(e){var t=e.member;if(!d)return void console.error((0,i.t)("show_member_profile_no_admin"),{currentCommunityMember:n});if(!t)return void console.error((0,i.t)("show_member_profile_no_member"));if(t.sqid)return b({sqid:t.sqid});if(t.id){var r="Missing sqid for audience edit navigation ".concat(t.public_uid," ").concat(t.id," generating sqid");return(0,c.dD)(r),console.warn(r),v(t.id)}if(t.public_uid){var o="Missing id or sqid for audience edit navigation ".concat(t.public_uid," ").concat(t.id," fetching the profile data and navigating");(0,c.dD)(o),console.warn(o),y(t.public_uid);return}console.error((0,i.t)("show_member_profile_fallback_error"),{member:t})},[d,n,b,v,y])}}},714218:function(e,t,n){n.d(t,{d:()=>s});var r=n(275271),o=n(131906);function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var s=function(){var e=(0,o.useQueryClient)();return{findAndReplaceRecord:(0,r.useCallback)(function(t,n){if(!n)throw Error("queryKey is required");return e.setQueryData(n,function(e){return{pages:e.pages.map(function(e){return a(i({},e),{records:e.records.map(function(e){return e.id===t.id?t:e})})}),pageParams:e.pageParams}})},[e]),removeRecord:(0,r.useCallback)(function(t,n){if(!n)throw Error("queryKey is required");return e.setQueryData(n,function(e){return{pages:e.pages.map(function(e){return a(i({},e),{records:e.records.filter(function(e){return e.id!==t})})}),pageParams:e.pageParams}})},[e]),updateAllRecords:(0,r.useCallback)(function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;if(!n)throw Error("queryKey is required");e.setQueryData(n,function(e){return a(i({},e),{pages:e.pages.map(function(e,n){return a(i({},e||{}),{records:t.slice(r*n,r*(Number(n)+1))})})})})},[e])}}},283780:function(e,t,n){n.d(t,{m:()=>s});var r=n(131906),o=n(93199);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var s=function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0,c=Array.isArray(s)?s:[s||e],u=(0,r.useInfiniteQuery)(c,function(t){var n,r=t.pageParam;return n=void 0===r?1:r,(0,o.UT)(l(e,{page:n}))},a({getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}},i));return t=a({},u),n=n={mapPages:function(e){var t=u.isLoading,n=u.data;return t||!n?[]:n.pages.map(e)}},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t},l=function(e,t){var n=new URL(window.location.origin+e),r=!0,o=!1,a=void 0;try{for(var s,l=Object.entries(t)[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c,u=(c=s.value,function(e){if(Array.isArray(e))return e}(c)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(c,2)||function(e,t){if(e){if("string"==typeof e)return i(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(c,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=u[0],f=u[1];n.searchParams.set(d,String(f))}}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return n.pathname+n.search}},257335:function(e,t,n){function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(i=function(){return!!e})()}n.d(t,{Z:()=>a});var a=new(function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");function t(){var e,n,o,a,s,l;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");return n=r(n=t),a=e=function(e,t){var n;if(t&&("object"==((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)||"function"==typeof t))return t;if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,i()?Reflect.construct(n,[],r(this).constructor):n.apply(this,o)),s="emitSubscriptionStateChange",l=function(t){"Chats::RoomChannel"===t.channel?e.emit("chatRoomSubscriptionStateChange",t):e.emit("subscriptionStateChange",t)},s in a?Object.defineProperty(a,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[s]=l,e}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e),t}(n(972100).EventEmitter))},333382:function(e,t,n){n.d(t,{H:()=>o});var r=n(275271),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,r.useEffect)(function(){if(e){var t=e.split(" ");return t.forEach(function(e){document.body.classList.add(e)}),function(){t.forEach(function(e){document.body.classList.remove(e)})}}},[e])}},228469:function(e,t,n){n.d(t,{X:()=>s});var r=n(275271),o=n(72622),i=function(){var e=/Version\/(\d+(\.\d+)?)/.exec(navigator.userAgent);return e?Number(e[1]):null},a=function(){if(!o.isSafari)return!1;var e=i();return null!==e&&e>=18.4},s=function(){return(0,r.useMemo)(function(){return!a()},[])}},275753:function(e,t,n){n.d(t,{T:()=>i});var r=n(441342),o=n(78456),i=function(){var e=(0,r.wh)(),t=e.currentCommunityMember,n=e.currentCommunitySettings,i=!!(null==n?void 0:n.cms_member_media_upload_enabled),a=!!(null==n?void 0:n.member_media_uploads_enabled),s=(0,o.vb)(t)||(0,o.I$)(t);return!i||s||a}},852950:function(e,t,n){n.d(t,{k:()=>o});var r=n(275271),o=function(e){return(0,r.useCallback)(function(t){("Enter"===t.key||" "===t.key)&&(t.preventDefault(),e(t))},[e])}},20056:function(e,t,n){n.d(t,{n:()=>o});var r=n(441342),o=function(){var e=(0,r.wh)().currentCommunitySettings;return{hasSplitRecurringEventsEnabled:!!(null==e?void 0:e.split_recurring_events_enabled),hasPublicEventRsvpEnabled:!!(null==e?void 0:e.public_event_rsvp_enabled)}}},405521:function(e,t,n){n.d(t,{k:()=>i});var r=n(275271);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(0,r.useRef)(null);return(0,r.useEffect)(function(){var e;t.current&&(null==(e=t.current)||e.focus())},[t,t.current].concat(function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),t}},289424:function(e,t,n){n.d(t,{$:()=>a});var r=n(275271),o=n(255637);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var a=function(e){var t,n=(t=(0,r.useState)("unset"),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return i(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=n[0],s=n[1],l=(0,o.Y)(e);(0,r.useEffect)(function(){return l&&(s(l.style.display||"unset"),l.style.display="none"),function(){l&&(l.style.display=a)}},[l])}},32589:function(e,t,n){n.d(t,{V:()=>o});var r=n(441342);function o(){var e=(0,r.wh)(),t=e.currentCommunity,n=e.currentCommunityMember;return!!(!(null==n?void 0:n.is_admin)&&(null==t?void 0:t.hide_emails_on_member_profiles))}},289131:function(e,t,n){n.d(t,{t:()=>o});var r=n(289424),o=function(){(0,r.$)("#beacon-container")}},413847:function(e,t,n){n.d(t,{$2:()=>a,m3:()=>s,ov:()=>o,rV:()=>i});var r=n(441342);function o(){var e=(0,r.wh)().currentCommunity;return!!(null==e?void 0:e.activity_score_ui_enabled)}function i(){var e=(0,r.wh)(),t=e.currentCommunitySettings,n=e.currentCommunityMember,i=null==n?void 0:n.is_admin,a=o(),s=null==t?void 0:t.upgrade_flows_for_activity_scores_enabled;return!!(i&&(a||s))}function a(){var e=(0,r.wh)().currentCommunity;return!!(null==e?void 0:e.community_ai_feature_flag_enabled)}function s(){var e=(0,r.wh)(),t=e.currentCommunitySettings,n=e.currentCommunityMember,i=null==n?void 0:n.is_admin,s=null==t?void 0:t.upgrade_flows_for_activity_scores_enabled,l=!a(),c=!o();return i&&s&&(l||c)}},119323:function(e,t,n){n.d(t,{u:()=>a,y:()=>i});var r=n(441342),o=n(78456),i=function(){var e=(0,r.wh)(),t=e.currentCommunity,n=e.currentCommunityMember,i=e.currentCommunitySettings,a=!!(null==t?void 0:t.connect_enabled),s=!!(null==i?void 0:i.connect_admin_only),l=(0,o.vb)(n);return s?l&&a:a},a=function(){var e=(0,r.wh)().currentCommunity;return!!(null==e?void 0:e.connect_recommendations_enabled)}},532701:function(e,t,n){n.d(t,{E8:()=>c,L7:()=>l,gq:()=>u,wO:()=>s,z1:()=>a});var r=n(535471),o=n(441342),i=n(78456),a=function(){var e=(0,o.wh)().currentCommunityMember;return!!(null==e?void 0:e.messaging_enabled)},s=function(){var e=(0,o.Cc)().record.group_messaging_enabled,t=(0,o.wh)().currentCommunityMember||{},n=t.messaging_enabled,r=t.messaging_enabled_by_admin,i=t.messaging_enabled_by_member;return e&&void 0!==n&&n&&void 0!==r&&r&&void 0!==i&&i},l=function(){var e,t=(0,o.wh)().currentCommunitySettings;return!!(null==t||null==(e=t.messaging_settings)?void 0:e.member_to_member_messaging_enabled)},c=function(){var e,t=(0,o.wh)(),n=t.currentCommunitySettings,r=t.currentCommunityMember,a=(0,i.vb)(r),s=!!(null==n||null==(e=n.messaging_settings)?void 0:e.member_to_member_messaging_enabled);return a||s},u=function(){var e,t=(0,o.wh)().currentCommunityMember,n=(0,r.D)(),i=!!(null==t||null==(e=t.policies)?void 0:e.can_access_direct_messages);return{shouldShowMessagingRoutes:!!(n||i),showMessagesTab:i}}},800504:function(e,t,n){n.d(t,{f:()=>i});var r=n(276012),o=n(22319),i=function(){var e=(0,o.wC)().masquerade_referrer_url,t=(0,r.Vu)().isBannerVisible;return!!e||t}},961217:function(e,t,n){n.d(t,{k:()=>a});var r=n(275271),o=n(263271);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var a=function(e){var t,n,a=e.enabled,s=e.signedId,l=e.mediaTranscoding,c=e.onSuccess,u=e.onError,d=(t=(0,r.useState)(null!=(n=null==l?void 0:l.status)?n:"pending"),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return i(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=d[0],m=d[1];return(0,o.s)({canCreateConnection:(void 0===a||a)&&!!s,channel:"MediaTranscodingChannel",blob_signed_id:s,onMessageReceive:function(e){"transcodingStatusUpdated"===e.event&&(m(e.json_message.status),"succeeded"===e.json_message.status?null==c||c({hlsUrl:e.json_message.hls_url,previewThumbnailsUrl:e.json_message.preview_thumbnails_url}):"failed"===e.json_message.status&&(null==u||u()))}}),{status:f}}},530133:function(e,t,n){n.d(t,{v:()=>i});var r=n(441342),o=n(117617),i=function(){var e=(0,r.wh)().currentCommunitySettings,t=(0,o.Be)(),n=(0,o.a7)();return{isMobileWebNewSpaceCustomizationUIEnabled:!!(null==e?void 0:e.mobile_web_new_space_customization_ui_enabled)&&!t&&!n}}},813248:function(e,t,n){n.d(t,{k:()=>i});var r=n(131906),o=n(547144),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.useQuery)(o.av.planFeatureFlags.show(),e)}},531829:function(e,t,n){n.d(t,{T:()=>i});var r=n(275271),o="Are you sure you want to leave?",i=function(e){(0,r.useEffect)(function(){var t=function(t){e&&(t.preventDefault(),t.returnValue=o)},n=function(t){e&&!window.confirm(o)&&t.preventDefault()};return window.addEventListener("beforeunload",t),document.addEventListener("turbolinks:before-visit",n),function(){window.removeEventListener("beforeunload",t),document.removeEventListener("turbolinks:before-visit",n)}},[e])}},386670:function(e,t,n){n.d(t,{J:()=>i});var r=n(275271);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(e,t){var n,i=(n=(0,r.useReducer)(e,t),function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(n,2)||function(e,t){if(e){if("string"==typeof e)return o(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],s=i[1],l=(0,r.useRef)(function(){return a});(0,r.useEffect)(function(){l.current=function(){return a}},[a]);var c=(0,r.useCallback)(function(e){"function"==typeof e?e(c,l.current):s(e)},[]);return[a,c]}},56664:function(e,t,n){n.d(t,{$:()=>u});var r=n(131906),o=n(903225),i=n(739792),a=n(93199),s=n(547144),l=n(60878),c=n(494375),u=function(){var e=(0,l.pm)(),t=e.success,n=e.error,u=(0,o.k6)(),d=(0,r.useMutation)(function(e){var t;return t=Number(e),(0,a.Cu)(s.av.scheduleDowngrades.create(t),{})},{onSuccess:function(){u.push(c.OS.SCHEDULED_DOWNGRADE_SUCCESS),t((0,i.t)("pricing_plans.subscription_updated"))},onError:function(){n((0,i.t)("pricing_plans.errors.schedule_downgrade_error"))}}),f=d.mutate,m=d.isLoading,p=(0,r.useMutation)(function(){return(0,a.Cu)(s.av.scheduleDowngrades.cancel(),{})},{onSuccess:function(){t((0,i.t)("pricing_plans.downgrade_schedule_cancelation.success"))},onError:function(){n((0,i.t)("pricing_plans.downgrade_schedule_cancelation.error"))}});return{scheduleDowngrade:f,isSchedulingDowngrade:m,cancelScheduledDowngrade:p.mutate,isCancelingDowngrade:p.isLoading}}},134592:function(e,t,n){n.d(t,{c:()=>u});var r=n(303189),o=n(78456),i=n(906082),a=n(484530),s=n(441342),l=function(e){var t,n=(0,s.wh)().experimentation;return(null!=(t=null==n?void 0:n.flags)?t:{})[e]},c=n(824869),u=function(){var e,t,n,u,d=(0,r.D)().currentPlan,f=(0,c.E)(),m=f.isCommunityOnTrial,p=f.isCommunityOnPaidPlan,b=(0,s.wh)(),h=b.currentCommunityMember,v=b.currentCommunity,y=l("business_plan_trial_test"),g=y&&(void 0===y?"undefined":y&&"undefined"!=typeof Symbol&&y.constructor===Symbol?"symbol":typeof y)=="object"&&"type"in y?y.type:void 0,x=(0,a.j)("business_plan_trial_test"),_=(null==d||null==(e=d.plan_trial)?void 0:e.active)||!1,j=(null==d||null==(t=d.plan_trial)?void 0:t.opted_out)||!1,w=(null==d||null==(n=d.plan_trial)?void 0:n.converted)||!1,O=(0,o.vb)(h),S=(null==v||null==(u=v.subscription)?void 0:u.status)==="active";return O&&x&&"variant_a"===g&&!m&&!_&&!j&&!w&&p&&S&&d&&(0,i.BD)(d.tier)}},226801:function(e,t,n){n.d(t,{L:()=>l,d:()=>c});var r=n(131906),o=n(441342),i=n(218059),a=n(93199),s=n(547144),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(0,i.Wj)(),n=(0,r.useQuery)({queryKey:["space-sidebar-notifications",e],queryFn:function(){return(0,a.UT)(s.av.sidebarNotifications.index({space_ids:e}))},enabled:!1,onSuccess:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];1===e.length?t({type:"UPDATE_SPACE_NOTIFICATIONS",payload:{space:e[0]}}):t({type:"SET_SPACE_NOTIFICATIONS",payload:{spaces:e||[]}})},onError:function(e){console.error("Something went wrong",e)}}),o=n.isLoading;return{refetchSpaceNotifications:n.refetch,isLoading:o}},c=function(e){var t=(0,o.nT)(),n=l([e]).refetchSpaceNotifications;return{resetUnreadCount:(0,r.useMutation)(function(){return(0,a.Cu)(s.av.spaces.resetUnreadCount({spaceId:e}),{forReactQuery:!0})},{onSuccess:function(e){t.actions.updateSpace(e),n()},onError:function(e){console.error("Error while resetting the unread count",e)}}).mutateAsync}}},255637:function(e,t,n){n.d(t,{Y:()=>s});var r=n(275271),o=n(952510);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var s=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,s=(t=(0,r.useState)(null),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return i(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=s[0],c=s[1];return(0,r.useEffect)(function(){var t;(t=function(){var t;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:return[4,(0,o.g)(e,{timeout:n})];case 1:var i,a;return i=t=r.sent(),(null!=(a=HTMLElement)&&"undefined"!=typeof Symbol&&a[Symbol.hasInstance]?!!a[Symbol.hasInstance](i):i instanceof a)&&c(t),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)})})()},[e,n]),l}},263271:function(e,t,n){n.d(t,{s:()=>b});var r=n(275271),o=n(932699),i=n(257335),a=(0,n(814730).tx)();function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=new Map,u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.channel,r=l(e,["channel"]);if(n&&t){c.has(n)||c.set(n,[]);var u=c.get(n),d=u.find(function(e){var t=e.params;return(0,o.isEqual)(r,t)});return d?d.callbacks.push(t):(d={subscription:a.subscribeTo(n,r),params:r,callbacks:[t]},u.push(d),d.subscription.on("message",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];d.callbacks.forEach(function(e){return e.apply(void 0,function(e){if(Array.isArray(e))return s(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return s(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())})}),d.subscription.on("connect",function(){i.Z.emitSubscriptionStateChange({channel:n,subscriptionState:"connected"})}),d.subscription.on("disconnect",function(){i.Z.emitSubscriptionStateChange({channel:n,subscriptionState:"disconnected"})})),d}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.channel,r=l(e,["channel"]);if(n&&t){var i=c.get(n);if(i){var a=i.find(function(e){var t=e.params;return(0,o.isEqual)(r,t)});a&&(a.callbacks=a.callbacks.filter(function(e){return e!==t}),a.callbacks.length||(a.subscription.disconnect(),c.set(n,i.filter(function(e){var t=e.params;return!(0,o.isEqual)(r,t)}))))}}};function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){f(e,t,n[t])})}return e}function p(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.channel,o=e.onMessageReceive,i=e.canCreateConnection,a=void 0===i||i,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["channel","onMessageReceive","canCreateConnection"]),l=(0,r.useRef)(o),c=(0,r.useRef)({}),b=JSON.stringify(s),h=JSON.stringify(t),v=(0,r.useRef)(s);v.current=s,l.current=o;var y=(0,r.useCallback)(function(e){return l.current(e)},[]);return(0,r.useEffect)(function(){if(a){var e=v.current,t=u(m({channel:n},e),y);return t&&(c.current=p(m({},c.current),f({},n,t))),function(){d(m({channel:n},e),y),c.current=p(m({},c.current),f({},n,null))}}},[n,a,b,h,y]),c.current[n]}},624804:function(e,t,n){n.d(t,{k:()=>i});var r=n(275271);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=(e=(0,r.useState)(t),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return o(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=n[0],a=n[1];return[i,(0,r.useCallback)(function(){return a(function(e){return!e})},[a]),a]}},548298:function(e,t,n){n.d(t,{c:()=>i});var r=n(275271);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(e,t){var n,i=(n=(0,r.useState)(e),function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(n,2)||function(e,t){if(e){if("string"==typeof e)return o(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],s=i[1];return(0,r.useEffect)(function(){var n=setTimeout(function(){s(e)},t);return function(){clearTimeout(n)}},[e,t]),a}},233516:function(e,t,n){n.d(t,{T:()=>i});var r=n(275271);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(){var e,t=(e=(0,r.useState)(void 0),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return o(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=t[0],i=t[1];return{ref:(0,r.useCallback)(function(e){e&&i(e.clientHeight)},[]),height:n}}},447640:function(e,t,n){n.d(t,{D:()=>o});var r=n(574307),o=function(){var e=(0,r.useFrame)(),t=e.document,n=e.window;return{frameDocument:t||document,frameWindow:null!=n?n:window,isInFrame:t&&t!==document}}},78580:function(e,t,n){n.d(t,{M:()=>a});var r=n(275271),o=n(117383),i=n(447640),a=function(e,t,n,a){var s=(0,i.D)(),l=s.frameDocument,c=s.isInFrame,u=(0,r.useMemo)(function(){if(c){var e,t;return e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},n),t=t={document:l},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}return n},[n,l,c]);return(0,o.y1)(e,t,u,a)}},194556:function(e,t,n){n.d(t,{A:()=>i});var r=n(275271);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(){var e,t=(0,r.useRef)(null),n=(e=(0,r.useState)(!0),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return o(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=n[0],a=n[1];return(0,r.useEffect)(function(){var e=new IntersectionObserver(function(e){a(null==e?void 0:e[0].isIntersecting)});return t.current&&e.observe(t.current),function(){e.disconnect()}},[]),[t,i]}},175730:function(e,t,n){n.d(t,{t:()=>i});var r=n(275271),o=n(932699),i=function(e){var t=e.onArrowDown,n=e.onArrowUp,i=e.onEnter,a=e.onEscape,s=e.enabled,l=void 0===s||s,c=e.elementRef,u=void 0===c?null:c;(0,r.useEffect)(function(){var e=(null==u?void 0:u.current)||document,r={ArrowDown:t,ArrowUp:n,Enter:i,Escape:a},s=function(e){if("key"in e){var t=r[e.key];(0,o.isFunction)(t)&&t(e)}};return l&&e?e.addEventListener("keydown",s):null==e||e.removeEventListener("keydown",s),function(){return null==e?void 0:e.removeEventListener("keydown",s)}},[l,t,n,i,a,u])}},283095:function(e,t,n){n.d(t,{K:()=>s,d:()=>l});var r=n(275271),o=n(932699),i=n(227851),a=n(431841),s=function(e){var t=e.cacheKey,n=e.fields,s=e.enabled,l=void 0===s||s,c=(0,i.qo)(),u=(0,o.pick)(c,void 0===n?[]:n),d=(0,a._)(t).setValue;(0,r.useEffect)(function(){l&&t&&d(u)},[u,t,l,d])},l=function(e){var t=e.cacheKey;if(!t)throw Error("CacheKey is required");var n=(0,a._)(t);return{getPersistedFormFieldValues:n.getValue,resetValues:n.resetValue}}},5179:function(e,t,n){n.d(t,{g:()=>o});var r=n(275271),o=function(e){var t=(0,r.useRef)(null);return(0,r.useLayoutEffect)(function(){var n=t.current;e&&n&&n.scrollIntoView({behavior:"smooth",block:"center"})},[e]),t}},212635:function(e,t,n){n.d(t,{M:()=>a});var r=n(275271),o=n(227851),i=n(767379),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.enabled,n=void 0===t||t,a=(0,o.Gc)();(0,r.useEffect)(function(){if(n){var e=function(e){"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&(0,i.C)(a)&&a.triggerFormSubmit()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}},[n,a])}},421541:function(e,t,n){n.d(t,{n:()=>r});var r={LAST_7_DAYS:"last_7_days",LAST_MONTH:"last_month",FROM_UNREAD:"from_unread"}},494571:function(e,t,n){n.d(t,{d:()=>r});var r={APPROVED:"approved",ANSWERED:"answered",UNANSWERED:"unanswered",PENDING:"pending",DISMISSED:"dismissed"}},11079:function(e,t,n){n.d(t,{Y:()=>o});var r=n(664215),o=function(e){return(0,r.default)(e,"yyyy-MM-dd",new Date)}},647190:function(e,t,n){n.d(t,{o:()=>i});var r=n(552676),o=n(859834),i=function(e){var t,n,i=e.member,a=e.children,s=i.name,l=i.public_uid,c=(0,o.O)({public_uid:l});return(0,r.jsx)("a",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},c),n=n={title:s,children:a},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))}},729504:function(e,t,n){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{W:()=>o});var o=function(){var e;function t(e){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");this.element=e}return e=[{key:"addAttachmentClickEventHandler",value:function(e){var t=this;this.element.addEventListener("click",function(n){var r=n.target.closest("action-text-attachment");if(r){var o=t.parseAttachmentAttributes(r);if(t.isPreviewableAttachment(o)){var i=t.getSimilarAttachments(o),a=i.findIndex(function(e){return e.sgid===o.sgid});e({attachments:i,currentIndex:a})}}})}},{key:"getSimilarAttachments",value:function(e){var t,n=this.isImageAttachment(e)&&this.isImageAttachment||this.isPdfAttachment(e)&&this.isPdfAttachment;return((function(e){if(Array.isArray(e))return r(e)})(t=this.element.querySelectorAll("action-text-attachment"))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return r(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map(this.parseAttachmentAttributes).filter(n)}},{key:"isPreviewableAttachment",value:function(e){return this.isPdfAttachment(e)||this.isImageAttachment(e)}},{key:"isImageAttachment",value:function(e){return["image/png","image/jpeg","image/jpg","image/gif"].includes(e.contentType)}},{key:"isPdfAttachment",value:function(e){return["application/pdf"].includes(e.contentType)}},{key:"parseAttachmentAttributes",value:function(e){var t,n;return{sgid:e.getAttribute("sgid"),contentType:e.getAttribute("content-type"),url:null==(n=e.querySelector("[data-target~='blob-container']"))||null==(t=n.dataset)?void 0:t.blobUrl,filename:e.getAttribute("filename"),filesize:e.getAttribute("filesize"),width:e.getAttribute("width"),height:e.getAttribute("height")}}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}()}}]);
//# sourceMappingURL=/packs/js/418-885594ba6f1309ca.js.map